<!DOCTYPE html>





<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 3.9.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=7.4.0">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=7.4.0">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=7.4.0">
  <link rel="mask-icon" href="/images/logo.svg?v=7.4.0" color="#222">

<link rel="stylesheet" href="/css/main.css?v=7.4.0">


<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css?v=4.7.0">


<script id="hexo-configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '7.4.0',
    exturl: false,
    sidebar: {"position":"left","display":"post","offset":12,"onmobile":false},
    copycode: {"enable":false,"show_result":false,"style":null},
    back2top: {"enable":true,"sidebar":false,"scrollpercent":false},
    bookmark: {"enable":false,"color":"#222","save":"auto"},
    fancybox: false,
    mediumzoom: false,
    lazyload: false,
    pangu: false,
    algolia: {
      appID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    },
    localsearch: {"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},
    path: '',
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    translation: {
      copy_button: 'Copy',
      copy_success: 'Copied',
      copy_failure: 'Copy failed'
    },
    sidebarPadding: 40
  };
</script>

  <meta name="description" content="1 复习Socket1.1 编写服务器用到的知识点1) Socket 编程 2) HTML 3) HTTP 协议 4) 反射 5) XML 解析 6) 服务器编写 1.2 复习 Socket 编程1) C/S 结构:客户端与服务器端一次双向通信 2) B/S 结构:浏览器与服 服务器与客户端单次双向通信 12345678910111213141516171819202122232425262728">
<meta name="keywords" content="服务器,Socket">
<meta property="og:type" content="article">
<meta property="og:title" content="20181119 服务器项目">
<meta property="og:url" content="http://zwer.xyz/2018/11/19/Java/20181119 服务器项目/index.html">
<meta property="og:site_name" content="zwer 的博客空间">
<meta property="og:description" content="1 复习Socket1.1 编写服务器用到的知识点1) Socket 编程 2) HTML 3) HTTP 协议 4) 反射 5) XML 解析 6) 服务器编写 1.2 复习 Socket 编程1) C/S 结构:客户端与服务器端一次双向通信 2) B/S 结构:浏览器与服 服务器与客户端单次双向通信 12345678910111213141516171819202122232425262728">
<meta property="og:locale" content="en">
<meta property="og:image" content="c:%5CUsers%5CLenovo%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1543980368379.png">
<meta property="og:image" content="c:%5CUsers%5CLenovo%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1543980429389.png">
<meta property="og:image" content="c:%5CUsers%5CLenovo%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1542715446421.png">
<meta property="og:image" content="c:%5CUsers%5CLenovo%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1542718075921.png">
<meta property="og:image" content="c:%5CUsers%5CLenovo%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1542718083794.png">
<meta property="og:image" content="c:%5CUsers%5CLenovo%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1542718369651.png">
<meta property="og:image" content="c:%5CUsers%5CLenovo%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1542723988088.png">
<meta property="og:image" content="c:%5CUsers%5CLenovo%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1542801240035.png">
<meta property="og:updated_time" content="2018-12-05T04:20:58.460Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="20181119 服务器项目">
<meta name="twitter:description" content="1 复习Socket1.1 编写服务器用到的知识点1) Socket 编程 2) HTML 3) HTTP 协议 4) 反射 5) XML 解析 6) 服务器编写 1.2 复习 Socket 编程1) C/S 结构:客户端与服务器端一次双向通信 2) B/S 结构:浏览器与服 服务器与客户端单次双向通信 12345678910111213141516171819202122232425262728">
<meta name="twitter:image" content="c:%5CUsers%5CLenovo%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1543980368379.png">
  <link rel="canonical" href="http://zwer.xyz/2018/11/19/Java/20181119 服务器项目/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome: false,
    isPost: true,
    isPage: false,
    isArchive: false
  };
</script>

  <title>20181119 服务器项目 | zwer 的博客空间</title>
  








  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .logo,
  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="en">
  <div class="container use-motion">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-meta">

    <div>
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">zwer 的博客空间</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
        <p class="site-subtitle">上善若水 自强不息</p>
      
  </div>

  <div class="site-nav-toggle">
    <button aria-label="Toggle navigation bar">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>


<nav class="site-nav">
  
  <ul id="menu" class="menu">
      
      
      
        
        <li class="menu-item menu-item-home">
      
    

    <a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i> <br>Home</a>

  </li>
      
      
      
        
        <li class="menu-item menu-item-archives">
      
    

    <a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i> <br>Archives</a>

  </li>
  </ul>

    

</nav>
</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
      <article itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block post">
    <link itemprop="mainEntityOfPage" href="http://zwer.xyz/2018/11/19/Java/20181119 服务器项目/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="zwer">
      <meta itemprop="description" content="记录学习的日常">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="zwer 的博客空间">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">20181119 服务器项目

          
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              
                
              

              <time title="Created: 2018-11-19 21:39:00" itemprop="dateCreated datePublished" datetime="2018-11-19T21:39:00+08:00">2018-11-19</time>
            </span>
          
            

            
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2018-12-05 12:20:58" itemprop="dateModified" datetime="2018-12-05T12:20:58+08:00">2018-12-05</time>
              </span>
            
          
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Java/" itemprop="url" rel="index"><span itemprop="name">Java</span></a></span>

                
                
              
            </span>
          

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h3 id="1-复习Socket"><a href="#1-复习Socket" class="headerlink" title="1 复习Socket"></a>1 复习Socket</h3><h4 id="1-1-编写服务器用到的知识点"><a href="#1-1-编写服务器用到的知识点" class="headerlink" title="1.1 编写服务器用到的知识点"></a>1.1 编写服务器用到的知识点</h4><p>1) Socket 编程</p>
<p>2) HTML</p>
<p>3) HTTP 协议</p>
<p>4) 反射</p>
<p>5) XML 解析</p>
<p>6) 服务器编写</p>
<h4 id="1-2-复习-Socket-编程"><a href="#1-2-复习-Socket-编程" class="headerlink" title="1.2 复习 Socket 编程"></a>1.2 复习 Socket 编程</h4><p>1) C/S 结构:客户端与服务器端一次双向通信</p>
<p>2) B/S 结构:浏览器与服</p>
<p>服务器与客户端单次双向通信</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.szxy.socket.server;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.DataInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.DataOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.net.ServerSocket;</span><br><span class="line"><span class="keyword">import</span> java.net.Socket;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Server</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"Server start..."</span>);</span><br><span class="line">		<span class="comment">//创建 ServerSocket 对象</span></span><br><span class="line">		ServerSocket server=<span class="keyword">null</span>;</span><br><span class="line">		<span class="comment">//监听客户端的请求，并获得输入流</span></span><br><span class="line">		Socket client=<span class="keyword">null</span>;</span><br><span class="line">		DataInputStream dis=<span class="keyword">null</span>;</span><br><span class="line">		<span class="comment">//获得输出流</span></span><br><span class="line">		DataOutputStream dos=<span class="keyword">null</span>;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			server = <span class="keyword">new</span> ServerSocket(<span class="number">8888</span>);</span><br><span class="line">			client = server.accept();</span><br><span class="line">			dis = <span class="keyword">new</span> DataInputStream(client.getInputStream());</span><br><span class="line">			System.out.println(dis.readUTF());</span><br><span class="line">			dos = <span class="keyword">new</span> DataOutputStream(client.getOutputStream());</span><br><span class="line">			dos.writeUTF(<span class="string">"Hello Client!"</span>);</span><br><span class="line">		&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">			<span class="comment">// TODO 自动生成的 catch 块</span></span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;<span class="keyword">finally</span>&#123;</span><br><span class="line">			<span class="comment">//关闭</span></span><br><span class="line">			IOClose.CloseAll(dos,dis,client,server);</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.szxy.socket.client;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.DataInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.DataOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.net.Socket;</span><br><span class="line"><span class="keyword">import</span> java.net.UnknownHostException;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 客户端</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> wzer</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		<span class="comment">//创建Socket对象</span></span><br><span class="line">		Socket client=<span class="keyword">null</span>;</span><br><span class="line">		<span class="comment">//获得输出流</span></span><br><span class="line">		DataOutputStream dos=<span class="keyword">null</span>;</span><br><span class="line">		<span class="comment">//获得输入流</span></span><br><span class="line">		DataInputStream dis=<span class="keyword">null</span>;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			client = <span class="keyword">new</span>  Socket(<span class="string">"localhost"</span>, <span class="number">8888</span>);</span><br><span class="line">			dos = <span class="keyword">new</span> DataOutputStream(client.getOutputStream());</span><br><span class="line">			dos.writeUTF(<span class="string">"Hello Server"</span>);</span><br><span class="line">			dis = <span class="keyword">new</span> DataInputStream(client.getInputStream());</span><br><span class="line">			System.out.println(dis.readUTF());</span><br><span class="line">		&#125; <span class="keyword">catch</span> (UnknownHostException e) &#123;</span><br><span class="line">			<span class="comment">// TODO 自动生成的 catch 块</span></span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">			<span class="comment">// TODO 自动生成的 catch 块</span></span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;<span class="keyword">finally</span>&#123;</span><br><span class="line">			<span class="comment">//关闭</span></span><br><span class="line">			IOClose.CloseAll(dis,dos,client);</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>服务器与浏览器单向通信</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.szxy.socket.server;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.BufferedReader;</span><br><span class="line"><span class="keyword">import</span> java.io.BufferedWriter;</span><br><span class="line"><span class="keyword">import</span> java.io.DataInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.DataOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStreamReader;</span><br><span class="line"><span class="keyword">import</span> java.io.OutputStreamWriter;</span><br><span class="line"><span class="keyword">import</span> java.net.ServerSocket;</span><br><span class="line"><span class="keyword">import</span> java.net.Socket;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BrowerServer</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"Server start..."</span>);</span><br><span class="line">		<span class="comment">//创建 ServerSocket 对象</span></span><br><span class="line">		ServerSocket server=<span class="keyword">null</span>;</span><br><span class="line">		<span class="comment">//监听客户端的请求，并获得输入流</span></span><br><span class="line">		Socket client=<span class="keyword">null</span>;</span><br><span class="line">		BufferedReader br =<span class="keyword">null</span>;</span><br><span class="line">		<span class="comment">//获得输出流</span></span><br><span class="line">		BufferedWriter bw =<span class="keyword">null</span>;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			server = <span class="keyword">new</span> ServerSocket(<span class="number">8888</span>);</span><br><span class="line">			client = server.accept();</span><br><span class="line">			</span><br><span class="line">			br = <span class="keyword">new</span> BufferedReader(<span class="keyword">new</span> InputStreamReader(client.getInputStream(),<span class="string">"utf-8"</span>));</span><br><span class="line">			String str=<span class="keyword">null</span>;</span><br><span class="line">			<span class="comment">// br.readLine().length</span></span><br><span class="line">			<span class="keyword">while</span>((str=br.readLine()).length()&gt;<span class="number">0</span>)&#123;</span><br><span class="line">				System.out.println(str);</span><br><span class="line">			&#125;</span><br><span class="line">			bw = <span class="keyword">new</span> BufferedWriter(<span class="keyword">new</span> OutputStreamWriter(client.getOutputStream(),<span class="string">"utf-8"</span>));</span><br><span class="line">			bw.write(<span class="string">"Hello client!"</span>);</span><br><span class="line">			</span><br><span class="line">		&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">			<span class="comment">// TODO 自动生成的 catch 块</span></span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;<span class="keyword">finally</span>&#123;</span><br><span class="line">			<span class="comment">//关闭</span></span><br><span class="line">			IOClose.CloseAll(bw,br,client,server);</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="2-HTML"><a href="#2-HTML" class="headerlink" title="2 HTML"></a>2 HTML</h3><p>作用：显示数据</p>
<h4 id="2-1-HTML-编写"><a href="#2-1-HTML-编写" class="headerlink" title="2.1 HTML 编写"></a>2.1 HTML 编写</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span>HTML 网页<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">h1</span>&gt;</span></span><br><span class="line">            Hello World</span><br><span class="line">        <span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="2-2-form-表单"><a href="#2-2-form-表单" class="headerlink" title="2.2 form 表单"></a>2.2 form 表单</h4><p>作用：与用户之间进行交互</p>
<p>method: 请求方式 get/post</p>
<p>​    get:不安全 数据量小  </p>
<p>​    post:安全  请求数据量大</p>
<p>post 请求方式会在请求的正文中，然后发送给服务器。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span>HTML 网页<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">"http://localhost:8888"</span> <span class="attr">method</span>=<span class="string">"get"</span>&gt;</span></span><br><span class="line">        	<span class="tag">&lt;<span class="name">p</span>&gt;</span></span><br><span class="line">                用户名：<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">id</span>=<span class="string">"unname"</span> <span class="attr">name</span>=<span class="string">"userName"</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">p</span>&gt;</span>  </span><br><span class="line">            <span class="tag">&lt;<span class="name">p</span>&gt;</span></span><br><span class="line">                密码：<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"password"</span> <span class="attr">id</span>=<span class="string">"pwd"</span> <span class="attr">name</span>=<span class="string">"passWd"</span>&gt;</span>	</span><br><span class="line">            <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">p</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"submit"</span> <span class="attr">value</span>=<span class="string">"提交"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="3-HTTP-协议"><a href="#3-HTTP-协议" class="headerlink" title="3 HTTP 协议"></a>3 HTTP 协议</h3><h4 id="3-1-协议"><a href="#3-1-协议" class="headerlink" title="3.1 协议"></a>3.1 协议</h4><p>1) 应用层:HTTP、FTP、TELNET、SNMP、DNS<br>2) 传输层:TCP、UDP<br>3) 网络层:IP</p>
<h4 id="3-2HTTP-协议简介"><a href="#3-2HTTP-协议简介" class="headerlink" title="3.2HTTP 协议简介"></a>3.2HTTP 协议简介</h4><p>HTTP:Hypertext Transfer Protocol 超文本传输协议,是网络应用层的协议，建立在 TCP/IP 协议基础上，HTTP 使用可靠的 TCP 连接，默认端口为 80。<br>用户打开 Web 浏览器(常见的 HTTP 客户端)，输入 URL<br>地址，就能接收到远程 HTTP 服务器端发送过来的网页，即HTTP 遵循请求(Request)/应答(Response)模型。Web 浏览器向 Web 服务器发送请求，Web 服务器处理请求并返回适当的应答，所有 HTTP 连接都被构造成一套请求与应答。HTTP 客户端和服务器分别由不同的软件开发商提供，它们都可以用任意的编程语言编写，如用.NET 编写的客户程序与用 Java 编写的服务器程序顺利通信，就必须遵守 HTTP 协<br>议，这样才能彼此都懂对方发送的消息，HTTP 协议严格规定了 HTTP 请求和 HTTP 响应的数据格式。</p>
<h4 id="3-3HTTP-请求格式"><a href="#3-3HTTP-请求格式" class="headerlink" title="3.3HTTP 请求格式"></a>3.3HTTP 请求格式</h4><p>1) 请求方式、URI(统一资源定位符)、HTTP 协议/版本<br>2) 请求头 Request Header<br>​    a) 请求头包含许多有关客户端环境和请求正文的有用信息。例如，请求头可以声明浏览器所用的语言，请求正文的长度等。<br>3) 请求正文 Requet Content (只有在 post 方式才有)<br>请求头和请求正文之间必须有符号行（回车符或行结束符），<br>请请求头分开。这个行非常重要，它表示请求头已结束，接<br>下来的是请求正文。通常 post 方式的数据存放于此，请求正<br>文中可以包含客户提交的查询字符串等信息。在实际应用中，<br>HTTP 请求正文可以包含更多的内容</p>
<p><strong>示例：</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">GET /Log?username=123&amp;pwd=123&amp;hobby=baketball HTTP/1.1</span><br><span class="line">Host: localhost:8888</span><br><span class="line">Connection: keep-alive</span><br><span class="line">Cache-Control: max-age=0</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br></pre></td></tr></table></figure>

<p><img src="C:%5CUsers%5CLenovo%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1543980368379.png" alt="1543980368379"></p>
<h4 id="3-4HTTP-响应格式"><a href="#3-4HTTP-响应格式" class="headerlink" title="3.4HTTP 响应格式"></a>3.4HTTP 响应格式</h4><p>1) HTTP 协议版本、状态代码、描述<br>2) 响应头(Response Head)<br>3) 响应正文(Respose Content)</p>
<p><img src="C:%5CUsers%5CLenovo%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1543980429389.png" alt="1543980429389"></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.szxy.socket.server;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.BufferedWriter;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.OutputStreamWriter;</span><br><span class="line"><span class="keyword">import</span> java.net.ServerSocket;</span><br><span class="line"><span class="keyword">import</span> java.net.Socket;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BrowerServer2</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		String CRLF=<span class="string">"\r\n"</span>;<span class="comment">//换行</span></span><br><span class="line">		String BLANK=<span class="string">" "</span>;<span class="comment">//空格</span></span><br><span class="line">		<span class="comment">//(1)创建ServerSocket对象</span></span><br><span class="line">		ServerSocket server=<span class="keyword">null</span>;</span><br><span class="line">		<span class="comment">//(2)监听是否有客户端发送请求</span></span><br><span class="line">		Socket client=<span class="keyword">null</span>;</span><br><span class="line">		InputStream is=<span class="keyword">null</span>;</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			server = <span class="keyword">new</span> ServerSocket(<span class="number">8888</span>);</span><br><span class="line">			client = server.accept();</span><br><span class="line">			<span class="comment">//获取来自浏览器的请求信息</span></span><br><span class="line">			is=client.getInputStream();</span><br><span class="line">			<span class="keyword">byte</span> [] buf=<span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">20480</span>];</span><br><span class="line">			<span class="keyword">int</span> len=is.read(buf);</span><br><span class="line">			System.out.println(<span class="keyword">new</span> String(buf,<span class="number">0</span>,len));</span><br><span class="line">			<span class="comment">/**对Web浏览器的请求作出响应*/</span></span><br><span class="line">			StringBuilder sb=<span class="keyword">new</span> StringBuilder();</span><br><span class="line">			StringBuilder sbContent=<span class="keyword">new</span> StringBuilder();<span class="comment">//响应的文本</span></span><br><span class="line">			sbContent.append(<span class="string">"&lt;html&gt;&lt;head&gt;&lt;title&gt;响应结果&lt;/title&gt;&lt;/head&gt;"</span>);</span><br><span class="line">			sbContent.append(<span class="string">"&lt;body&gt;登录成功&lt;/body&gt;&lt;/html&gt;"</span>);</span><br><span class="line">			</span><br><span class="line">			<span class="comment">//(1)拼接响应头</span></span><br><span class="line">			sb.append(<span class="string">"HTTP/1.1"</span>).append(BLANK).append(<span class="number">200</span>).append(BLANK).append(<span class="string">"OK"</span>);</span><br><span class="line">			sb.append(CRLF);<span class="comment">//换行</span></span><br><span class="line">			sb.append(<span class="string">"Content-Type: text/html;charset=utf-8"</span>);</span><br><span class="line">			sb.append(CRLF);<span class="comment">//换行</span></span><br><span class="line">			sb.append(<span class="string">"Content-Length:"</span>).append(sbContent.toString().getBytes().length).append(CRLF);</span><br><span class="line">			sb.append(CRLF);<span class="comment">//换行,代表响应头与响应的正文部门之间的空行</span></span><br><span class="line">			sb.append(sbContent);</span><br><span class="line">			</span><br><span class="line">			<span class="comment">//通过流输出 </span></span><br><span class="line">			BufferedWriter bw=<span class="keyword">new</span> BufferedWriter(<span class="keyword">new</span> OutputStreamWriter(client.getOutputStream(),<span class="string">"utf-8"</span>));</span><br><span class="line">			bw.write(sb.toString());</span><br><span class="line">			bw.flush();</span><br><span class="line">			bw.close();</span><br><span class="line">			</span><br><span class="line">		&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">			<span class="comment">// TODO Auto-generated catch block</span></span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;<span class="keyword">finally</span>&#123;</span><br><span class="line">		<span class="comment">//(6)关闭流</span></span><br><span class="line">			IOClose.CloseAll(is,client,server);</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">	浏览器访问</span></span><br><span class="line"><span class="comment">	</span></span><br><span class="line"><span class="comment">	</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>

<p><img src="C:%5CUsers%5CLenovo%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1542715446421.png" alt="1542715446421"></p>
<h3 id="4-Tomcat-快速应用"><a href="#4-Tomcat-快速应用" class="headerlink" title="4 Tomcat 快速应用"></a>4 Tomcat 快速应用</h3><h4 id="4-1Tomcat-简介"><a href="#4-1Tomcat-简介" class="headerlink" title="4.1Tomcat 简介"></a>4.1Tomcat 简介</h4><p>Tomcat 是 在 SUN 公 司 的 JSWDK（ <code>JavaServer WebDevelopmentKit</code> ,是 SUN 公司推出的小型 Servlet/JSP 调试工具）的基础上发展起来的一个优秀的 Servlet 容器，Tomcat<br>本身完全用 Java 语言编写。</p>
<h4 id="4-2Tomcat-使用"><a href="#4-2Tomcat-使用" class="headerlink" title="4.2Tomcat 使用"></a>4.2Tomcat 使用</h4><p>1) 配置 <code>Tomcat</code>  JAVA_HOME    Java JDK 的根目录</p>
<p><img src="C:%5CUsers%5CLenovo%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1542718075921.png" alt="1542718075921"></p>
<p>b) CATALINA_HOME    Tomcat 根目录</p>
<p><img src="C:%5CUsers%5CLenovo%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1542718083794.png" alt="1542718083794"></p>
<p>2) 启动和关闭 </p>
<p>Tomcat启动 Tomcat 服务器:startup.bat<br>关闭 Tomcat 服务器:shutdown.bat</p>
<p>3) 部署项目到服务器在 <code>webapps</code>目录下新建目录存放.html 面页 访问项目</p>
<h3 id="5-Tomcat-服务器运行原理"><a href="#5-Tomcat-服务器运行原理" class="headerlink" title="5 Tomcat 服务器运行原理"></a>5 Tomcat 服务器运行原理</h3><h4 id="5-1Tomcat-的运行原理"><a href="#5-1Tomcat-的运行原理" class="headerlink" title="5.1Tomcat 的运行原理"></a>5.1Tomcat 的运行原理</h4><p><strong>客户浏览器发出要求访问特定的 Servlet 的请求。</strong></p>
<p>1) Tomcat 服务器接收到客户请求并解析。</p>
<p>2) Tomcat 服 务 器 创 建 一 个 <code>ServletRequest</code>对 象 ， 在<code>ServletRequest</code> 对象中包含了客户请求信息及其他关于客户的信息，如请求头，请求正文，以及客户机的 IP 地址等。</p>
<p>3) Tomcat 服务器创建一个<code>ServletResponse</code> 对象</p>
<p>4) Tomcat 服务器调用客户所请求的 Servlet 的 service 服务方法，并且把 <code>ServletRequst</code> 对象和 <code>ServletResponse</code> 对象做为参数传给该服务方法。</p>
<p>5) Servlet 从<code>ServletRequest</code>对象中可获取客户的请求信息。</p>
<p>6) Servlet 利用 <code>ServletResponse</code> 对象来生成响应结果</p>
<p>7) Tomcat 服务器把 Servlet 生成的响应结果发送给客户。</p>
<p><img src="C:%5CUsers%5CLenovo%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1542718369651.png" alt="1542718369651"></p>
<h3 id="6-http-工具查看网络交互过程"><a href="#6-http-工具查看网络交互过程" class="headerlink" title="6  http 工具查看网络交互过程"></a>6  http 工具查看网络交互过程</h3><h4 id="6-1-下载并安装"><a href="#6-1-下载并安装" class="headerlink" title="6.1 下载并安装"></a>6.1 下载并安装</h4><p>链接：<a href="https://pan.baidu.com/s/1OPIaYkwCGP_boRQ62dHuug" target="_blank" rel="noopener">https://pan.baidu.com/s/1OPIaYkwCGP_boRQ62dHuug</a><br>提取码：3bv8 </p>
<h4 id="6-2-HttpWatch-的使用"><a href="#6-2-HttpWatch-的使用" class="headerlink" title="6.2 HttpWatch 的使用"></a>6.2 <code>HttpWatch</code> 的使用</h4><p>1) IE 浏 览 器  –&gt; 查 看 –&gt;  浏 览 器 栏 –&gt;  <code>HttpWatch Professional</code><br>2) 输入网址<br>3) 分析数据</p>
<h3 id="7-整体架构和接口-编写XML文件"><a href="#7-整体架构和接口-编写XML文件" class="headerlink" title="7 整体架构和接口_编写XML文件"></a>7 整体架构和接口_编写XML文件</h3><h4 id="7-1-整体架构和接口"><a href="#7-1-整体架构和接口" class="headerlink" title="7.1 整体架构和接口"></a>7.1 整体架构和接口</h4><h5 id="Entity-类-实体类"><a href="#Entity-类-实体类" class="headerlink" title="Entity 类  实体类"></a>Entity 类  实体类</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.szxy.server;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * &lt;servlet&gt;</span></span><br><span class="line"><span class="comment">		&lt;servlet-name&gt;login&lt;/servlet-name&gt;</span></span><br><span class="line"><span class="comment">		&lt;servlet-class&gt;cn.szxy.servlet.LoginServlet&lt;/servlet-class&gt;</span></span><br><span class="line"><span class="comment">	&lt;/servlet&gt;</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> wzer</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Entity</span> </span>&#123;<span class="comment">//一个 servlet-name 对应 一个 实体类</span></span><br><span class="line">	<span class="keyword">private</span> String name;<span class="comment">// servlet-name</span></span><br><span class="line">	<span class="keyword">private</span> String clazz;<span class="comment">// servlet-class</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> name;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.name = name;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getClazz</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> clazz;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setClazz</span><span class="params">(String clazz)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.clazz = clazz;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">Entity</span><span class="params">(String name, String clazz)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">super</span>();</span><br><span class="line">		<span class="keyword">this</span>.name = name;</span><br><span class="line">		<span class="keyword">this</span>.clazz = clazz;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">Entity</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">super</span>();</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="Mapping类-映射"><a href="#Mapping类-映射" class="headerlink" title="Mapping类  映射"></a>Mapping类  映射</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.szxy.server;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * </span></span><br><span class="line"><span class="comment"> * &lt;servlet-mapping&gt;</span></span><br><span class="line"><span class="comment">		&lt;servlet-name&gt;login&lt;/servlet-name&gt;</span></span><br><span class="line"><span class="comment">		&lt;url-pattern&gt;/LoginServlet&lt;/url-pattern&gt;</span></span><br><span class="line"><span class="comment">	&lt;/servlet-mapping&gt;</span></span><br><span class="line"><span class="comment">	&lt;servlet-mapping&gt;</span></span><br><span class="line"><span class="comment">		&lt;servlet-name&gt;login&lt;/servlet-name&gt;</span></span><br><span class="line"><span class="comment">		&lt;url-pattern&gt;/Log&lt;/url-pattern&gt;</span></span><br><span class="line"><span class="comment">	&lt;/servlet-mapping&gt;</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> wzer</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Mapping</span> </span>&#123;<span class="comment">//映射关系，多路径访问</span></span><br><span class="line">		<span class="keyword">private</span> String name; <span class="comment">//servlet-name</span></span><br><span class="line">		<span class="keyword">private</span> List&lt;String&gt; urlPattern; <span class="comment">//url-pattern</span></span><br><span class="line">		<span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">			<span class="keyword">return</span> name;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">			<span class="keyword">this</span>.name = name;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="function"><span class="keyword">public</span> List&lt;String&gt; <span class="title">getUrlPattern</span><span class="params">()</span> </span>&#123;</span><br><span class="line">			<span class="keyword">return</span> urlPattern;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setUrlPattern</span><span class="params">(List&lt;String&gt; urlPattern)</span> </span>&#123;</span><br><span class="line">			<span class="keyword">this</span>.urlPattern = urlPattern;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="function"><span class="keyword">public</span> <span class="title">Mapping</span><span class="params">(String name, List&lt;String&gt; urlPattern)</span> </span>&#123;</span><br><span class="line">			<span class="keyword">super</span>();</span><br><span class="line">			<span class="keyword">this</span>.name = name;</span><br><span class="line">			<span class="keyword">this</span>.urlPattern = urlPattern;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="function"><span class="keyword">public</span> <span class="title">Mapping</span><span class="params">()</span> </span>&#123;</span><br><span class="line">			<span class="keyword">this</span>.urlPattern = <span class="keyword">new</span> ArrayList&lt;String&gt;();</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="7-2-编写-XML文件"><a href="#7-2-编写-XML文件" class="headerlink" title="7.2  编写 XML文件"></a>7.2  编写 XML文件</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">web-app</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>login<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>cn.szxy.servlet.LoginServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>login<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/LoginServlet<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/Log<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>Regsin<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>cn.szxy.servlet.RegisnServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">web-app</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src="C:%5CUsers%5CLenovo%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1542723988088.png" alt="1542723988088"></p>
<p>#### </p>
<h3 id="8-DOM4J-解析-XML-文档"><a href="#8-DOM4J-解析-XML-文档" class="headerlink" title="8  DOM4J 解析 XML 文档"></a>8  DOM4J 解析 XML 文档</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.szxy.server;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.Iterator;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.dom4j.Document;</span><br><span class="line"><span class="keyword">import</span> org.dom4j.DocumentException;</span><br><span class="line"><span class="keyword">import</span> org.dom4j.Element;</span><br><span class="line"><span class="keyword">import</span> org.dom4j.io.SAXReader;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">WebDOM4J</span> </span>&#123;<span class="comment">// 解析 XML 文档</span></span><br><span class="line">	<span class="keyword">private</span> List&lt;Entity&gt; entity;</span><br><span class="line">	<span class="keyword">private</span> List&lt;Mapping&gt; mapping;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> List&lt;Entity&gt; <span class="title">getEntity</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> entity;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setEntity</span><span class="params">(List&lt;Entity&gt; entity)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.entity = entity;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> List&lt;Mapping&gt; <span class="title">getMapping</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> mapping;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setMapping</span><span class="params">(List&lt;Mapping&gt; mapping)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.mapping = mapping;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">WebDOM4J</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.entity = <span class="keyword">new</span>  ArrayList&lt;Entity&gt;();</span><br><span class="line">		<span class="keyword">this</span>.mapping = <span class="keyword">new</span> ArrayList&lt;Mapping&gt;();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">WebDOM4J</span><span class="params">(List&lt;Entity&gt; entity, List&lt;Mapping&gt; mapping)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">super</span>();</span><br><span class="line">		<span class="keyword">this</span>.entity = entity;</span><br><span class="line">		<span class="keyword">this</span>.mapping = mapping;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">private</span> Document <span class="title">getDocuement</span><span class="params">()</span></span>&#123;</span><br><span class="line">		Document doc=<span class="keyword">null</span>;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			<span class="comment">//创建 SAXReader 对象</span></span><br><span class="line">			SAXReader reader = <span class="keyword">new</span> SAXReader();</span><br><span class="line">			<span class="comment">//调用 read 方法</span></span><br><span class="line">			<span class="keyword">return</span> reader.read(<span class="string">"src/cn/szxy/WEB_INFO/web.xml"</span>);</span><br><span class="line">		&#125; <span class="keyword">catch</span> (DocumentException e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">null</span>;	</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">parse</span><span class="params">(Document doc)</span></span>&#123;</span><br><span class="line">		<span class="comment">//获得 根节点 root</span></span><br><span class="line">		Element root = doc.getRootElement();</span><br><span class="line">		<span class="comment">//遍历节点</span></span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			Class c = Class.forName(<span class="string">"cn.szxy.server.Entity"</span>);</span><br><span class="line">		&#125; <span class="keyword">catch</span> (ClassNotFoundException e) &#123;</span><br><span class="line">			<span class="comment">// TODO 自动生成的 catch 块</span></span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">for</span>(Iterator&lt;Element&gt; iter = root.elementIterator(<span class="string">"servlet"</span>);iter.hasNext();)&#123;</span><br><span class="line">			Element subEle = iter.next(); <span class="comment">//获得每个serlvet</span></span><br><span class="line">			<span class="comment">//System.out.println(subEle);</span></span><br><span class="line">			Entity t  = <span class="keyword">new</span> Entity(); <span class="comment">// 存储 servlet-name和 servlet-class</span></span><br><span class="line">			<span class="keyword">for</span>(Iterator&lt;Element&gt; subIter = subEle.elementIterator();subIter.hasNext();)&#123;</span><br><span class="line">				Element ele = subIter.next();</span><br><span class="line">				System.out.println(ele.getName()+<span class="string">"\t"</span>+ele.getText());</span><br><span class="line">				<span class="keyword">if</span>(<span class="string">"servlet-name"</span>.equals(ele.getName()))&#123;</span><br><span class="line">					t.setName(ele.getText());</span><br><span class="line">				&#125;<span class="keyword">else</span> <span class="keyword">if</span>(<span class="string">"servlet-class"</span>.equals(ele.getName()))&#123;</span><br><span class="line">					t.setClazz(ele.getText());</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">			entity.add(t);</span><br><span class="line">		&#125;	</span><br><span class="line">		<span class="keyword">for</span> (Entity list : entity) &#123;</span><br><span class="line">			System.out.println(list.getName()+<span class="string">"\t"</span>+list.getClazz());</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="comment">// servlet-mapping</span></span><br><span class="line">		<span class="keyword">for</span>(Iterator&lt;Element&gt; iter = root.elementIterator(<span class="string">"servlet-mapping"</span>);iter.hasNext();)&#123;</span><br><span class="line">			Element subEle = iter.next(); <span class="comment">//获得每个serlvet</span></span><br><span class="line">			<span class="comment">//System.out.println(subEle);</span></span><br><span class="line">			Mapping m = <span class="keyword">new</span> Mapping();</span><br><span class="line">			<span class="keyword">for</span>(Iterator&lt;Element&gt; subIter = subEle.elementIterator();subIter.hasNext();)&#123;</span><br><span class="line">				Element ele = subIter.next();</span><br><span class="line">				<span class="comment">//System.out.println(ele.getName()+"\t"+ele.getText());</span></span><br><span class="line">				<span class="keyword">if</span>(<span class="string">"servlet-name"</span>.equals(ele.getName()))&#123;</span><br><span class="line">					m.setName(ele.getText());</span><br><span class="line">				&#125;<span class="keyword">else</span> <span class="keyword">if</span>(<span class="string">"url-pattern"</span>.equals(ele.getName()))&#123;</span><br><span class="line">					<span class="comment">//获得集合对象，调用集合对象的添加方法  ---------</span></span><br><span class="line">					m.getUrlPattern().add(ele.getText());</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">			mapping.add(m);</span><br><span class="line">		&#125;	</span><br><span class="line">		<span class="keyword">for</span>(Mapping m:mapping)&#123;</span><br><span class="line">			<span class="comment">//System.out.println(m.getName()+"----");</span></span><br><span class="line">			<span class="keyword">for</span>(String s:m.getUrlPattern())&#123;</span><br><span class="line">				System.out.println(s);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;	</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		WebDOM4J dom4j = <span class="keyword">new</span> WebDOM4J();</span><br><span class="line">		dom4j.parse(dom4j.getDocuement());</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="8-2-总结："><a href="#8-2-总结：" class="headerlink" title="8.2 总结："></a>8.2 总结：</h4><p>1 把 XML文档中 信息解析到 Entity 类  和 Mapping 类。</p>
<p>2   获得集合对象，调用集合对象的添加方法,添加元素<br>​    <code>m.getUrlPattern().add(ele.getText());</code></p>
<p>3  根据传入节点的值 遍历该节点下面的</p>
<p><code>for(Iterator&lt;Element&gt; iter = root.elementIterator(&quot;servlet&quot;);iter.hasNext();)</code></p>
<h3 id="9-根据反射创建-Serlvet对象"><a href="#9-根据反射创建-Serlvet对象" class="headerlink" title="9 根据反射创建 Serlvet对象"></a>9 根据反射创建 <code>Serlvet</code>对象</h3><h4 id="9-1-编写-ServletContext-类"><a href="#9-1-编写-ServletContext-类" class="headerlink" title="9.1 编写 ServletContext 类"></a>9.1 编写 <code>ServletContext</code> 类</h4><p>​    Servlet 上下文，就是一个容器，用于存储映射关系</p>
<h4 id="9-2-编写-WebApp-类"><a href="#9-2-编写-WebApp-类" class="headerlink" title="9.2 编写 WebApp 类"></a>9.2 编写 <code>WebApp</code> 类</h4><p>1) 初始化程序运行的数据</p>
<p>2) 根据不同的 <code>url</code> 创建所请求的 Servlet </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.szxy.server;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> cn.szxy.servlet.Servlet;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 初始化 程序运行的数据</span></span><br><span class="line"><span class="comment"> * </span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> wzer</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">WebApp</span> </span>&#123;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> ServletContext context;</span><br><span class="line">	<span class="keyword">static</span>&#123;</span><br><span class="line">		context = <span class="keyword">new</span> ServletContext();</span><br><span class="line">		<span class="comment">//分别获得对应的关系的map集合</span></span><br><span class="line">		Map&lt;String,String&gt; servlet = context.getServlet();</span><br><span class="line">		Map&lt;String,String&gt; mapping = context.getMapping();</span><br><span class="line">		<span class="comment">//创建 解析的 XML 文档</span></span><br><span class="line">		WebDOM4J dom4j = <span class="keyword">new</span> WebDOM4J();</span><br><span class="line">		dom4j.parse(dom4j.getDocuement());</span><br><span class="line">		<span class="comment">//获取解析之后的List集合</span></span><br><span class="line">		List&lt;Entity&gt; entityList = dom4j.getEntity();</span><br><span class="line">		List&lt;Mapping&gt; mappingList = dom4j.getMapping();</span><br><span class="line">		<span class="comment">//将 List中数据放入 Map中</span></span><br><span class="line">		<span class="keyword">for</span> (Entity  entity : entityList) &#123;</span><br><span class="line">			servlet.put(entity.getName(),entity.getClazz());</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="comment">//System.out.println(servlet);</span></span><br><span class="line">		<span class="keyword">for</span> (Mapping map : mappingList) &#123;</span><br><span class="line">			<span class="comment">//遍历 url-patterns 集合</span></span><br><span class="line">			List&lt;String&gt; urlpatterns = map.getUrlPattern();</span><br><span class="line">			<span class="keyword">for</span> (String str: urlpatterns) &#123;</span><br><span class="line">				mapping.put(str, map.getName());</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="comment">//System.out.println(mapping);</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * 获得映射关系，获得servlet-class</span></span><br><span class="line"><span class="comment">	 * </span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Servlet <span class="title">getServlet</span><span class="params">(String url)</span> </span>&#123;</span><br><span class="line">		<span class="comment">//判断 url 格式是否正确</span></span><br><span class="line">		<span class="keyword">if</span>(url==<span class="keyword">null</span>||url.trim().equals(<span class="string">""</span>))&#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="comment">//如果 url 正确</span></span><br><span class="line">		<span class="comment">//根据 url 的key 去获取 servlet-name 的值</span></span><br><span class="line">		String name = context.getMapping().get(url);</span><br><span class="line">		<span class="comment">//根据 servlet-name的key 去获取 servlet-class 的value</span></span><br><span class="line">		String servletclass = context.getServlet().get(name);</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			<span class="comment">//根据反射，获得servlet-class对象</span></span><br><span class="line">			Class clazz = Class.forName(servletclass);</span><br><span class="line">			<span class="comment">//调用无参构造方法 创建 Servlet 对象</span></span><br><span class="line">			Servlet servlet = (Servlet)clazz.newInstance();</span><br><span class="line">			<span class="keyword">return</span> servlet;</span><br><span class="line">		&#125; <span class="keyword">catch</span> (ClassNotFoundException e) &#123;</span><br><span class="line">			<span class="comment">// TODO 自动生成的 catch 块</span></span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125; <span class="keyword">catch</span> (InstantiationException e) &#123;</span><br><span class="line">			<span class="comment">// TODO 自动生成的 catch 块</span></span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125; <span class="keyword">catch</span> (IllegalAccessException e) &#123;</span><br><span class="line">			<span class="comment">// TODO 自动生成的 catch 块</span></span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		System.out.println(getServlet(<span class="string">"/Log"</span>));</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="10-封装-Request-请求"><a href="#10-封装-Request-请求" class="headerlink" title="10 封装  Request 请求"></a>10 封装  Request 请求</h3><h4 id="10-1-编写-Server"><a href="#10-1-编写-Server" class="headerlink" title="10.1 编写 Server"></a>10.1 编写 Server</h4><p>1) 启动服务</p>
<p><img src="C:%5CUsers%5CLenovo%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1542801240035.png" alt="1542801240035"></p>
<p>2) 关闭服务</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.szxy.server;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"><span class="keyword">import</span> java.net.ServerSocket;</span><br><span class="line"><span class="keyword">import</span> java.net.Socket;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> cn.szxy.util.IOUtilClose;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Server</span> </span>&#123;<span class="comment">//服务器</span></span><br><span class="line">	ServerSocket server;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">start</span><span class="params">()</span></span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.start(<span class="number">9999</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">start</span><span class="params">(<span class="keyword">int</span> port)</span></span>&#123;</span><br><span class="line">		<span class="comment">//创建 ServerSocket 对象</span></span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			server = <span class="keyword">new</span> ServerSocket(port);</span><br><span class="line">			<span class="keyword">this</span>.receive();</span><br><span class="line">		&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">			<span class="comment">// TODO 自动生成的 catch 块</span></span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">receive</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="comment">// 监听客户端的请求</span></span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			Socket  client = server.accept();</span><br><span class="line">			InputStream is = client.getInputStream();</span><br><span class="line">			<span class="comment">/*byte[] buf = new byte[10240];</span></span><br><span class="line"><span class="comment">		    //读取字节数组的长度</span></span><br><span class="line"><span class="comment">			int len = is.read(buf);</span></span><br><span class="line"><span class="comment">			System.out.println(new String(buf,0,len));*/</span></span><br><span class="line">			</span><br><span class="line">			<span class="comment">/*Request req = new Request(is);</span></span><br><span class="line"><span class="comment">			req.show();*/</span></span><br><span class="line">		&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">			<span class="comment">// TODO 自动生成的 catch 块</span></span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">stop</span><span class="params">()</span></span>&#123;</span><br><span class="line">		IOUtilClose.CloseALL(server);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">//测试 方法</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"启动服务器..."</span>);</span><br><span class="line">		Server server = <span class="keyword">new</span> Server();</span><br><span class="line">		server.start();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="10-2-编写-HTML"><a href="#10-2-编写-HTML" class="headerlink" title="10.2 编写 HTML"></a>10.2 编写 HTML</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>Login<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">"http://localhost:9999/Log"</span> <span class="attr">method</span>=<span class="string">"post"</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">p</span>&gt;</span>用户名:<span class="tag">&lt;/<span class="name">p</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"username"</span> <span class="attr">id</span>=<span class="string">"username"</span>/&gt;</span><span class="tag">&lt;<span class="name">br</span>/&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">p</span>&gt;</span>密码:<span class="tag">&lt;/<span class="name">p</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"password"</span> <span class="attr">name</span>=<span class="string">"pwd"</span> <span class="attr">id</span>=<span class="string">"paaword"</span>/&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">p</span>&gt;</span>兴趣:&amp;nbsp;&amp;nbsp;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"checkbox"</span> <span class="attr">name</span>=<span class="string">"hobby"</span> <span class="attr">value</span>=<span class="string">"baketball"</span> /&gt;</span>篮球</span><br><span class="line">		    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"checkbox"</span> <span class="attr">name</span>=<span class="string">"hobby"</span> <span class="attr">value</span>=<span class="string">"football"</span> /&gt;</span>足球</span><br><span class="line">	   		<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"checkbox"</span> <span class="attr">name</span>=<span class="string">"hobby"</span> <span class="attr">value</span>=<span class="string">"pingpang"</span> /&gt;</span>乒乓球<span class="tag">&lt;<span class="name">br</span>/&gt;</span></span><br><span class="line">	   		<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"submit"</span>  <span class="attr">value</span>=<span class="string">"提交"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line">	</span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="10-3-封装-Request-method-url"><a href="#10-3-封装-Request-method-url" class="headerlink" title="10.3 封装 Request_method_url"></a>10.3 封装 Request_method_url</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.szxy.server;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Request</span> </span>&#123;<span class="comment">//接受客户端的请求  </span></span><br><span class="line">	<span class="keyword">private</span> InputStream is; </span><br><span class="line">	<span class="keyword">private</span> String requstInfo; <span class="comment">//请求信息</span></span><br><span class="line">	<span class="keyword">private</span> String method; <span class="comment">//请求方法</span></span><br><span class="line">	<span class="keyword">private</span> String url; <span class="comment">//路径</span></span><br><span class="line">	 </span><br><span class="line">	<span class="keyword">private</span> Map&lt;String,List&lt;String&gt;&gt; parametermapValues;<span class="comment">// 请求参数</span></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String CRLF = <span class="string">"\r\n"</span>; <span class="comment">//换行</span></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String BLANK = <span class="string">"\t"</span>; <span class="comment">//空白</span></span><br><span class="line">	</span><br><span class="line">	<span class="comment">//构造函数，初始化属性</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">Request</span><span class="params">()</span></span>&#123;</span><br><span class="line">		parametermapValues=<span class="keyword">new</span> HashMap&lt;String,List&lt;String&gt;&gt;();</span><br><span class="line">		requstInfo = <span class="string">""</span>;</span><br><span class="line">		method = <span class="string">""</span>;</span><br><span class="line">		url = <span class="string">""</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">Request</span><span class="params">(InputStream is)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>();<span class="comment">//调用无参构造函数</span></span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			<span class="keyword">this</span>.is = is;</span><br><span class="line">			<span class="keyword">byte</span>[] buf = <span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">20480</span>];</span><br><span class="line">			<span class="keyword">int</span> len = is.read(buf);</span><br><span class="line">			requstInfo = <span class="keyword">new</span> String(buf,<span class="number">0</span>,len);</span><br><span class="line">		&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">			<span class="keyword">return</span>;	</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="comment">//调用本类中的分解请求信息的方法</span></span><br><span class="line">		<span class="keyword">this</span>.parseRequestInfo();</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">//分解请求信息的方法</span></span><br><span class="line">	<span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">parseRequestInfo</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		String paraString=<span class="string">""</span>;<span class="comment">//用于存储请求参数</span></span><br><span class="line">		<span class="comment">//获得第一行</span></span><br><span class="line">		String firstLine = requstInfo.substring(<span class="number">0</span>,requstInfo.indexOf(CRLF)).trim(); </span><br><span class="line">		<span class="keyword">int</span> index = firstLine.indexOf(<span class="string">"/"</span>); <span class="comment">//截取到第一个参数结束</span></span><br><span class="line">		<span class="keyword">this</span>.method = firstLine.substring(<span class="number">0</span>,index).trim();<span class="comment">//请求的第一个参数 请求方法    含头不含尾</span></span><br><span class="line">		String urlString = firstLine.substring(index, firstLine.indexOf(<span class="string">"HTTP/"</span>)).trim();<span class="comment">//获得文件路径</span></span><br><span class="line">		<span class="comment">//判断 get请求 还是 post请求</span></span><br><span class="line">		<span class="keyword">if</span>(method.equalsIgnoreCase(<span class="keyword">this</span>.method))&#123;</span><br><span class="line">			<span class="keyword">if</span>(urlString.contains(<span class="string">"?"</span>))&#123;</span><br><span class="line">				String[] urlArray = urlString.split(<span class="string">"\\?"</span>);</span><br><span class="line">				<span class="keyword">this</span>.url = urlArray[<span class="number">0</span>];</span><br><span class="line">				paraString = urlArray[<span class="number">1</span>];	</span><br><span class="line">			&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">				<span class="keyword">this</span>.url = urlString;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;<span class="keyword">else</span>&#123;<span class="comment">//post不包含请求参数</span></span><br><span class="line">			<span class="keyword">this</span>.url = urlString;</span><br><span class="line">			paraString =requstInfo.substring(requstInfo.lastIndexOf(CRLF));</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span>(paraString.equals(<span class="string">""</span>))&#123;</span><br><span class="line">			<span class="keyword">return</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		System.out.println(paraString);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">//用于测试</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">show</span><span class="params">()</span></span>&#123;</span><br><span class="line">		System.out.println(<span class="keyword">this</span>.url);</span><br><span class="line">		System.out.println(<span class="keyword">this</span>.method);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="11-封装-Request-存储参数-处理中文"><a href="#11-封装-Request-存储参数-处理中文" class="headerlink" title="11  封装 Request  存储参数  处理中文"></a>11  封装 Request  <em>存储参数</em>  处理中文</h3><h4 id="11-1-编写分解参数的方法"><a href="#11-1-编写分解参数的方法" class="headerlink" title="11.1 编写分解参数的方法"></a>11.1 编写分解参数的方法</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">	username=Tom&amp;pwd=123&amp;hobby=football&amp;hobby=baketball</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">parseParam</span><span class="params">(String paraString)</span></span>&#123;</span><br><span class="line">		String[] token = paraString.split(<span class="string">"&amp;"</span>);<span class="comment">//根据 &amp; 符号切割成字符数组</span></span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; token.length; i++) &#123;</span><br><span class="line">			String keyValues = token[i];</span><br><span class="line">			String[] keyValue = keyValues.split(<span class="string">"="</span>);</span><br><span class="line">			<span class="keyword">if</span>(keyValue.length ==<span class="number">1</span>)&#123;<span class="comment">// 只有参数名，没有参数值</span></span><br><span class="line">				keyValue = Arrays.copyOf(keyValue, <span class="number">2</span>);</span><br><span class="line">				keyValue[<span class="number">1</span>] = <span class="keyword">null</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="comment">//把参数名和参数值放入集合中</span></span><br><span class="line">			String key = keyValue[<span class="number">0</span>];</span><br><span class="line">			String value= keyValue[<span class="number">1</span>]==<span class="keyword">null</span>?<span class="keyword">null</span>:decode(keyValue[<span class="number">1</span>].trim(),<span class="string">"utf-8"</span>);</span><br><span class="line">			</span><br><span class="line">			<span class="comment">//放到集合存储</span></span><br><span class="line">			<span class="keyword">if</span>(!parametermapValues.containsKey(key))&#123;</span><br><span class="line">				parametermapValues.put(key, <span class="keyword">new</span> ArrayList&lt;String&gt;());</span><br><span class="line">			&#125;</span><br><span class="line">			List&lt;String&gt;  values = parametermapValues.get(key);</span><br><span class="line">			values.add(value);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<h4 id="11-2-编写根据页面上的-name-获取多个值的方法"><a href="#11-2-编写根据页面上的-name-获取多个值的方法" class="headerlink" title="11.2 编写根据页面上的 name 获取多个值的方法"></a>11.2 编写根据页面上的 name 获取多个值的方法</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//根据表单 元素的name获取多个值</span></span><br><span class="line">	<span class="keyword">public</span> String [] getParametermapValues(String key)&#123;</span><br><span class="line">		List&lt;String&gt; values = parametermapValues.get(key);</span><br><span class="line">		<span class="keyword">if</span>(values==<span class="keyword">null</span>)&#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">		&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">			<span class="keyword">return</span> values.toArray(<span class="keyword">new</span> String[<span class="number">0</span>]);<span class="comment">//将集合转成 数组</span></span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<h4 id="11-3-编写根据页面上的-name-获取单个值的方法"><a href="#11-3-编写根据页面上的-name-获取单个值的方法" class="headerlink" title="11.3 编写根据页面上的 name 获取单个值的方法"></a>11.3 编写根据页面上的 name 获取单个值的方法</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//根据表单元素的name获取单个值</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getParameter</span><span class="params">(String name)</span></span>&#123;</span><br><span class="line">		String[] values = <span class="keyword">this</span>.getParametermapValues(name);</span><br><span class="line">		<span class="keyword">if</span>(values==<span class="keyword">null</span>)&#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">		&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">			<span class="keyword">return</span> values[<span class="number">0</span>];</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<h4 id="11-4-编写解码的方法"><a href="#11-4-编写解码的方法" class="headerlink" title="11.4 编写解码的方法"></a>11.4 编写解码的方法</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//处理中文 ，因为浏览器对中文进行编码，所以需要解码</span></span><br><span class="line">	<span class="function"><span class="keyword">private</span> String <span class="title">decode</span><span class="params">(String value,String code)</span></span>&#123;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			<span class="keyword">return</span> URLDecoder.decode(value, code);</span><br><span class="line">		&#125; <span class="keyword">catch</span> (UnsupportedEncodingException e) &#123;</span><br><span class="line">			<span class="comment">// TODO 自动生成的 catch 块</span></span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<h4 id="11-5-Request-类"><a href="#11-5-Request-类" class="headerlink" title="11.5  Request 类"></a>11.5  Request 类</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.szxy.server;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.UnsupportedEncodingException;</span><br><span class="line"><span class="keyword">import</span> java.net.URLDecoder;</span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.Arrays;</span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Request</span> </span>&#123;<span class="comment">//接受客户端的请求  </span></span><br><span class="line">	<span class="keyword">private</span> InputStream is; </span><br><span class="line">	<span class="keyword">private</span> String requstInfo; <span class="comment">//请求信息</span></span><br><span class="line">	<span class="keyword">private</span> String method; <span class="comment">//请求方法</span></span><br><span class="line">	<span class="keyword">private</span> String url; <span class="comment">//路径</span></span><br><span class="line">	 </span><br><span class="line">	<span class="keyword">private</span> Map&lt;String,List&lt;String&gt;&gt; parametermapValues;<span class="comment">// 请求参数</span></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String CRLF = <span class="string">"\r\n"</span>; <span class="comment">//换行</span></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String BLANK = <span class="string">"\t"</span>; <span class="comment">//空白</span></span><br><span class="line">	</span><br><span class="line">	<span class="comment">//构造函数，初始化属性</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">Request</span><span class="params">()</span></span>&#123;</span><br><span class="line">		parametermapValues=<span class="keyword">new</span> HashMap&lt;String,List&lt;String&gt;&gt;();</span><br><span class="line">		requstInfo = <span class="string">""</span>;</span><br><span class="line">		method = <span class="string">""</span>;</span><br><span class="line">		url = <span class="string">""</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">Request</span><span class="params">(InputStream is)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>();<span class="comment">//调用无参构造函数</span></span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			<span class="keyword">this</span>.is = is;</span><br><span class="line">			<span class="keyword">byte</span>[] buf = <span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">20480</span>];</span><br><span class="line">			<span class="keyword">int</span> len = is.read(buf);</span><br><span class="line">			requstInfo = <span class="keyword">new</span> String(buf,<span class="number">0</span>,len);</span><br><span class="line">		&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">			<span class="keyword">return</span>;	</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="comment">//调用本类中的分解请求信息的方法</span></span><br><span class="line">		<span class="keyword">this</span>.parseRequestInfo();</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">//分解请求信息的方法</span></span><br><span class="line">	<span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">parseRequestInfo</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		String paraString=<span class="string">""</span>;<span class="comment">//用于存储请求参数</span></span><br><span class="line">		<span class="comment">//获得第一行</span></span><br><span class="line">		String firstLine = requstInfo.substring(<span class="number">0</span>,requstInfo.indexOf(CRLF)).trim(); </span><br><span class="line">		<span class="keyword">int</span> index = firstLine.indexOf(<span class="string">"/"</span>); <span class="comment">//截取到第一个参数结束</span></span><br><span class="line">		<span class="keyword">this</span>.method = firstLine.substring(<span class="number">0</span>,index).trim();<span class="comment">//请求的第一个参数 请求方法    含头不含尾</span></span><br><span class="line">		String urlString = firstLine.substring(index, firstLine.indexOf(<span class="string">"HTTP/"</span>)).trim();<span class="comment">//获得文件路径</span></span><br><span class="line">		<span class="comment">//判断 get请求 还是 post请求</span></span><br><span class="line">		<span class="keyword">if</span>(method.equalsIgnoreCase(<span class="keyword">this</span>.method))&#123;</span><br><span class="line">			<span class="keyword">if</span>(urlString.contains(<span class="string">"?"</span>))&#123;</span><br><span class="line">				String[] urlArray = urlString.split(<span class="string">"\\?"</span>);</span><br><span class="line">				<span class="keyword">this</span>.url = urlArray[<span class="number">0</span>];</span><br><span class="line">				paraString = urlArray[<span class="number">1</span>];	</span><br><span class="line">			&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">				<span class="keyword">this</span>.url = urlString;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;<span class="keyword">else</span>&#123;<span class="comment">//post不包含请求参数</span></span><br><span class="line">			<span class="keyword">this</span>.url = urlString;</span><br><span class="line">			paraString =requstInfo.substring(requstInfo.lastIndexOf(CRLF));</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span>(paraString.equals(<span class="string">""</span>))&#123;</span><br><span class="line">			<span class="keyword">return</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="comment">//调用分解 请求参数的方法</span></span><br><span class="line">		<span class="keyword">this</span>.parseParam(paraString);</span><br><span class="line">		<span class="comment">//System.out.println(paraString);</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 *  分解 请求参数</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">parseParam</span><span class="params">(String paraString)</span></span>&#123;</span><br><span class="line">		String[] token = paraString.split(<span class="string">"&amp;"</span>);</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; token.length; i++) &#123;</span><br><span class="line">			String keyValues = token[i];</span><br><span class="line">			String[] keyValue = keyValues.split(<span class="string">"="</span>);</span><br><span class="line">			<span class="keyword">if</span>(keyValue.length ==<span class="number">1</span>)&#123;<span class="comment">// 只有参数名，没有参数值</span></span><br><span class="line">				keyValue = Arrays.copyOf(keyValue, <span class="number">2</span>);</span><br><span class="line">				keyValue[<span class="number">1</span>] = <span class="keyword">null</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="comment">//把参数名和参数值放入集合中</span></span><br><span class="line">			String key = keyValue[<span class="number">0</span>];</span><br><span class="line">			String value= keyValue[<span class="number">1</span>]==<span class="keyword">null</span>?<span class="keyword">null</span>:decode(keyValue[<span class="number">1</span>].trim(),<span class="string">"utf-8"</span>);</span><br><span class="line">			</span><br><span class="line">			<span class="comment">//放到集合存储</span></span><br><span class="line">			<span class="keyword">if</span>(!parametermapValues.containsKey(key))&#123;</span><br><span class="line">				parametermapValues.put(key, <span class="keyword">new</span> ArrayList&lt;String&gt;());</span><br><span class="line">			&#125;</span><br><span class="line">			List&lt;String&gt;  values = parametermapValues.get(key);</span><br><span class="line">			values.add(value);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">//根据表单 元素的name获取多个值</span></span><br><span class="line">	<span class="keyword">public</span> String [] getParametermapValues(String key)&#123;</span><br><span class="line">		List&lt;String&gt; values = parametermapValues.get(key);</span><br><span class="line">		<span class="keyword">if</span>(values==<span class="keyword">null</span>)&#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">		&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">			<span class="keyword">return</span> values.toArray(<span class="keyword">new</span> String[<span class="number">0</span>]);<span class="comment">//将集合转成 数组</span></span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">//根据表单元素的name获取单个值</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getParameter</span><span class="params">(String name)</span></span>&#123;</span><br><span class="line">		String[] values = <span class="keyword">this</span>.getParametermapValues(name);</span><br><span class="line">		<span class="keyword">if</span>(values==<span class="keyword">null</span>)&#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">		&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">			<span class="keyword">return</span> values[<span class="number">0</span>];</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//处理中文 ，因为浏览器对中文进行编码，所以需要解码</span></span><br><span class="line">	<span class="function"><span class="keyword">private</span> String <span class="title">decode</span><span class="params">(String value,String code)</span></span>&#123;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			<span class="keyword">return</span> URLDecoder.decode(value, code);</span><br><span class="line">		&#125; <span class="keyword">catch</span> (UnsupportedEncodingException e) &#123;</span><br><span class="line">			<span class="comment">// TODO 自动生成的 catch 块</span></span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//用于测试</span></span><br><span class="line">		<span class="comment">/*public void show()&#123;</span></span><br><span class="line"><span class="comment">			System.out.println(this.url);</span></span><br><span class="line"><span class="comment">			System.out.println(this.method);</span></span><br><span class="line"><span class="comment">		&#125;*/</span></span><br><span class="line">		</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		Request req = <span class="keyword">new</span> Request();</span><br><span class="line">		req.parseParam(<span class="string">"usr=a%20a&amp;pwd=&amp;hoby=foot&amp;hoby=baket"</span>);</span><br><span class="line">		System.out.println(req.parametermapValues);</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//调用获得多个值</span></span><br><span class="line">		String[] str = req.getParametermapValues(<span class="string">"hoby"</span>);</span><br><span class="line">		<span class="keyword">for</span> (String string : str) &#123;</span><br><span class="line">			System.out.println(string);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="comment">//调用获得一个值</span></span><br><span class="line">		System.out.println(req.getParameter(<span class="string">"usr"</span>));</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="11-6-总结"><a href="#11-6-总结" class="headerlink" title="11.6 总结"></a>11.6 总结</h4><p>1 字符串的分割</p>
<p>2 集合的使用  </p>
<p>3 集合的嵌套  Map中有List集合  </p>
<h3 id="12-封装-Response"><a href="#12-封装-Response" class="headerlink" title="12 封装 Response"></a>12 封装 Response</h3><h4 id="12-1-封装-Response"><a href="#12-1-封装-Response" class="headerlink" title="12.1 封装 Response"></a>12.1 封装 Response</h4><p>1) 构造响应头</p>
<p>2) 推送到客户端</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.szxy.server;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.BufferedWriter;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.OutputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.OutputStreamWriter;</span><br><span class="line"><span class="keyword">import</span> java.io.UnsupportedEncodingException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> cn.szxy.util.IOUtilClose;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Response</span> </span>&#123;<span class="comment">//响应</span></span><br><span class="line">	<span class="keyword">private</span> StringBuilder headInfo;<span class="comment">//响应头</span></span><br><span class="line">	<span class="keyword">private</span> StringBuilder content;<span class="comment">//响应内容</span></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">int</span> length;<span class="comment">//响应内容的长度</span></span><br><span class="line">	<span class="comment">//流</span></span><br><span class="line">	<span class="keyword">private</span> BufferedWriter bw;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//两个常量，换行和空格</span></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String CRLF=<span class="string">"\r\n"</span>;<span class="comment">//换行</span></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String BLANK=<span class="string">" "</span>;<span class="comment">//空格</span></span><br><span class="line">	</span><br><span class="line">	<span class="comment">//构造方法</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">Response</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		headInfo=<span class="keyword">new</span> StringBuilder();</span><br><span class="line">		content=<span class="keyword">new</span> StringBuilder();</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">//带参构造方法</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">Response</span><span class="params">(OutputStream os)</span></span>&#123;</span><br><span class="line">		<span class="keyword">this</span>();<span class="comment">//调用本类的无参构造方法</span></span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			bw=<span class="keyword">new</span> BufferedWriter(<span class="keyword">new</span> OutputStreamWriter(os, <span class="string">"utf-8"</span>));</span><br><span class="line">		&#125; <span class="keyword">catch</span> (UnsupportedEncodingException e) &#123;</span><br><span class="line">			headInfo=<span class="keyword">null</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">//构造正文部分</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> Response <span class="title">print</span><span class="params">(String info)</span></span>&#123;</span><br><span class="line">		content.append(info);</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			length+=info.getBytes(<span class="string">"utf-8"</span>).length;</span><br><span class="line">		&#125; <span class="keyword">catch</span> (UnsupportedEncodingException e) &#123;</span><br><span class="line">			<span class="comment">// TODO Auto-generated catch block</span></span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> Response <span class="title">println</span><span class="params">(String info)</span></span>&#123;</span><br><span class="line">		content.append(info).append(CRLF);</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			length+=(info+CRLF).getBytes(<span class="string">"utf-8"</span>).length;</span><br><span class="line">		&#125; <span class="keyword">catch</span> (UnsupportedEncodingException e) &#123;</span><br><span class="line">			<span class="comment">// TODO Auto-generated catch block</span></span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//构造响应头</span></span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">createHeadInfo</span><span class="params">(<span class="keyword">int</span> code)</span></span>&#123;</span><br><span class="line">		headInfo.append(<span class="string">"HTTP/1.1"</span>).append(BLANK).append(code).append(BLANK);</span><br><span class="line">		<span class="keyword">switch</span> (code) &#123;</span><br><span class="line">		<span class="keyword">case</span> <span class="number">200</span>:</span><br><span class="line">			headInfo.append(<span class="string">"OK"</span>);</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">case</span> <span class="number">500</span>:</span><br><span class="line">			headInfo.append(<span class="string">"SERVER ERROR"</span>);</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">default</span>:</span><br><span class="line">			headInfo.append(<span class="string">"NOT FOUND"</span>);</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		headInfo.append(CRLF);</span><br><span class="line">		headInfo.append(<span class="string">"Content-Type:text/html;charset=utf-8"</span>).append(CRLF);</span><br><span class="line">		headInfo.append(<span class="string">"Content-Length:"</span>+length).append(CRLF);</span><br><span class="line">		headInfo.append(CRLF);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * 推送到客户机的浏览器</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@param</span> code</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">pushToClient</span><span class="params">(<span class="keyword">int</span> code)</span></span>&#123;</span><br><span class="line">		<span class="keyword">if</span> (headInfo==<span class="keyword">null</span>) &#123;</span><br><span class="line">			code=<span class="number">500</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			<span class="comment">//调用本类中的构造响应头</span></span><br><span class="line">			<span class="keyword">this</span>.createHeadInfo(code);</span><br><span class="line">			bw.write(headInfo.toString());</span><br><span class="line">			bw.write(content.toString());</span><br><span class="line">			bw.flush();</span><br><span class="line">			<span class="keyword">this</span>.close();</span><br><span class="line">		&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">			<span class="comment">// TODO Auto-generated catch block</span></span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">close</span><span class="params">()</span></span>&#123;</span><br><span class="line">		IOUtilClose.CloseALL(bw);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="12-2-编写相应的-Servlet-构造响应内容"><a href="#12-2-编写相应的-Servlet-构造响应内容" class="headerlink" title="12.2 编写相应的 Servlet 构造响应内容"></a>12.2 编写相应的 Servlet 构造响应内容</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.szxy.servlet;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> cn.szxy.server.Request;</span><br><span class="line"><span class="keyword">import</span> cn.szxy.server.Response;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LoginServlet</span> <span class="keyword">extends</span> <span class="title">Servlet</span></span>&#123;</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doGet</span><span class="params">(Request req, Response rep)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">			<span class="comment">//获取请求参数</span></span><br><span class="line">		String name=req.getParameter(<span class="string">"username"</span>);</span><br><span class="line">		String pwd=req.getParameter(<span class="string">"pwd"</span>);</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">if</span>(<span class="keyword">this</span>.login(name, pwd))&#123;</span><br><span class="line">			<span class="comment">//调用响应中的构建内容的方</span></span><br><span class="line">			rep.println(name+<span class="string">"登录成功"</span>);</span><br><span class="line">		&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">			rep.println(name+<span class="string">"登录失败，对不起，账号或密码不正确"</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">private</span> <span class="keyword">boolean</span> <span class="title">login</span><span class="params">(String name,String pwd)</span></span>&#123;</span><br><span class="line">		<span class="keyword">if</span> (<span class="string">"bjsxt"</span>.equals(name)&amp;&amp;<span class="string">"123"</span>.equals(pwd)) &#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doPost</span><span class="params">(Request req, Response rep)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">		<span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="12-3-启动服务器进行"><a href="#12-3-启动服务器进行" class="headerlink" title="12.3 启动服务器进行"></a>12.3 启动服务器进行</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.szxy.server;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.BufferedWriter;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.OutputStreamWriter;</span><br><span class="line"><span class="keyword">import</span> java.net.ServerSocket;</span><br><span class="line"><span class="keyword">import</span> java.net.Socket;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> cn.szxy.servlet.Servlet;</span><br><span class="line"><span class="keyword">import</span> cn.szxy.util.IOUtilClose;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Server</span> </span>&#123;<span class="comment">//服务器</span></span><br><span class="line">	ServerSocket server;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">start</span><span class="params">()</span></span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.start(<span class="number">9999</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">start</span><span class="params">(<span class="keyword">int</span> port)</span></span>&#123;</span><br><span class="line">		<span class="comment">//创建 ServerSocket 对象</span></span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			server = <span class="keyword">new</span> ServerSocket(port);</span><br><span class="line">			<span class="keyword">this</span>.receive();</span><br><span class="line">		&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">receive</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="comment">// 监听客户端的请求</span></span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			Socket  client = server.accept();</span><br><span class="line">			<span class="comment">//封装请求信息</span></span><br><span class="line">			Request req = <span class="keyword">new</span> Request(client.getInputStream());</span><br><span class="line">			</span><br><span class="line">			<span class="comment">/*做出响应*/</span></span><br><span class="line">			<span class="comment">/*StringBuilder sb = new StringBuilder();</span></span><br><span class="line"><span class="comment">			sb.append("HTTP/1.1").append(" ").append("200").append(" ").append("OK").append("\r\n");</span></span><br><span class="line"><span class="comment">			sb.append("Content-Type:text/html;charset=utf-8").append("\r\n");</span></span><br><span class="line"><span class="comment">			String str="&lt;html&gt;&lt;head&gt;&lt;title&gt;响应结果&lt;/title&gt;&lt;/head&gt;&lt;body&gt;成功&lt;/body&gt;&lt;/html&gt;";</span></span><br><span class="line"><span class="comment">			sb.append("\r\n");</span></span><br><span class="line"><span class="comment">			sb.append(str);</span></span><br><span class="line"><span class="comment">			//通过输出流发出去</span></span><br><span class="line"><span class="comment">			BufferedWriter bw = new BufferedWriter(new OutputStreamWriter(client.getOutputStream(),"utf-8"));</span></span><br><span class="line"><span class="comment">			bw.write(sb.toString());</span></span><br><span class="line"><span class="comment">			bw.flush();</span></span><br><span class="line"><span class="comment">			bw.close();*/</span></span><br><span class="line">			</span><br><span class="line">			Response resp = <span class="keyword">new</span> Response(client.getOutputStream());</span><br><span class="line">			Servlet servlet = WebApp.getServlet(req.getUrl());  <span class="comment">//获得servlet-class</span></span><br><span class="line">			<span class="keyword">int</span> code=<span class="number">200</span>;</span><br><span class="line">			<span class="keyword">if</span> (servlet==<span class="keyword">null</span>) &#123;</span><br><span class="line">				code=<span class="number">404</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="comment">//调用Servlet中的服务的方法</span></span><br><span class="line">			<span class="keyword">try</span> &#123;</span><br><span class="line">				servlet.service(req, resp);</span><br><span class="line">			&#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">				<span class="comment">// TODO Auto-generated catch block</span></span><br><span class="line">				e.printStackTrace();</span><br><span class="line">			&#125;</span><br><span class="line">			resp.pushToClient(code);</span><br><span class="line">			IOUtilClose.CloseALL(client);</span><br><span class="line">			</span><br><span class="line">		</span><br><span class="line">		&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">			<span class="comment">// TODO 自动生成的 catch 块</span></span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">stop</span><span class="params">()</span></span>&#123;</span><br><span class="line">		IOUtilClose.CloseALL(server);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">//测试 方法</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"启动服务器..."</span>);</span><br><span class="line">		Server server = <span class="keyword">new</span> Server();</span><br><span class="line">		server.start();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="13-多线程"><a href="#13-多线程" class="headerlink" title="13 多线程"></a>13 多线程</h3><h4 id="13-1-Dispatcher-调度-类"><a href="#13-1-Dispatcher-调度-类" class="headerlink" title="13.1 Dispatcher (调度) 类"></a>13.1 Dispatcher (调度) 类</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.szxy.server;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.net.Socket;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> cn.szxy.servlet.Servlet;</span><br><span class="line"><span class="keyword">import</span> cn.szxy.util.IOUtilClose;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 一个请求一个响应	</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> wzer</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Dispatcher</span> <span class="keyword">implements</span> <span class="title">Runnable</span></span>&#123;</span><br><span class="line">	<span class="keyword">private</span> Request req;</span><br><span class="line">	<span class="keyword">private</span> Response resp;</span><br><span class="line">	<span class="keyword">private</span> Socket client;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">int</span> code;<span class="comment">//状态码</span></span><br><span class="line">	<span class="comment">//构造函数  初始化</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">Dispatcher</span><span class="params">(Socket client)</span> </span>&#123;</span><br><span class="line">		<span class="comment">// 把局部变量的值赋给 成员变量</span></span><br><span class="line">		<span class="keyword">this</span>.client = client;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			<span class="keyword">this</span>.req = <span class="keyword">new</span> Request(<span class="keyword">this</span>.client.getInputStream());</span><br><span class="line">			<span class="keyword">this</span>.resp = <span class="keyword">new</span> Response(<span class="keyword">this</span>.client.getOutputStream());</span><br><span class="line">		&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">			<span class="keyword">this</span>.code = <span class="number">500</span>;</span><br><span class="line">			<span class="keyword">return</span> ;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="comment">//根据不同的 URL 创建指定的 Servlet</span></span><br><span class="line">		<span class="comment">//System.out.println(req.getUrl());</span></span><br><span class="line">		Servlet servlet = WebApp.getServlet(req.getUrl());</span><br><span class="line">		<span class="keyword">if</span>(servlet==<span class="keyword">null</span>)&#123;</span><br><span class="line">			<span class="keyword">this</span>.code = <span class="number">404</span>;</span><br><span class="line">		&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">			<span class="comment">//调用 servlet 相应的 service 方法</span></span><br><span class="line">			<span class="keyword">try</span> &#123;</span><br><span class="line">				servlet.service(req, resp);</span><br><span class="line">			&#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">				<span class="keyword">this</span>.code =<span class="number">500</span>;</span><br><span class="line">			&#125; </span><br><span class="line">		&#125;</span><br><span class="line">		resp.pushToClient(code);</span><br><span class="line">		IOUtilClose.CloseALL(client);  </span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="13-2-Servlet-类"><a href="#13-2-Servlet-类" class="headerlink" title="13.2 Servlet 类"></a>13.2 Servlet 类</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.szxy.server;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.BufferedWriter;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.OutputStreamWriter;</span><br><span class="line"><span class="keyword">import</span> java.net.ServerSocket;</span><br><span class="line"><span class="keyword">import</span> java.net.Socket;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> cn.szxy.servlet.Servlet;</span><br><span class="line"><span class="keyword">import</span> cn.szxy.util.IOUtilClose;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Server</span> </span>&#123;<span class="comment">//服务器</span></span><br><span class="line">	<span class="keyword">private</span> ServerSocket server;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">boolean</span> isShutdown = <span class="keyword">false</span>;<span class="comment">//默认没有出错</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">start</span><span class="params">()</span></span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.start(<span class="number">8888</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">start</span><span class="params">(<span class="keyword">int</span> port)</span></span>&#123;</span><br><span class="line">		<span class="comment">//创建 ServerSocket 对象</span></span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			server = <span class="keyword">new</span> ServerSocket(port);</span><br><span class="line">			<span class="keyword">this</span>.receive();</span><br><span class="line">		&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">receive</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			<span class="keyword">while</span>(!isShutdown)&#123;</span><br><span class="line">				<span class="comment">// 监听客户端的请求</span></span><br><span class="line">				Socket  client = server.accept();</span><br><span class="line">				<span class="comment">//创建线程类对象</span></span><br><span class="line">				Dispatcher  dis = <span class="keyword">new</span> Dispatcher(client);</span><br><span class="line">				<span class="comment">//创建代理类并启动线程</span></span><br><span class="line">				<span class="keyword">new</span> Thread(dis).start();	</span><br><span class="line">			&#125;</span><br><span class="line">		&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">			<span class="keyword">this</span>.stop();<span class="comment">//出现错误，关闭服务器		</span></span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">stop</span><span class="params">()</span></span>&#123;</span><br><span class="line">		isShutdown = <span class="keyword">true</span>;</span><br><span class="line">		IOUtilClose.CloseALL(server);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">//测试 方法</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"启动服务器..."</span>);</span><br><span class="line">		Server server = <span class="keyword">new</span> Server();</span><br><span class="line">		server.start();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="13-3-bug"><a href="#13-3-bug" class="headerlink" title="13.3 bug"></a>13.3 bug</h4><p>​    在处理网站 小图标没有添加对应的 Servlet 去处理，导致程序出现空指针异常。</p>
<h3 id="14-处理小-bug"><a href="#14-处理小-bug" class="headerlink" title="14 处理小 bug"></a>14 处理小 bug</h3><h4 id="14-1-新建-FaviconServlet-类"><a href="#14-1-新建-FaviconServlet-类" class="headerlink" title="14.1 新建 FaviconServlet 类"></a>14.1 新建 <code>FaviconServlet</code> 类</h4><p>只需创建好 <code>FAViconServlet</code>， 不需要对数据进行处理</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.szxy.servlet;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> cn.szxy.server.Request;</span><br><span class="line"><span class="keyword">import</span> cn.szxy.server.Response;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">FaviconServlet</span> <span class="keyword">extends</span> <span class="title">Servlet</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doGet</span><span class="params">(Request req, Response resp)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">		<span class="comment">// TODO 自动生成的方法存根</span></span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doPost</span><span class="params">(Request req, Response resp)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">		<span class="comment">// TODO 自动生成的方法存根</span></span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="14-2-配置-web-xml"><a href="#14-2-配置-web-xml" class="headerlink" title="14.2  配置 web.xml"></a>14.2  配置 web.xml</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="line">&lt;web-app&gt;</span><br><span class="line">	&lt;servlet&gt;</span><br><span class="line">		&lt;servlet-name&gt;login&lt;/servlet-name&gt;</span><br><span class="line">		&lt;servlet-class&gt;cn.szxy.servlet.LoginServlet&lt;/servlet-class&gt;</span><br><span class="line">	&lt;/servlet&gt;</span><br><span class="line">	&lt;servlet-mapping&gt;</span><br><span class="line">		&lt;servlet-name&gt;login&lt;/servlet-name&gt;</span><br><span class="line">		&lt;url-pattern&gt;/LoginServlet&lt;/url-pattern&gt;</span><br><span class="line">		&lt;url-pattern&gt;/Log&lt;/url-pattern&gt;</span><br><span class="line">	&lt;/servlet-mapping&gt;</span><br><span class="line">	&lt;servlet&gt;</span><br><span class="line">		&lt;servlet-name&gt;Regsin&lt;/servlet-name&gt;</span><br><span class="line">		&lt;servlet-class&gt;cn.szxy.servlet.RegisnServlet&lt;/servlet-class&gt;</span><br><span class="line">	&lt;/servlet&gt;</span><br><span class="line">	</span><br><span class="line">	&lt;servlet&gt;</span><br><span class="line">		&lt;servlet-name&gt;Favicon&lt;/servlet-name&gt;</span><br><span class="line">		&lt;servlet-class&gt;cn.szxy.servlet.FaviconServlet&lt;/servlet-class&gt;</span><br><span class="line">	&lt;/servlet&gt;</span><br><span class="line">	&lt;servlet-mapping&gt;</span><br><span class="line">		&lt;servlet-name&gt;Favicon&lt;/servlet-name&gt;</span><br><span class="line">		&lt;url-pattern&gt;/favicon.ico&lt;/url-pattern&gt;</span><br><span class="line">	&lt;/servlet-mapping&gt;</span><br><span class="line">&lt;/web-app&gt;</span><br></pre></td></tr></table></figure>

<h3 id="15总结和期望"><a href="#15总结和期望" class="headerlink" title="15总结和期望"></a>15总结和期望</h3><h4 id="15-1-项目总结涉及知识点"><a href="#15-1-项目总结涉及知识点" class="headerlink" title="15.1 项目总结涉及知识点"></a>15.1 项目总结涉及知识点</h4><p>1) 集合</p>
<p>2) IO</p>
<p>3) 多线程</p>
<p>4) 网络编程</p>
<p>5) 面向对象</p>
<p>6) 反射</p>
<p>7) XML</p>
<p>8) HTML</p>
<h4 id="15-2-项目思路"><a href="#15-2-项目思路" class="headerlink" title="15.2 项目思路"></a>15.2 项目思路</h4><p>1) 先分析</p>
<p>2) 搭建项目框架</p>
<p>3) 一步一步实现，先从会的开始实现</p>
<p>4) 整体思路，宏观使用面向对象，微观使用面向过程</p>
<p>5) 注重代码的调试</p>
<h4 id="15-3-思想是从键盘中敲出来的"><a href="#15-3-思想是从键盘中敲出来的" class="headerlink" title="15.3 思想是从键盘中敲出来的"></a>15.3 思想是从键盘中敲出来的</h4><p>1) 多注重实战</p>
<p>2) 学知识不是目的，目的是对知识的<strong>综合运用,</strong>才能将知识转化为<strong>能力</strong></p>
<p>3) 不要气馁，每天进步一点点，人最大的敌人是自己，今天的自己比昨天的自己有进步，就是成功。</p>
<p>4) 今天所有的付出，都会在明天以 RMB 的形式还给你。</p>
<p>5) 加油！</p>
<p><strong>记住：你不拼一把，永远不知道自己有多优秀</strong></p>

    </div>

    
    
    
        
      

      <footer class="post-footer">
          
            
          
          <div class="post-tags">
            
              <a href="/tags/服务器/" rel="tag"># 服务器</a>
            
              <a href="/tags/Socket/" rel="tag"># Socket</a>
            
          </div>
        

        

          <div class="post-nav">
            <div class="post-nav-next post-nav-item">
              
                <a href="/2018/11/18/Java/20181118 多线程并发技术/" rel="next" title="20181118 多线程并发技术">
                  <i class="fa fa-chevron-left"></i> 20181118 多线程并发技术
                </a>
              
            </div>

            <span class="post-nav-divider"></span>

            <div class="post-nav-prev post-nav-item">
              
                <a href="/2018/11/23/数据库/20181123 Oracle 数据库的使用/" rel="prev" title="20181123 Oracle 数据库的使用">
                  20181123 Oracle 数据库的使用 <i class="fa fa-chevron-right"></i>
                </a>
              
            </div>
          </div>
        
      </footer>
    
  </div>
  
  
  
  </article>

  </div>


          </div>
          

        </div>
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">
        
        
        
        
      

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-复习Socket"><span class="nav-number">1.</span> <span class="nav-text">1 复习Socket</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-1-编写服务器用到的知识点"><span class="nav-number">1.1.</span> <span class="nav-text">1.1 编写服务器用到的知识点</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#1-2-复习-Socket-编程"><span class="nav-number">1.2.</span> <span class="nav-text">1.2 复习 Socket 编程</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-HTML"><span class="nav-number">2.</span> <span class="nav-text">2 HTML</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#2-1-HTML-编写"><span class="nav-number">2.1.</span> <span class="nav-text">2.1 HTML 编写</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-2-form-表单"><span class="nav-number">2.2.</span> <span class="nav-text">2.2 form 表单</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-HTTP-协议"><span class="nav-number">3.</span> <span class="nav-text">3 HTTP 协议</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#3-1-协议"><span class="nav-number">3.1.</span> <span class="nav-text">3.1 协议</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-2HTTP-协议简介"><span class="nav-number">3.2.</span> <span class="nav-text">3.2HTTP 协议简介</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-3HTTP-请求格式"><span class="nav-number">3.3.</span> <span class="nav-text">3.3HTTP 请求格式</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-4HTTP-响应格式"><span class="nav-number">3.4.</span> <span class="nav-text">3.4HTTP 响应格式</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-Tomcat-快速应用"><span class="nav-number">4.</span> <span class="nav-text">4 Tomcat 快速应用</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#4-1Tomcat-简介"><span class="nav-number">4.1.</span> <span class="nav-text">4.1Tomcat 简介</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#4-2Tomcat-使用"><span class="nav-number">4.2.</span> <span class="nav-text">4.2Tomcat 使用</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-Tomcat-服务器运行原理"><span class="nav-number">5.</span> <span class="nav-text">5 Tomcat 服务器运行原理</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#5-1Tomcat-的运行原理"><span class="nav-number">5.1.</span> <span class="nav-text">5.1Tomcat 的运行原理</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#6-http-工具查看网络交互过程"><span class="nav-number">6.</span> <span class="nav-text">6  http 工具查看网络交互过程</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#6-1-下载并安装"><span class="nav-number">6.1.</span> <span class="nav-text">6.1 下载并安装</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#6-2-HttpWatch-的使用"><span class="nav-number">6.2.</span> <span class="nav-text">6.2 HttpWatch 的使用</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#7-整体架构和接口-编写XML文件"><span class="nav-number">7.</span> <span class="nav-text">7 整体架构和接口_编写XML文件</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#7-1-整体架构和接口"><span class="nav-number">7.1.</span> <span class="nav-text">7.1 整体架构和接口</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#Entity-类-实体类"><span class="nav-number">7.1.1.</span> <span class="nav-text">Entity 类  实体类</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Mapping类-映射"><span class="nav-number">7.1.2.</span> <span class="nav-text">Mapping类  映射</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#7-2-编写-XML文件"><span class="nav-number">7.2.</span> <span class="nav-text">7.2  编写 XML文件</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#8-DOM4J-解析-XML-文档"><span class="nav-number">8.</span> <span class="nav-text">8  DOM4J 解析 XML 文档</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#8-2-总结："><span class="nav-number">8.1.</span> <span class="nav-text">8.2 总结：</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#9-根据反射创建-Serlvet对象"><span class="nav-number">9.</span> <span class="nav-text">9 根据反射创建 Serlvet对象</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#9-1-编写-ServletContext-类"><span class="nav-number">9.1.</span> <span class="nav-text">9.1 编写 ServletContext 类</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#9-2-编写-WebApp-类"><span class="nav-number">9.2.</span> <span class="nav-text">9.2 编写 WebApp 类</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#10-封装-Request-请求"><span class="nav-number">10.</span> <span class="nav-text">10 封装  Request 请求</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#10-1-编写-Server"><span class="nav-number">10.1.</span> <span class="nav-text">10.1 编写 Server</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#10-2-编写-HTML"><span class="nav-number">10.2.</span> <span class="nav-text">10.2 编写 HTML</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#10-3-封装-Request-method-url"><span class="nav-number">10.3.</span> <span class="nav-text">10.3 封装 Request_method_url</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#11-封装-Request-存储参数-处理中文"><span class="nav-number">11.</span> <span class="nav-text">11  封装 Request  存储参数  处理中文</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#11-1-编写分解参数的方法"><span class="nav-number">11.1.</span> <span class="nav-text">11.1 编写分解参数的方法</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#11-2-编写根据页面上的-name-获取多个值的方法"><span class="nav-number">11.2.</span> <span class="nav-text">11.2 编写根据页面上的 name 获取多个值的方法</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#11-3-编写根据页面上的-name-获取单个值的方法"><span class="nav-number">11.3.</span> <span class="nav-text">11.3 编写根据页面上的 name 获取单个值的方法</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#11-4-编写解码的方法"><span class="nav-number">11.4.</span> <span class="nav-text">11.4 编写解码的方法</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#11-5-Request-类"><span class="nav-number">11.5.</span> <span class="nav-text">11.5  Request 类</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#11-6-总结"><span class="nav-number">11.6.</span> <span class="nav-text">11.6 总结</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#12-封装-Response"><span class="nav-number">12.</span> <span class="nav-text">12 封装 Response</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#12-1-封装-Response"><span class="nav-number">12.1.</span> <span class="nav-text">12.1 封装 Response</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#12-2-编写相应的-Servlet-构造响应内容"><span class="nav-number">12.2.</span> <span class="nav-text">12.2 编写相应的 Servlet 构造响应内容</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#12-3-启动服务器进行"><span class="nav-number">12.3.</span> <span class="nav-text">12.3 启动服务器进行</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#13-多线程"><span class="nav-number">13.</span> <span class="nav-text">13 多线程</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#13-1-Dispatcher-调度-类"><span class="nav-number">13.1.</span> <span class="nav-text">13.1 Dispatcher (调度) 类</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#13-2-Servlet-类"><span class="nav-number">13.2.</span> <span class="nav-text">13.2 Servlet 类</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#13-3-bug"><span class="nav-number">13.3.</span> <span class="nav-text">13.3 bug</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#14-处理小-bug"><span class="nav-number">14.</span> <span class="nav-text">14 处理小 bug</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#14-1-新建-FaviconServlet-类"><span class="nav-number">14.1.</span> <span class="nav-text">14.1 新建 FaviconServlet 类</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#14-2-配置-web-xml"><span class="nav-number">14.2.</span> <span class="nav-text">14.2  配置 web.xml</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#15总结和期望"><span class="nav-number">15.</span> <span class="nav-text">15总结和期望</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#15-1-项目总结涉及知识点"><span class="nav-number">15.1.</span> <span class="nav-text">15.1 项目总结涉及知识点</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#15-2-项目思路"><span class="nav-number">15.2.</span> <span class="nav-text">15.2 项目思路</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#15-3-思想是从键盘中敲出来的"><span class="nav-number">15.3.</span> <span class="nav-text">15.3 思想是从键盘中敲出来的</span></a></li></ol></li></ol></div>
        
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">zwer</p>
  <div class="site-description" itemprop="description">记录学习的日常</div>
</div>
  <nav class="site-state motion-element">
      <div class="site-state-item site-state-posts">
        
          <a href="/archives/">
        
          <span class="site-state-item-count">77</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
    
      
      
      <div class="site-state-item site-state-categories">
        
        <span class="site-state-item-count">10</span>
        <span class="site-state-item-name">categories</span>
        
      </div>
    
      
      
      <div class="site-state-item site-state-tags">
        
        <span class="site-state-item-count">52</span>
        <span class="site-state-item-name">tags</span>
        
      </div>
    
  </nav>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love" id="animate">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">zwer</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io" class="theme-link" rel="noopener" target="_blank">Hexo</a> v3.9.0</div>
  <span class="post-meta-divider">|</span>
  <div class="theme-info">Theme – <a href="https://theme-next.org" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a> v7.4.0</div>

        












        
      </div>
    </footer>
  </div>

  


  <script src="/lib/anime.min.js?v=3.1.0"></script>
  <script src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  <script src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
<script src="/js/utils.js?v=7.4.0"></script><script src="/js/motion.js?v=7.4.0"></script>
<script src="/js/schemes/muse.js?v=7.4.0"></script>
<script src="/js/next-boot.js?v=7.4.0"></script>



  





















  

  

  

</body>
</html>
