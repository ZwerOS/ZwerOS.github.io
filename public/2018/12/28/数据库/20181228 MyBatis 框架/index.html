<!DOCTYPE html>





<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 3.9.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=7.4.0">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=7.4.0">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=7.4.0">
  <link rel="mask-icon" href="/images/logo.svg?v=7.4.0" color="#222">

<link rel="stylesheet" href="/css/main.css?v=7.4.0">


<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css?v=4.7.0">


<script id="hexo-configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '7.4.0',
    exturl: false,
    sidebar: {"position":"left","display":"post","offset":12,"onmobile":false},
    copycode: {"enable":false,"show_result":false,"style":null},
    back2top: {"enable":true,"sidebar":false,"scrollpercent":false},
    bookmark: {"enable":false,"color":"#222","save":"auto"},
    fancybox: false,
    mediumzoom: false,
    lazyload: false,
    pangu: false,
    algolia: {
      appID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    },
    localsearch: {"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},
    path: '',
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    translation: {
      copy_button: 'Copy',
      copy_success: 'Copied',
      copy_failure: 'Copy failed'
    },
    sidebarPadding: 40
  };
</script>

  <meta name="description" content="1 框架的基本概念和配置文件a）框架是程序员将代码进行封装，之后进行重复使用的过程 b) 框架其实一个半成品，连接数据库为例，需要添加驱动，用户，密码的信息 c）所以在使用之前告诉框架一个信息，通过以配置文件的方法告知，一般来说， 多数会使用 xml 作为框架的配置 d）因此，在使用框架开发代码时，需要编写好配置文件，代码的编写反而会减少。 e）框架都是第三方提供的，提供的都是 Jar 包  ​">
<meta name="keywords" content="Mybatis 框架">
<meta property="og:type" content="article">
<meta property="og:title" content="2018 MyBatis 框架">
<meta property="og:url" content="http://zwer.xyz/2018/12/28/数据库/20181228 MyBatis 框架/index.html">
<meta property="og:site_name" content="zwer 的博客空间">
<meta property="og:description" content="1 框架的基本概念和配置文件a）框架是程序员将代码进行封装，之后进行重复使用的过程 b) 框架其实一个半成品，连接数据库为例，需要添加驱动，用户，密码的信息 c）所以在使用之前告诉框架一个信息，通过以配置文件的方法告知，一般来说， 多数会使用 xml 作为框架的配置 d）因此，在使用框架开发代码时，需要编写好配置文件，代码的编写反而会减少。 e）框架都是第三方提供的，提供的都是 Jar 包  ​">
<meta property="og:locale" content="en">
<meta property="og:image" content="http://www.zwer.xyz/picGo/20181228205405.png">
<meta property="og:image" content="http://www.zwer.xyz/picGo/20190106160532.png">
<meta property="og:image" content="http://www.zwer.xyz/picGo/20190106160547.png">
<meta property="og:updated_time" content="2019-02-24T06:29:54.145Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="2018 MyBatis 框架">
<meta name="twitter:description" content="1 框架的基本概念和配置文件a）框架是程序员将代码进行封装，之后进行重复使用的过程 b) 框架其实一个半成品，连接数据库为例，需要添加驱动，用户，密码的信息 c）所以在使用之前告诉框架一个信息，通过以配置文件的方法告知，一般来说， 多数会使用 xml 作为框架的配置 d）因此，在使用框架开发代码时，需要编写好配置文件，代码的编写反而会减少。 e）框架都是第三方提供的，提供的都是 Jar 包  ​">
<meta name="twitter:image" content="http://www.zwer.xyz/picGo/20181228205405.png">
  <link rel="canonical" href="http://zwer.xyz/2018/12/28/数据库/20181228 MyBatis 框架/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome: false,
    isPost: true,
    isPage: false,
    isArchive: false
  };
</script>

  <title>2018 MyBatis 框架 | zwer 的博客空间</title>
  








  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .logo,
  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="en">
  <div class="container use-motion">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-meta">

    <div>
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">zwer 的博客空间</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
        <p class="site-subtitle">上善若水 自强不息</p>
      
  </div>

  <div class="site-nav-toggle">
    <button aria-label="Toggle navigation bar">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>


<nav class="site-nav">
  
  <ul id="menu" class="menu">
      
      
      
        
        <li class="menu-item menu-item-home">
      
    

    <a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i> <br>Home</a>

  </li>
      
      
      
        
        <li class="menu-item menu-item-archives">
      
    

    <a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i> <br>Archives</a>

  </li>
  </ul>

    

</nav>
</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
      <article itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block post">
    <link itemprop="mainEntityOfPage" href="http://zwer.xyz/2018/12/28/数据库/20181228 MyBatis 框架/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="zwer">
      <meta itemprop="description" content="记录学习的日常">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="zwer 的博客空间">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">2018 MyBatis 框架

          
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              
                
              

              <time title="Created: 2018-12-28 20:00:00" itemprop="dateCreated datePublished" datetime="2018-12-28T20:00:00+08:00">2018-12-28</time>
            </span>
          
            

            
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2019-02-24 14:29:54" itemprop="dateModified" datetime="2019-02-24T14:29:54+08:00">2019-02-24</time>
              </span>
            
          
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/数据库/" itemprop="url" rel="index"><span itemprop="name">数据库</span></a></span>

                
                
              
            </span>
          

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h1 id="1-框架的基本概念和配置文件"><a href="#1-框架的基本概念和配置文件" class="headerlink" title="1 框架的基本概念和配置文件"></a>1 框架的基本概念和配置文件</h1><p>a）框架是程序员将代码进行封装，之后进行重复使用的过程</p>
<p>b) 框架其实一个半成品，连接数据库为例，需要添加驱动，用户，密码的信息</p>
<p>c）所以在使用之前告诉框架一个信息，通过以<u>配置文件</u>的方法告知，一般来说，</p>
<p>多数会使用 xml 作为框架的配置</p>
<p>d）因此，在使用框架开发代码时，需要编写好配置文件，代码的编写反而会减少。</p>
<p>e）框架都是第三方提供的，提供的都是 <strong>Jar 包</strong> </p>
<p>​     使用框架前，必须将框架涉及的 jar 导入项目中。</p>
<p>f）常见的 Java 开发的框架</p>
<ul>
<li>MyBatis， ORM 框架， 底层是对 jdbc 进行了封装</li>
<li>Spring， 是一个容器，管理东西</li>
<li>SpringMVC，分层开发的框架</li>
<li>Struts2，类似于 SpringMVC</li>
<li>Hibernate，类似于 MyBatis</li>
</ul>
<p>h）框架整合</p>
<p>​    SSM  = Spring + SpringMVC + MyBatis</p>
<p>​    SSH =   Spring + Struts + Hibernate</p>
<h1 id="2-MyBatis-简介"><a href="#2-MyBatis-简介" class="headerlink" title="2  MyBatis 简介"></a>2  MyBatis 简介</h1><blockquote>
<p>a） MyBatis 是一个 ORM 框架，用于操作数据库，底层是对 JDBC 进行的封装</p>
<p>b） MyBatis 的前生 iBatis，是 Apache 下的一个项目，现在被迁移到了 GitHub 上</p>
</blockquote>
<h1 id="3-MyBatis-环境配置"><a href="#3-MyBatis-环境配置" class="headerlink" title="3 MyBatis 环境配置"></a>3 MyBatis 环境配置</h1><h2 id="3-1-创建项目"><a href="#3-1-创建项目" class="headerlink" title="3.1  创建项目"></a>3.1  创建项目</h2><p>​    java project 项目</p>
<h2 id="3-2-导入-jar-包"><a href="#3-2-导入-jar-包" class="headerlink" title="3.2 导入 jar 包"></a>3.2 导入 jar 包</h2><h3 id="3-2-1-MyBatis-核心包"><a href="#3-2-1-MyBatis-核心包" class="headerlink" title="3.2.1 MyBatis 核心包"></a>3.2.1 MyBatis 核心包</h3><p>mybatis-3.2.7.jar</p>
<h3 id="3-2-2-MyBatis-依赖的-jar-包"><a href="#3-2-2-MyBatis-依赖的-jar-包" class="headerlink" title="3.2.2  MyBatis 依赖的 jar 包"></a>3.2.2  MyBatis 依赖的 jar 包</h3><p>asm-3.3.1.jar 字节码解析包，被 cglib 依赖<br>cglib-2.2.2.jar 动态代码实现<br>commons-logging-1.1.1.jar  日志包<br>javassist-3.17.1-GA.jar  字节码解析包<br>log4j-1.2.17.jar              日志<br>log4j-api-2.0-rc1.jar      日志<br>log4j-core-2.0-rc1.jar    日志<br>slf4j-api-1.7.5.jar           日志<br>slf4j-log4j12-1.7.5.jar   日志 </p>
<h3 id="3-2-3-驱动包-jar"><a href="#3-2-3-驱动包-jar" class="headerlink" title="3.2.3  驱动包 jar"></a>3.2.3  驱动包 jar</h3><p>mysql-connector-java-5.1.30.jar   </p>
<h2 id="3-3-编写配置文件"><a href="#3-3-编写配置文件" class="headerlink" title="3.3 编写配置文件"></a>3.3 编写配置文件</h2><p>a） 是一个 xml 文件，命名无要求(除中文)，位置无要求,一般</p>
<p>命名为 mybatis.xml 或者 mybatis-cfg.xml，<strong>放在 src 目录下 .</strong></p>
<p>b） mybatis 配置文件的约束 dtd 约束 </p>
<ul>
<li>dtd 文件（ MyBatis 官方提供了 dtd 约束, 方便 xml 的编写 ）</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE configuration</span><br><span class="line"> PUBLIC &quot;-//mybatis.org//DTD Config 3.0//EN&quot;</span><br><span class="line">&quot;http://mybatis.org/dtd/mybatis-3-config.dtd&quot;</span><br></pre></td></tr></table></figure>

<ul>
<li>关联 dtd 文件 — 更换 dtd 文件的查找位置</li>
</ul>
<p>打开Eclipse -&gt; PreFerences - &gt; XML  -&gt; XML Catelog - &gt;add -&gt; 选择File System -&gt; key type 设置为 System ID -&gt;</p>
<p>key值粘贴MyBatis 官方提供了dtd约束</p>
<p><img src="http://www.zwer.xyz/picGo/20181228205405.png" alt></p>
<h3 id="3-3-1-配置文件内容-初步"><a href="#3-3-1-配置文件内容-初步" class="headerlink" title="3.3.1 配置文件内容(初步)"></a>3.3.1 配置文件内容(初步)</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE configuration</span></span><br><span class="line"><span class="meta">  PUBLIC "-//mybatis.org//DTD Config 3.0//EN"</span></span><br><span class="line"><span class="meta">  "http://mybatis.org/dtd/mybatis-3-config.dtd"&gt;</span></span><br><span class="line"></span><br><span class="line"> <span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line"> 	<span class="comment">&lt;!-- 用于指定环境 </span></span><br><span class="line"><span class="comment"> 		 default: 用于指定使用的环境 id</span></span><br><span class="line"><span class="comment"> 	--&gt;</span></span><br><span class="line"> 	<span class="tag">&lt;<span class="name">environments</span> <span class="attr">default</span>=<span class="string">"szxy"</span>&gt;</span></span><br><span class="line"> 		<span class="comment">&lt;!-- 用于配置开发环境 </span></span><br><span class="line"><span class="comment"> 			 id：环境的唯一标识</span></span><br><span class="line"><span class="comment"> 		--&gt;</span></span><br><span class="line"> 		<span class="tag">&lt;<span class="name">environment</span> <span class="attr">id</span>=<span class="string">"szxy"</span>&gt;</span></span><br><span class="line"> 			<span class="comment">&lt;!-- 事务管理器 </span></span><br><span class="line"><span class="comment"> 				  type：用于设置 mybatis 采用什么方式管理事务</span></span><br><span class="line"><span class="comment"> 				  JDBC 表示采用和 JDBC 一样的事务管理方式</span></span><br><span class="line"><span class="comment"> 			--&gt;</span></span><br><span class="line"> 			<span class="tag">&lt;<span class="name">transactionManager</span> <span class="attr">type</span>=<span class="string">"JDBC"</span>&gt;</span><span class="tag">&lt;/<span class="name">transactionManager</span>&gt;</span></span><br><span class="line"> 			<span class="comment">&lt;!-- </span></span><br><span class="line"><span class="comment"> 				数据源/连接池 ，用于配置数据库连接池和数据库连接的参数</span></span><br><span class="line"><span class="comment"> 				type: 用于设置 mybatis 是否采用连接池技术</span></span><br><span class="line"><span class="comment"> 				pooled 表示 MyBatis 采用连接池技术</span></span><br><span class="line"><span class="comment"> 			 --&gt;</span> 			 </span><br><span class="line"> 			<span class="tag">&lt;<span class="name">dataSource</span> <span class="attr">type</span>=<span class="string">"pooled"</span>&gt;</span></span><br><span class="line"> 				<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"driver"</span> <span class="attr">value</span>=<span class="string">"com.mysql.jdbc.Driver"</span>/&gt;</span></span><br><span class="line"> 				<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"url"</span> <span class="attr">value</span>=<span class="string">"jdbc:mysql://localhost:3306/MyBatisTable"</span>/&gt;</span></span><br><span class="line"> 				<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"username"</span> <span class="attr">value</span>=<span class="string">"root"</span>/&gt;</span></span><br><span class="line"> 				<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"password"</span> <span class="attr">value</span>=<span class="string">"root"</span>/&gt;</span></span><br><span class="line"> 			<span class="tag">&lt;/<span class="name">dataSource</span>&gt;</span></span><br><span class="line"> 		<span class="tag">&lt;/<span class="name">environment</span>&gt;</span></span><br><span class="line"> 	<span class="tag">&lt;/<span class="name">environments</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="3-4-定义-pojo-类"><a href="#3-4-定义-pojo-类" class="headerlink" title="3.4  定义 pojo 类"></a>3.4  定义 pojo 类</h2><p>此处 略去</p>
<h2 id="3-5-Mapper-映射文件-数据访问层-Dao"><a href="#3-5-Mapper-映射文件-数据访问层-Dao" class="headerlink" title="3.5 Mapper 映射文件 == 数据访问层  Dao"></a>3.5 Mapper 映射文件 == 数据访问层  Dao</h2><blockquote>
<p>在 MyBatis 中， 推荐使用 mapper 作为包名 ，写一个映射配置文件即可 . </p>
<p>UserMapper.xml 用于 定义要执行的 SQL 语句，同时设定返回结果的类型</p>
<p>Eclipse快捷键： 选中文件，重命名 F2</p>
</blockquote>
<ul>
<li>UserMapper.xml</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;!DOCTYPE mapper</span></span><br><span class="line"><span class="meta">  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"</span></span><br><span class="line"><span class="meta">  "http://mybatis.org/dtd/mybatis-3-mapper.dtd"&gt;</span></span><br><span class="line"> <span class="comment">&lt;!-- </span></span><br><span class="line"><span class="comment"> 	  namespace 表示命名空间 ,可以随意定义，一般情况下写全限定名</span></span><br><span class="line"><span class="comment"> 	  MyBatis 管理 SQL 语句是通过 namespace + id 来定位的</span></span><br><span class="line"><span class="comment"> 	  namespace 类似于 包名+类名的结构</span></span><br><span class="line"><span class="comment">  --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span> =<span class="string">"cn.szxy.mapper.UserMapper"</span>&gt;</span></span><br><span class="line">	<span class="comment">&lt;!--  </span></span><br><span class="line"><span class="comment">		select 标签用于编写查询语句</span></span><br><span class="line"><span class="comment">		id: SQL 语句的唯一标识，类似于方法名</span></span><br><span class="line"><span class="comment">		resultType: 用于设定结果的返回类型(全限定路径)</span></span><br><span class="line"><span class="comment">		如果返回有集合，要写集合泛型的类型</span></span><br><span class="line"><span class="comment">	 --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"selAll"</span> <span class="attr">resultType</span>=<span class="string">"cn.szxy.pojo.User"</span>&gt;</span></span><br><span class="line">		<span class="comment">&lt;!-- 注意： SQL 语句不需要写分号哦 ！ --&gt;</span></span><br><span class="line">		select * from M_user</span><br><span class="line">	<span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>mybatis.xml  </li>
</ul>
<blockquote>
<p>添加 扫描映射文件</p>
</blockquote>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--  扫描映射文件  --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">mappers</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">mapper</span> <span class="attr">resource</span>=<span class="string">"cn/szxy/mapper/UserMapper.xml"</span> /&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">mappers</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE configuration</span></span><br><span class="line"><span class="meta">  PUBLIC "-//mybatis.org//DTD Config 3.0//EN"</span></span><br><span class="line"><span class="meta">  "http://mybatis.org/dtd/mybatis-3-config.dtd"&gt;</span></span><br><span class="line"></span><br><span class="line"> <span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line"> 	<span class="comment">&lt;!-- 用于指定环境 </span></span><br><span class="line"><span class="comment"> 		 default: 用于指定使用的环境 id</span></span><br><span class="line"><span class="comment"> 	--&gt;</span></span><br><span class="line"> 	<span class="tag">&lt;<span class="name">environments</span> <span class="attr">default</span>=<span class="string">"szxy"</span>&gt;</span></span><br><span class="line"> 		<span class="comment">&lt;!-- 用于配置开发环境 </span></span><br><span class="line"><span class="comment"> 			 id：环境的唯一标识</span></span><br><span class="line"><span class="comment"> 		--&gt;</span></span><br><span class="line"> 		<span class="tag">&lt;<span class="name">environment</span> <span class="attr">id</span>=<span class="string">"szxy"</span>&gt;</span></span><br><span class="line"> 			<span class="comment">&lt;!-- 事务管理器 </span></span><br><span class="line"><span class="comment"> 				  type：用于设置 mybatis 采用什么方式管理事务</span></span><br><span class="line"><span class="comment"> 				  JDBC 表示采用和 JDBC 一样的事务管理方式</span></span><br><span class="line"><span class="comment"> 			--&gt;</span></span><br><span class="line"> 			<span class="tag">&lt;<span class="name">transactionManager</span> <span class="attr">type</span>=<span class="string">"JDBC"</span>&gt;</span><span class="tag">&lt;/<span class="name">transactionManager</span>&gt;</span></span><br><span class="line"> 			<span class="comment">&lt;!-- </span></span><br><span class="line"><span class="comment"> 				数据源/连接池 ，用于配置数据库连接池和数据库连接的参数</span></span><br><span class="line"><span class="comment"> 				type: 用于设置 mybatis 是否采用连接池技术</span></span><br><span class="line"><span class="comment"> 				pooled 表示 MyBatis 采用连接池技术</span></span><br><span class="line"><span class="comment"> 			 --&gt;</span> 			 </span><br><span class="line"> 			<span class="tag">&lt;<span class="name">dataSource</span> <span class="attr">type</span>=<span class="string">"pooled"</span>&gt;</span></span><br><span class="line"> 				<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"driver"</span> <span class="attr">value</span>=<span class="string">"com.mysql.jdbc.Driver"</span>/&gt;</span></span><br><span class="line"> 				<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"url"</span> <span class="attr">value</span>=<span class="string">"jdbc:mysql://localhost:3306/MyBatisTable"</span>/&gt;</span></span><br><span class="line"> 				<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"username"</span> <span class="attr">value</span>=<span class="string">"root"</span>/&gt;</span></span><br><span class="line"> 				<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"password"</span> <span class="attr">value</span>=<span class="string">"root"</span>/&gt;</span></span><br><span class="line"> 			<span class="tag">&lt;/<span class="name">dataSource</span>&gt;</span></span><br><span class="line"> 		<span class="tag">&lt;/<span class="name">environment</span>&gt;</span></span><br><span class="line"> 	<span class="tag">&lt;/<span class="name">environments</span>&gt;</span></span><br><span class="line"> 	<span class="comment">&lt;!--  扫描映射文件  --&gt;</span></span><br><span class="line"> 	<span class="tag">&lt;<span class="name">mappers</span>&gt;</span></span><br><span class="line"> 		<span class="tag">&lt;<span class="name">mapper</span> <span class="attr">resource</span>=<span class="string">"cn/szxy/mapper/UserMapper.xml"</span> /&gt;</span></span><br><span class="line"> 	<span class="tag">&lt;/<span class="name">mappers</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>测试类</li>
</ul>
<blockquote>
<p>小插曲： 使用 Eclipse 自带的库 Junit，进行单元测试，无序创建 main 方法</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.szxy.Test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.io.Resources;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSession;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSessionFactory;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSessionFactoryBuilder;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> cn.szxy.pojo.User;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestMyBatis</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">		<span class="comment">//加载 Mybatis 核心文件配置文件</span></span><br><span class="line">		 InputStream is = Resources.getResourceAsStream(<span class="string">"mybatis.xml"</span>);</span><br><span class="line">		<span class="comment">//构建 SqlSessionFactory 工厂</span></span><br><span class="line">		SqlSessionFactory factory = <span class="keyword">new</span> SqlSessionFactoryBuilder().build(is);</span><br><span class="line">		<span class="comment">//获得 SqlSession 对象</span></span><br><span class="line">		SqlSession session = factory.openSession();</span><br><span class="line">		<span class="comment">//通过 SqlSession 对象，执行 SQL 语句</span></span><br><span class="line">		List&lt;User&gt; list = session.selectList(<span class="string">"cn.szxy.mapper.UserMapper.selAll"</span>);</span><br><span class="line">		<span class="comment">/*** 注意 数据库表中的列名和 pojo 类的成员变量名字必须一致 ***/</span></span><br><span class="line">		System.out.println(list);</span><br><span class="line">		is.close();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="4-MyBatis-配置文件详解"><a href="#4-MyBatis-配置文件详解" class="headerlink" title="4 MyBatis 配置文件详解"></a>4 MyBatis 配置文件详解</h1><h2 id="4-1-configuration"><a href="#4-1-configuration" class="headerlink" title="4.1 configuration"></a>4.1 configuration</h2><p>​    配置 MyBatis 的环境</p>
<h2 id="4-2-environments"><a href="#4-2-environments" class="headerlink" title="4.2 environments"></a>4.2 environments</h2><p>用于管理所有的环境，并可以指定默认的使用哪个环境，通过 default 属性确定</p>
<h2 id="4-3-environment"><a href="#4-3-environment" class="headerlink" title="4.3 environment"></a>4.3 environment</h2><p>用于配置环境， id 属性用于表示唯一标识当前环境</p>
<h2 id="4-4-transcation"><a href="#4-4-transcation" class="headerlink" title="4.4  transcation"></a>4.4  transcation</h2><p>用于配置事务管理器 </p>
<h3 id="4-4-1-type-属性"><a href="#4-4-1-type-属性" class="headerlink" title="4.4.1  type 属性"></a>4.4.1  type 属性</h3><p>用于指定以何种方式管理 SQL 语句 </p>
<p>a） JDBC   表示 MyBatis 采用与原生 JDBC 一样的方式管理事务</p>
<p>b）MANAGED: 表示将事务管理交给其他容器进行, 例如 Spring </p>
<h1 id="4-5-lt-DataSource-gt"><a href="#4-5-lt-DataSource-gt" class="headerlink" title="4.5 &lt;DataSource&gt;"></a>4.5 <code>&lt;DataSource&gt;</code></h1><p>用于配置数据源, 设置 MyBatis 是否使用连接池技术, 并且配置数据库连接的四个参数 </p>
<h2 id="4-5-1-type-属性"><a href="#4-5-1-type-属性" class="headerlink" title="4.5.1 type 属性"></a>4.5.1 type 属性</h2><p>用于设置 MyBatis 是否使用连接池技术 </p>
<p>a)   <u>POOLED,</u> 表示采用连接池技术 </p>
<p>b)   UNPOOLED, 表示每次都会开启和关闭连接, 不使用连接池技术 </p>
<p>c)    JNDI, 使用其他容器(例如 Spring)提供数据源 </p>
<h2 id="1-6-lt-property-gt"><a href="#1-6-lt-property-gt" class="headerlink" title="1.6  &lt;property&gt;"></a>1.6  <code>&lt;property&gt;</code></h2><p>用于配置数据库连接参数(driver, url, username, password) </p>
<h2 id="1-7-lt-mappers-gt"><a href="#1-7-lt-mappers-gt" class="headerlink" title="1.7 &lt;mappers&gt;"></a>1.7 <code>&lt;mappers&gt;</code></h2><p>用于扫描 mapper 信息 </p>
<h1 id="5-Mapper-映射配置文件详解"><a href="#5-Mapper-映射配置文件详解" class="headerlink" title="5 Mapper 映射配置文件详解"></a>5 Mapper 映射配置文件详解</h1><h2 id="5-1-lt-mapper-gt"><a href="#5-1-lt-mapper-gt" class="headerlink" title="5.1 &lt;mapper&gt;"></a>5.1 <code>&lt;mapper&gt;</code></h2><p>根元素</p>
<h2 id="5-1-1-namespace-属性"><a href="#5-1-1-namespace-属性" class="headerlink" title="5.1.1  namespace  属性"></a>5.1.1  namespace  属性</h2><p>用于指定命名空间，mybatis 是通过 namespace + id 来定位 SQL 语句的，所以必须指定    </p>
<p>namespace. 通常 namespace 被配置为全限定路径</p>
<h2 id="5-2-lt-select-gt"><a href="#5-2-lt-select-gt" class="headerlink" title="5.2 &lt;select&gt;"></a>5.2 <code>&lt;select&gt;</code></h2><p>用于定义查询语句（DQL）</p>
<h3 id="5-2-1-id-属性"><a href="#5-2-1-id-属性" class="headerlink" title="5.2.1 id 属性"></a>5.2.1 id 属性</h3><p>用于表示唯一的 SQL 语句，类似于方法中的方法名</p>
<h3 id="5-2-2-resultType-属性"><a href="#5-2-2-resultType-属性" class="headerlink" title="5.2.2 resultType 属性"></a>5.2.2 resultType 属性</h3><p>用于设定查询返回的数据类型，要写类型的全限定路径. 如果返回的<br>是集合类型, 要写集合的泛型的类型</p>
<h1 id="6-MyBatis-中常用三个查询方法"><a href="#6-MyBatis-中常用三个查询方法" class="headerlink" title="6 MyBatis 中常用三个查询方法"></a>6 MyBatis 中常用三个查询方法</h1><h2 id="6-1-select-List"><a href="#6-1-select-List" class="headerlink" title="6.1 select List"></a>6.1 select List</h2><p>用于查询多条数据的情况，返回值是一个 list 集合 ，如果没有查到任何数据，返回没有元素的集合</p>
<p>（空集合，不是 null）</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * 查找所有用户</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@throws</span> IOException</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span>  <span class="keyword">static</span>  <span class="keyword">void</span> <span class="title">selAll</span><span class="params">()</span> <span class="keyword">throws</span> IOException</span>&#123;</span><br><span class="line">		InputStream is = Resources.getResourceAsStream(<span class="string">"mybatis-cfg.xml"</span>);</span><br><span class="line">		SqlSessionFactory factory = <span class="keyword">new</span> SqlSessionFactoryBuilder().build(is);</span><br><span class="line">		SqlSession session = factory.openSession();</span><br><span class="line">		</span><br><span class="line">		<span class="comment">// 将结果打印在控制台打印输出</span></span><br><span class="line">		List&lt;User&gt; list = session.selectList(<span class="string">"cn.szxy.mapper.UserMapper.selAll"</span>);</span><br><span class="line">		<span class="keyword">for</span> (User user : list) &#123;</span><br><span class="line">			System.out.println(user);</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		session.close();</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<h2 id="6-2-selectOne"><a href="#6-2-selectOne" class="headerlink" title="6.2  selectOne"></a>6.2  selectOne</h2><p>用于查询单条数据的情况，若查不到返回值结果是 null  </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * 查找单个用户</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@throws</span> IOException</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span>  <span class="keyword">void</span> <span class="title">selOne</span><span class="params">()</span> <span class="keyword">throws</span> IOException</span>&#123;</span><br><span class="line">		InputStream is = Resources.getResourceAsStream(<span class="string">"mybatis-cfg.xml"</span>);</span><br><span class="line">		SqlSessionFactory factory = <span class="keyword">new</span> SqlSessionFactoryBuilder().build(is);</span><br><span class="line">		SqlSession session = factory.openSession();</span><br><span class="line">		</span><br><span class="line">		User user = session.selectOne(<span class="string">"cn.szxy.mapper.UserMapper.selOne"</span>);</span><br><span class="line">		System.out.println(user);</span><br><span class="line">		</span><br><span class="line">		session.close();</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<h2 id="6-3-selectMap-—-重点"><a href="#6-3-selectMap-—-重点" class="headerlink" title="6.3 selectMap    — 重点"></a>6.3 selectMap    — 重点</h2><p>用于查询多条数据的情况，多条数据要形成一个 Map 集合。</p>
<p>如果查不到，返回一个空的map集合(null )</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * 查找所有用户并用户id映射</span></span><br><span class="line"><span class="comment">	 * id 作为 key 键</span></span><br><span class="line"><span class="comment">	 * User对象 作为 value 值</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@throws</span> IOException</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span>  <span class="keyword">void</span> <span class="title">selMap</span><span class="params">()</span> <span class="keyword">throws</span> IOException</span>&#123;</span><br><span class="line">		InputStream is = Resources.getResourceAsStream(<span class="string">"mybatis-cfg.xml"</span>);</span><br><span class="line">		SqlSessionFactory factory = <span class="keyword">new</span> SqlSessionFactoryBuilder().build(is);</span><br><span class="line">		SqlSession session = factory.openSession();</span><br><span class="line">		</span><br><span class="line">		<span class="comment">// 获得结果集</span></span><br><span class="line">		Map&lt;Integer, User&gt; map = session.selectMap(<span class="string">"cn.szxy.mapper.UserMapper.selAll"</span>,<span class="string">"id"</span>);</span><br><span class="line">		<span class="comment">// 遍历集合</span></span><br><span class="line">		Set&lt;Integer&gt; set = map.keySet();</span><br><span class="line">		<span class="keyword">for</span> (Integer i : set) &#123;</span><br><span class="line">			System.out.println(<span class="string">"id="</span>+i+<span class="string">"\t"</span>+map.get(i));</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		session.close();</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<h1 id="7-Log4J"><a href="#7-Log4J" class="headerlink" title="7 Log4J"></a>7 Log4J</h1><h2 id="7-1-Log4J-简介"><a href="#7-1-Log4J-简介" class="headerlink" title="7.1 Log4J 简介"></a>7.1 Log4J 简介</h2><p>a） Log4J 是 apache 提供的一款记录日志的工具</p>
<p>b）log4j  既可以将日志信息打印在控制台上，也可以打印输出到一个日志文件中</p>
<p>c）log4j 可以定制日志的输出格式</p>
<p>d）log4j 可以定制日志的级别</p>
<h2 id="7-2日志级别"><a href="#7-2日志级别" class="headerlink" title="7.2日志级别"></a>7.2日志级别</h2><ul>
<li><h5 id="FATAL"><a href="#FATAL" class="headerlink" title="FATAL"></a>FATAL</h5></li>
</ul>
<p>致命的，表示非常严重的错误，一般是系统错误</p>
<ul>
<li>ERROR</li>
</ul>
<p>错误，表示代码错误，比较严重</p>
<ul>
<li>WARN</li>
</ul>
<p>警告，不影响程序的运行</p>
<ul>
<li>IFNO</li>
</ul>
<p>信息，表示普通的输出信息</p>
<ul>
<li>DEBUG </li>
</ul>
<p>调式，表示程序员人为调用一些信息</p>
<h2 id="7-3-log4j-使用"><a href="#7-3-log4j-使用" class="headerlink" title="7.3 log4j 使用"></a>7.3 log4j 使用</h2><h3 id="7-3-1-导包"><a href="#7-3-1-导包" class="headerlink" title="7.3.1 导包"></a>7.3.1 导包</h3><p>log4j-1.2.17.jar<br>log4j-api-2.0-rc1.jar<br>log4j-core-2.0-rc1.jar</p>
<h3 id="7-3-2-配置文件"><a href="#7-3-2-配置文件" class="headerlink" title="7.3.2 配置文件"></a>7.3.2 配置文件</h3><p>使用 log4j.properties 的配置文件，会设定log4j的设置信息，例如日志的级别，日志的输出格式，</p>
<p>日志的格式等等。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"># Set root category priority to INFO and its only appender to CONSOLE.</span><br><span class="line">#log4j.rootCategory=DEBUG, CONSOLE</span><br><span class="line">log4j.rootCategory=DEBUG, CONSOLE, LOGFILE</span><br><span class="line"></span><br><span class="line"># Set the enterprise logger category to FATAL and its only appender to CONSOLE.</span><br><span class="line">log4j.logger.org.apache.axis.enterprise=FATAL, CONSOLE</span><br><span class="line"></span><br><span class="line"># CONSOLE is set to be a ConsoleAppender using a PatternLayout.</span><br><span class="line">log4j.appender.CONSOLE=org.apache.log4j.ConsoleAppender</span><br><span class="line">log4j.appender.CONSOLE.layout=org.apache.log4j.PatternLayout</span><br><span class="line">log4j.appender.CONSOLE.layout.ConversionPattern=- %m %c %d&#123;YYYY-MM-DD HH:mm:ss&#125; %n</span><br><span class="line"></span><br><span class="line"># LOGFILE is set to be a File appender using a PatternLayout.</span><br><span class="line">log4j.appender.LOGFILE=org.apache.log4j.FileAppender</span><br><span class="line">log4j.appender.LOGFILE.File= D:/test.log</span><br><span class="line">log4j.appender.LOGFILE.Append=true</span><br><span class="line">log4j.appender.LOGFILE.layout=org.apache.log4j.PatternLayout</span><br><span class="line">log4j.appender.LOGFILE.layout.ConversionPattern= - %l%m%n</span><br></pre></td></tr></table></figure>

<h2 id="7-4-MyBatis-对log4j-的支持-——定制-SQL-语句输出格式"><a href="#7-4-MyBatis-对log4j-的支持-——定制-SQL-语句输出格式" class="headerlink" title="7.4 MyBatis 对log4j 的支持 ——定制 SQL 语句输出格式"></a>7.4 MyBatis 对log4j 的支持 ——定制 SQL 语句输出格式</h2><p>在项目的 src 目录下添加 log4j.properties 配置文件</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">- Logging initialized using 'class org.apache.ibatis.logging.slf4j.Slf4jImpl' adapter. org.apache.ibatis.logging.LogFactory 2019-01-05 21:30:42 </span><br><span class="line">- PooledDataSource forcefully closed/removed all connections. org.apache.ibatis.datasource.pooled.PooledDataSource 2019-01-05 21:30:42 </span><br><span class="line">- PooledDataSource forcefully closed/removed all connections. org.apache.ibatis.datasource.pooled.PooledDataSource 2019-01-05 21:30:42 </span><br><span class="line">- PooledDataSource forcefully closed/removed all connections. org.apache.ibatis.datasource.pooled.PooledDataSource 2019-01-05 21:30:42 </span><br><span class="line">- PooledDataSource forcefully closed/removed all connections. org.apache.ibatis.datasource.pooled.PooledDataSource 2019-01-05 21:30:42 </span><br><span class="line">- Opening JDBC Connection org.apache.ibatis.transaction.jdbc.JdbcTransaction 2019-01-05 21:30:42 </span><br><span class="line">- Created connection 1955915048. org.apache.ibatis.datasource.pooled.PooledDataSource 2019-01-05 21:30:43 </span><br><span class="line">- Setting autocommit to false on JDBC Connection [com.mysql.jdbc.JDBC4Connection@7494e528] org.apache.ibatis.transaction.jdbc.JdbcTransaction 2019-01-05 21:30:43 </span><br><span class="line">- ==&gt;  Preparing: select * from M_user  cn.szxy.mapper.UserMapper.selAll 2019-01-05 21:30:43 </span><br><span class="line">- ==&gt; Parameters:  cn.szxy.mapper.UserMapper.selAll 2019-01-05 21:30:43 </span><br><span class="line">- <span class="tag">&lt;<span class="name">==</span>      <span class="attr">Total:</span> <span class="attr">6</span> <span class="attr">cn.szxy.mapper.UserMapper.selAll</span> <span class="attr">2019-01-05</span> <span class="attr">21:30:43</span> </span></span><br><span class="line"><span class="tag"><span class="attr">User</span> [<span class="attr">id</span>=<span class="string">1,</span> <span class="attr">name</span>=<span class="string">小猪,</span> <span class="attr">sex</span>=<span class="string">男,</span> <span class="attr">age</span>=<span class="string">20]</span></span></span><br><span class="line"><span class="tag"><span class="attr">User</span> [<span class="attr">id</span>=<span class="string">2,</span> <span class="attr">name</span>=<span class="string">abc,</span> <span class="attr">sex</span>=<span class="string">男,</span> <span class="attr">age</span>=<span class="string">20]</span></span></span><br><span class="line"><span class="tag"><span class="attr">User</span> [<span class="attr">id</span>=<span class="string">3,</span> <span class="attr">name</span>=<span class="string">ytj,</span> <span class="attr">sex</span>=<span class="string">男,</span> <span class="attr">age</span>=<span class="string">20]</span></span></span><br><span class="line"><span class="tag"><span class="attr">User</span> [<span class="attr">id</span>=<span class="string">4,</span> <span class="attr">name</span>=<span class="string">123,</span> <span class="attr">sex</span>=<span class="string">男,</span> <span class="attr">age</span>=<span class="string">20]</span></span></span><br><span class="line"><span class="tag"><span class="attr">User</span> [<span class="attr">id</span>=<span class="string">5,</span> <span class="attr">name</span>=<span class="string">小红,</span> <span class="attr">sex</span>=<span class="string">女,</span> <span class="attr">age</span>=<span class="string">20]</span></span></span><br><span class="line"><span class="tag"><span class="attr">User</span> [<span class="attr">id</span>=<span class="string">6,</span> <span class="attr">name</span>=<span class="string">小猪,</span> <span class="attr">sex</span>=<span class="string">男,</span> <span class="attr">age</span>=<span class="string">22]</span></span></span><br><span class="line"><span class="tag"><span class="attr">-</span> <span class="attr">Resetting</span> <span class="attr">autocommit</span> <span class="attr">to</span> <span class="attr">true</span> <span class="attr">on</span> <span class="attr">JDBC</span> <span class="attr">Connection</span> [<span class="attr">com.mysql.jdbc.JDBC4Connection</span>@<span class="attr">7494e528</span>] <span class="attr">org.apache.ibatis.transaction.jdbc.JdbcTransaction</span> <span class="attr">2019-01-05</span> <span class="attr">21:30:43</span> </span></span><br><span class="line"><span class="tag"><span class="attr">-</span> <span class="attr">Closing</span> <span class="attr">JDBC</span> <span class="attr">Connection</span> [<span class="attr">com.mysql.jdbc.JDBC4Connection</span>@<span class="attr">7494e528</span>] <span class="attr">org.apache.ibatis.transaction.jdbc.JdbcTransaction</span> <span class="attr">2019-01-05</span> <span class="attr">21:30:43</span> </span></span><br><span class="line"><span class="tag"><span class="attr">-</span> <span class="attr">Returned</span> <span class="attr">connection</span> <span class="attr">1955915048</span> <span class="attr">to</span> <span class="attr">pool.</span> <span class="attr">org.apache.ibatis.datasource.pooled.PooledDataSource</span> <span class="attr">2019-01-05</span> <span class="attr">21:30:43</span></span></span><br></pre></td></tr></table></figure>

<ul>
<li>修改 log4j.perperties 配置信息</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"># Set root category priority to INFO and its only appender to CONSOLE.</span><br><span class="line">log4j.rootCategory=ERROR, CONSOLE</span><br><span class="line"># log4j.rootCategory=DEBUG, CONSOLE, LOGFILE</span><br><span class="line"></span><br><span class="line"># 单独输出 SQL 语句</span><br><span class="line"># 方法级别</span><br><span class="line"># log4j.logger.cn.szxy.mapper.UserMapper.selOne=debug;</span><br><span class="line"># 类级别</span><br><span class="line"># log4j.logger.cn.szxy.mapper.UserMapper=debug;</span><br><span class="line"># 包级别</span><br><span class="line">log4j.logger.cn.szxy.mapper=debug;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># Set the enterprise logger category to FATAL and its only appender to CONSOLE.</span><br><span class="line">log4j.logger.org.apache.axis.enterprise=FATAL, CONSOLE</span><br><span class="line"></span><br><span class="line"># CONSOLE is set to be a ConsoleAppender using a PatternLayout.</span><br><span class="line">log4j.appender.CONSOLE=org.apache.log4j.ConsoleAppender</span><br><span class="line">log4j.appender.CONSOLE.layout=org.apache.log4j.PatternLayout</span><br><span class="line">log4j.appender.CONSOLE.layout.ConversionPattern=- %m %c %d&#123;YYYY-MM-DD HH:mm:ss&#125; %n</span><br><span class="line"></span><br><span class="line"># LOGFILE is set to be a File appender using a PatternLayout.</span><br><span class="line">log4j.appender.LOGFILE=org.apache.log4j.FileAppender</span><br><span class="line">log4j.appender.LOGFILE.File= D:/test.log</span><br><span class="line">log4j.appender.LOGFILE.Append=true</span><br><span class="line">log4j.appender.LOGFILE.layout=org.apache.log4j.PatternLayout</span><br><span class="line">log4j.appender.LOGFILE.layout.ConversionPattern= - %l%m%n</span><br></pre></td></tr></table></figure>

<ul>
<li><p>在 mybatis_cfg.xml</p>
<ul>
<li>设置  setting </li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">settings</span>&gt;</span></span><br><span class="line"> 	<span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">"logImpl"</span> <span class="attr">value</span>=<span class="string">"LOG4J"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">settings</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>Mybatis 配置文件</li>
</ul>
</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE configuration</span></span><br><span class="line"><span class="meta">  PUBLIC "-//mybatis.org//DTD Config 3.0//EN"</span></span><br><span class="line"><span class="meta">  "http://mybatis.org/dtd/mybatis-3-config.dtd"&gt;</span></span><br><span class="line">  <span class="comment">&lt;!--  配置  --&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line"> 	<span class="tag">&lt;<span class="name">settings</span>&gt;</span></span><br><span class="line"> 	 	<span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">"logImpl"</span> <span class="attr">value</span>=<span class="string">"LOG4J"</span>/&gt;</span></span><br><span class="line"> 	<span class="tag">&lt;/<span class="name">settings</span>&gt;</span>	</span><br><span class="line">	<span class="tag">&lt;<span class="name">environments</span> <span class="attr">default</span>=<span class="string">"szxy"</span>&gt;</span></span><br><span class="line">		<span class="comment">&lt;!--  环境 id 是环境的唯一标识  --&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">environment</span> <span class="attr">id</span>=<span class="string">"szxy"</span>&gt;</span></span><br><span class="line">			<span class="comment">&lt;!-- 事务管理 --&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">transactionManager</span> <span class="attr">type</span>=<span class="string">"JDBC"</span> /&gt;</span></span><br><span class="line">			<span class="comment">&lt;!--  数据源 --&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">dataSource</span> <span class="attr">type</span>=<span class="string">"pooled"</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"driver"</span> <span class="attr">value</span>=<span class="string">"com.mysql.jdbc.Driver"</span>/&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"url"</span> <span class="attr">value</span>=<span class="string">"jdbc:mysql://localhost:3306/MyBatisTable"</span>/&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"username"</span> <span class="attr">value</span>=<span class="string">"root"</span>/&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"password"</span> <span class="attr">value</span>=<span class="string">"root"</span>/&gt;</span></span><br><span class="line">			<span class="tag">&lt;/<span class="name">dataSource</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">environment</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">environments</span>&gt;</span></span><br><span class="line">	<span class="comment">&lt;!--  扫描映射文件  --&gt;</span></span><br><span class="line"> 	<span class="tag">&lt;<span class="name">mappers</span>&gt;</span></span><br><span class="line"> 		<span class="tag">&lt;<span class="name">mapper</span> <span class="attr">resource</span>=<span class="string">"cn/szxy/mapper/UserMapper.xml"</span>/&gt;</span></span><br><span class="line"> 	<span class="tag">&lt;/<span class="name">mappers</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h1 id="8-properties-软编码"><a href="#8-properties-软编码" class="headerlink" title="8  properties 软编码"></a>8  properties 软编码</h1><ul>
<li>db.properties 数据库配置文件 </li>
</ul>
<blockquote>
<p>这些是外部化的, 可替代的属性, 这些属性也可以配置在典型的 Java 属性配置文件中, 或者通过 properties 元素的子元素来传递。</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">jdbc.driver=com.mysql.jdbc.Driver</span><br><span class="line">jdbc.url=jdbc:mysql://localhost:3306/MyBatisTable</span><br><span class="line">jdbc.username=root</span><br><span class="line">jdbc.password=root</span><br></pre></td></tr></table></figure>

<ul>
<li>其中的属性就可以在整个配置文件中使用,使用可替换的属性来实现动态配置</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"driver"</span> <span class="attr">value</span>=<span class="string">"$&#123;jdbc.driver&#125;"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"url"</span> <span class="attr">value</span>=<span class="string">"$&#123;jdbc.url&#125;"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"username"</span> <span class="attr">value</span>=<span class="string">"$&#123;jdbc.username&#125;"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"password"</span> <span class="attr">value</span>=<span class="string">"$&#123;jdbc.password&#125;"</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>MyBatis 配置文件</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE configuration</span></span><br><span class="line"><span class="meta">  PUBLIC "-//mybatis.org//DTD Config 3.0//EN"</span></span><br><span class="line"><span class="meta">  "http://mybatis.org/dtd/mybatis-3-config.dtd"&gt;</span></span><br><span class="line">  <span class="comment">&lt;!--  配置  --&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line"> 	<span class="comment">&lt;!-- 加载 properties 外部文件 --&gt;</span></span><br><span class="line"> 	<span class="tag">&lt;<span class="name">properties</span> <span class="attr">resource</span>=<span class="string">"db.properties"</span> /&gt;</span></span><br><span class="line"> </span><br><span class="line"> 	<span class="comment">&lt;!-- 设置MyBatis对 Log4J 的支持   --&gt;</span></span><br><span class="line"> 	<span class="tag">&lt;<span class="name">settings</span>&gt;</span></span><br><span class="line"> 	 	<span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">"logImpl"</span> <span class="attr">value</span>=<span class="string">"LOG4J"</span>/&gt;</span></span><br><span class="line"> 	<span class="tag">&lt;/<span class="name">settings</span>&gt;</span>	</span><br><span class="line">	<span class="tag">&lt;<span class="name">environments</span> <span class="attr">default</span>=<span class="string">"szxy"</span>&gt;</span></span><br><span class="line">		<span class="comment">&lt;!--  环境 id 是环境的唯一标识  --&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">environment</span> <span class="attr">id</span>=<span class="string">"szxy"</span>&gt;</span></span><br><span class="line">			<span class="comment">&lt;!-- 事务管理 --&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">transactionManager</span> <span class="attr">type</span>=<span class="string">"JDBC"</span> /&gt;</span></span><br><span class="line">			<span class="comment">&lt;!--  数据源 --&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">dataSource</span> <span class="attr">type</span>=<span class="string">"pooled"</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"driver"</span> <span class="attr">value</span>=<span class="string">"$&#123;jdbc.driver&#125;"</span>/&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"url"</span> <span class="attr">value</span>=<span class="string">"$&#123;jdbc.url&#125;"</span>/&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"username"</span> <span class="attr">value</span>=<span class="string">"$&#123;jdbc.username&#125;"</span>/&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"password"</span> <span class="attr">value</span>=<span class="string">"$&#123;jdbc.password&#125;"</span>/&gt;</span></span><br><span class="line">			<span class="tag">&lt;/<span class="name">dataSource</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">environment</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">environments</span>&gt;</span></span><br><span class="line">	<span class="comment">&lt;!--  扫描映射文件  --&gt;</span></span><br><span class="line"> 	<span class="tag">&lt;<span class="name">mappers</span>&gt;</span></span><br><span class="line"> 		<span class="tag">&lt;<span class="name">mapper</span> <span class="attr">resource</span>=<span class="string">"cn/szxy/mapper/UserMapper.xml"</span>/&gt;</span></span><br><span class="line"> 	<span class="tag">&lt;/<span class="name">mappers</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h1 id="9-typeAliases-标签配置别名"><a href="#9-typeAliases-标签配置别名" class="headerlink" title="9   typeAliases 标签配置别名"></a>9   typeAliases 标签配置别名</h1><ul>
<li>mybatis.xml 部分配置</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">typeAliases</span>&gt;</span></span><br><span class="line"> 		<span class="comment">&lt;!-- 设置User 类型的别名为 User --&gt;</span></span><br><span class="line"> 		<span class="comment">&lt;!-- &lt;typeAlias type="cn.szxy.pojo.User"/&gt; --&gt;</span></span><br><span class="line"> 		<span class="comment">&lt;!-- 设置 package 包下的类型别名为 类名 --&gt;</span></span><br><span class="line"> 		<span class="tag">&lt;<span class="name">package</span> <span class="attr">name</span>=<span class="string">"cn.szxy.pojo"</span>/&gt;</span></span><br><span class="line"> <span class="tag">&lt;/<span class="name">typeAliases</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>对于普通的 Java 类型,有许多内建的类型别名。它们都是大小写不敏感的,由于重载的名字,要注意原生类型的特殊处理。 </p>
<p><img src="http://www.zwer.xyz/picGo/20190106160532.png" alt></p>
<p><img src="http://www.zwer.xyz/picGo/20190106160547.png" alt></p>
<h1 id="10-带参数的查询-parameterType"><a href="#10-带参数的查询-parameterType" class="headerlink" title="10  带参数的查询 parameterType"></a>10  带参数的查询 parameterType</h1><p>参数类型，用于参数传递</p>
<p>#{}用于使用参数</p>
<p>index  ，索引 ，从0开始</p>
<p>param+数字， param1，param2</p>
<p>如果参数类型是对象，可以通过#{属性名}获取</p>
<p>如果参数类型是map集合，可以通过     #{key}获取</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- parameterType  参数类型，用于参数传递  --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"selByAge"</span> <span class="attr">resultType</span>=<span class="string">"User"</span> <span class="attr">parameterType</span>=<span class="string">"int"</span>&gt;</span></span><br><span class="line">		<span class="comment">&lt;!-- </span></span><br><span class="line"><span class="comment">				#&#123;&#125;用于使用参数</span></span><br><span class="line"><span class="comment">				index  ，索引 ，从0开始</span></span><br><span class="line"><span class="comment">		 --&gt;</span></span><br><span class="line">		select * from M_user where age = #&#123;param1&#125;</span><br><span class="line">	<span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"selBy2"</span> <span class="attr">resultType</span>=<span class="string">"User"</span> <span class="attr">parameterType</span>=<span class="string">"User"</span>&gt;</span></span><br><span class="line">		<span class="comment">&lt;!-- </span></span><br><span class="line"><span class="comment">			如果参数类型是对象，可以通过#&#123;属性名&#125;获取	</span></span><br><span class="line"><span class="comment">		 --&gt;</span></span><br><span class="line">		select * from M_user where name= #&#123;name&#125; and age = #&#123;age&#125;</span><br><span class="line">	<span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line">	<span class="comment">&lt;!-- map 是 Mybatis自己设置  Map 的别名 --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"selBy2s"</span> <span class="attr">resultType</span>=<span class="string">"User"</span> <span class="attr">parameterType</span>=<span class="string">"map"</span>&gt;</span></span><br><span class="line">		<span class="comment">&lt;!-- </span></span><br><span class="line"><span class="comment">			如果参数类型是Map集合，可以通过#&#123;key键&#125;获取</span></span><br><span class="line"><span class="comment">		 --&gt;</span></span><br><span class="line">		 select *  from M_user where name=#&#123;uname&#125; and age = #&#123;uage&#125;</span><br><span class="line">	<span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>TestParams.java</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.szxy.Test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.io.Resources;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSession;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSessionFactoryBuilder;</span><br><span class="line"><span class="keyword">import</span> org.junit.Test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> cn.szxy.pojo.User;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestParams</span> </span>&#123;</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 *  查询 单个用户</span></span><br><span class="line"><span class="comment">	 *  根据用户 年龄查询</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="meta">@Test</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">selByAge</span><span class="params">()</span></span>&#123;</span><br><span class="line">		SqlSession session = <span class="keyword">null</span>;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			session  = <span class="keyword">new</span> SqlSessionFactoryBuilder()</span><br><span class="line">				.build(Resources.getResourceAsStream(<span class="string">"mybatis-cfg.xml"</span>))</span><br><span class="line">				.openSession();</span><br><span class="line">			User user = session.selectOne(<span class="string">"cn.szxy.mapper.UserMapper.selByAge"</span>, <span class="number">22</span>);</span><br><span class="line">			System.out.println(user);</span><br><span class="line">			</span><br><span class="line">		&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;<span class="keyword">finally</span>&#123;</span><br><span class="line">			<span class="keyword">if</span>(session != <span class="keyword">null</span>)&#123;</span><br><span class="line">				session.close();</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 *  查询 单个用户</span></span><br><span class="line"><span class="comment">	 *  传入两个参数 name、age</span></span><br><span class="line"><span class="comment">	 * </span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="meta">@Test</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">selBy2</span><span class="params">()</span></span>&#123;</span><br><span class="line">		SqlSession session = <span class="keyword">null</span>;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			session  = <span class="keyword">new</span> SqlSessionFactoryBuilder()</span><br><span class="line">				.build(Resources.getResourceAsStream(<span class="string">"mybatis-cfg.xml"</span>))</span><br><span class="line">				.openSession();</span><br><span class="line">			User u = <span class="keyword">new</span> User();</span><br><span class="line">			u.setName(<span class="string">"abc"</span>);</span><br><span class="line">			u.setAge(<span class="string">"20"</span>);</span><br><span class="line">			User user = session.selectOne(<span class="string">"cn.szxy.mapper.UserMapper.selBy2"</span>, u);</span><br><span class="line">			System.out.println(user);</span><br><span class="line">			</span><br><span class="line">		&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;<span class="keyword">finally</span>&#123;</span><br><span class="line">			<span class="keyword">if</span>(session != <span class="keyword">null</span>)&#123;</span><br><span class="line">				session.close();</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="meta">@Test</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">selBy2s</span><span class="params">()</span></span>&#123;</span><br><span class="line">		SqlSession session = <span class="keyword">null</span>;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			session  = <span class="keyword">new</span> SqlSessionFactoryBuilder()</span><br><span class="line">				.build(Resources.getResourceAsStream(<span class="string">"mybatis-cfg.xml"</span>))</span><br><span class="line">				.openSession();</span><br><span class="line">			</span><br><span class="line">			Map&lt;String,String&gt; map = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">			map.put(<span class="string">"uname"</span>, <span class="string">"abc"</span>);</span><br><span class="line">			map.put(<span class="string">"uage"</span>,<span class="string">"20"</span>);	</span><br><span class="line">			User user = session.selectOne(<span class="string">"cn.szxy.mapper.UserMapper.selBy2s"</span>, map);</span><br><span class="line">			System.out.println(user);</span><br><span class="line">			</span><br><span class="line">		&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;<span class="keyword">finally</span>&#123;</span><br><span class="line">			<span class="keyword">if</span>(session != <span class="keyword">null</span>)&#123;</span><br><span class="line">				session.close();</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="11-DML-操作-封装工具类"><a href="#11-DML-操作-封装工具类" class="headerlink" title="11  DML 操作 _封装工具类"></a>11  DML 操作 _封装工具类</h1><h2 id="11-1-事务（Transcation）"><a href="#11-1-事务（Transcation）" class="headerlink" title="11.1 事务（Transcation）"></a>11.1 事务（Transcation）</h2><blockquote>
<ol>
<li><p>事务是数据库操作的最小单元，特征有ACID，应该保证一个事务中SQL 语句要么同时成功，要么同时都失败，即保证事务的一致性</p>
</li>
<li><p>MyBatis 中配置事务管理器，type属性设置为 JDBC ，表示 MyBatis 采用和原生 JDBC 相同的事务管理机制</p>
</li>
<li><p>在MyBatis 执行开始时，将自动关闭自动提交的功能，</p>
</li>
</ol>
</blockquote>
<h2 id="11-2-封装工具类"><a href="#11-2-封装工具类" class="headerlink" title="11.2  封装工具类"></a>11.2  封装工具类</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.szxy.util;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.io.Resources;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSession;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSessionFactory;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSessionFactoryBuilder;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyBatisUtil</span> </span>&#123;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> SqlSessionFactory factory;</span><br><span class="line">	<span class="keyword">static</span>&#123;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			InputStream is = Resources.getResourceAsStream(<span class="string">"mybatis-cfg.xml"</span>);</span><br><span class="line">			factory = <span class="keyword">new</span> SqlSessionFactoryBuilder().build(is);</span><br><span class="line">		&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> SqlSession <span class="title">getSession</span><span class="params">()</span></span>&#123;</span><br><span class="line">		SqlSession session = <span class="keyword">null</span>;</span><br><span class="line">		<span class="keyword">if</span>(factory!= <span class="keyword">null</span>)&#123;</span><br><span class="line">			 <span class="comment">// true 表示在执行SQL之前，不关闭 数据库自动提交事务的功能</span></span><br><span class="line">			 session = factory.openSession(<span class="keyword">true</span>);</span><br><span class="line">		&#125;</span><br><span class="line">        <span class="comment">// 关闭资源</span></span><br><span class="line">		<span class="keyword">return</span> session;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="11-3-增删改操作（DML）"><a href="#11-3-增删改操作（DML）" class="headerlink" title="11.3  增删改操作（DML）"></a>11.3  增删改操作（DML）</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.szxy.Test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSession;</span><br><span class="line"><span class="keyword">import</span> org.junit.Test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> cn.szxy.pojo.User;</span><br><span class="line"><span class="keyword">import</span> cn.szxy.util.MyBatisUtil;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 执行 DML 操作</span></span><br><span class="line"><span class="comment"> * 在 MyBatis内部中 </span></span><br><span class="line"><span class="comment"> * 执行 SQL 语句都采用 executeUpdate 方法 </span></span><br><span class="line"><span class="comment"> * 所以 SqlSession 对象中 insert、update、delete 方法可以通用</span></span><br><span class="line"><span class="comment"> * 使用 insert、update、delete 方法名的好处是 见名知意</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">InsUser</span> </span>&#123;</span><br><span class="line">	<span class="meta">@Test</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">InsUserOne</span><span class="params">()</span></span>&#123;</span><br><span class="line">		SqlSession session = MyBatisUtil.getSession();</span><br><span class="line">		User user = <span class="keyword">new</span> User();</span><br><span class="line">		user.setName(<span class="string">"小赵同学222"</span>);</span><br><span class="line">		user.setSex(<span class="string">"女"</span>);</span><br><span class="line">		user.setAge(<span class="string">"20"</span>);</span><br><span class="line">		<span class="keyword">int</span> num = session.insert(<span class="string">"cn.szxy.mapper.UserMapper.InsUserOne"</span>, user);</span><br><span class="line">		<span class="keyword">if</span>(num &gt; <span class="number">0</span>)&#123;</span><br><span class="line">			<span class="comment">//提交事务</span></span><br><span class="line">			session.commit();</span><br><span class="line">			System.out.println(<span class="string">"SUCESS!"</span>);</span><br><span class="line">		&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">			<span class="comment">//回滚事务</span></span><br><span class="line">			session.rollback();</span><br><span class="line">			System.out.println(<span class="string">"FAILED"</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="comment">//关闭资源</span></span><br><span class="line">		session.close();</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="meta">@Test</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">UpdateOne</span><span class="params">()</span></span>&#123;</span><br><span class="line">		SqlSession session = MyBatisUtil.getSession();</span><br><span class="line">		User user = <span class="keyword">new</span> User();</span><br><span class="line">		user.setName(<span class="string">"小赵"</span>);</span><br><span class="line">		user.setAge(<span class="string">"20"</span>);</span><br><span class="line">		user.setId(<span class="number">4</span>);</span><br><span class="line">		<span class="keyword">int</span> num = session.update(<span class="string">"cn.szxy.mapper.UserMapper.UpdateOne"</span>, user);</span><br><span class="line">		<span class="keyword">if</span>(num &gt; <span class="number">0</span>)&#123;</span><br><span class="line">			<span class="comment">//提交事务</span></span><br><span class="line">			session.commit();</span><br><span class="line">			System.out.println(<span class="string">"SUCESS!"</span>);</span><br><span class="line">		&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">			<span class="comment">//回滚事务</span></span><br><span class="line">			session.rollback();</span><br><span class="line">			System.out.println(<span class="string">"FAILED"</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="comment">//关闭资源</span></span><br><span class="line">		session.close();</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * 不存在的用户id，删除该用户id ，不会报错哦</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="meta">@Test</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">delOne</span><span class="params">()</span></span>&#123;</span><br><span class="line">		SqlSession session = MyBatisUtil.getSession();</span><br><span class="line">	</span><br><span class="line">		<span class="keyword">int</span> num = session.update(<span class="string">"cn.szxy.mapper.UserMapper.delOne"</span>, <span class="number">16</span>);</span><br><span class="line">		<span class="keyword">if</span>(num &gt; <span class="number">0</span>)&#123;</span><br><span class="line">			<span class="comment">//提交事务</span></span><br><span class="line">			session.commit();</span><br><span class="line">			System.out.println(<span class="string">"SUCESS!"</span>);</span><br><span class="line">		&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">			<span class="comment">//回滚事务</span></span><br><span class="line">			session.rollback();</span><br><span class="line">			System.out.println(<span class="string">"FAILED"</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="comment">//关闭资源</span></span><br><span class="line">		session.close();</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="12-MyBatis-接口绑定方案"><a href="#12-MyBatis-接口绑定方案" class="headerlink" title="12   MyBatis 接口绑定方案"></a>12   MyBatis 接口绑定方案</h1><blockquote>
<p>在 MyBatis 中提供一套接口绑定方案，程序员可以提供一个接口，然后提供对应接口的 mapper.xml 文件</p>
<p>MyBatis 会自动将接口与 mapper.xml 绑定，实际上，MyBatis就是会根据接口和mapper.xml配置文件创建接口的实现类（动态代理模式），换言之，就可以得到接口类型绑定的实现类</p>
</blockquote>
<h2 id="12-1-实现方式"><a href="#12-1-实现方式" class="headerlink" title="12.1 实现方式"></a>12.1 实现方式</h2><h3 id="12-1-1-定义接口"><a href="#12-1-1-定义接口" class="headerlink" title="12.1.1 定义接口"></a>12.1.1 定义接口</h3><ul>
<li>UserMapper.java  接口</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.szxy.mapper;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> cn.szxy.pojo.User;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UserMapper</span> </span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * 查找所有用户</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function">List&lt;User&gt; <span class="title">selAll</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="12-1-2-编写对应接口的映射文件"><a href="#12-1-2-编写对应接口的映射文件" class="headerlink" title="12.1.2 编写对应接口的映射文件"></a>12.1.2 编写对应接口的映射文件</h3><p>注意：id 名和 接口中的方法名 相同</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE mapper</span></span><br><span class="line"><span class="meta">  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"</span></span><br><span class="line"><span class="meta">  "http://mybatis.org/dtd/mybatis-3-mapper.dtd"&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">	mapper  映射</span></span><br><span class="line"><span class="comment">	namespace 名字空间  </span></span><br><span class="line"><span class="comment">	namespace + id 确定 SQL 语句 </span></span><br><span class="line"><span class="comment"> --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span> =<span class="string">"cn.szxy.mapper.UserMapper"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">&lt;!-- 查找所有用户 --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"selAll"</span> <span class="attr">resultType</span>=<span class="string">"User"</span>&gt;</span></span><br><span class="line">		select * from M_user</span><br><span class="line">	<span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="12-1-3-在核心配置文件中扫描mapper"><a href="#12-1-3-在核心配置文件中扫描mapper" class="headerlink" title="12.1.3  在核心配置文件中扫描mapper"></a>12.1.3  在核心配置文件中扫描mapper</h3><ul>
<li>mybatis-cfg.xml    </li>
</ul>
<p>MyBatis.xml 核心配置文件</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE configuration</span></span><br><span class="line"><span class="meta">  PUBLIC "-//mybatis.org//DTD Config 3.0//EN"</span></span><br><span class="line"><span class="meta">  "http://mybatis.org/dtd/mybatis-3-config.dtd"&gt;</span></span><br><span class="line">  <span class="comment">&lt;!--  配置  --&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line"> 	<span class="comment">&lt;!-- 加载 properties 外部文件 --&gt;</span></span><br><span class="line"> 	<span class="tag">&lt;<span class="name">properties</span> <span class="attr">resource</span>=<span class="string">"db.properties"</span> /&gt;</span></span><br><span class="line"> </span><br><span class="line"> 	<span class="comment">&lt;!-- 设置MyBatis对 Log4J 的支持   --&gt;</span></span><br><span class="line"> 	<span class="tag">&lt;<span class="name">settings</span>&gt;</span></span><br><span class="line"> 	 	<span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">"logImpl"</span> <span class="attr">value</span>=<span class="string">"LOG4J"</span>/&gt;</span></span><br><span class="line"> 	<span class="tag">&lt;/<span class="name">settings</span>&gt;</span>	</span><br><span class="line"> 	<span class="comment">&lt;!-- typealiases 给类型设置别名--&gt;</span></span><br><span class="line"> 	<span class="tag">&lt;<span class="name">typeAliases</span>&gt;</span></span><br><span class="line"> 		<span class="comment">&lt;!-- 设置User 类型的别名为 User --&gt;</span></span><br><span class="line"> 		<span class="comment">&lt;!-- &lt;typeAlias type="cn.szxy.pojo.User"/&gt; --&gt;</span></span><br><span class="line"> 		<span class="comment">&lt;!-- 设置 package 包下的类型别名为 类名 --&gt;</span></span><br><span class="line"> 		<span class="tag">&lt;<span class="name">package</span> <span class="attr">name</span>=<span class="string">"cn.szxy.pojo"</span>/&gt;</span></span><br><span class="line"> 	<span class="tag">&lt;/<span class="name">typeAliases</span>&gt;</span></span><br><span class="line"> 	</span><br><span class="line">	<span class="tag">&lt;<span class="name">environments</span> <span class="attr">default</span>=<span class="string">"szxy"</span>&gt;</span></span><br><span class="line">		<span class="comment">&lt;!--  环境 id 是环境的唯一标识  --&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">environment</span> <span class="attr">id</span>=<span class="string">"szxy"</span>&gt;</span></span><br><span class="line">			<span class="comment">&lt;!-- 事务管理 --&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">transactionManager</span> <span class="attr">type</span>=<span class="string">"JDBC"</span> /&gt;</span></span><br><span class="line">			<span class="comment">&lt;!--  数据源 --&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">dataSource</span> <span class="attr">type</span>=<span class="string">"pooled"</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"driver"</span> <span class="attr">value</span>=<span class="string">"$&#123;jdbc.driver&#125;"</span>/&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"url"</span> <span class="attr">value</span>=<span class="string">"$&#123;jdbc.url&#125;"</span>/&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"username"</span> <span class="attr">value</span>=<span class="string">"$&#123;jdbc.username&#125;"</span>/&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"password"</span> <span class="attr">value</span>=<span class="string">"$&#123;jdbc.password&#125;"</span>/&gt;</span></span><br><span class="line">			<span class="tag">&lt;/<span class="name">dataSource</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">environment</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">environments</span>&gt;</span></span><br><span class="line">	<span class="comment">&lt;!--  扫描映射文件  --&gt;</span></span><br><span class="line"> 	<span class="tag">&lt;<span class="name">mappers</span>&gt;</span></span><br><span class="line"> 		<span class="comment">&lt;!-- &lt;mapper resource="cn/szxy/mapper/UserMapper.xml"/&gt; --&gt;</span></span><br><span class="line"> 		<span class="comment">&lt;!-- &lt;mapper class="cn.szxy.mapper.UserMapper"/&gt; --&gt;</span></span><br><span class="line"> 		<span class="tag">&lt;<span class="name">package</span> <span class="attr">name</span>=<span class="string">"cn.szxy.mapper"</span> /&gt;</span></span><br><span class="line"> 	<span class="tag">&lt;/<span class="name">mappers</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="12-1-4-应用"><a href="#12-1-4-应用" class="headerlink" title="12.1.4 应用"></a>12.1.4 应用</h3><ul>
<li>TestBind.java     绑定</li>
</ul>
<p>定义接口的对象接受 UserMapper 实现类对象（由Mybatis 自己创建）</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.szxy.Test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSession;</span><br><span class="line"><span class="keyword">import</span> org.junit.Test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> cn.szxy.mapper.UserMapper;</span><br><span class="line"><span class="keyword">import</span> cn.szxy.pojo.User;</span><br><span class="line"><span class="keyword">import</span> cn.szxy.util.MyBatisUtil;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestBind</span> </span>&#123;</span><br><span class="line">	<span class="meta">@Test</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">selAll</span><span class="params">()</span></span>&#123;</span><br><span class="line">		SqlSession session = MyBatisUtil.getSession();</span><br><span class="line">		<span class="comment">//获得 UserMapper 实现类的对象</span></span><br><span class="line">		UserMapper mapper = session.getMapper(UserMapper.class);</span><br><span class="line">		List&lt;User&gt; list = mapper.selAll();</span><br><span class="line">		<span class="keyword">for</span> (User user : list) &#123;</span><br><span class="line">			System.out.println(user);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="12-2-通过接口方案，解决多参数传递"><a href="#12-2-通过接口方案，解决多参数传递" class="headerlink" title="12.2 通过接口方案，解决多参数传递"></a>12.2 通过接口方案，解决多参数传递</h2><p>紧接上述的步骤，查询用户根据用户和密码</p>
<h3 id="12-2-1-定义接口中的抽象方法"><a href="#12-2-1-定义接口中的抽象方法" class="headerlink" title="12.2.1 定义接口中的抽象方法"></a>12.2.1 定义接口中的抽象方法</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.szxy.mapper;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.Param;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> cn.szxy.pojo.User;</span><br><span class="line"><span class="keyword">import</span> cn.szxy.pojo.User2;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UserMapper</span> </span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * 查找所有用户</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> List&lt;User&gt; <span class="title">selAll</span><span class="params">()</span></span>;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * 查找单个用户根据用户名和密码</span></span><br><span class="line"><span class="comment">	 * </span></span><br><span class="line"><span class="comment">	 *使用 注解 <span class="doctag">@Param</span>()</span></span><br><span class="line"><span class="comment">	 *用于填写 select 语句的选择参数</span></span><br><span class="line"><span class="comment">	 *构成 map 函数</span></span><br><span class="line"><span class="comment">	 *其实 <span class="doctag">@Param</span>("username") 相当于键 key</span></span><br><span class="line"><span class="comment">	 *而 String username 相当于 值 value</span></span><br><span class="line"><span class="comment">	 *</span></span><br><span class="line"><span class="comment">	 *当使用 注解<span class="doctag">@Param</span>后 就不能使用索引 0、 1</span></span><br><span class="line"><span class="comment">	 * </span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@param</span> username  用户名</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@param</span> password  密码</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> User2 <span class="title">selByUP</span><span class="params">( @Param(<span class="string">"username"</span>)</span> String username,@<span class="title">Param</span><span class="params">(<span class="string">"password"</span>)</span> String password)</span>;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="12-2-2-在-UserMapper-xml-中添加-sql-语句"><a href="#12-2-2-在-UserMapper-xml-中添加-sql-语句" class="headerlink" title="12.2.2 在 UserMapper.xml 中添加 sql 语句"></a>12.2.2 在 UserMapper.xml 中添加 sql 语句</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE mapper</span></span><br><span class="line"><span class="meta">  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"</span></span><br><span class="line"><span class="meta">  "http://mybatis.org/dtd/mybatis-3-mapper.dtd"&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">	mapper  映射</span></span><br><span class="line"><span class="comment">	namespace 名字空间  </span></span><br><span class="line"><span class="comment">	namespace + id 确定 SQL 语句 </span></span><br><span class="line"><span class="comment"> --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span> =<span class="string">"cn.szxy.mapper.UserMapper"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">&lt;!-- 查找所有用户 --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"selAll"</span> <span class="attr">resultType</span>=<span class="string">"User"</span>&gt;</span></span><br><span class="line">		select * from M_user</span><br><span class="line">	<span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line">	<span class="comment">&lt;!-- 查找单个用户根据用户名和密码 --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"selByUP"</span> <span class="attr">resultType</span>=<span class="string">"User2"</span>&gt;</span></span><br><span class="line">		<span class="comment">&lt;!-- select * from Test where username= #&#123;param1&#125; and password=#&#123;param2&#125; --&gt;</span></span><br><span class="line">	<span class="comment">&lt;!-- 	select * from Test where username=#&#123;username&#125; and password=#&#123;password&#125; --&gt;</span></span><br><span class="line">		select * from Test where username=#&#123;0&#125; and password=#&#123;1&#125;</span><br><span class="line">	<span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="12-2-3-应用"><a href="#12-2-3-应用" class="headerlink" title="12.2.3 应用"></a>12.2.3 应用</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.szxy.Test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSession;</span><br><span class="line"><span class="keyword">import</span> org.junit.Test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> cn.szxy.mapper.UserMapper;</span><br><span class="line"><span class="keyword">import</span> cn.szxy.pojo.User2;</span><br><span class="line"><span class="keyword">import</span> cn.szxy.util.MyBatisUtil;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestSel</span> </span>&#123;</span><br><span class="line">	<span class="meta">@Test</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">selByUP</span><span class="params">()</span></span>&#123;</span><br><span class="line">		SqlSession session = MyBatisUtil.getSession();</span><br><span class="line">		UserMapper mapper = session.getMapper(UserMapper.class);</span><br><span class="line">		User2 user = mapper.selByUP(<span class="string">"小红"</span>,<span class="string">"123"</span>);</span><br><span class="line">		System.out.println(user); </span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="12-2-4-总结"><a href="#12-2-4-总结" class="headerlink" title="12.2.4 总结"></a>12.2.4 总结</h3><h4 id="1-方式一-使用索引0、1-或者-参数param1-、param2"><a href="#1-方式一-使用索引0、1-或者-参数param1-、param2" class="headerlink" title="1   方式一 使用索引0、1 或者 参数param1 、param2"></a>1   方式一 使用索引0、1 或者 参数param1 、param2</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 查找单个用户根据用户名和密码 --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"selByUP"</span> <span class="attr">resultType</span>=<span class="string">"User2"</span>&gt;</span></span><br><span class="line">        select * from Test where username= #&#123;0&#125; and password=#&#123;1&#125;</span><br><span class="line">		<span class="comment">&lt;!-- select * from Test where username= #&#123;param1&#125; and password=#&#123;param2&#125; --&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="2-方式二-使用注解-Param-来使用自己设定的值-或者使用-参数param1-、param2"><a href="#2-方式二-使用注解-Param-来使用自己设定的值-或者使用-参数param1-、param2" class="headerlink" title="2  方式二 使用注解 @Param 来使用自己设定的值 或者使用 参数param1 、param2"></a>2  方式二 使用注解 @Param 来使用自己设定的值 或者使用 参数param1 、param2</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 查找单个用户根据用户名和密码 --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"selByUP"</span> <span class="attr">resultType</span>=<span class="string">"User2"</span>&gt;</span></span><br><span class="line">		<span class="comment">&lt;!-- select * from Test where username= #&#123;param1&#125; and password=#&#123;param2&#125; --&gt;</span></span><br><span class="line">		select * from Test where username=#&#123;username&#125; and password=#&#123;password&#125; </span><br><span class="line">	<span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * 查找单个用户根据用户名和密码</span></span><br><span class="line"><span class="comment">	 * </span></span><br><span class="line"><span class="comment">	 *使用 注解 <span class="doctag">@Param</span>()</span></span><br><span class="line"><span class="comment">	 *用于填写 select 语句的选择参数</span></span><br><span class="line"><span class="comment">	 *构成 map 函数</span></span><br><span class="line"><span class="comment">	 *其实 <span class="doctag">@Param</span>("username") 相当于键 key</span></span><br><span class="line"><span class="comment">	 *而 String username 相当于 值 value</span></span><br><span class="line"><span class="comment">	 *</span></span><br><span class="line"><span class="comment">	 *当使用 注解<span class="doctag">@Param</span>后 就不能使用索引 0、 1</span></span><br><span class="line"><span class="comment">	 * </span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@param</span> username  用户名</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@param</span> password  密码</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> User2 <span class="title">selByUP</span><span class="params">( @Param(<span class="string">"username"</span>)</span> String username,@<span class="title">Param</span><span class="params">(<span class="string">"password"</span>)</span> String password)</span>;</span><br></pre></td></tr></table></figure>

<h1 id="13-动态-SQL-dynamic"><a href="#13-动态-SQL-dynamic" class="headerlink" title="13 动态 SQL   dynamic"></a>13 动态 SQL   dynamic</h1><p> 根据条件的不同，sql 语句也会随之动态的改变</p>
<blockquote>
<p>MyBatis 的一个强大的特性之一通常是它的动态 SQL 能力。如果你有使用 JDBC 或其他相似框架的经验,你就明白条件地串联 SQL  字符串在一起是多么的痛苦,确保不能忘了空格或在列表的最后省略逗号。动态 SQL 可以彻底处理这种痛苦。 </p>
<p>通常使用动态 SQL 不可能是独立的一部分,MyBatis 当然使用一种强大的动态 SQL 语言来改进这种情形,这种语言可以被用在任意映射的 SQL  语句中。 </p>
<p>动态 SQL 元素和使用 JSTL 或其他相似的基于 XML 的文本处理器相似。在 MyBatis 之前的版本中,有很多的元素需要来了解。MyBatis  3 大大提升了它们,现在用不到原先一半的元素就能工作了。MyBatis 采用功能强大的基于 OGNL 的表达式来消除其他元素。 </p>
</blockquote>
<ul>
<li>if  </li>
<li>choose (when, otherwise)  </li>
<li>trim (where, set)  </li>
<li>foreach </li>
</ul>
<h2 id="13-1-lt-where-gt-lt-if-gt"><a href="#13-1-lt-where-gt-lt-if-gt" class="headerlink" title="13.1  &lt; where&gt;   &lt;if&gt;"></a>13.1  <code>&lt; where&gt;</code>   <code>&lt;if&gt;</code></h2><blockquote>
<p>if 标签用于进行条件判断， test 用于指定判断条件，为了拼接条件，在 SQL 语句 的后面添加 1=1 的恒成立</p>
<p>where 标签 用于管理 where <strong>子句</strong>，有如下的功能</p>
<p>a)  如果没有条件，不会生成 where 关键字</p>
<p>b）如果有条件，会自动生成 where 关键字</p>
<p>c）如果第一个条件中有 and ，去除之</p>
</blockquote>
<ul>
<li>UserMapper.xml</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 查找所有用户 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"sel"</span> <span class="attr">resultType</span>=<span class="string">"User"</span>&gt;</span></span><br><span class="line">	select * from Test </span><br><span class="line">	<span class="tag">&lt;<span class="name">where</span>&gt;</span>  </span><br><span class="line">		 <span class="comment">&lt;!--  test 设置判断条件</span></span><br><span class="line"><span class="comment">			   相当于 if语句中的判断条件</span></span><br><span class="line"><span class="comment">		 --&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"username !=null and username !='' "</span>&gt;</span> </span><br><span class="line">			and username = #&#123;username&#125;</span><br><span class="line">		<span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"password !=null and password !='' "</span>&gt;</span></span><br><span class="line">			and password = #&#123;password&#125;</span><br><span class="line">		<span class="tag">&lt;/<span class="name">if</span>&gt;</span>			</span><br><span class="line">	<span class="tag">&lt;/<span class="name">where</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="13-2-lt-choose-gt-lt-when-gt"><a href="#13-2-lt-choose-gt-lt-when-gt" class="headerlink" title="13.2  &lt;choose&gt; &lt;when&gt;"></a>13.2  <code>&lt;choose&gt;</code> <code>&lt;when&gt;</code></h2><blockquote>
<p>类似与 Java中 switch… case …</p>
</blockquote>
<ul>
<li>UserMapper.xml</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--  优化查找所有用户  --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"sel"</span> <span class="attr">resultType</span>=<span class="string">"User"</span>&gt;</span></span><br><span class="line">	select * from Test</span><br><span class="line">	<span class="tag">&lt;<span class="name">where</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">choose</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">when</span> <span class="attr">test</span>=<span class="string">"username != null and username != '' "</span>&gt;</span></span><br><span class="line">				username = #&#123;username&#125;</span><br><span class="line">			<span class="tag">&lt;/<span class="name">when</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">when</span> <span class="attr">test</span>=<span class="string">"password !=null and password != '' "</span>&gt;</span></span><br><span class="line">				password = #&#123;password&#125;</span><br><span class="line">			<span class="tag">&lt;/<span class="name">when</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">otherwise</span>&gt;</span></span><br><span class="line">				where 1=1 </span><br><span class="line">			<span class="tag">&lt;/<span class="name">otherwise</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">choose</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">where</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="13-3-lt-set-gt"><a href="#13-3-lt-set-gt" class="headerlink" title="13.3 &lt;set&gt;"></a>13.3 <code>&lt;set&gt;</code></h2><blockquote>
<p> set  标签用于管理更新语句</p>
</blockquote>
<ul>
<li>UserMapper.xml</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 更新用户信息  --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">update</span> <span class="attr">id</span>=<span class="string">"updateUser"</span>&gt;</span></span><br><span class="line">	update Test</span><br><span class="line">	<span class="tag">&lt;<span class="name">set</span>&gt;</span></span><br><span class="line">		<span class="comment">&lt;!-- 优化 防止没有填写 username or password 修改信息 --&gt;</span></span><br><span class="line">		id = #&#123;id&#125;,</span><br><span class="line">		<span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"username !=null and username !='' "</span>&gt;</span></span><br><span class="line">			 username = #&#123;username&#125;,</span><br><span class="line">		<span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"password !=null and password !='' "</span>&gt;</span></span><br><span class="line">			 password = #&#123;password&#125;,</span><br><span class="line">		<span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">set</span>&gt;</span></span><br><span class="line">	where id = #&#123;id&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">update</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="13-3-lt-trim-gt"><a href="#13-3-lt-trim-gt" class="headerlink" title="13.3 &lt;trim&gt;"></a>13.3 <code>&lt;trim&gt;</code></h2><blockquote>
<p>相当于 where 和 set 标签的作用，甚至可以补充where和set 标签做不到的功能</p>
<p>用于在前后增加或者删除一些内容</p>
<p>a）prefix                表示添加前缀<br>b）prefixOverriedes 表示覆盖前面的内容<br>c） suffix                表示添加后缀<br>d）sufficOverrides    表示覆盖后面的内容</p>
</blockquote>
<ul>
<li>UserMapper.xml</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 使用 trim  --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">update</span> <span class="attr">id</span>=<span class="string">"updateUser"</span>&gt;</span></span><br><span class="line">		<span class="comment">&lt;!-- </span></span><br><span class="line"><span class="comment">			prefix 			   表示添加前缀</span></span><br><span class="line"><span class="comment">			prefixOverriedes 表示覆盖前面的内容</span></span><br><span class="line"><span class="comment">			suffix 			   表示添加后缀</span></span><br><span class="line"><span class="comment">			sufficOverrides  表示覆盖后面的内容</span></span><br><span class="line"><span class="comment">		 --&gt;</span></span><br><span class="line">			update  Test </span><br><span class="line">			<span class="tag">&lt;<span class="name">trim</span> <span class="attr">prefix</span>=<span class="string">"set"</span> <span class="attr">prefixOverrides</span>=<span class="string">""</span> <span class="attr">suffix</span>=<span class="string">""</span>  <span class="attr">suffixOverrides</span>=<span class="string">","</span>&gt;</span></span><br><span class="line">				  username = #&#123;username&#125;,</span><br><span class="line">			<span class="tag">&lt;/<span class="name">trim</span>&gt;</span></span><br><span class="line">			where id = #&#123;id&#125;</span><br><span class="line">	<span class="tag">&lt;/<span class="name">update</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="13-4-lt-bind-gt"><a href="#13-4-lt-bind-gt" class="headerlink" title="13.4  &lt;bind&gt;"></a>13.4  <code>&lt;bind&gt;</code></h2><blockquote>
<p>bind 标签对传进来的数据进行在加工</p>
</blockquote>
<ul>
<li>UserMapper.xml</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--  优化查找所有用户  --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"sel"</span> <span class="attr">resultType</span>=<span class="string">"User"</span>&gt;</span></span><br><span class="line">		select * from Test</span><br><span class="line">		<span class="tag">&lt;<span class="name">where</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">choose</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">when</span> <span class="attr">test</span>=<span class="string">"username != null and username != '' "</span>&gt;</span></span><br><span class="line">				<span class="comment">&lt;!--  </span></span><br><span class="line"><span class="comment">				  		bind 标签 对传入的数据进行再加工</span></span><br><span class="line"><span class="comment">				  	         用 value的 %usename% 修饰  #&#123;&#125;  </span></span><br><span class="line"><span class="comment">				   --&gt;</span></span><br><span class="line">				   <span class="tag">&lt;<span class="name">bind</span> <span class="attr">name</span>=<span class="string">"username"</span> <span class="attr">value</span>=<span class="string">"'%' + username + '%' "</span>/&gt;</span></span><br><span class="line">					username like #&#123;username&#125;  <span class="comment">&lt;!-- 模糊查询 --&gt;</span></span><br><span class="line">				<span class="tag">&lt;/<span class="name">when</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">when</span> <span class="attr">test</span>=<span class="string">"password !=null and password != '' "</span>&gt;</span></span><br><span class="line">					password = #&#123;password&#125;</span><br><span class="line">				<span class="tag">&lt;/<span class="name">when</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">otherwise</span>&gt;</span></span><br><span class="line">					where 1=1</span><br><span class="line">				<span class="tag">&lt;/<span class="name">otherwise</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;/<span class="name">choose</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">where</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>注意： <code>&lt;bind name=&quot;username&quot; value=&quot;&#39;%&#39; + username + &#39;%&#39; &quot;/&gt;</code>  中  value 字符串的拼接</p>
<h2 id="13-5-foreach"><a href="#13-5-foreach" class="headerlink" title="13.5 foreach"></a>13.5 foreach</h2><blockquote>
<p>用于 在 SQL 语句中遍历集合参数，在 in 查询中使用</p>
<p>collection ： 表示待遍历的集合</p>
<p>open： 表示设置开始的符号</p>
<p>item:  表示迭代变量</p>
<p>separator: 表示项目分隔符</p>
<p>close： 表示设置结束的符号</p>
</blockquote>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 使用 foreach 标签 --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"selIn"</span> <span class="attr">parameterType</span>=<span class="string">"int"</span> <span class="attr">resultType</span>=<span class="string">"User"</span>&gt;</span></span><br><span class="line">		select </span><br><span class="line">			<span class="tag">&lt;<span class="name">include</span> <span class="attr">refid</span>=<span class="string">"psql"</span> /&gt;</span></span><br><span class="line">		from  Test where id in </span><br><span class="line">		<span class="tag">&lt;<span class="name">foreach</span> <span class="attr">item</span>=<span class="string">"item"</span> <span class="attr">open</span>=<span class="string">"("</span> <span class="attr">separator</span>=<span class="string">","</span> <span class="attr">close</span>=<span class="string">")"</span> <span class="attr">collection</span>=<span class="string">"list"</span>&gt;</span></span><br><span class="line">			#&#123;item&#125;</span><br><span class="line">		<span class="tag">&lt;/<span class="name">foreach</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="13-6-lt-sql-gt-lt-include-gt"><a href="#13-6-lt-sql-gt-lt-include-gt" class="headerlink" title="13.6 &lt;sql&gt; &lt;include&gt;"></a>13.6 <code>&lt;sql&gt;</code> <code>&lt;include&gt;</code></h2><blockquote>
<p>sql 标签配合 include 标签使用，实现 sql 语句的复用，减少代码的书写</p>
<p><sql>用于提取 SQL 语句 </sql></p>
<p><include> 用于 引用 SQL 语句</include></p>
</blockquote>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--  这里要复用的 sql 语句  --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">sql</span> <span class="attr">id</span>=<span class="string">"psql"</span>&gt;</span>id,username,password<span class="tag">&lt;/<span class="name">sql</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 查找所有用户 --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"sel"</span> <span class="attr">resultType</span>=<span class="string">"User"</span>&gt;</span></span><br><span class="line">		select</span><br><span class="line">			 <span class="tag">&lt;<span class="name">include</span> <span class="attr">refid</span>=<span class="string">"psql"</span>/&gt;</span></span><br><span class="line">	   from Test </span><br><span class="line">		<span class="tag">&lt;<span class="name">where</span>&gt;</span>  </span><br><span class="line">			 <span class="comment">&lt;!--  test 设置判断条件</span></span><br><span class="line"><span class="comment">				   相当于 if语句中的判断条件</span></span><br><span class="line"><span class="comment">			 --&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"username !=null and username !='' "</span>&gt;</span> </span><br><span class="line">				and username = #&#123;username&#125;</span><br><span class="line">			<span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"password !=null and password !='' "</span>&gt;</span></span><br><span class="line">				and password = #&#123;password&#125;</span><br><span class="line">			<span class="tag">&lt;/<span class="name">if</span>&gt;</span>			</span><br><span class="line">		<span class="tag">&lt;/<span class="name">where</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h1 id="14-MyBatis-的缓存机制"><a href="#14-MyBatis-的缓存机制" class="headerlink" title="14   MyBatis 的缓存机制"></a>14   MyBatis 的缓存机制</h1><blockquote>
<p>a）缓存用于提交查询效率</p>
<p>b） MyBatis 的缓存是使用 SQL 标签的 ID 作为缓存的唯一标识的。</p>
<p>执行相同的标签可以使用缓存。不同的标签不能使用缓存。</p>
<p>c）MyBatis 中有两种缓存机制</p>
</blockquote>
<h2 id="14-1-一级缓存"><a href="#14-1-一级缓存" class="headerlink" title="14.1 一级缓存"></a>14.1 一级缓存</h2><blockquote>
<p>a）线程级别的缓存,默认开启，SqlSession的缓存</p>
<p>b）在一个 SqlSession 生命周期中有效， SqlSession 关闭，缓存清空</p>
<p>基于 id 查询并且是同个 SqlSession 对象上</p>
</blockquote>
<h2 id="14-2-二级缓存"><a href="#14-2-二级缓存" class="headerlink" title="14.2 二级缓存"></a>14.2 二级缓存</h2><blockquote>
<p>a）进程级别的缓存， SqlSessionFactory 的缓存</p>
<p>b） 在一个 SqlSessionFactory 生命周期中有效，可以在多个 SqlSession 生命周期中共享。</p>
<p>c）默认关闭，需要使用的时候，要为某个命名空间开启二级缓存 (在mapper.xml 中配置 <cache>)</cache></p>
</blockquote>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 开启二级缓存 ,要求实体类进行序列化 或者设置 readOnly的属性为 true  --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">cache</span> <span class="attr">readOnly</span>=<span class="string">"true"</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<h1 id="15-列名和属性名不一致问题-resultMap标签"><a href="#15-列名和属性名不一致问题-resultMap标签" class="headerlink" title="15  列名和属性名不一致问题_resultMap标签"></a>15  列名和属性名不一致问题_resultMap标签</h1><blockquote>
<p>有两种解决方式：</p>
<p>a） 给列名起别名</p>
<p>b） 不使用 resultType，改用resultMap</p>
</blockquote>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">type</span>=<span class="string">"User"</span> <span class="attr">id</span>=<span class="string">"rmap"</span>&gt;</span></span><br><span class="line">		<span class="comment">&lt;!-- </span></span><br><span class="line"><span class="comment">			设置 主键属性</span></span><br><span class="line"><span class="comment">		 --&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">id</span> <span class="attr">column</span>=<span class="string">"id"</span> <span class="attr">property</span>=<span class="string">"id1"</span>/&gt;</span></span><br><span class="line">		<span class="comment">&lt;!-- </span></span><br><span class="line"><span class="comment">			设置其他非主属性</span></span><br><span class="line"><span class="comment">		 --&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"username"</span> <span class="attr">property</span>=<span class="string">"username1"</span>/&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"password"</span> <span class="attr">property</span>=<span class="string">"password1"</span>/&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"selAll"</span>  <span class="attr">resultMap</span>=<span class="string">"rmap"</span>&gt;</span></span><br><span class="line">		select * from Test</span><br><span class="line">	<span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h1 id="16-多表关联查询"><a href="#16-多表关联查询" class="headerlink" title="16 多表关联查询"></a>16 多表关联查询</h1><h2 id="16-1-设计表-表结构"><a href="#16-1-设计表-表结构" class="headerlink" title="16.1   设计表-表结构"></a>16.1   设计表-表结构</h2><ul>
<li>设计 Student表和 class 表，student表中的字段有id,name,age,gender,cid</li>
<li>class表中的字段有 id（作为主键）,name ,room</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">use</span> mybatistable;</span><br><span class="line"><span class="comment">-- show create table test;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">drop</span> <span class="keyword">table</span> t_student;</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> t_student(</span><br><span class="line">	<span class="keyword">id</span> <span class="built_in">int</span>(<span class="number">10</span>) <span class="keyword">not</span> <span class="literal">null</span> auto_increment,</span><br><span class="line">	<span class="keyword">name</span> <span class="built_in">varchar</span>(<span class="number">30</span>) <span class="keyword">not</span> <span class="literal">null</span>,</span><br><span class="line">	age <span class="built_in">int</span>(<span class="number">3</span>) <span class="keyword">not</span> <span class="literal">null</span>,</span><br><span class="line">	gender <span class="built_in">char</span>(<span class="number">5</span>) <span class="keyword">not</span> <span class="literal">null</span>,</span><br><span class="line">	cid <span class="built_in">int</span>(<span class="number">10</span>) <span class="keyword">not</span> <span class="literal">null</span>,</span><br><span class="line">	<span class="keyword">constraint</span> pk_id primary <span class="keyword">key</span>(<span class="keyword">id</span>),</span><br><span class="line">	<span class="keyword">constraint</span> uk_name <span class="keyword">unique</span>(<span class="keyword">name</span>),</span><br><span class="line">	<span class="keyword">constraint</span> fk_cid <span class="keyword">foreign</span> <span class="keyword">key</span>(cid) <span class="keyword">references</span> t_class(<span class="keyword">id</span>)</span><br><span class="line">)<span class="keyword">engine</span>=<span class="keyword">InnODB</span>,<span class="keyword">charset</span>=utf8</span><br><span class="line"></span><br><span class="line"><span class="keyword">drop</span> <span class="keyword">table</span> t_class;</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> t_class(</span><br><span class="line">	<span class="keyword">id</span> <span class="built_in">int</span>(<span class="number">10</span>) <span class="keyword">not</span> <span class="literal">null</span> auto_increment,</span><br><span class="line">	<span class="keyword">name</span> <span class="built_in">varchar</span>(<span class="number">20</span>) <span class="keyword">not</span> <span class="literal">null</span>,</span><br><span class="line">  room <span class="built_in">varchar</span>(<span class="number">20</span>) <span class="keyword">not</span> <span class="literal">null</span>,</span><br><span class="line">	<span class="keyword">constraint</span> pk_id primary <span class="keyword">key</span>(<span class="keyword">id</span>),</span><br><span class="line">	<span class="keyword">constraint</span> uk_name <span class="keyword">unique</span>(<span class="keyword">name</span>)</span><br><span class="line">)<span class="keyword">engine</span>=<span class="keyword">InnoDB</span>,<span class="keyword">charset</span>=utf8;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 测试数据</span></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_class <span class="keyword">values</span>(<span class="number">1001</span>,<span class="string">'软件工程'</span>,<span class="string">'工B207'</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_class <span class="keyword">values</span>(<span class="number">1002</span>,<span class="string">'计算机科学与技术'</span>,<span class="string">'工B201'</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_class <span class="keyword">values</span>(<span class="number">1003</span>,<span class="string">'网络工程'</span>,<span class="string">'工B203'</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_class <span class="keyword">values</span>(<span class="number">1004</span>,<span class="string">'物联网工程'</span>,<span class="string">'工B206'</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">truncate</span> <span class="keyword">table</span> t_student;</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_student <span class="keyword">values</span>(<span class="number">2016110101</span>,<span class="string">'小王'</span>,<span class="number">25</span>,<span class="string">'男'</span>,<span class="number">1001</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_student <span class="keyword">values</span>(<span class="number">2016110202</span>,<span class="string">'小赵'</span>,<span class="number">21</span>,<span class="string">'女'</span>,<span class="number">1002</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_student <span class="keyword">values</span>(<span class="number">2016110303</span>,<span class="string">'小军'</span>,<span class="number">20</span>,<span class="string">'男'</span>,<span class="number">1003</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_student <span class="keyword">values</span>(<span class="number">2016110404</span>,<span class="string">'小红'</span>,<span class="number">22</span>,<span class="string">'男'</span>,<span class="number">1004</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_student <span class="keyword">values</span>(<span class="number">2016110405</span>,<span class="string">'小李'</span>,<span class="number">20</span>,<span class="string">'男'</span>,<span class="number">1004</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 查表</span></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> t_class;</span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> t_student;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 查找每个学生对应的班级号</span></span><br><span class="line"><span class="keyword">select</span> </span><br><span class="line">s.id,s.name,s.age,s.gender,c.id <span class="keyword">as</span> cid</span><br><span class="line"><span class="keyword">from</span> t_student s,t_class c </span><br><span class="line"><span class="keyword">where</span> s.cid = c.id</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> </span><br><span class="line">	s.id <span class="keyword">sid</span>,s.name sname,s.age sage,s.gender sgender,c.id cid ,c.name cname,c.room croom</span><br><span class="line"><span class="keyword">from</span> t_student s</span><br><span class="line"><span class="keyword">left</span> <span class="keyword">join</span> t_class c</span><br><span class="line"><span class="keyword">on</span> s.cid =  c.id</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 查询每班的人数总和</span></span><br><span class="line"><span class="keyword">select</span> c.id cid,<span class="keyword">count</span>(*) <span class="keyword">as</span> <span class="string">'班级总数'</span></span><br><span class="line"><span class="keyword">from</span> t_class c ,t_student s</span><br><span class="line"><span class="keyword">where</span> s.cid = c.id</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> c.id</span><br></pre></td></tr></table></figure>

<h2 id="16-2-业务装配实现多表查询-多对一"><a href="#16-2-业务装配实现多表查询-多对一" class="headerlink" title="16.2  业务装配实现多表查询(多对一)"></a>16.2  业务装配实现多表查询(多对一)</h2><p>mapper 层 只做单表查询操作，在 service 层进行手动装配，实现关联查询的结果。</p>
<ul>
<li>实体类</li>
</ul>
<p>创建班级类(Clazz) 和学生类(Student) ，并在Student类中加一个Clazz类型的属性，用于表示学生的班级信息。</p>
<ul>
<li>mapper 层</li>
</ul>
<p>提供 StudentMapper 和ClazzMapper ，StudentMapper 查询所有学生信息，ClazzMapper 根据根据编号查询班级信息。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"selAll"</span> <span class="attr">resultMap</span>=<span class="string">"smap"</span>&gt;</span></span><br><span class="line">		select * from t_student</span><br><span class="line">	<span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"selById"</span> <span class="attr">resultMap</span>=<span class="string">"cmap"</span> <span class="attr">parameterType</span>=<span class="string">"int"</span>&gt;</span></span><br><span class="line">		select * from t_class where id = #&#123;0&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>新增的层  - services 层</li>
</ul>
<p>调用 mapper 层，先查询所有学生，再根据每个学生所在的班级编号查询班级信息，手动进行组装，称之为业务装配</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> List&lt;Student&gt; <span class="title">selAll</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		SqlSession session = MyBatisUtil.getSqlSession();</span><br><span class="line">		StudentMapper stuMapper = session.getMapper(StudentMapper.class);</span><br><span class="line">		ClazzMapper clsMapper = session.getMapper(ClazzMapper.class);</span><br><span class="line">		List&lt;Student&gt; students = stuMapper.selAll();</span><br><span class="line">		<span class="keyword">for</span> (Student stu : students) &#123;</span><br><span class="line">			<span class="comment">/**  业务装配    </span></span><br><span class="line"><span class="comment">			 * 	  根据学生的班级号查询对应的班级信心</span></span><br><span class="line"><span class="comment">			 * 	 再添加到 学生类中</span></span><br><span class="line"><span class="comment">			 * ***/</span></span><br><span class="line">			Clazz cls = clsMapper.selById(stu.getCid());</span><br><span class="line">			stu.setClazz(cls);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> students;</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>Test 层</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestMyBatis</span> </span>&#123;</span><br><span class="line">	<span class="meta">@Test</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test03</span><span class="params">()</span></span>&#123;</span><br><span class="line">		StudentService stuService = <span class="keyword">new</span> StudentServiceImpl();</span><br><span class="line">		List&lt;Student&gt; list = stuService.selAll();</span><br><span class="line">		<span class="keyword">for</span> (Student stu : list) &#123;</span><br><span class="line">			System.out.println(stu);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="16-3-resultMap-association-N-1-查询（多对一）"><a href="#16-3-resultMap-association-N-1-查询（多对一）" class="headerlink" title="16.3 resultMap association   N+1 查询（多对一）"></a>16.3 resultMap association   N+1 查询（多对一）</h2><blockquote>
<p>  优点：使用的  SQL 语句简单，都是单表查询<br>  缺点：执行 SQL 语句的次数多 N+1 次，效率低</p>
</blockquote>
<ul>
<li><p>pojo  层</p>
<p>创建班级类(Clazz) 和学生类(Student) ，并在Student类中加一个Clazz类型的属性，用于表示学生的班级信息。</p>
</li>
<li><p>mapper 层</p>
<p>在 StudentMapper.xml 中，使用新的标签，resultMap标签下的association标签，用于关联其他表，做多表查询使用，需要传入参数进去 column。</p>
</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">type</span>=<span class="string">"Student"</span> <span class="attr">id</span>=<span class="string">"smap"</span>&gt;</span></span><br><span class="line">			<span class="comment">&lt;!--  设置主键的id  --&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">id</span> <span class="attr">column</span>=<span class="string">"id"</span> <span class="attr">property</span>=<span class="string">"sid"</span>/&gt;</span></span><br><span class="line">			<span class="comment">&lt;!-- 设置非主属性映射 --&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"name"</span> <span class="attr">property</span>=<span class="string">"sname"</span>/&gt;</span></span><br><span class="line">			<span class="comment">&lt;!-- </span></span><br><span class="line"><span class="comment">					若没有手动映射cid，则在查询结果中 cid 等于 0</span></span><br><span class="line"><span class="comment">					由于 MyBatis 的机制，一个相同的属性只使用 </span></span><br><span class="line"><span class="comment">					若想使用多次，则需要手动映射</span></span><br><span class="line"><span class="comment">			 --&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"cid"</span> <span class="attr">property</span>=<span class="string">"cid"</span>/&gt;</span></span><br><span class="line">			<span class="comment">&lt;!-- 关联到 clazz 表，根据 cid 查询班级信息 --&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">association</span> <span class="attr">property</span>=<span class="string">"clazz"</span> <span class="attr">select</span>=<span class="string">"cn.szxy.mapper.ClazzMapper.selById"</span> <span class="attr">column</span>=<span class="string">"cid"</span> /&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"selAll"</span> <span class="attr">resultMap</span>=<span class="string">"smap"</span>&gt;</span></span><br><span class="line">		select * from t_student</span><br><span class="line">	<span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>services 层</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> List&lt;Student&gt; <span class="title">selAll</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    SqlSession session = MyBatisUtil.getSqlSession();</span><br><span class="line">    StudentMapper stuMapper = session.getMapper(StudentMapper.class);</span><br><span class="line">    List&lt;Student&gt; students = stuMapper.selAll();</span><br><span class="line">    <span class="keyword">return</span> students;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>Test 层</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.szxy.test;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSession;</span><br><span class="line"><span class="keyword">import</span> org.junit.Test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> cn.szxy.mapper.ClazzMapper;</span><br><span class="line"><span class="keyword">import</span> cn.szxy.mapper.StudentMapper;</span><br><span class="line"><span class="keyword">import</span> cn.szxy.pojo.Clazz;</span><br><span class="line"><span class="keyword">import</span> cn.szxy.pojo.Student;</span><br><span class="line"><span class="keyword">import</span> cn.szxy.services.StudentService;</span><br><span class="line"><span class="keyword">import</span> cn.szxy.services.StudentServiceImpl;</span><br><span class="line"><span class="keyword">import</span> cn.szxy.util.MyBatisUtil;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestMyBatis</span> </span>&#123;</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 *   N+1 查询</span></span><br><span class="line"><span class="comment">	 *   1 表示查询所有的学生信息</span></span><br><span class="line"><span class="comment">	 *   N 表示查询每个学生的班级编号对应的班级信息</span></span><br><span class="line"><span class="comment">	 *   </span></span><br><span class="line"><span class="comment">	 *   优点：使用的  SQL 语句简单，都是单表查询</span></span><br><span class="line"><span class="comment">	 *   缺点：执行 SQL 语句的次数多 N+1 次，效率低</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="meta">@Test</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test01</span><span class="params">()</span></span>&#123;</span><br><span class="line">		StudentService stuService = <span class="keyword">new</span> StudentServiceImpl();</span><br><span class="line">		List&lt;Student&gt; list = stuService.selAll();</span><br><span class="line">		<span class="keyword">for</span> (Student stu : list) &#123;</span><br><span class="line">			System.out.println(stu);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="16-4-resultMap-association-的关联查询-多对一"><a href="#16-4-resultMap-association-的关联查询-多对一" class="headerlink" title="16.4  resultMap association 的关联查询(多对一)"></a>16.4  resultMap association 的关联查询(多对一)</h2><blockquote>
<p>a）在 ClazzMapper.xml  中定义多表连接查询 SQL  语句，一次性查到所有需要的数据</p>
<p>b）通过 <resultmap> 定义映射关系，并通过 collection 标签指定集合的泛型的映射关系，可以把collection标签看成一个resultMapper 标签使用，<strong>ofType</strong>属性表示集合的泛型，可以写全限定路径名或别名</resultmap></p>
</blockquote>
<ul>
<li><p>实体类</p>
<p>创建班级类(Clazz) 和学生类(Student) ，并在Student类中加一个Clazz类型的属性，用于表示学生的班级信息。</p>
</li>
<li><p>mapper 层</p>
</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">type</span>=<span class="string">"Student"</span> <span class="attr">id</span>=<span class="string">"smap"</span>&gt;</span></span><br><span class="line">			<span class="comment">&lt;!--  设置主键的id  --&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">id</span> <span class="attr">column</span>=<span class="string">"sid"</span> <span class="attr">property</span>=<span class="string">"sid"</span>/&gt;</span></span><br><span class="line">			<span class="comment">&lt;!-- 设置非主属性映射 --&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"sname"</span> <span class="attr">property</span>=<span class="string">"sname"</span>/&gt;</span></span><br><span class="line">			<span class="comment">&lt;!-- </span></span><br><span class="line"><span class="comment">					若没有手动映射cid，则在查询结果中 cid 等于 0</span></span><br><span class="line"><span class="comment">					由于 MyBatis 的机制，一个相同的属性只使用 </span></span><br><span class="line"><span class="comment">					若想使用多次，则需要手动映射</span></span><br><span class="line"><span class="comment">			 --&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"sage"</span> <span class="attr">property</span>=<span class="string">"age"</span>/&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"sgender"</span> <span class="attr">property</span>=<span class="string">"gender"</span>/&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"cid"</span> <span class="attr">property</span>=<span class="string">"cid"</span>/&gt;</span></span><br><span class="line">			<span class="comment">&lt;!-- 关联到 clazz 表，根据 cid 查询班级信息 --&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">association</span> <span class="attr">property</span>=<span class="string">"clazz"</span> <span class="attr">javaType</span>=<span class="string">"Clazz"</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">id</span> <span class="attr">column</span>=<span class="string">"cid"</span> <span class="attr">property</span>=<span class="string">"cid"</span>/&gt;</span>	</span><br><span class="line">				<span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"cname"</span> <span class="attr">property</span>=<span class="string">"cname"</span>/&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"croom"</span> <span class="attr">property</span>=<span class="string">"croom"</span>/&gt;</span></span><br><span class="line">			<span class="tag">&lt;/<span class="name">association</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"selAll"</span> <span class="attr">resultMap</span>=<span class="string">"smap"</span>&gt;</span></span><br><span class="line">		select </span><br><span class="line">			s.id sid,s.name sname,s.age sage,s.gender sgender,c.id cid ,c.name cname,c.room croom</span><br><span class="line">		from t_student s</span><br><span class="line">		left join t_class c</span><br><span class="line">		on s.cid =  c.id</span><br><span class="line">	<span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>service  层</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> List&lt;Student&gt; <span class="title">selAll</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	SqlSession session = MyBatisUtil.getSqlSession();</span><br><span class="line">	StudentMapper stuMapper = session.getMapper(StudentMapper.class);</span><br><span class="line">	List&lt;Student&gt; students = stuMapper.selAll();</span><br><span class="line">	<span class="keyword">return</span> students;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>Test 层 </li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test01</span><span class="params">()</span></span>&#123;</span><br><span class="line">    StudentService stuService = <span class="keyword">new</span> StudentServiceImpl();</span><br><span class="line">    List&lt;Student&gt; list = stuService.selAll();</span><br><span class="line">    <span class="keyword">for</span> (Student stu : list) &#123;</span><br><span class="line">    System.out.println(stu);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="16-5-resultMap-association-N-1-查询（一对多）"><a href="#16-5-resultMap-association-N-1-查询（一对多）" class="headerlink" title="16.5  resultMap association   N+1 查询（一对多）"></a>16.5  resultMap association   N+1 查询（一对多）</h2><blockquote>
<p>注意关联其他表 使用 collection标签,其中属性有：</p>
<p>property: 指定要关联的一个集合</p>
<p>select: 设定要继续引用查询， namespace+id</p>
<p>column:  查询时需要传递的列</p>
</blockquote>
<ul>
<li>实体类</li>
</ul>
<p>创建 Student 类和 Clazz 类，其中在 Clazz 类添加属性为泛型为 Student 的 List 集合，用于查询每个班级信息中对应的学生信息</p>
<ul>
<li>mapper 层</li>
</ul>
<p>提供 ClazzMapper 和 StudentMapper ，ClazzMaper 查询所有班级信息， StudentMapper 根据班级编号查询学生信息。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">type</span>=<span class="string">"clazz"</span> <span class="attr">id</span>=<span class="string">"cmap"</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">id</span> <span class="attr">column</span>=<span class="string">"cid"</span> <span class="attr">property</span>=<span class="string">"cid"</span>/&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"cname"</span> <span class="attr">property</span>=<span class="string">"cname"</span>/&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"croom"</span> <span class="attr">property</span>=<span class="string">"croom"</span>/&gt;</span></span><br><span class="line">	 	<span class="tag">&lt;<span class="name">collection</span> <span class="attr">property</span>=<span class="string">"students"</span> <span class="attr">select</span>=<span class="string">"cn.szxy.mapper.StudentMapper.selByCId"</span> <span class="attr">column</span>=<span class="string">"cid"</span> /&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line">	</span><br><span class="line">	<span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"selAll"</span> <span class="attr">resultMap</span>=<span class="string">"cmap"</span>&gt;</span></span><br><span class="line">		select</span><br><span class="line">		c.id cid,c.name cname,c.room croom </span><br><span class="line">	   from t_class c  </span><br><span class="line">	<span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"selByCId"</span> <span class="attr">resultType</span>=<span class="string">"student"</span> <span class="attr">parameterType</span>=<span class="string">"int"</span>&gt;</span></span><br><span class="line">		select </span><br><span class="line">		s.id sid,s.name sname,s.age,s.gender,s.cid</span><br><span class="line">		from t_student s where cid = #&#123;0&#125;</span><br><span class="line">	<span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>services 层</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> List&lt;Clazz&gt; <span class="title">selAll</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		SqlSession session = MyBatisUtil.getSqlSession();</span><br><span class="line">		ClazzMapper clsMapper = session.getMapper(ClazzMapper.class);</span><br><span class="line">		List&lt;Clazz&gt; list = clsMapper.selAll();</span><br><span class="line">		<span class="keyword">return</span> list;</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>Test  层</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span> </span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test03</span><span class="params">()</span></span>&#123;</span><br><span class="line">		SqlSession session = MyBatisUtil.getSqlSession();</span><br><span class="line">		ClazzMapper mapper = session.getMapper(ClazzMapper.class);</span><br><span class="line">		List&lt;Clazz&gt; list = mapper.selAll();</span><br><span class="line">		<span class="keyword">for</span> (Clazz clazz : list) &#123;</span><br><span class="line">			System.out.println(clazz);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<h2 id="16-6resultMap-关联查询（一对多）"><a href="#16-6resultMap-关联查询（一对多）" class="headerlink" title="16.6resultMap 关联查询（一对多）"></a>16.6resultMap 关联查询（一对多）</h2><blockquote>
<p>a）在 ClazzMapper.xml  中定义多表连接查询 SQL  语句，一次性查到所有需要的数据</p>
<p>b）通过 <resultmap> 定义映射关系，并通过 collection 标签指定集合的泛型的映射关系，可以把collection标签看成一个resultMapper 标签使用，<strong>ofType</strong>属性表示集合的泛型，可以写全限定路径名或别名</resultmap></p>
</blockquote>
<ul>
<li>实体类</li>
</ul>
<p>创建 Student 类和 Clazz 类，其中在 Clazz 类添加属性为泛型为 Student 的 List 集合，用于查询每个班级信息中对应的学生信息</p>
<ul>
<li>mapper 层</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">type</span>=<span class="string">"clazz"</span> <span class="attr">id</span>=<span class="string">"cmap"</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">id</span> <span class="attr">column</span>=<span class="string">"cid"</span> <span class="attr">property</span>=<span class="string">"cid"</span>/&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"name"</span> <span class="attr">property</span>=<span class="string">"cname"</span>/&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"room"</span> <span class="attr">property</span>=<span class="string">"croom"</span>/&gt;</span></span><br><span class="line">		<span class="comment">&lt;!--  除了指定 类型为 集合list 还需要指定集合的泛型  oftype--&gt;</span></span><br><span class="line">	 	<span class="tag">&lt;<span class="name">collection</span> <span class="attr">property</span>=<span class="string">"students"</span> <span class="attr">javaType</span>=<span class="string">"list"</span> <span class="attr">ofType</span>=<span class="string">"Student"</span>&gt;</span></span><br><span class="line">	 		<span class="tag">&lt;<span class="name">id</span> <span class="attr">column</span>=<span class="string">"id"</span> <span class="attr">property</span>=<span class="string">"sid"</span>/&gt;</span></span><br><span class="line">	 		<span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"name"</span> <span class="attr">property</span>=<span class="string">"sname"</span>/&gt;</span></span><br><span class="line">	 		<span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"age"</span> <span class="attr">property</span>=<span class="string">"age"</span>/&gt;</span></span><br><span class="line">	 		<span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"gender"</span> <span class="attr">property</span>=<span class="string">"gender"</span>/&gt;</span></span><br><span class="line">	 		<span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"cid"</span> <span class="attr">property</span>=<span class="string">"cid"</span>/&gt;</span></span><br><span class="line">	 	<span class="tag">&lt;/<span class="name">collection</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"selAll"</span> <span class="attr">resultMap</span>=<span class="string">"cmap"</span>&gt;</span></span><br><span class="line">			select </span><br><span class="line">			c.id cid,c.name,c.room,s.id,s.name,s.age,s.gender </span><br><span class="line">			from t_class c</span><br><span class="line">			left join t_student s</span><br><span class="line">			on  c.id = s.cid</span><br><span class="line">	<span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>services 层</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> List&lt;Clazz&gt; <span class="title">selAll</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		SqlSession session = MyBatisUtil.getSqlSession();</span><br><span class="line">		ClazzMapper clsMapper = session.getMapper(ClazzMapper.class);</span><br><span class="line">		List&lt;Clazz&gt; list = clsMapper.selAll();</span><br><span class="line">		<span class="keyword">return</span> list;</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>Test 层</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span> </span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test03</span><span class="params">()</span></span>&#123;</span><br><span class="line">		SqlSession session = MyBatisUtil.getSqlSession();</span><br><span class="line">		ClazzMapper mapper = session.getMapper(ClazzMapper.class);</span><br><span class="line">		List&lt;Clazz&gt; list = mapper.selAll();</span><br><span class="line">		<span class="keyword">for</span> (Clazz clazz : list) &#123;</span><br><span class="line">			System.out.println(clazz);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>注意：</li>
</ul>
<p>查询班级中 学生的信息是一个集合的形式</p>
<p><collection>标签用于关联一个集合，而<association>关联一个对象</association></collection></p>
<p>在使用 resultMap 关联查询时，注意collection标签中属性 oftype 设置泛型</p>
<p>若不设置泛型，程序报错。</p>
<h2 id="16-7-通过-Auto-Mapping-实现多表查询（多对一）"><a href="#16-7-通过-Auto-Mapping-实现多表查询（多对一）" class="headerlink" title="16.7 通过 Auto-Mapping 实现多表查询（多对一）"></a>16.7 通过 Auto-Mapping 实现多表查询（多对一）</h2><blockquote>
<p>优点：不需要使用手动映射，resultmap标签，简单</p>
<p>缺点：格式要求严格，而且只能使用同类型的数据库</p>
<p>如：MySql 中字符串原样输出采用 `` <code>,而 Oracle 数据库中字符串原样输出采用双引号</code>“ “`</p>
</blockquote>
<ul>
<li>mapper 层</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- resultType 使用 自动映射   --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"selAll"</span>  <span class="attr">resultType</span>=<span class="string">"student"</span>&gt;</span></span><br><span class="line">	select </span><br><span class="line">		s.id sid,s.name sname,s.age,s.gender,s.cid,c.id `clazz.cid`,c.name `clazz.name`, c.room `clazz.room`</span><br><span class="line">	from t_student s</span><br><span class="line">	left join t_class c</span><br><span class="line">	on s.cid =  c.id</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>Test 层</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test01</span><span class="params">()</span></span>&#123;</span><br><span class="line">		StudentService stuService = <span class="keyword">new</span> StudentServiceImpl();</span><br><span class="line">		List&lt;Student&gt; list = stuService.selAll();</span><br><span class="line">		<span class="keyword">for</span> (Student stu : list) &#123;</span><br><span class="line">			System.out.println(stu);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<h1 id="17-注解开发"><a href="#17-注解开发" class="headerlink" title="17   注解开发"></a>17   注解开发</h1><h2 id="17-1-注解概况"><a href="#17-1-注解概况" class="headerlink" title="17.1 注解概况"></a>17.1 注解概况</h2><blockquote>
<p>注解用于描述代码的代码</p>
</blockquote>
<p>例如：@Test(用于描述方法进行 junit 测试), @Override（用于描述方法的重写）,@Param(用于描述属性的名称)</p>
<p>a )  注解的格式 @(xxx)，使用需要<strong>导包</strong></p>
<p>b ）使用注解简化配置文件，但是注解有时候不友好，甚至会很麻烦</p>
<p>c ）关于注解的属性</p>
<ul>
<li>属性的设定方式：属性名 = 属性值</li>
</ul>
<p>d ）关于属性值的类型</p>
<ul>
<li><p>基本类型和 String ，可以使用<strong>双引号</strong>的形式</p>
</li>
<li><p>数组形式，name = {值1，值2，…},如果数组元素<strong>只有一个</strong>，可以省略大括号</p>
</li>
<li><p>对象类型 ，<strong>对象=@对象名(属性)</strong></p>
</li>
<li><p>如果属性是该注解的<strong>默认属性</strong>，而且该注解只配置一个属性，可以将属性名省略</p>
</li>
<li><p>注解和配置文件可以配合使用</p>
</li>
</ul>
<h2 id="17-2-Mybatis-中常见的注解"><a href="#17-2-Mybatis-中常见的注解" class="headerlink" title="17.2  Mybatis 中常见的注解"></a>17.2  Mybatis 中常见的注解</h2><h3 id="17-2-1-CRUD-注解"><a href="#17-2-1-CRUD-注解" class="headerlink" title="17.2.1 CRUD    注解"></a>17.2.1 CRUD    注解</h3><p>@select： 类似于 <code>&lt;select&gt;</code></p>
<p>@Insert:  类似于 <code>&lt;Insert&gt;</code></p>
<p>@Update: 类似于 <code>&lt;update&gt;</code></p>
<p>@Delete:  类似于  <code>&lt;delete&gt;</code></p>
<ul>
<li>mapper 层</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">StudentMapper</span> </span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Select</span>(<span class="string">"select s.id sid,s.name sname,s.age,s.gender,s.cid from t_student s"</span>)</span><br><span class="line">	<span class="function">List&lt;Student&gt; <span class="title">selAll</span><span class="params">()</span></span>;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Insert</span>(<span class="string">"insert into t_student values(default,#&#123;sname&#125;,#&#123;age&#125;,#&#123;gender&#125;,#&#123;cid&#125;)"</span>)</span><br><span class="line">	<span class="function"><span class="keyword">int</span> <span class="title">InsOne</span><span class="params">(Student stu)</span></span>;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Update</span>(<span class="string">"update t_student set age = #&#123;1&#125; where id = #&#123;0&#125;"</span>)</span><br><span class="line">	<span class="function"><span class="keyword">int</span> <span class="title">UpdOne</span><span class="params">(<span class="keyword">int</span> id,<span class="keyword">int</span> age)</span></span>;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Delete</span>(<span class="string">"delete from t_student where id = #&#123;sid&#125;"</span>)</span><br><span class="line">	<span class="function"><span class="keyword">int</span> <span class="title">delOne</span><span class="params">(@Param(<span class="string">"sid"</span>)</span> <span class="keyword">int</span> id)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="17-2-2-使用注解关联查询"><a href="#17-2-2-使用注解关联查询" class="headerlink" title="17.2.2  使用注解关联查询"></a>17.2.2  使用注解关联查询</h3><blockquote>
<p>@Results 类似于 <code>&lt;ResultMap&gt;</code>标签</p>
<p>@Result 类似于 <code>&lt;Result&gt;</code> 和<code>&lt;id&gt;</code>标签</p>
<p>当 @Result 当做 <code>&lt;id&gt;</code> 标签时，注意添加<code>id= true</code></p>
<p>@one 类似于与 <code>&lt;association&gt;</code>标签</p>
</blockquote>
<ul>
<li>mapper 层</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Select</span>(<span class="string">"select * from t_student"</span>)	</span><br><span class="line">	<span class="meta">@Results</span>(value = &#123;</span><br><span class="line">			<span class="meta">@Result</span>(column=<span class="string">"id"</span>,property=<span class="string">"sid"</span>,id=<span class="keyword">true</span>),</span><br><span class="line">			<span class="meta">@Result</span>(column=<span class="string">"name"</span>,property=<span class="string">"sname"</span>),</span><br><span class="line">			<span class="meta">@Result</span>(column=<span class="string">"age"</span>,property=<span class="string">"age"</span>),</span><br><span class="line">			<span class="meta">@Result</span>(column=<span class="string">"gender"</span>,property=<span class="string">"gender"</span>),</span><br><span class="line">			<span class="meta">@Result</span>(column=<span class="string">"cid"</span>,property=<span class="string">"cid"</span>),</span><br><span class="line">			<span class="meta">@Result</span>(property=<span class="string">"clazz"</span>,one=<span class="meta">@One</span>(select=<span class="string">"cn.szxy.mapper.ClazzMapper.selByCid"</span>),column=<span class="string">"cid"</span>)</span><br><span class="line">	&#125;)</span><br><span class="line">	<span class="function">List&lt;Student&gt; <span class="title">selAll</span><span class="params">()</span></span>;</span><br></pre></td></tr></table></figure>

<p>​    </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Select</span>(value = &#123;<span class="string">"select * from T_class where id=#&#123;id&#125;"</span>&#125;)	</span><br><span class="line">	<span class="meta">@Results</span>(value = &#123;</span><br><span class="line">			<span class="meta">@Result</span>(column=<span class="string">"id"</span>,property=<span class="string">"cid"</span>,id=<span class="keyword">true</span>),</span><br><span class="line">			<span class="meta">@Result</span>(column=<span class="string">"name"</span>,property=<span class="string">"cname"</span>),</span><br><span class="line">			<span class="meta">@Result</span>(column=<span class="string">"room"</span>,property=<span class="string">"croom"</span>)</span><br><span class="line">	&#125;)</span><br><span class="line">	<span class="function"><span class="keyword">public</span> Clazz <span class="title">selByCid</span><span class="params">(@Param(<span class="string">"id"</span>)</span> <span class="keyword">int</span> id)</span>;</span><br></pre></td></tr></table></figure>

<h1 id="18-MyBatis-运行原理"><a href="#18-MyBatis-运行原理" class="headerlink" title="18   MyBatis 运行原理"></a>18   MyBatis 运行原理</h1><blockquote>
<p>用于技术面试</p>
</blockquote>
<h2 id="18-1-运行过程中涉及类和接口"><a href="#18-1-运行过程中涉及类和接口" class="headerlink" title="18.1  运行过程中涉及类和接口"></a>18.1  运行过程中涉及类和接口</h2><ul>
<li><p><strong>Resources(C)</strong></p>
<p>用于加载 MyBatis 核心配置文件  xml</p>
</li>
<li><p><strong>XMLConfigBuilder(C)</strong> </p>
</li>
</ul>
<p>用于解析 xml 文件(核心配置文件)  </p>
<ul>
<li><strong>Configuration(C)</strong></li>
</ul>
<p>用于存放 xml 文件解析后的结果 </p>
<ul>
<li><strong>DefaultSqlSessionFactory(C)</strong></li>
</ul>
<p>是 SqlSessionFactory(I) 的 实现类, 创建时需要使用 Configuration 对象 </p>
<ul>
<li><strong>SqlSession( I )</strong></li>
</ul>
<p>是 MyBatis 操作的核心 </p>
<ul>
<li><strong>DefaultSqlSession(C)</strong></li>
</ul>
<p>是 SqlSession 接口的实现类 </p>
<ul>
<li><strong>TransactionFactory(I)</strong></li>
</ul>
<p>用于生产 Transaction 对象 </p>
<ul>
<li><strong>Transaction(I)</strong></li>
</ul>
<p>用于表示操作数据库的事务对象 </p>
<ul>
<li><strong>Executor(I)</strong></li>
</ul>
<p>是 MyBatis 的核心执行器, 类似于 jdbc 中的 Statement, 常用的实现类是 SimpleExecutor </p>
<h2 id="18-2-文字描述"><a href="#18-2-文字描述" class="headerlink" title="18.2 文字描述"></a>18.2 <strong>文字描述</strong></h2><p>​    当 MyBatis 运行开始时, 先要通过 Resources 加载核心配置文件, 之后使 XMLConfigBuilder </p>
<p>对配置文件进行解析, 将解析结果封装为 Configuration 对象, 接着, 使用Configuration 对象构建</p>
<p>一个DefaultSqlSessionFactory 对象, 至此, SqlSession 工厂构建完成. </p>
<p>​    接下来, 通过工厂对象调用 openSession 方法创建 SqlSession 对 象 . 在 这 个 过 程 中 , 需 </p>
<p>要 通 过TransactionFactory 生成 Transaction 对象, 并且, 还需要创建核心执行器 Executor 对</p>
<p>象, 之后, 通过这些对象来创建DefaultSqlSession 对象, 至此, SqlSession 对象创建成功. </p>
<p>​    之后, 通过 SqlSession 对象执行相应的操作, 如果执行成功, 调用 commit 方法提交事务; 如</p>
<p>果失败, 调用rollback 方法事务回滚. 最后, 调用 close 方法关闭session 资源. 以上, 就是 MyBatis </p>
<p>的运行原理.</p>

    </div>

    
    
    
        
      

      <footer class="post-footer">
          
            
          
          <div class="post-tags">
            
              <a href="/tags/Mybatis-框架/" rel="tag"># Mybatis 框架</a>
            
          </div>
        

        

          <div class="post-nav">
            <div class="post-nav-next post-nav-item">
              
                <a href="/2018/12/11/数据库/20181211 JDBC 技术/" rel="next" title="2018 JDBC 技术">
                  <i class="fa fa-chevron-left"></i> 2018 JDBC 技术
                </a>
              
            </div>

            <span class="post-nav-divider"></span>

            <div class="post-nav-prev post-nav-item">
              
                <a href="/2019/01/09/前端/20190109 HTML5/" rel="prev" title="2019 HTML5">
                  2019 HTML5 <i class="fa fa-chevron-right"></i>
                </a>
              
            </div>
          </div>
        
      </footer>
    
  </div>
  
  
  
  </article>

  </div>


          </div>
          

        </div>
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">
        
        
        
        
      

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#1-框架的基本概念和配置文件"><span class="nav-number">1.</span> <span class="nav-text">1 框架的基本概念和配置文件</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#2-MyBatis-简介"><span class="nav-number">2.</span> <span class="nav-text">2  MyBatis 简介</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#3-MyBatis-环境配置"><span class="nav-number">3.</span> <span class="nav-text">3 MyBatis 环境配置</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#3-1-创建项目"><span class="nav-number">3.1.</span> <span class="nav-text">3.1  创建项目</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-2-导入-jar-包"><span class="nav-number">3.2.</span> <span class="nav-text">3.2 导入 jar 包</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#3-2-1-MyBatis-核心包"><span class="nav-number">3.2.1.</span> <span class="nav-text">3.2.1 MyBatis 核心包</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-2-2-MyBatis-依赖的-jar-包"><span class="nav-number">3.2.2.</span> <span class="nav-text">3.2.2  MyBatis 依赖的 jar 包</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-2-3-驱动包-jar"><span class="nav-number">3.2.3.</span> <span class="nav-text">3.2.3  驱动包 jar</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-3-编写配置文件"><span class="nav-number">3.3.</span> <span class="nav-text">3.3 编写配置文件</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#3-3-1-配置文件内容-初步"><span class="nav-number">3.3.1.</span> <span class="nav-text">3.3.1 配置文件内容(初步)</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-4-定义-pojo-类"><span class="nav-number">3.4.</span> <span class="nav-text">3.4  定义 pojo 类</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-5-Mapper-映射文件-数据访问层-Dao"><span class="nav-number">3.5.</span> <span class="nav-text">3.5 Mapper 映射文件 == 数据访问层  Dao</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#4-MyBatis-配置文件详解"><span class="nav-number">4.</span> <span class="nav-text">4 MyBatis 配置文件详解</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#4-1-configuration"><span class="nav-number">4.1.</span> <span class="nav-text">4.1 configuration</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-2-environments"><span class="nav-number">4.2.</span> <span class="nav-text">4.2 environments</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-3-environment"><span class="nav-number">4.3.</span> <span class="nav-text">4.3 environment</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-4-transcation"><span class="nav-number">4.4.</span> <span class="nav-text">4.4  transcation</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#4-4-1-type-属性"><span class="nav-number">4.4.1.</span> <span class="nav-text">4.4.1  type 属性</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#4-5-lt-DataSource-gt"><span class="nav-number">5.</span> <span class="nav-text">4.5 &lt;DataSource&gt;</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#4-5-1-type-属性"><span class="nav-number">5.1.</span> <span class="nav-text">4.5.1 type 属性</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#1-6-lt-property-gt"><span class="nav-number">5.2.</span> <span class="nav-text">1.6  &lt;property&gt;</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#1-7-lt-mappers-gt"><span class="nav-number">5.3.</span> <span class="nav-text">1.7 &lt;mappers&gt;</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#5-Mapper-映射配置文件详解"><span class="nav-number">6.</span> <span class="nav-text">5 Mapper 映射配置文件详解</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#5-1-lt-mapper-gt"><span class="nav-number">6.1.</span> <span class="nav-text">5.1 &lt;mapper&gt;</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#5-1-1-namespace-属性"><span class="nav-number">6.2.</span> <span class="nav-text">5.1.1  namespace  属性</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#5-2-lt-select-gt"><span class="nav-number">6.3.</span> <span class="nav-text">5.2 &lt;select&gt;</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#5-2-1-id-属性"><span class="nav-number">6.3.1.</span> <span class="nav-text">5.2.1 id 属性</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-2-2-resultType-属性"><span class="nav-number">6.3.2.</span> <span class="nav-text">5.2.2 resultType 属性</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#6-MyBatis-中常用三个查询方法"><span class="nav-number">7.</span> <span class="nav-text">6 MyBatis 中常用三个查询方法</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#6-1-select-List"><span class="nav-number">7.1.</span> <span class="nav-text">6.1 select List</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#6-2-selectOne"><span class="nav-number">7.2.</span> <span class="nav-text">6.2  selectOne</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#6-3-selectMap-—-重点"><span class="nav-number">7.3.</span> <span class="nav-text">6.3 selectMap    — 重点</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#7-Log4J"><span class="nav-number">8.</span> <span class="nav-text">7 Log4J</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#7-1-Log4J-简介"><span class="nav-number">8.1.</span> <span class="nav-text">7.1 Log4J 简介</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#7-2日志级别"><span class="nav-number">8.2.</span> <span class="nav-text">7.2日志级别</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#FATAL"><span class="nav-number">8.2.0.0.1.</span> <span class="nav-text">FATAL</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#7-3-log4j-使用"><span class="nav-number">8.3.</span> <span class="nav-text">7.3 log4j 使用</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#7-3-1-导包"><span class="nav-number">8.3.1.</span> <span class="nav-text">7.3.1 导包</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#7-3-2-配置文件"><span class="nav-number">8.3.2.</span> <span class="nav-text">7.3.2 配置文件</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#7-4-MyBatis-对log4j-的支持-——定制-SQL-语句输出格式"><span class="nav-number">8.4.</span> <span class="nav-text">7.4 MyBatis 对log4j 的支持 ——定制 SQL 语句输出格式</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#8-properties-软编码"><span class="nav-number">9.</span> <span class="nav-text">8  properties 软编码</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#9-typeAliases-标签配置别名"><span class="nav-number">10.</span> <span class="nav-text">9   typeAliases 标签配置别名</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#10-带参数的查询-parameterType"><span class="nav-number">11.</span> <span class="nav-text">10  带参数的查询 parameterType</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#11-DML-操作-封装工具类"><span class="nav-number">12.</span> <span class="nav-text">11  DML 操作 _封装工具类</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#11-1-事务（Transcation）"><span class="nav-number">12.1.</span> <span class="nav-text">11.1 事务（Transcation）</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#11-2-封装工具类"><span class="nav-number">12.2.</span> <span class="nav-text">11.2  封装工具类</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#11-3-增删改操作（DML）"><span class="nav-number">12.3.</span> <span class="nav-text">11.3  增删改操作（DML）</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#12-MyBatis-接口绑定方案"><span class="nav-number">13.</span> <span class="nav-text">12   MyBatis 接口绑定方案</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#12-1-实现方式"><span class="nav-number">13.1.</span> <span class="nav-text">12.1 实现方式</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#12-1-1-定义接口"><span class="nav-number">13.1.1.</span> <span class="nav-text">12.1.1 定义接口</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#12-1-2-编写对应接口的映射文件"><span class="nav-number">13.1.2.</span> <span class="nav-text">12.1.2 编写对应接口的映射文件</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#12-1-3-在核心配置文件中扫描mapper"><span class="nav-number">13.1.3.</span> <span class="nav-text">12.1.3  在核心配置文件中扫描mapper</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#12-1-4-应用"><span class="nav-number">13.1.4.</span> <span class="nav-text">12.1.4 应用</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#12-2-通过接口方案，解决多参数传递"><span class="nav-number">13.2.</span> <span class="nav-text">12.2 通过接口方案，解决多参数传递</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#12-2-1-定义接口中的抽象方法"><span class="nav-number">13.2.1.</span> <span class="nav-text">12.2.1 定义接口中的抽象方法</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#12-2-2-在-UserMapper-xml-中添加-sql-语句"><span class="nav-number">13.2.2.</span> <span class="nav-text">12.2.2 在 UserMapper.xml 中添加 sql 语句</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#12-2-3-应用"><span class="nav-number">13.2.3.</span> <span class="nav-text">12.2.3 应用</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#12-2-4-总结"><span class="nav-number">13.2.4.</span> <span class="nav-text">12.2.4 总结</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-方式一-使用索引0、1-或者-参数param1-、param2"><span class="nav-number">13.2.4.1.</span> <span class="nav-text">1   方式一 使用索引0、1 或者 参数param1 、param2</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-方式二-使用注解-Param-来使用自己设定的值-或者使用-参数param1-、param2"><span class="nav-number">13.2.4.2.</span> <span class="nav-text">2  方式二 使用注解 @Param 来使用自己设定的值 或者使用 参数param1 、param2</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#13-动态-SQL-dynamic"><span class="nav-number">14.</span> <span class="nav-text">13 动态 SQL   dynamic</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#13-1-lt-where-gt-lt-if-gt"><span class="nav-number">14.1.</span> <span class="nav-text">13.1  &lt; where&gt;   &lt;if&gt;</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#13-2-lt-choose-gt-lt-when-gt"><span class="nav-number">14.2.</span> <span class="nav-text">13.2  &lt;choose&gt; &lt;when&gt;</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#13-3-lt-set-gt"><span class="nav-number">14.3.</span> <span class="nav-text">13.3 &lt;set&gt;</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#13-3-lt-trim-gt"><span class="nav-number">14.4.</span> <span class="nav-text">13.3 &lt;trim&gt;</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#13-4-lt-bind-gt"><span class="nav-number">14.5.</span> <span class="nav-text">13.4  &lt;bind&gt;</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#13-5-foreach"><span class="nav-number">14.6.</span> <span class="nav-text">13.5 foreach</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#13-6-lt-sql-gt-lt-include-gt"><span class="nav-number">14.7.</span> <span class="nav-text">13.6 &lt;sql&gt; &lt;include&gt;</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#14-MyBatis-的缓存机制"><span class="nav-number">15.</span> <span class="nav-text">14   MyBatis 的缓存机制</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#14-1-一级缓存"><span class="nav-number">15.1.</span> <span class="nav-text">14.1 一级缓存</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#14-2-二级缓存"><span class="nav-number">15.2.</span> <span class="nav-text">14.2 二级缓存</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#15-列名和属性名不一致问题-resultMap标签"><span class="nav-number">16.</span> <span class="nav-text">15  列名和属性名不一致问题_resultMap标签</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#16-多表关联查询"><span class="nav-number">17.</span> <span class="nav-text">16 多表关联查询</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#16-1-设计表-表结构"><span class="nav-number">17.1.</span> <span class="nav-text">16.1   设计表-表结构</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#16-2-业务装配实现多表查询-多对一"><span class="nav-number">17.2.</span> <span class="nav-text">16.2  业务装配实现多表查询(多对一)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#16-3-resultMap-association-N-1-查询（多对一）"><span class="nav-number">17.3.</span> <span class="nav-text">16.3 resultMap association   N+1 查询（多对一）</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#16-4-resultMap-association-的关联查询-多对一"><span class="nav-number">17.4.</span> <span class="nav-text">16.4  resultMap association 的关联查询(多对一)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#16-5-resultMap-association-N-1-查询（一对多）"><span class="nav-number">17.5.</span> <span class="nav-text">16.5  resultMap association   N+1 查询（一对多）</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#16-6resultMap-关联查询（一对多）"><span class="nav-number">17.6.</span> <span class="nav-text">16.6resultMap 关联查询（一对多）</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#16-7-通过-Auto-Mapping-实现多表查询（多对一）"><span class="nav-number">17.7.</span> <span class="nav-text">16.7 通过 Auto-Mapping 实现多表查询（多对一）</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#17-注解开发"><span class="nav-number">18.</span> <span class="nav-text">17   注解开发</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#17-1-注解概况"><span class="nav-number">18.1.</span> <span class="nav-text">17.1 注解概况</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#17-2-Mybatis-中常见的注解"><span class="nav-number">18.2.</span> <span class="nav-text">17.2  Mybatis 中常见的注解</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#17-2-1-CRUD-注解"><span class="nav-number">18.2.1.</span> <span class="nav-text">17.2.1 CRUD    注解</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#17-2-2-使用注解关联查询"><span class="nav-number">18.2.2.</span> <span class="nav-text">17.2.2  使用注解关联查询</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#18-MyBatis-运行原理"><span class="nav-number">19.</span> <span class="nav-text">18   MyBatis 运行原理</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#18-1-运行过程中涉及类和接口"><span class="nav-number">19.1.</span> <span class="nav-text">18.1  运行过程中涉及类和接口</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#18-2-文字描述"><span class="nav-number">19.2.</span> <span class="nav-text">18.2 文字描述</span></a></li></ol></li></ol></div>
        
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">zwer</p>
  <div class="site-description" itemprop="description">记录学习的日常</div>
</div>
  <nav class="site-state motion-element">
      <div class="site-state-item site-state-posts">
        
          <a href="/archives/">
        
          <span class="site-state-item-count">77</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
    
      
      
      <div class="site-state-item site-state-categories">
        
        <span class="site-state-item-count">10</span>
        <span class="site-state-item-name">categories</span>
        
      </div>
    
      
      
      <div class="site-state-item site-state-tags">
        
        <span class="site-state-item-count">52</span>
        <span class="site-state-item-name">tags</span>
        
      </div>
    
  </nav>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love" id="animate">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">zwer</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io" class="theme-link" rel="noopener" target="_blank">Hexo</a> v3.9.0</div>
  <span class="post-meta-divider">|</span>
  <div class="theme-info">Theme – <a href="https://theme-next.org" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a> v7.4.0</div>

        












        
      </div>
    </footer>
  </div>

  


  <script src="/lib/anime.min.js?v=3.1.0"></script>
  <script src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  <script src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
<script src="/js/utils.js?v=7.4.0"></script><script src="/js/motion.js?v=7.4.0"></script>
<script src="/js/schemes/muse.js?v=7.4.0"></script>
<script src="/js/next-boot.js?v=7.4.0"></script>



  





















  

  

  

</body>
</html>
