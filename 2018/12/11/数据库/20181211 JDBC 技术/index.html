<!DOCTYPE html>





<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 3.9.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=7.4.0">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=7.4.0">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=7.4.0">
  <link rel="mask-icon" href="/images/logo.svg?v=7.4.0" color="#222">

<link rel="stylesheet" href="/css/main.css?v=7.4.0">


<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css?v=4.7.0">


<script id="hexo-configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '7.4.0',
    exturl: false,
    sidebar: {"position":"left","display":"post","offset":12,"onmobile":false},
    copycode: {"enable":false,"show_result":false,"style":null},
    back2top: {"enable":true,"sidebar":false,"scrollpercent":false},
    bookmark: {"enable":false,"color":"#222","save":"auto"},
    fancybox: false,
    mediumzoom: false,
    lazyload: false,
    pangu: false,
    algolia: {
      appID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    },
    localsearch: {"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},
    path: '',
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    translation: {
      copy_button: 'Copy',
      copy_success: 'Copied',
      copy_failure: 'Copy failed'
    },
    sidebarPadding: 40
  };
</script>

  <meta name="description" content="1 JDBC 简介 前言：  JDBC (Java Data Base  Connectivity, java 数据库连接 是一种用于执行 SQL 语句的 Java API ，为多种关系数据库提供统一访问   将 Java 语言 和 JDBC 结合起来使程序员不必为不同的平台编写不同的应用程序 2 JDBC 连接数据库的步骤a） 注册驱动 b）建立数据库连接 (Connection) c）准备 S">
<meta name="keywords" content="JDBC">
<meta property="og:type" content="article">
<meta property="og:title" content="2018 JDBC 技术">
<meta property="og:url" content="http://zwer.xyz/2018/12/11/数据库/20181211 JDBC 技术/index.html">
<meta property="og:site_name" content="zwer 的博客空间">
<meta property="og:description" content="1 JDBC 简介 前言：  JDBC (Java Data Base  Connectivity, java 数据库连接 是一种用于执行 SQL 语句的 Java API ，为多种关系数据库提供统一访问   将 Java 语言 和 JDBC 结合起来使程序员不必为不同的平台编写不同的应用程序 2 JDBC 连接数据库的步骤a） 注册驱动 b）建立数据库连接 (Connection) c）准备 S">
<meta property="og:locale" content="en">
<meta property="og:image" content="http://www.zwer.xyz/picGo/20181210205117.png">
<meta property="og:image" content="http://www.zwer.xyz/picGo/20181210211301.png">
<meta property="og:image" content="http://www.zwer.xyz/picGo/20181210212623.png">
<meta property="og:image" content="http://www.zwer.xyz/picGo/20181210213218.png">
<meta property="og:image" content="http://www.zwer.xyz/picGo/20181210213111.png">
<meta property="og:image" content="http://www.zwer.xyz/picGo/20181210215802.png">
<meta property="og:updated_time" content="2018-12-28T13:04:13.631Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="2018 JDBC 技术">
<meta name="twitter:description" content="1 JDBC 简介 前言：  JDBC (Java Data Base  Connectivity, java 数据库连接 是一种用于执行 SQL 语句的 Java API ，为多种关系数据库提供统一访问   将 Java 语言 和 JDBC 结合起来使程序员不必为不同的平台编写不同的应用程序 2 JDBC 连接数据库的步骤a） 注册驱动 b）建立数据库连接 (Connection) c）准备 S">
<meta name="twitter:image" content="http://www.zwer.xyz/picGo/20181210205117.png">
  <link rel="canonical" href="http://zwer.xyz/2018/12/11/数据库/20181211 JDBC 技术/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome: false,
    isPost: true,
    isPage: false,
    isArchive: false
  };
</script>

  <title>2018 JDBC 技术 | zwer 的博客空间</title>
  








  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .logo,
  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="en">
  <div class="container use-motion">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-meta">

    <div>
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">zwer 的博客空间</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
        <p class="site-subtitle">上善若水 自强不息</p>
      
  </div>

  <div class="site-nav-toggle">
    <button aria-label="Toggle navigation bar">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>


<nav class="site-nav">
  
  <ul id="menu" class="menu">
      
      
      
        
        <li class="menu-item menu-item-home">
      
    

    <a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i> <br>Home</a>

  </li>
      
      
      
        
        <li class="menu-item menu-item-archives">
      
    

    <a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i> <br>Archives</a>

  </li>
  </ul>

    

</nav>
</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
      <article itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block post">
    <link itemprop="mainEntityOfPage" href="http://zwer.xyz/2018/12/11/数据库/20181211 JDBC 技术/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="zwer">
      <meta itemprop="description" content="记录学习的日常">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="zwer 的博客空间">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">2018 JDBC 技术

          
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              
                
              

              <time title="Created: 2018-12-11 00:00:00" itemprop="dateCreated datePublished" datetime="2018-12-11T00:00:00+08:00">2018-12-11</time>
            </span>
          
            

            
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2018-12-28 21:04:13" itemprop="dateModified" datetime="2018-12-28T21:04:13+08:00">2018-12-28</time>
              </span>
            
          
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/数据库/" itemprop="url" rel="index"><span itemprop="name">数据库</span></a></span>

                
                
              
            </span>
          

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h1 id="1-JDBC-简介"><a href="#1-JDBC-简介" class="headerlink" title="1 JDBC 简介"></a>1 JDBC 简介</h1><blockquote>
<p>前言：</p>
<p> JDBC (Java Data Base  Connectivity, java 数据库连接</p>
<p>是一种用于执行 SQL 语句的 Java API ，为多种关系数据库提供<u>统一访问</u></p>
</blockquote>
<p><img src="http://www.zwer.xyz/picGo/20181210205117.png" alt></p>
<p>将 Java 语言 和 JDBC 结合起来使程序员不必为不同的平台编写不同的应用程序</p>
<h1 id="2-JDBC-连接数据库的步骤"><a href="#2-JDBC-连接数据库的步骤" class="headerlink" title="2 JDBC 连接数据库的步骤"></a>2 JDBC 连接数据库的步骤</h1><p>a） 注册驱动</p>
<p>b）建立数据库连接 (Connection)</p>
<p>c）准备 SQL 语句</p>
<p>d）获取 SQL语句发送器 (Statement)</p>
<p>e) 发送并执行 SQL 语句 ，得到结果集 (ResultSet)</p>
<p>f) 处理结果集</p>
<p>g） 关闭资源 (Connection,Statement,ResultSet) </p>
<ul>
<li>第一步：找  Oracle 的  jar 的位置</li>
</ul>
<p><img src="http://www.zwer.xyz/picGo/20181210211301.png" alt></p>
<ul>
<li>第二步： 新建项目并创建文件夹 lib，将 ojdbc6.jar 复制到该文件夹下，并单击鼠标游标右键添加上 构建目录中</li>
</ul>
<p><img src="http://www.zwer.xyz/picGo/20181210212623.png" alt></p>
<ul>
<li>第三步：新建 java 文件用于连接数据库</li>
</ul>
<p><img src="http://www.zwer.xyz/picGo/20181210213218.png" alt></p>
<p><img src="http://www.zwer.xyz/picGo/20181210213111.png" alt></p>
<ul>
<li>第四步：  编写 Java 代码连接数据库</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.szxy.dao.test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.sql.Connection;</span><br><span class="line"><span class="keyword">import</span> java.sql.DriverManager;</span><br><span class="line"><span class="keyword">import</span> java.sql.ResultSet;</span><br><span class="line"><span class="keyword">import</span> java.sql.SQLException;</span><br><span class="line"><span class="keyword">import</span> java.sql.Statement;</span><br><span class="line"><span class="keyword">import</span> java.util.Date;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 用于连接数据库测试</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> wzer</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">JDBCTestQuery</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> ClassNotFoundException, SQLException </span>&#123;</span><br><span class="line">		<span class="comment">//声明</span></span><br><span class="line">		String url = <span class="string">"jdbc:oracle:thin:@localhost:1521:orcl"</span>;</span><br><span class="line">		String user = <span class="string">"scott"</span>;</span><br><span class="line">		String password = <span class="string">"tiger"</span>;</span><br><span class="line">		<span class="comment">//注册驱动</span></span><br><span class="line">		Class.forName(<span class="string">"oracle.jdbc.driver.OracleDriver"</span>);</span><br><span class="line">		<span class="comment">//建立数据库连接,需要用到驱动管理器</span></span><br><span class="line">		Connection conn = DriverManager.getConnection(url, user, password);</span><br><span class="line">		<span class="comment">//System.out.println(conn);</span></span><br><span class="line">		<span class="comment">//定义 SQL 语句</span></span><br><span class="line">		String sql = <span class="string">"select empno,ename,hiredate from emp"</span>;</span><br><span class="line">		<span class="comment">//建立 发送器</span></span><br><span class="line">		Statement state = conn.createStatement();</span><br><span class="line">		<span class="comment">// 发送 sql 语句，并返回结果集</span></span><br><span class="line">		ResultSet result = state.executeQuery(sql);</span><br><span class="line">		<span class="comment">// 处理 结果集</span></span><br><span class="line">		System.out.println(<span class="string">"empno\tename\thiredate"</span>);</span><br><span class="line">		<span class="keyword">while</span>(result.next())&#123;</span><br><span class="line">			<span class="keyword">int</span> empno = result.getInt(<span class="number">1</span>);<span class="comment">//数据库列的索引从 1 开始</span></span><br><span class="line">			String ename = result.getString(<span class="string">"ename"</span>); <span class="comment">//根据列名索引</span></span><br><span class="line">			Date hiredate = result.getDate(<span class="number">3</span>);</span><br><span class="line">			System.out.println(empno+<span class="string">"\t"</span>+ename+<span class="string">"\t"</span>+hiredate.toLocaleString());</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="comment">//关闭资源</span></span><br><span class="line">		result.close();</span><br><span class="line">		state.close();</span><br><span class="line">		conn.close();	</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>处理结果集后得到的结果：</p>
<p><img src="http://www.zwer.xyz/picGo/20181210215802.png" alt></p>
<h1 id="3-JDBC-异常处理-关闭资源"><a href="#3-JDBC-异常处理-关闭资源" class="headerlink" title="3 JDBC 异常处理 关闭资源"></a>3 JDBC 异常处理 关闭资源</h1><blockquote>
<p>Eclipse 小技巧 ： 使用快捷键 Ctrl +2，L (声明对应方法接受类型的变量)</p>
<p>使用资源后一定要关闭资源，关闭的顺序是<u>从后往前关</u></p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.szxy.dao.test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.sql.Connection;</span><br><span class="line"><span class="keyword">import</span> java.sql.Date;</span><br><span class="line"><span class="keyword">import</span> java.sql.DriverManager;</span><br><span class="line"><span class="keyword">import</span> java.sql.ResultSet;</span><br><span class="line"><span class="keyword">import</span> java.sql.SQLException;</span><br><span class="line"><span class="keyword">import</span> java.sql.Statement;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 异常处理和关闭资源</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> wzer</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">JDBCTestQuery2</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		<span class="comment">//声明变量</span></span><br><span class="line">		String url = <span class="string">"jdbc:oracle:thin:@127.0.0.1:1521:orcl"</span>;</span><br><span class="line">		String user = <span class="string">"scott"</span>;</span><br><span class="line">		String password = <span class="string">"tiger"</span>;</span><br><span class="line">		<span class="comment">//声明</span></span><br><span class="line">		Connection conn = <span class="keyword">null</span>;</span><br><span class="line">		Statement stat = <span class="keyword">null</span>;</span><br><span class="line">		ResultSet rs = <span class="keyword">null</span>;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			<span class="comment">//1 注册驱动</span></span><br><span class="line">			Class.forName(<span class="string">"oracle.jdbc.OracleDriver"</span>);</span><br><span class="line">			<span class="comment">//2 获得数据库连接    小技巧   Ctrl+2，L   创建对应的接受变量</span></span><br><span class="line">		    conn = DriverManager.getConnection(url, user, password);</span><br><span class="line">			<span class="comment">//3 定义 SQL 语句</span></span><br><span class="line">			String sql = <span class="string">"select ename,sal,hiredate from emp"</span>;</span><br><span class="line">			<span class="comment">//4 创建发射器</span></span><br><span class="line">			stat = conn.createStatement();</span><br><span class="line">			<span class="comment">//5 使用发射器并执行 SQL语句,并返回结果集</span></span><br><span class="line">			rs = stat.executeQuery(sql);</span><br><span class="line">			<span class="comment">//6 处理结果集</span></span><br><span class="line">			System.out.println(<span class="string">"ename"</span>+<span class="string">"\t"</span>+<span class="string">"sal"</span>+<span class="string">"\t"</span>+<span class="string">"hiredate"</span>);</span><br><span class="line">			<span class="keyword">while</span>(rs.next())&#123;</span><br><span class="line">				String ename = rs.getString(<span class="number">1</span>);</span><br><span class="line">				<span class="keyword">double</span> sal = rs.getDouble(<span class="string">"sal"</span>);</span><br><span class="line">				Date hiredate = rs.getDate(<span class="string">"hiredate"</span>);</span><br><span class="line">				System.out.println(ename+<span class="string">"\t"</span>+sal+<span class="string">"\t"</span>+hiredate);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125; <span class="keyword">catch</span> (ClassNotFoundException e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;<span class="keyword">finally</span>&#123;<span class="comment">//7 关闭顺序，从后往前关</span></span><br><span class="line">			<span class="keyword">if</span>(rs != <span class="keyword">null</span>)&#123;</span><br><span class="line">				<span class="keyword">try</span> &#123;</span><br><span class="line">					rs.close();</span><br><span class="line">				&#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">					e.printStackTrace();</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">if</span>(stat != <span class="keyword">null</span>)&#123;</span><br><span class="line">				<span class="keyword">try</span> &#123;</span><br><span class="line">					stat.close();</span><br><span class="line">				&#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">					e.printStackTrace();</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">if</span>(conn != <span class="keyword">null</span>)&#123;</span><br><span class="line">				<span class="keyword">try</span> &#123;</span><br><span class="line">					conn.close();</span><br><span class="line">				&#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">					e.printStackTrace();</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;	</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="4-JDBC-执行-DML-操作"><a href="#4-JDBC-执行-DML-操作" class="headerlink" title="4 JDBC  执行 DML 操作"></a>4 JDBC  执行 DML 操作</h1><blockquote>
<p>执行 DML 返回的结果是 <u>受影响的行数</u></p>
<p>Eclipse 小技巧;  ALT + 上下 可以移动一行的位置</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.szxy.dao.test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.sql.Connection;</span><br><span class="line"><span class="keyword">import</span> java.sql.DriverManager;</span><br><span class="line"><span class="keyword">import</span> java.sql.SQLException;</span><br><span class="line"><span class="keyword">import</span> java.sql.Statement;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Eclipse 小技巧  alt+ 上下 可以移动一行的位置</span></span><br><span class="line"><span class="comment"> * JDBC 执行 DML 操作</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> wzer</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">JDBCTestUpdate</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		<span class="comment">//声明变量</span></span><br><span class="line">		String url = <span class="string">"jdbc:oracle:thin:@localhost:1521:orcl"</span>;</span><br><span class="line">		String user = <span class="string">"scott"</span>;</span><br><span class="line">		String password = <span class="string">"tiger"</span>;</span><br><span class="line">		<span class="comment">//声明</span></span><br><span class="line">		Connection conn = <span class="keyword">null</span>;</span><br><span class="line">		Statement stat = <span class="keyword">null</span>;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			<span class="comment">//注册驱动</span></span><br><span class="line">			Class.forName(<span class="string">"oracle.jdbc.OracleDriver"</span>);</span><br><span class="line">			<span class="comment">//获得数据库连接</span></span><br><span class="line">			conn = DriverManager.getConnection(url, user, password);</span><br><span class="line">			System.out.println(conn);</span><br><span class="line">			<span class="comment">//定义 SQL 语句</span></span><br><span class="line">			<span class="comment">//String sql = "insert into emp values('1001','小名','CLEAK',7902,sysdate,500,200,20)";</span></span><br><span class="line">			<span class="comment">//String sql = "update emp set sal = sal*2+100 where empno= 1001";</span></span><br><span class="line">			String sql = <span class="string">"delete from emp where empno = '1001'"</span>;</span><br><span class="line">			<span class="comment">//创建发射器</span></span><br><span class="line">			stat = conn.createStatement();</span><br><span class="line">			<span class="comment">//使用发射器执行 SQL，并返回结果</span></span><br><span class="line">			<span class="comment">//rowcount 指数据表中受影响的行数</span></span><br><span class="line">			<span class="keyword">int</span> rowcount = stat.executeUpdate(sql);</span><br><span class="line">			<span class="keyword">if</span>(rowcount &gt; <span class="number">0</span>)&#123;</span><br><span class="line">				System.out.println(<span class="string">"操作成功"</span>);</span><br><span class="line">			&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">				System.out.println(<span class="string">"操作失败"</span>);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125; <span class="keyword">catch</span> (ClassNotFoundException e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;<span class="keyword">finally</span>&#123;</span><br><span class="line">			<span class="keyword">if</span>(stat != <span class="keyword">null</span>)&#123;</span><br><span class="line">				<span class="keyword">try</span> &#123;</span><br><span class="line">					stat.close();</span><br><span class="line">				&#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">					e.printStackTrace();</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">if</span>(conn != <span class="keyword">null</span>)&#123;</span><br><span class="line">				<span class="keyword">try</span> &#123;</span><br><span class="line">					conn.close();</span><br><span class="line">				&#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">					e.printStackTrace();</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li><p><strong>执行上面的程序出现的问题</strong></p>
<p>在 Oracle 图形操作窗口中，执行 DML 操作，没有提交事务</p>
</li>
</ul>
<p>导致程序运行后，不能执行 DML ，必须结束</p>
<h1 id="5-JSBC-事务操作"><a href="#5-JSBC-事务操作" class="headerlink" title="5  JSBC 事务操作"></a>5  JSBC 事务操作</h1><blockquote>
<p>JDBC 采用自动提交事务的操作</p>
<p>Connection 类中的方法 SetAutoCommit()  设置事务提交</p>
</blockquote>
<ul>
<li><strong>使用数据库中的表格</strong></li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> t_account(</span><br><span class="line">    aid <span class="built_in">number</span>(<span class="number">5</span>),</span><br><span class="line">    aname varchar2(<span class="number">20</span>) <span class="keyword">constraints</span> nn_aname <span class="keyword">not</span> <span class="literal">null</span>,</span><br><span class="line">    amoney <span class="built_in">number</span>(<span class="number">5</span>,<span class="number">2</span>),</span><br><span class="line">    <span class="keyword">constraints</span> pk_aid primary <span class="keyword">key</span>(aid)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_account <span class="keyword">values</span>(<span class="number">1</span>,<span class="string">'张三'</span>,<span class="number">100</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_account <span class="keyword">values</span>(<span class="number">2</span>,<span class="string">'李四'</span>，<span class="number">10</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> *  <span class="keyword">from</span> t_account;</span><br></pre></td></tr></table></figure>

<ul>
<li><strong>模拟 转账操作</strong></li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.szxy.dao.test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.sql.Connection;</span><br><span class="line"><span class="keyword">import</span> java.sql.DriverManager;</span><br><span class="line"><span class="keyword">import</span> java.sql.SQLException;</span><br><span class="line"><span class="keyword">import</span> java.sql.Statement;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 测试 执行 DML 事务操作</span></span><br><span class="line"><span class="comment"> * 模拟 转账操作</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> wzer</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">JDBCTestTransaction</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		String url = <span class="string">"jdbc:oracle:thin:@127.0.0.1:1521:orcl"</span>;</span><br><span class="line">		String user = <span class="string">"szxy"</span>;</span><br><span class="line">		String password = <span class="string">"123"</span>;</span><br><span class="line">		</span><br><span class="line">		Connection conn = <span class="keyword">null</span>;</span><br><span class="line">		Statement stat1 = <span class="keyword">null</span>; </span><br><span class="line">		Statement stat2 = <span class="keyword">null</span>;</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			<span class="comment">//注册驱动</span></span><br><span class="line">			Class.forName(<span class="string">"oracle.jdbc.OracleDriver"</span>);</span><br><span class="line">			<span class="comment">//获得连接</span></span><br><span class="line">			conn = DriverManager.getConnection(url, user, password);</span><br><span class="line">			</span><br><span class="line">			<span class="comment">//设置事务不自动提交</span></span><br><span class="line">			conn.setAutoCommit(<span class="keyword">false</span>);</span><br><span class="line">			<span class="comment">//创建发射器</span></span><br><span class="line">			stat1 = conn.createStatement();</span><br><span class="line">			stat2 = conn.createStatement();</span><br><span class="line">			String sql1 = <span class="string">"update t_account set amoney = amoney -20 where aid = 1 "</span>;</span><br><span class="line">			String sql2 = <span class="string">"update t_account set amoney = amoney +20 where aid = 4 "</span>;</span><br><span class="line">			<span class="comment">//使用发射器，并返回受影响的行数</span></span><br><span class="line">			<span class="keyword">int</span> rownum = stat1.executeUpdate(sql1);</span><br><span class="line">			rownum += stat2.executeUpdate(sql2);</span><br><span class="line">			<span class="comment">//判断模拟转账是否成功</span></span><br><span class="line">			<span class="keyword">if</span>(rownum == <span class="number">2</span>)&#123;</span><br><span class="line">				System.out.println(<span class="string">"转账成功"</span>);</span><br><span class="line">				conn.commit();<span class="comment">//提交事务</span></span><br><span class="line">				System.out.println(<span class="string">"事务提交成功"</span>);</span><br><span class="line">			&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">				System.out.println(<span class="string">"转账失败"</span>);</span><br><span class="line">				conn.rollback();<span class="comment">//回滚</span></span><br><span class="line">				System.out.println(<span class="string">"转账发生错误，回滚"</span>);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">			<span class="keyword">if</span>( conn!=<span class="keyword">null</span>)&#123;</span><br><span class="line">					<span class="keyword">try</span> &#123;</span><br><span class="line">						conn.rollback();</span><br><span class="line">					&#125; <span class="keyword">catch</span> (SQLException e1) &#123;</span><br><span class="line">						e1.printStackTrace();</span><br><span class="line">					&#125;</span><br><span class="line">					System.out.println(<span class="string">"SQL 语句发生错误"</span>+e.getMessage());</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;<span class="keyword">finally</span>&#123;</span><br><span class="line">			<span class="keyword">if</span>(conn!=<span class="keyword">null</span>)&#123;<span class="comment">//恢复事务提交的方式</span></span><br><span class="line">				<span class="keyword">try</span> &#123;</span><br><span class="line">					conn.setAutoCommit(<span class="keyword">true</span>);</span><br><span class="line">				&#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">					e.printStackTrace();</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">if</span>(stat1 != <span class="keyword">null</span>)&#123;</span><br><span class="line">				<span class="keyword">try</span> &#123;</span><br><span class="line">					stat1.close();</span><br><span class="line">				&#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">					e.printStackTrace();</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">if</span>(stat2 != <span class="keyword">null</span>)&#123;</span><br><span class="line">				<span class="keyword">try</span> &#123;</span><br><span class="line">					stat2.close();</span><br><span class="line">				&#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">					e.printStackTrace();</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">if</span>(conn != <span class="keyword">null</span>)&#123;</span><br><span class="line">				<span class="keyword">try</span> &#123;</span><br><span class="line">					conn.close();</span><br><span class="line">				&#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">					e.printStackTrace();</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;	</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="6-JDBC-登录流程-封装工具类"><a href="#6-JDBC-登录流程-封装工具类" class="headerlink" title="6  JDBC 登录流程 封装工具类"></a>6  JDBC 登录流程 封装工具类</h1><blockquote>
<p>Eclipse 小技巧： ssyt + ( ALT+ / ) 打印跟踪信息</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.szxy.Util;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.sql.Connection;</span><br><span class="line"><span class="keyword">import</span> java.sql.DriverManager;</span><br><span class="line"><span class="keyword">import</span> java.sql.ResultSet;</span><br><span class="line"><span class="keyword">import</span> java.sql.SQLException;</span><br><span class="line"><span class="keyword">import</span> java.sql.Statement;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 数据库连接工具</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> wzer</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DBUtil</span> </span>&#123;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String URL = <span class="string">"jdbc:oracle:thin:@localhost:1521:orcl"</span>;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String USER = <span class="string">"szxy"</span>;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String PASSWORD = <span class="string">"123"</span>;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">static</span>&#123;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			Class.forName(<span class="string">"oracle.jdbc.OracleDriver"</span>);</span><br><span class="line">		&#125; <span class="keyword">catch</span> (ClassNotFoundException e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * 建立数据库连接</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Connection <span class="title">getConnection</span><span class="params">()</span></span>&#123;</span><br><span class="line">		Connection conn = <span class="keyword">null</span>;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			conn = DriverManager.getConnection(URL, USER, PASSWORD);</span><br><span class="line">		&#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">			System.out.println(</span><br><span class="line">					<span class="string">"DBUtil.getConnection([URL:]"</span>+URL+<span class="string">"[USER:]"</span>+USER+<span class="string">"[PASSWORD:]"</span>+PASSWORD+<span class="string">""</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> conn;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * 创建 发射器</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@param</span> conn</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Statement <span class="title">getStatement</span><span class="params">(Connection conn)</span></span>&#123;</span><br><span class="line">		Statement stat = <span class="keyword">null</span>;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			stat = conn.createStatement();</span><br><span class="line">		&#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> stat;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">CloseAll</span><span class="params">(ResultSet rs,Statement stat,Connection conn)</span></span>&#123;</span><br><span class="line">		<span class="keyword">if</span>(rs != <span class="keyword">null</span>)&#123;</span><br><span class="line">			<span class="keyword">try</span> &#123;</span><br><span class="line">				rs.close();</span><br><span class="line">			&#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">				e.printStackTrace();</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span>(stat!= <span class="keyword">null</span>)&#123;</span><br><span class="line">			<span class="keyword">try</span> &#123;</span><br><span class="line">				stat.close();</span><br><span class="line">			&#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">				e.printStackTrace();</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span>(conn != <span class="keyword">null</span>)&#123;</span><br><span class="line">			<span class="keyword">try</span> &#123;</span><br><span class="line">				conn.close();</span><br><span class="line">			&#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">				e.printStackTrace();</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>Login 登录</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.szxy.login;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.sql.Connection;</span><br><span class="line"><span class="keyword">import</span> java.sql.ResultSet;</span><br><span class="line"><span class="keyword">import</span> java.sql.SQLException;</span><br><span class="line"><span class="keyword">import</span> java.sql.Statement;</span><br><span class="line"><span class="keyword">import</span> java.util.Scanner;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> cn.szxy.Util.DBUtil;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Login</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		Scanner input = <span class="keyword">new</span> Scanner(System.in);</span><br><span class="line">		System.out.println(<span class="string">"请输入用户名："</span>);</span><br><span class="line">		String user = input.next();</span><br><span class="line">		System.out.println(<span class="string">"请输入密码"</span>);</span><br><span class="line">		String password = input.next();</span><br><span class="line">		</span><br><span class="line">		Connection conn = DBUtil.getConnection();</span><br><span class="line">		Statement stat = DBUtil.getStatement(conn);</span><br><span class="line">		String sql = </span><br><span class="line">	<span class="string">"select count(*) from T_user where tuser='"</span>+user+<span class="string">"' and tpassword = '"</span> +password+ <span class="string">"'"</span>;</span><br><span class="line">		System.out.println(sql);</span><br><span class="line">		ResultSet rs = <span class="keyword">null</span>;</span><br><span class="line">	    <span class="keyword">try</span> &#123;</span><br><span class="line">			rs = stat.executeQuery(sql);</span><br><span class="line">			<span class="keyword">if</span>(rs.next())&#123;</span><br><span class="line">		    	<span class="keyword">if</span>(rs.getInt(<span class="number">1</span>) == <span class="number">0</span>)&#123;</span><br><span class="line">		    		System.out.println(<span class="string">"用户名或密码错误"</span>);</span><br><span class="line">		    	&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">		    		System.out.println(<span class="string">"欢迎用户  "</span>+user+<span class="string">"  登录成功"</span>);</span><br><span class="line">		    	&#125;</span><br><span class="line">			&#125;</span><br><span class="line">			</span><br><span class="line">		&#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;<span class="keyword">finally</span>&#123;</span><br><span class="line">			DBUtil.CloseAll(rs, stat, conn);</span><br><span class="line">		&#125;</span><br><span class="line">	    input.close();</span><br><span class="line">	   </span><br><span class="line">	    </span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="7-SQL-注入"><a href="#7-SQL-注入" class="headerlink" title="7  SQL 注入"></a>7  SQL 注入</h1><blockquote>
<p>‘ or 1 = ‘1</p>
<p>？ 表示占位符</p>
<p><code>PreparedStatment</code>  预处理处理器</p>
</blockquote>
<h4 id><a href="#" class="headerlink" title=" "></a> </h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.szxy.login;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.sql.Connection;</span><br><span class="line"><span class="keyword">import</span> java.sql.PreparedStatement;</span><br><span class="line"><span class="keyword">import</span> java.sql.ResultSet;</span><br><span class="line"><span class="keyword">import</span> java.sql.SQLException;</span><br><span class="line"><span class="keyword">import</span> java.sql.Statement;</span><br><span class="line"><span class="keyword">import</span> java.util.Scanner;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> cn.szxy.Util.DBUtil;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 使用 Statement 的 PreparedStatement 子接口</span></span><br><span class="line"><span class="comment"> * 采用 占位符 ？</span></span><br><span class="line"><span class="comment"> * 执行 SQL 效率高 安全性好</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> wzer</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Login2</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		Scanner input = <span class="keyword">new</span> Scanner(System.in);</span><br><span class="line">		System.out.println(<span class="string">"请输入用户名："</span>);</span><br><span class="line">		String user = input.next();</span><br><span class="line">		System.out.println(<span class="string">"请输入密码"</span>);</span><br><span class="line">		String password = input.next();</span><br><span class="line">		</span><br><span class="line">		Connection conn = DBUtil.getConnection();</span><br><span class="line">		</span><br><span class="line">		<span class="comment">// ? 占位符</span></span><br><span class="line">		String sql = <span class="string">"select count(*) from T_user where tuser=? and tpassword = ?"</span>;</span><br><span class="line">		System.out.println(sql);</span><br><span class="line"></span><br><span class="line">		PreparedStatement pstat = <span class="keyword">null</span>;</span><br><span class="line">		ResultSet rs = <span class="keyword">null</span>;</span><br><span class="line">	    <span class="keyword">try</span> &#123;</span><br><span class="line">	    	<span class="comment">// 预处理发射器</span></span><br><span class="line">			pstat = conn.prepareStatement(sql);</span><br><span class="line">			<span class="comment">//填 占位符</span></span><br><span class="line">	    	pstat.setString(<span class="number">1</span>, user);</span><br><span class="line">			pstat.setString(<span class="number">2</span>, password);</span><br><span class="line">	    	rs = pstat.executeQuery();</span><br><span class="line">			<span class="keyword">if</span>(rs.next())&#123;</span><br><span class="line">		    	<span class="keyword">if</span>(rs.getInt(<span class="number">1</span>) == <span class="number">0</span>)&#123;</span><br><span class="line">		    		System.out.println(<span class="string">"用户名或密码错误"</span>);</span><br><span class="line">		    	&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">		    		System.out.println(<span class="string">"欢迎用户  "</span>+user+<span class="string">"  登录成功"</span>);</span><br><span class="line">		    	&#125;</span><br><span class="line">			&#125;</span><br><span class="line">			</span><br><span class="line">		&#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;<span class="keyword">finally</span>&#123;<span class="comment">//  pstat 向上转型 从子类接口向父类接口转变  --使用多态</span></span><br><span class="line">			DBUtil.CloseAll(rs, pstat, conn);</span><br><span class="line">		&#125;</span><br><span class="line">	    input.close();</span><br><span class="line">	   </span><br><span class="line">	    </span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="8-封装-PreparedStatement"><a href="#8-封装-PreparedStatement" class="headerlink" title="8  封装 PreparedStatement"></a>8  封装 PreparedStatement</h1><ul>
<li>DBUtil.java</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.bjsxt.util;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.sql.Connection;</span><br><span class="line"><span class="keyword">import</span> java.sql.DriverManager;</span><br><span class="line"><span class="keyword">import</span> java.sql.PreparedStatement;</span><br><span class="line"><span class="keyword">import</span> java.sql.ResultSet;</span><br><span class="line"><span class="keyword">import</span> java.sql.SQLException;</span><br><span class="line"><span class="keyword">import</span> java.sql.Statement;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DBUtil</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String DRIVER = <span class="string">"oracle.jdbc.OracleDriver"</span>;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String URL = <span class="string">"jdbc:oracle:thin:@localhost:1521:orcl"</span>;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String USER = <span class="string">"bjsxt"</span>;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String PASSWORD = <span class="string">"123"</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">static</span> &#123;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			<span class="comment">// 注册驱动</span></span><br><span class="line">			Class.forName(DRIVER);</span><br><span class="line">		&#125; <span class="keyword">catch</span> (ClassNotFoundException e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * 获取数据库连接</span></span><br><span class="line"><span class="comment">	 * </span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Connection <span class="title">getConn</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		Connection conn = <span class="keyword">null</span>;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			conn = DriverManager.getConnection(URL, USER, PASSWORD);</span><br><span class="line">		&#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">			System.out.println(</span><br><span class="line">					<span class="string">"DBUtil.getConn(连接创建失败, 请检查[url]:"</span> + URL + <span class="string">", [user]:"</span> + USER + <span class="string">", [password]:"</span> + PASSWORD + <span class="string">")"</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> conn;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * 获取SQL发送器</span></span><br><span class="line"><span class="comment">	 * </span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@param</span> conn</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Statement <span class="title">getStmt</span><span class="params">(Connection conn)</span> </span>&#123;</span><br><span class="line">		Statement stmt = <span class="keyword">null</span>;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			stmt = conn.createStatement();</span><br><span class="line">		&#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> stmt;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * 获取预处理发送器</span></span><br><span class="line"><span class="comment">	 * </span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@param</span> conn</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@param</span> sql</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> PreparedStatement <span class="title">getPstmt</span><span class="params">(Connection conn, String sql)</span> </span>&#123;</span><br><span class="line">		PreparedStatement pstmt = <span class="keyword">null</span>;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			pstmt = conn.prepareStatement(sql);</span><br><span class="line">		&#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> pstmt;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * 动态绑定参数</span></span><br><span class="line"><span class="comment">	 * </span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@param</span> pstmt</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@param</span> params</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">bindParam</span><span class="params">(PreparedStatement pstmt, Object... params)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= params.length; i++) &#123;</span><br><span class="line">				pstmt.setObject(i, params[i - <span class="number">1</span>]);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * 统一关闭资源</span></span><br><span class="line"><span class="comment">	 * </span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@param</span> rs</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@param</span> stmt</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@param</span> conn</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">close</span><span class="params">(ResultSet rs, Statement stmt, Connection conn)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">if</span> (rs != <span class="keyword">null</span>) &#123;</span><br><span class="line">			<span class="keyword">try</span> &#123;</span><br><span class="line">				rs.close();</span><br><span class="line">			&#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">				e.printStackTrace();</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> (stmt != <span class="keyword">null</span>) &#123;</span><br><span class="line">			<span class="keyword">try</span> &#123;</span><br><span class="line">				stmt.close();</span><br><span class="line">			&#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">				e.printStackTrace();</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> (conn != <span class="keyword">null</span>) &#123;</span><br><span class="line">			<span class="keyword">try</span> &#123;</span><br><span class="line">				conn.close();</span><br><span class="line">			&#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">				e.printStackTrace();</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>Login2.java</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.szxy.login;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.sql.Connection;</span><br><span class="line"><span class="keyword">import</span> java.sql.PreparedStatement;</span><br><span class="line"><span class="keyword">import</span> java.sql.ResultSet;</span><br><span class="line"><span class="keyword">import</span> java.sql.SQLException;</span><br><span class="line"><span class="keyword">import</span> java.sql.Statement;</span><br><span class="line"><span class="keyword">import</span> java.util.Scanner;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> cn.szxy.Util.DBUtil;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 使用 Statement 的 PreparedStatement 子接口</span></span><br><span class="line"><span class="comment"> * 采用 占位符 ？</span></span><br><span class="line"><span class="comment"> * 执行 SQL 效率高 安全性好</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> wzer</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Login2</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		Scanner input = <span class="keyword">new</span> Scanner(System.in);</span><br><span class="line">		System.out.println(<span class="string">"请输入用户名："</span>);</span><br><span class="line">		String user = input.next();</span><br><span class="line">		System.out.println(<span class="string">"请输入密码"</span>);</span><br><span class="line">		String password = input.next();</span><br><span class="line">		</span><br><span class="line">		Connection conn = DBUtil.getConnection();</span><br><span class="line">		</span><br><span class="line">		<span class="comment">// ? 占位符</span></span><br><span class="line">		String sql = <span class="string">"select count(*) from T_user where tuser=? and tpassword = ?"</span>;</span><br><span class="line">		System.out.println(sql);</span><br><span class="line">		</span><br><span class="line">		PreparedStatement pstat = <span class="keyword">null</span>;</span><br><span class="line">		ResultSet rs = <span class="keyword">null</span>;</span><br><span class="line">	    <span class="keyword">try</span> &#123;</span><br><span class="line">	    	<span class="comment">// 预处理发射器</span></span><br><span class="line">			pstat = DBUtil.getPreparedStatement(conn, sql);</span><br><span class="line">			<span class="comment">//填 占位符</span></span><br><span class="line">			DBUtil.bindParam(pstat,user,password);</span><br><span class="line">	    	rs = pstat.executeQuery();</span><br><span class="line">			<span class="keyword">if</span>(rs.next())&#123;</span><br><span class="line">		    	<span class="keyword">if</span>(rs.getInt(<span class="number">1</span>) == <span class="number">0</span>)&#123;</span><br><span class="line">		    		System.out.println(<span class="string">"用户名或密码错误"</span>);</span><br><span class="line">		    	&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">		    		System.out.println(<span class="string">"欢迎用户  "</span>+user+<span class="string">"  登录成功"</span>);</span><br><span class="line">		    	&#125;</span><br><span class="line">			&#125;</span><br><span class="line">			</span><br><span class="line">		&#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;<span class="keyword">finally</span>&#123;<span class="comment">//  pstat 向上转型 从子类接口向父类接口转变  --使用多态</span></span><br><span class="line">			DBUtil.CloseAll(rs, pstat, conn);</span><br><span class="line">		&#125;</span><br><span class="line">	    input.close();</span><br><span class="line">	   </span><br><span class="line">	    </span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="9-Properties-类"><a href="#9-Properties-类" class="headerlink" title="9 Properties 类"></a>9 Properties 类</h1><blockquote>
<p>软编码： 将配置信息提取生成一个配置文件， 然后让程序在执行过程中， 读取配置信息</p>
<p>好处： 可以动态的获取配置信息， 有助于后续代码的维护</p>
<p>Java中， 提供了一个类， 叫Properties类， 用于读取properties配置文件</p>
<p>Eclipse 小技巧： ctrl + shirt + o 导包</p>
<p>trim()  去掉字符串两端的空格，提交程序的健壮性</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.szxy.Util;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.sql.Connection;</span><br><span class="line"><span class="keyword">import</span> java.sql.DriverManager;</span><br><span class="line"><span class="keyword">import</span> java.sql.PreparedStatement;</span><br><span class="line"><span class="keyword">import</span> java.sql.ResultSet;</span><br><span class="line"><span class="keyword">import</span> java.sql.SQLException;</span><br><span class="line"><span class="keyword">import</span> java.sql.Statement;</span><br><span class="line"><span class="keyword">import</span> java.util.Properties;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 数据库连接工具</span></span><br><span class="line"><span class="comment"> * 软编码： 将配置信息提取生成一个配置文件， 然后让程序在执行过程中， 读取配置信息</span></span><br><span class="line"><span class="comment"> * 好处： 可以动态的获取配置信息， 有助于后续代码的维护</span></span><br><span class="line"><span class="comment"> * </span></span><br><span class="line"><span class="comment"> * Java中， 提供了一个类， 叫Properties类， 用于读取properties配置文件</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> wzer</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DBUtil</span> </span>&#123;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> String driver;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> String url;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> String user;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> String password;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">static</span>&#123;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			<span class="comment">//创建 Properties 对象</span></span><br><span class="line">			Properties prop = <span class="keyword">new</span> Properties();</span><br><span class="line">			<span class="comment">//加载 db.properties 配置文件</span></span><br><span class="line">			prop.load(DBUtil.class.getClassLoader().getResourceAsStream(<span class="string">"db.properties"</span>));</span><br><span class="line">			<span class="comment">// 读取信息并进行初始化</span></span><br><span class="line">			driver = prop.getProperty(<span class="string">"jdbc.driver"</span>).trim();</span><br><span class="line">			url = prop.getProperty(<span class="string">"jdbc.url"</span>).trim();</span><br><span class="line">			user = prop.getProperty(<span class="string">"jdbc.user"</span>).trim();</span><br><span class="line">			password = prop.getProperty(<span class="string">"jdbc.password"</span>).trim();</span><br><span class="line">			</span><br><span class="line">			Class.forName(driver);</span><br><span class="line">		&#125; <span class="keyword">catch</span> (ClassNotFoundException e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * 建立数据库连接</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Connection <span class="title">getConnection</span><span class="params">()</span></span>&#123;</span><br><span class="line">		Connection conn = <span class="keyword">null</span>;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			conn = DriverManager.getConnection(url,user,password);</span><br><span class="line">		&#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">			System.out.println(</span><br><span class="line">					<span class="string">"DBUtil.getConnection([URL:]"</span>+url+<span class="string">"[USER:]"</span>+user+<span class="string">"[PASSWORD:]"</span>+password+<span class="string">""</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> conn;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * 创建 发射器</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@param</span> conn</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Statement <span class="title">getStatement</span><span class="params">(Connection conn)</span></span>&#123;</span><br><span class="line">		Statement stat = <span class="keyword">null</span>;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			stat = conn.createStatement();</span><br><span class="line">		&#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> stat;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * 预处理编译器</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@param</span> conn</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@param</span> sql</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> PreparedStatement  <span class="title">getPreparedStatement</span><span class="params">(Connection conn,String sql)</span></span>&#123;</span><br><span class="line">		PreparedStatement pstat = <span class="keyword">null</span>;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			pstat = conn.prepareStatement(sql);</span><br><span class="line">		&#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> pstat;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * 绑定参数</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@param</span> pstat</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@param</span> params</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">bindParam</span><span class="params">(PreparedStatement pstat,Object ...params)</span></span>&#123;</span><br><span class="line">		<span class="comment">// i从 1 开始是因为数据库的索引从 1 开始</span></span><br><span class="line">		<span class="comment">// params 是一个数组，下标从 0 开始</span></span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=params.length;i++)&#123;</span><br><span class="line">			<span class="keyword">try</span> &#123;</span><br><span class="line">				pstat.setObject(i, params[i-<span class="number">1</span>]);</span><br><span class="line">			&#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">				e.printStackTrace();</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * 统一关闭资源</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@param</span> rs</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@param</span> stat</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@param</span> conn</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">CloseAll</span><span class="params">(ResultSet rs,Statement stat,Connection conn)</span></span>&#123;</span><br><span class="line">		<span class="keyword">if</span>(rs != <span class="keyword">null</span>)&#123;</span><br><span class="line">			<span class="keyword">try</span> &#123;</span><br><span class="line">				rs.close();</span><br><span class="line">			&#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">				e.printStackTrace();</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span>(stat!= <span class="keyword">null</span>)&#123;</span><br><span class="line">			<span class="keyword">try</span> &#123;</span><br><span class="line">				stat.close();</span><br><span class="line">			&#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">				e.printStackTrace();</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span>(conn != <span class="keyword">null</span>)&#123;</span><br><span class="line">			<span class="keyword">try</span> &#123;</span><br><span class="line">				conn.close();</span><br><span class="line">			&#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">				e.printStackTrace();</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>注意</strong>： 配置文件的位置 在 <u>src 目录下</u>，不是 DBUtil.java 所在的包下,不然找不到文件位置，报空指针异常</p>
<h1 id="10-通过-Statement-插入数据"><a href="#10-通过-Statement-插入数据" class="headerlink" title="10  通过 Statement 插入数据"></a>10  通过 Statement 插入数据</h1><blockquote>
<p>目标： 比较 执行 SQL 的效率</p>
<p>SQL语句：truncate  table  表名        - -  清除表格  </p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.szxy;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.sql.Connection;</span><br><span class="line"><span class="keyword">import</span> java.sql.SQLException;</span><br><span class="line"><span class="keyword">import</span> java.sql.Statement;</span><br><span class="line"><span class="keyword">import</span> java.util.UUID;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> cn.szxy.Util.DBUtil;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestStatement</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		<span class="comment">// 往表 T_num 中 插入 1000条数据</span></span><br><span class="line">		<span class="keyword">int</span> num = <span class="number">1000</span>;</span><br><span class="line">		<span class="keyword">long</span> start = System.currentTimeMillis();</span><br><span class="line">		<span class="comment">/*for(int i=0;i&lt;num;i++)&#123;</span></span><br><span class="line"><span class="comment">			insertNum1(i);	</span></span><br><span class="line"><span class="comment">		&#125;*/</span></span><br><span class="line">		insertNum2(<span class="number">1000</span>);  <span class="comment">//速度较 insertNum2()快</span></span><br><span class="line">		<span class="keyword">long</span> end = System.currentTimeMillis();</span><br><span class="line">		System.out.println(<span class="string">"时间: "</span>+(end-start)+<span class="string">"ms"</span>);</span><br><span class="line">	</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">insertNum2</span><span class="params">(<span class="keyword">int</span> num)</span> </span>&#123;</span><br><span class="line">		<span class="comment">//定义 SQL 语句</span></span><br><span class="line">		Connection conn = DBUtil.getConnection();</span><br><span class="line">		Statement stat = DBUtil.getStatement(conn);</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;num;i++)&#123;</span><br><span class="line">				String sql = <span class="string">"insert into T_num values('"</span>+getUUID()+<span class="string">"',"</span>+i+<span class="string">",'"</span>+getType(i)+<span class="string">"')"</span>;</span><br><span class="line">				System.out.println(sql);</span><br><span class="line">				stat.execute(sql);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;<span class="keyword">finally</span>&#123;</span><br><span class="line">			DBUtil.CloseAll(<span class="keyword">null</span>, stat, conn);</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * 插入一条数据</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@param</span> num</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">insertNum1</span><span class="params">(<span class="keyword">int</span> num)</span> </span>&#123;</span><br><span class="line">		<span class="comment">//定义 SQL 语句</span></span><br><span class="line">		String sql = <span class="string">"insert into T_num values('"</span>+getUUID()+<span class="string">"',"</span>+num+<span class="string">",'"</span>+getType(num)+<span class="string">"')"</span>;</span><br><span class="line">		System.out.println(sql);</span><br><span class="line">		Connection conn = DBUtil.getConnection();</span><br><span class="line">		Statement stat = DBUtil.getStatement(conn);</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			stat.execute(sql);</span><br><span class="line">		&#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;<span class="keyword">finally</span>&#123;</span><br><span class="line">			DBUtil.CloseAll(<span class="keyword">null</span>, stat, conn);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">private</span> <span class="keyword">static</span> String <span class="title">getType</span><span class="params">(<span class="keyword">int</span> num)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">if</span>(num &lt;<span class="number">4</span> )&#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="string">"ZS"</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">2</span>;i&lt;=Math.sqrt(num);i++)&#123;</span><br><span class="line">			<span class="keyword">if</span>(i%<span class="number">2</span>==<span class="number">0</span>)&#123;</span><br><span class="line">				<span class="keyword">return</span> <span class="string">"HS"</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> <span class="string">"ZS"</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * 生成 UUID</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">private</span> <span class="keyword">static</span> String <span class="title">getUUID</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> UUID.randomUUID().toString().replaceAll(<span class="string">"-"</span>, <span class="string">""</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="总结："><a href="#总结：" class="headerlink" title="总结："></a>总结：</h5><p>​    java.util 包下 UUID 类中静态方法 randomUUID() 可以生成一串字符序列</p>
<p>​    在上面进行 插入语句测试中，发现 数据库的连接和关闭耗费的资源比较多，而且耗费的时间也长。在数据库使用，减少数据库连接和关闭的次数，可以大幅提高执行 SQL 语句的效率</p>
<h1 id="11-使用-PreparedStatement-插入数据"><a href="#11-使用-PreparedStatement-插入数据" class="headerlink" title="11 使用 PreparedStatement 插入数据"></a>11 使用 PreparedStatement 插入数据</h1><blockquote>
<p>提高 执行 SQL 的效率:</p>
<p>关闭自动提交事务</p>
<p>批处理提交 SQL 语句</p>
</blockquote>
<h4 id="1-使用-PreparedStatement-的批处理功能："><a href="#1-使用-PreparedStatement-的批处理功能：" class="headerlink" title="1 使用  PreparedStatement 的批处理功能："></a>1 使用  PreparedStatement 的批处理功能：</h4><p><code>addBatch()</code>  加入批处理，相同于加入缓冲区</p>
<p><code>executeBatch()</code> 执行批处理</p>
<h4 id="2-代码-Demo"><a href="#2-代码-Demo" class="headerlink" title="2 代码 Demo"></a>2 代码 Demo</h4><h5 id="2-1-使用-PreparedStatement-预处理发射器"><a href="#2-1-使用-PreparedStatement-预处理发射器" class="headerlink" title="2.1 使用 PreparedStatement 预处理发射器"></a>2.1 使用 PreparedStatement 预处理发射器</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 使用 PreparedStatement 预处理发射器</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> num</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">insertNum3</span><span class="params">(<span class="keyword">int</span> num)</span> </span>&#123;</span><br><span class="line">	Connection conn = DBUtil.getConnection();</span><br><span class="line">	String sql = <span class="string">"insert into T_num values(?,?,?)"</span>; </span><br><span class="line">	PreparedStatement pstat = DBUtil.getPreparedStatement(conn, sql);</span><br><span class="line">	<span class="keyword">try</span> &#123;</span><br><span class="line">			<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;num;i++)&#123;</span><br><span class="line">			DBUtil.bindParam(pstat, getUUID(),i,getType(i));</span><br><span class="line">			pstat.executeUpdate();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">		e.printStackTrace();</span><br><span class="line">	&#125;<span class="keyword">finally</span>&#123;</span><br><span class="line">		DBUtil.CloseAll(<span class="keyword">null</span>, pstat, conn);</span><br><span class="line">	&#125;	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="2-2-使用-PreparedStatement，并统一提交事务"><a href="#2-2-使用-PreparedStatement，并统一提交事务" class="headerlink" title="2.2  使用 PreparedStatement，并统一提交事务"></a>2.2  使用 PreparedStatement，并统一提交事务</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * PreparedStatement 预处理发射器</span></span><br><span class="line"><span class="comment"> * 关闭 自动提交事务</span></span><br><span class="line"><span class="comment"> * 统一提交事务</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> num</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">insertNum4</span><span class="params">(<span class="keyword">int</span> num)</span> </span>&#123;</span><br><span class="line">	Connection conn = DBUtil.getConnection();</span><br><span class="line">	String sql = <span class="string">"insert into T_num values(?,?,?)"</span>; </span><br><span class="line">	PreparedStatement pstat = DBUtil.getPreparedStatement(conn, sql);</span><br><span class="line">	<span class="keyword">try</span> &#123;</span><br><span class="line">			<span class="comment">//关闭事务自动提交</span></span><br><span class="line">			conn.setAutoCommit(<span class="keyword">false</span>);</span><br><span class="line">			<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;num;i++)&#123;</span><br><span class="line">			DBUtil.bindParam(pstat, getUUID(),i,getType(i));</span><br><span class="line">			pstat.executeUpdate();</span><br><span class="line">		&#125;</span><br><span class="line">			<span class="comment">//提交事务</span></span><br><span class="line">			conn.commit();</span><br><span class="line">	&#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">		e.printStackTrace();</span><br><span class="line">	&#125;<span class="keyword">finally</span>&#123;</span><br><span class="line">		DBUtil.CloseAll(<span class="keyword">null</span>, pstat, conn);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="2-3-使用-PreparedStatement-的批处理，并统一提交事务"><a href="#2-3-使用-PreparedStatement-的批处理，并统一提交事务" class="headerlink" title="2.3  使用 PreparedStatement 的批处理，并统一提交事务"></a>2.3  使用 PreparedStatement 的批处理，并统一提交事务</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * PreparedStatement 预处理发射器</span></span><br><span class="line"><span class="comment"> * 使用 批处理</span></span><br><span class="line"><span class="comment"> * 统一提交事务</span></span><br><span class="line"><span class="comment"> * </span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> num</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">insertNum5</span><span class="params">(<span class="keyword">int</span> num)</span> </span>&#123;</span><br><span class="line">	Connection conn = DBUtil.getConnection();</span><br><span class="line">	String sql = <span class="string">"insert into T_num values(?,?,?)"</span>; </span><br><span class="line">	PreparedStatement pstat = DBUtil.getPreparedStatement(conn, sql);</span><br><span class="line">	<span class="keyword">try</span> &#123;</span><br><span class="line">			<span class="comment">//关闭事务自动提交</span></span><br><span class="line">			conn.setAutoCommit(<span class="keyword">false</span>);</span><br><span class="line">			<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;num;i++)&#123;</span><br><span class="line">			DBUtil.bindParam(pstat, getUUID(),i,getType(i));</span><br><span class="line">			<span class="comment">//添加到批处理</span></span><br><span class="line">			pstat.addBatch();</span><br><span class="line">			<span class="comment">//pstat.executeUpdate();</span></span><br><span class="line">		&#125;</span><br><span class="line">			<span class="comment">//执行批处理</span></span><br><span class="line">			pstat.executeBatch();</span><br><span class="line">			<span class="comment">//提价事务</span></span><br><span class="line">			conn.commit();</span><br><span class="line">	&#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">		e.printStackTrace();</span><br><span class="line">	&#125;<span class="keyword">finally</span>&#123;</span><br><span class="line">		DBUtil.CloseAll(<span class="keyword">null</span>, pstat, conn);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="2-4-完整代码"><a href="#2-4-完整代码" class="headerlink" title="2.4  完整代码"></a>2.4  完整代码</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.szxy;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.sql.Connection;</span><br><span class="line"><span class="keyword">import</span> java.sql.PreparedStatement;</span><br><span class="line"><span class="keyword">import</span> java.sql.SQLException;</span><br><span class="line"><span class="keyword">import</span> java.sql.Statement;</span><br><span class="line"><span class="keyword">import</span> java.util.UUID;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> cn.szxy.Util.DBUtil;</span><br><span class="line">	</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestStatement</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		<span class="comment">// 往表 T_num 中 插入 1000条数据</span></span><br><span class="line">		<span class="keyword">int</span> num = <span class="number">1000</span>;</span><br><span class="line">		<span class="keyword">long</span> start = System.currentTimeMillis();</span><br><span class="line">		<span class="comment">/*for(int i=0;i&lt;num;i++)&#123;</span></span><br><span class="line"><span class="comment">			insertNum1(i);	</span></span><br><span class="line"><span class="comment">		&#125;*/</span></span><br><span class="line">		<span class="comment">//insertNum2(1000);  //速度较 insertNum2()快</span></span><br><span class="line">		<span class="comment">//insertNum3(1000);</span></span><br><span class="line">		<span class="comment">//insertNum4(num);</span></span><br><span class="line">		insertNum5(<span class="number">10000</span>);</span><br><span class="line">		<span class="keyword">long</span> end = System.currentTimeMillis();</span><br><span class="line">		System.out.println(<span class="string">"时间: "</span>+(end-start)+<span class="string">"ms"</span>);</span><br><span class="line">	</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * PreparedStatement 预处理发射器</span></span><br><span class="line"><span class="comment">	 * 使用 批处理</span></span><br><span class="line"><span class="comment">	 * 统一提交事务</span></span><br><span class="line"><span class="comment">	 * </span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@param</span> num</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">insertNum5</span><span class="params">(<span class="keyword">int</span> num)</span> </span>&#123;</span><br><span class="line">		Connection conn = DBUtil.getConnection();</span><br><span class="line">		String sql = <span class="string">"insert into T_num values(?,?,?)"</span>; </span><br><span class="line">		PreparedStatement pstat = DBUtil.getPreparedStatement(conn, sql);</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">				<span class="comment">//关闭事务自动提交</span></span><br><span class="line">				conn.setAutoCommit(<span class="keyword">false</span>);</span><br><span class="line">				<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;num;i++)&#123;</span><br><span class="line">				DBUtil.bindParam(pstat, getUUID(),i,getType(i));</span><br><span class="line">				<span class="comment">//添加到批处理</span></span><br><span class="line">				pstat.addBatch();</span><br><span class="line">				<span class="comment">//pstat.executeUpdate();</span></span><br><span class="line">			&#125;</span><br><span class="line">				<span class="comment">//执行批处理</span></span><br><span class="line">				pstat.executeBatch();</span><br><span class="line">				<span class="comment">//提价事务</span></span><br><span class="line">				conn.commit();</span><br><span class="line">		&#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;<span class="keyword">finally</span>&#123;</span><br><span class="line">			DBUtil.CloseAll(<span class="keyword">null</span>, pstat, conn);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * PreparedStatement 预处理发射器</span></span><br><span class="line"><span class="comment">	 * 关闭 自动提交书屋</span></span><br><span class="line"><span class="comment">	 * 统一提交事务</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@param</span> num</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">insertNum4</span><span class="params">(<span class="keyword">int</span> num)</span> </span>&#123;</span><br><span class="line">		Connection conn = DBUtil.getConnection();</span><br><span class="line">		String sql = <span class="string">"insert into T_num values(?,?,?)"</span>; </span><br><span class="line">		PreparedStatement pstat = DBUtil.getPreparedStatement(conn, sql);</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">				<span class="comment">//关闭事务自动提交</span></span><br><span class="line">				conn.setAutoCommit(<span class="keyword">false</span>);</span><br><span class="line">				<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;num;i++)&#123;</span><br><span class="line">				DBUtil.bindParam(pstat, getUUID(),i,getType(i));</span><br><span class="line">				pstat.executeUpdate();</span><br><span class="line">			&#125;</span><br><span class="line">				<span class="comment">//提价事务</span></span><br><span class="line">				conn.commit();</span><br><span class="line">		&#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;<span class="keyword">finally</span>&#123;</span><br><span class="line">			DBUtil.CloseAll(<span class="keyword">null</span>, pstat, conn);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * 使用 PreparedStatement 预处理发射器</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@param</span> num</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">insertNum3</span><span class="params">(<span class="keyword">int</span> num)</span> </span>&#123;</span><br><span class="line">		Connection conn = DBUtil.getConnection();</span><br><span class="line">		String sql = <span class="string">"insert into T_num values(?,?,?)"</span>; </span><br><span class="line">		PreparedStatement pstat = DBUtil.getPreparedStatement(conn, sql);</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">				<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;num;i++)&#123;</span><br><span class="line">				DBUtil.bindParam(pstat, getUUID(),i,getType(i));</span><br><span class="line">				pstat.executeUpdate();</span><br><span class="line">			&#125;</span><br><span class="line">		&#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;<span class="keyword">finally</span>&#123;</span><br><span class="line">			DBUtil.CloseAll(<span class="keyword">null</span>, pstat, conn);</span><br><span class="line">		&#125;	</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * Statement 发射器</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@param</span> num</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">insertNum2</span><span class="params">(<span class="keyword">int</span> num)</span> </span>&#123;</span><br><span class="line">		Connection conn = DBUtil.getConnection();</span><br><span class="line">		Statement stat = DBUtil.getStatement(conn);</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;num;i++)&#123;</span><br><span class="line">				<span class="comment">//定义 SQL 语句</span></span><br><span class="line">				String sql = <span class="string">"insert into T_num values('"</span>+getUUID()+<span class="string">"',"</span>+i+<span class="string">",'"</span>+getType(i)+<span class="string">"')"</span>;</span><br><span class="line">				System.out.println(sql);</span><br><span class="line">				stat.execute(sql);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;<span class="keyword">finally</span>&#123;</span><br><span class="line">			DBUtil.CloseAll(<span class="keyword">null</span>, stat, conn);</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * 插入一条数据</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@param</span> num</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">insertNum1</span><span class="params">(<span class="keyword">int</span> num)</span> </span>&#123;</span><br><span class="line">		<span class="comment">//定义 SQL 语句</span></span><br><span class="line">		String sql = <span class="string">"insert into T_num values('"</span>+getUUID()+<span class="string">"',"</span>+num+<span class="string">",'"</span>+getType(num)+<span class="string">"')"</span>;</span><br><span class="line">		System.out.println(sql);</span><br><span class="line">		Connection conn = DBUtil.getConnection();</span><br><span class="line">		Statement stat = DBUtil.getStatement(conn);</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			stat.execute(sql);</span><br><span class="line">		&#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;<span class="keyword">finally</span>&#123;</span><br><span class="line">			DBUtil.CloseAll(<span class="keyword">null</span>, stat, conn);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * 获得 num 的类型</span></span><br><span class="line"><span class="comment">	 * 是合数还是质数</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@param</span> num</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">private</span> <span class="keyword">static</span> String <span class="title">getType</span><span class="params">(<span class="keyword">int</span> num)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">if</span>(num &lt;<span class="number">4</span> )&#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="string">"ZS"</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">2</span>;i&lt;=Math.sqrt(num);i++)&#123;</span><br><span class="line">			<span class="keyword">if</span>(i%<span class="number">2</span>==<span class="number">0</span>)&#123;</span><br><span class="line">				<span class="keyword">return</span> <span class="string">"HS"</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> <span class="string">"ZS"</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * 生成 UUID</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">private</span> <span class="keyword">static</span> String <span class="title">getUUID</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> UUID.randomUUID().toString().replaceAll(<span class="string">"-"</span>, <span class="string">""</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="3-总结："><a href="#3-总结：" class="headerlink" title="3  总结："></a>3  总结：</h4><p>​    a. 使用 PreparedStatent 的效率比 Statement 高</p>
<p>​    b. 在 统一提交事务，可以提高 JDBC 执行 SQL 语句的效率</p>
<p>​    c. 使用 PreparedStatement 批处理能有效的提高 JDBC 执行 SQL 语句的效率</p>
<h1 id="12-ORM-对象关系模型"><a href="#12-ORM-对象关系模型" class="headerlink" title="12  ORM  对象关系模型"></a>12  ORM  对象关系模型</h1><blockquote>
<p>ORM  oject relational model  对象关系模型</p>
<p>将 二维表的数据，转换为对象</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> Map&lt;String, Integer&gt; <span class="title">CountNum</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		Map&lt;String,Integer&gt; map = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">		<span class="comment">// 定义 SQL 语句</span></span><br><span class="line">		String sql = <span class="string">"select type,count(*) from T_num group by type"</span>;</span><br><span class="line">		<span class="comment">// 获得数据库连接</span></span><br><span class="line">		Connection conn = DBUtil.getConnection();</span><br><span class="line">		<span class="comment">// 创建发射器</span></span><br><span class="line">		PreparedStatement pstat = DBUtil.getPreparedStatement(conn, sql);</span><br><span class="line">		<span class="comment">//  结果集</span></span><br><span class="line">		ResultSet rs = <span class="keyword">null</span>;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			rs = pstat.executeQuery();</span><br><span class="line">			<span class="keyword">while</span>(rs.next())&#123;</span><br><span class="line">				String type = rs.getString(<span class="string">"Type"</span>);</span><br><span class="line">				<span class="keyword">int</span> counter = rs.getInt(<span class="number">2</span>);</span><br><span class="line">				map.put(type, counter);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;<span class="keyword">finally</span>&#123;</span><br><span class="line">			DBUtil.CloseAll(rs, pstat, conn);</span><br><span class="line">		&#125;</span><br><span class="line">				</span><br><span class="line">		<span class="keyword">return</span> map;</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<h1 id="13-分层开发-环境搭建"><a href="#13-分层开发-环境搭建" class="headerlink" title="13 分层开发   环境搭建"></a>13 分层开发   环境搭建</h1><blockquote>
<p>a&gt; 当一个项目功能比较多，代码量比较大的时候，需要使用分层开发,便于团队协作</p>
<p>b&gt;  ORM Object Relational Mapping, 对象关系映射</p>
<p>c&gt; 代码的分层是通过包（package）来区分的，常见的包名：</p>
<ul>
<li>实体类: entity，bean，pojo</li>
<li>工具类: Util</li>
<li>数据访问层: dao，Dao Access Object 用于和数据库进行交互，通过用于定义接口</li>
</ul>
<p>// Alt +  Shift + S    –&gt; r  –&gt;  Alt +a </p>
<p>实体类的特征：</p>
<ol>
<li>私有化的成员变量</li>
<li>公开的 getter 和 setter方法</li>
<li>至少提供一个无参构造器</li>
<li>重写 hashcode 方法</li>
<li>重写 equal 方法</li>
<li>实现 序列化接口</li>
</ol>
</blockquote>
<h4 id="13-1-代码-Demo"><a href="#13-1-代码-Demo" class="headerlink" title="13.1  代码 Demo"></a>13.1  代码 Demo</h4><ul>
<li>EmpDao.java </li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.szxy.dao;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> cn.szxy.pojo.Emp;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">EmpDao</span> </span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * 查询所有雇员信息</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function">List&lt;Emp&gt; <span class="title">findAll</span><span class="params">()</span></span>;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * 根据雇员的 ID 查询雇员信息</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@param</span> empno</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function">Emp  <span class="title">findByIdEmp</span><span class="params">(<span class="keyword">int</span> empno)</span></span>;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * 添加雇员</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@param</span> emp</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">boolean</span> <span class="title">insertEmp</span><span class="params">(Emp emp)</span></span>;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * 更新雇员信息</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@param</span> emp</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">boolean</span> <span class="title">updateEmp</span><span class="params">(Emp emp)</span></span>;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * 删除雇员</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@param</span> empno</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">boolean</span> <span class="title">deleteEmp</span><span class="params">(<span class="keyword">int</span> empno)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li><p>BaseDao.java</p>
<blockquote>
<p>使用 BeanUtils 封装查询方法</p>
</blockquote>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.szxy.dao;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.InvocationTargetException;</span><br><span class="line"><span class="keyword">import</span> java.sql.Connection;</span><br><span class="line"><span class="keyword">import</span> java.sql.PreparedStatement;</span><br><span class="line"><span class="keyword">import</span> java.sql.ResultSet;</span><br><span class="line"><span class="keyword">import</span> java.sql.ResultSetMetaData;</span><br><span class="line"><span class="keyword">import</span> java.sql.SQLException;</span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.commons.beanutils.BeanUtils;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> cn.szxy.Util.DBUtil;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BaseDao</span></span>&#123;</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * 执行 DML 语句(增删改)</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@param</span> sql</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@param</span> parmas</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">update</span><span class="params">(String sql,Object ... params)</span></span>&#123;</span><br><span class="line">		Connection conn = <span class="keyword">null</span>;</span><br><span class="line">		PreparedStatement pstat = <span class="keyword">null</span>;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			conn = DBUtil.getConnection();</span><br><span class="line">			pstat = DBUtil.getPreparedStatement(conn, sql);</span><br><span class="line">			DBUtil.bindParam(pstat, params);</span><br><span class="line">			<span class="keyword">int</span> row = pstat.executeUpdate(); <span class="comment">//执行更新语句</span></span><br><span class="line">			<span class="keyword">if</span>(row &gt; <span class="number">0</span>)&#123;</span><br><span class="line">				<span class="keyword">return</span> <span class="keyword">true</span>;  <span class="comment">//执行更新语句成功</span></span><br><span class="line">			&#125;</span><br><span class="line">		&#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;<span class="keyword">finally</span>&#123;</span><br><span class="line">			DBUtil.CloseAll(<span class="keyword">null</span>, pstat, conn);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">public</span> &lt;T&gt; <span class="function">List&lt;T&gt; <span class="title">queryAll</span><span class="params">(Class&lt;T&gt; cls,String sql,Object ... params)</span></span>&#123;</span><br><span class="line">		List&lt;T&gt; list = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">		Connection conn = DBUtil.getConnection();</span><br><span class="line">		PreparedStatement pstat = DBUtil.getPreparedStatement(conn, sql);</span><br><span class="line">		DBUtil.bindParam(pstat, params);</span><br><span class="line">		ResultSet rs = <span class="keyword">null</span>;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			rs =  pstat.executeQuery();</span><br><span class="line">			ResultSetMetaData metaData = rs.getMetaData(); <span class="comment">// 元数据</span></span><br><span class="line">			<span class="keyword">while</span>(rs.next())&#123;</span><br><span class="line">				T bean =  cls.newInstance(); <span class="comment">//创建对象</span></span><br><span class="line">				<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;metaData.getColumnCount();i++)&#123;</span><br><span class="line">					<span class="comment">// 设置属性</span></span><br><span class="line">					BeanUtils.setProperty(bean, metaData.getColumnLabel(i+<span class="number">1</span>).toLowerCase(),rs.getObject(i+<span class="number">1</span>));					</span><br><span class="line">				&#125;</span><br><span class="line">				list.add(bean);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;<span class="keyword">finally</span>&#123;</span><br><span class="line">			DBUtil.CloseAll(rs, pstat, conn);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> list;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">protected</span> &lt;T&gt; <span class="function">T <span class="title">queryOne</span><span class="params">(Class&lt;T&gt; cls, String sql, Object... params)</span> </span>&#123;</span><br><span class="line">		Connection conn = DBUtil.getConnection();</span><br><span class="line">		PreparedStatement pstmt = DBUtil.getPreparedStatement(conn, sql);</span><br><span class="line">		DBUtil.bindParam(pstmt, params);</span><br><span class="line">		ResultSet rs = <span class="keyword">null</span>;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			rs = pstmt.executeQuery();</span><br><span class="line">			ResultSetMetaData metaData = rs.getMetaData();</span><br><span class="line">			<span class="keyword">if</span>(rs.next()) &#123;</span><br><span class="line">				T bean = cls.newInstance();</span><br><span class="line">				<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;metaData.getColumnCount(); i++) &#123;</span><br><span class="line">					BeanUtils.setProperty(bean, metaData.getColumnLabel(i + <span class="number">1</span>).toLowerCase(), rs.getObject(i + <span class="number">1</span>));</span><br><span class="line">				&#125;</span><br><span class="line">				<span class="keyword">return</span> bean;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">			DBUtil.CloseAll(<span class="keyword">null</span>, pstmt, conn);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>EmpDaoImpl.java</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.szxy.dao.Impl;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.sql.Connection;</span><br><span class="line"><span class="keyword">import</span> java.sql.Date;</span><br><span class="line"><span class="keyword">import</span> java.sql.PreparedStatement;</span><br><span class="line"><span class="keyword">import</span> java.sql.ResultSet;</span><br><span class="line"><span class="keyword">import</span> java.sql.SQLException;</span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> cn.szxy.Util.DBUtil;</span><br><span class="line"><span class="keyword">import</span> cn.szxy.dao.BaseDao;</span><br><span class="line"><span class="keyword">import</span> cn.szxy.dao.EmpDao;</span><br><span class="line"><span class="keyword">import</span> cn.szxy.pojo.Emp;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">EmpDaoImpl</span> <span class="keyword">extends</span> <span class="title">BaseDao</span> <span class="keyword">implements</span> <span class="title">EmpDao</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> List&lt;Emp&gt; <span class="title">findAll</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		String sql = <span class="string">"select * from emp"</span>;</span><br><span class="line">		<span class="keyword">return</span> queryAll(Emp.class, sql);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> Emp <span class="title">findByIdEmp</span><span class="params">(<span class="keyword">int</span> empno)</span> </span>&#123;</span><br><span class="line">		String sql = <span class="string">"select * from emp where empno = ?"</span>;</span><br><span class="line">		<span class="keyword">return</span> queryOne(Emp.class, sql,empno);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">insertEmp</span><span class="params">(Emp emp)</span></span>&#123;</span><br><span class="line">		String sql = <span class="string">"insert into emp values(?,?,?,?,?,?,?,?)"</span>;</span><br><span class="line">		Object[] obj = &#123;</span><br><span class="line">		            emp.getEmpno(),</span><br><span class="line">		            emp.getEname(),</span><br><span class="line">		            emp.getJob(),</span><br><span class="line">		            emp.getMgr(),</span><br><span class="line">		            emp.getHirdate(),</span><br><span class="line">		            emp.getSal(),</span><br><span class="line">		            emp.getComm(),</span><br><span class="line">		            emp.getDeptno()</span><br><span class="line">		&#125;;</span><br><span class="line">		<span class="keyword">return</span> update(sql,obj);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">deleteEmp</span><span class="params">(<span class="keyword">int</span> empno)</span> </span>&#123;</span><br><span class="line">		String sql = <span class="string">"delete from emp where empno = ?"</span>;</span><br><span class="line">		<span class="keyword">return</span> update(sql,empno);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">updateBySalEmp</span><span class="params">(<span class="keyword">int</span> empno , <span class="keyword">double</span> sal)</span> </span>&#123;</span><br><span class="line">		String sql = <span class="string">"update emp set sal=? where empno=?	"</span>;</span><br><span class="line">		<span class="keyword">return</span> update(sql,sal,empno);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


    </div>

    
    
    
        
      

      <footer class="post-footer">
          
            
          
          <div class="post-tags">
            
              <a href="/tags/JDBC/" rel="tag"># JDBC</a>
            
          </div>
        

        

          <div class="post-nav">
            <div class="post-nav-next post-nav-item">
              
                <a href="/2018/12/10/数据库/20181210 数据库设计范式/" rel="next" title="数据库设计范式">
                  <i class="fa fa-chevron-left"></i> 数据库设计范式
                </a>
              
            </div>

            <span class="post-nav-divider"></span>

            <div class="post-nav-prev post-nav-item">
              
                <a href="/2018/12/28/数据库/20181228 MyBatis 框架/" rel="prev" title="2018 MyBatis 框架">
                  2018 MyBatis 框架 <i class="fa fa-chevron-right"></i>
                </a>
              
            </div>
          </div>
        
      </footer>
    
  </div>
  
  
  
  </article>

  </div>


          </div>
          

        </div>
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">
        
        
        
        
      

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#1-JDBC-简介"><span class="nav-number">1.</span> <span class="nav-text">1 JDBC 简介</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#2-JDBC-连接数据库的步骤"><span class="nav-number">2.</span> <span class="nav-text">2 JDBC 连接数据库的步骤</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#3-JDBC-异常处理-关闭资源"><span class="nav-number">3.</span> <span class="nav-text">3 JDBC 异常处理 关闭资源</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#4-JDBC-执行-DML-操作"><span class="nav-number">4.</span> <span class="nav-text">4 JDBC  执行 DML 操作</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#5-JSBC-事务操作"><span class="nav-number">5.</span> <span class="nav-text">5  JSBC 事务操作</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#6-JDBC-登录流程-封装工具类"><span class="nav-number">6.</span> <span class="nav-text">6  JDBC 登录流程 封装工具类</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#7-SQL-注入"><span class="nav-number">7.</span> <span class="nav-text">7  SQL 注入</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#null"><span class="nav-number">7.0.0.1.</span> <span class="nav-text"> </span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#8-封装-PreparedStatement"><span class="nav-number">8.</span> <span class="nav-text">8  封装 PreparedStatement</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#9-Properties-类"><span class="nav-number">9.</span> <span class="nav-text">9 Properties 类</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#10-通过-Statement-插入数据"><span class="nav-number">10.</span> <span class="nav-text">10  通过 Statement 插入数据</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#总结："><span class="nav-number">10.0.0.0.1.</span> <span class="nav-text">总结：</span></a></li></ol></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#11-使用-PreparedStatement-插入数据"><span class="nav-number">11.</span> <span class="nav-text">11 使用 PreparedStatement 插入数据</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-使用-PreparedStatement-的批处理功能："><span class="nav-number">11.0.0.1.</span> <span class="nav-text">1 使用  PreparedStatement 的批处理功能：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-代码-Demo"><span class="nav-number">11.0.0.2.</span> <span class="nav-text">2 代码 Demo</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#2-1-使用-PreparedStatement-预处理发射器"><span class="nav-number">11.0.0.2.1.</span> <span class="nav-text">2.1 使用 PreparedStatement 预处理发射器</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#2-2-使用-PreparedStatement，并统一提交事务"><span class="nav-number">11.0.0.2.2.</span> <span class="nav-text">2.2  使用 PreparedStatement，并统一提交事务</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#2-3-使用-PreparedStatement-的批处理，并统一提交事务"><span class="nav-number">11.0.0.2.3.</span> <span class="nav-text">2.3  使用 PreparedStatement 的批处理，并统一提交事务</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#2-4-完整代码"><span class="nav-number">11.0.0.2.4.</span> <span class="nav-text">2.4  完整代码</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-总结："><span class="nav-number">11.0.0.3.</span> <span class="nav-text">3  总结：</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#12-ORM-对象关系模型"><span class="nav-number">12.</span> <span class="nav-text">12  ORM  对象关系模型</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#13-分层开发-环境搭建"><span class="nav-number">13.</span> <span class="nav-text">13 分层开发   环境搭建</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#13-1-代码-Demo"><span class="nav-number">13.0.0.1.</span> <span class="nav-text">13.1  代码 Demo</span></a></li></ol></li></ol></li></ol></li></ol></div>
        
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">zwer</p>
  <div class="site-description" itemprop="description">记录学习的日常</div>
</div>
  <nav class="site-state motion-element">
      <div class="site-state-item site-state-posts">
        
          <a href="/archives/">
        
          <span class="site-state-item-count">74</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
    
      
      
      <div class="site-state-item site-state-categories">
        
        <span class="site-state-item-count">10</span>
        <span class="site-state-item-name">categories</span>
        
      </div>
    
      
      
      <div class="site-state-item site-state-tags">
        
        <span class="site-state-item-count">51</span>
        <span class="site-state-item-name">tags</span>
        
      </div>
    
  </nav>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love" id="animate">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">zwer</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io" class="theme-link" rel="noopener" target="_blank">Hexo</a> v3.9.0</div>
  <span class="post-meta-divider">|</span>
  <div class="theme-info">Theme – <a href="https://theme-next.org" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a> v7.4.0</div>

        












        
      </div>
    </footer>
  </div>

  


  <script src="/lib/anime.min.js?v=3.1.0"></script>
  <script src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  <script src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
<script src="/js/utils.js?v=7.4.0"></script><script src="/js/motion.js?v=7.4.0"></script>
<script src="/js/schemes/muse.js?v=7.4.0"></script>
<script src="/js/next-boot.js?v=7.4.0"></script>



  





















  

  

  

</body>
</html>
