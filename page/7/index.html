<!DOCTYPE html>





<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 3.9.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=7.4.0">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=7.4.0">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=7.4.0">
  <link rel="mask-icon" href="/images/logo.svg?v=7.4.0" color="#222">

<link rel="stylesheet" href="/css/main.css?v=7.4.0">


<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css?v=4.7.0">


<script id="hexo-configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '7.4.0',
    exturl: false,
    sidebar: {"position":"left","display":"post","offset":12,"onmobile":false},
    copycode: {"enable":false,"show_result":false,"style":null},
    back2top: {"enable":true,"sidebar":false,"scrollpercent":false},
    bookmark: {"enable":false,"color":"#222","save":"auto"},
    fancybox: false,
    mediumzoom: false,
    lazyload: false,
    pangu: false,
    algolia: {
      appID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    },
    localsearch: {"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},
    path: '',
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    translation: {
      copy_button: 'Copy',
      copy_success: 'Copied',
      copy_failure: 'Copy failed'
    },
    sidebarPadding: 40
  };
</script>

  <meta name="description" content="记录学习的日常">
<meta name="keywords" content="zwer">
<meta property="og:type" content="website">
<meta property="og:title" content="zwer 的博客空间">
<meta property="og:url" content="http://zwer.xyz/page/7/index.html">
<meta property="og:site_name" content="zwer 的博客空间">
<meta property="og:description" content="记录学习的日常">
<meta property="og:locale" content="en">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="zwer 的博客空间">
<meta name="twitter:description" content="记录学习的日常">
  <link rel="canonical" href="http://zwer.xyz/page/7/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome: true,
    isPost: false,
    isPage: false,
    isArchive: false
  };
</script>

  <title>zwer 的博客空间</title>
  








  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .logo,
  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="en">
  <div class="container use-motion">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-meta">

    <div>
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">zwer 的博客空间</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
        <p class="site-subtitle">上善若水 自强不息</p>
      
  </div>

  <div class="site-nav-toggle">
    <button aria-label="Toggle navigation bar">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>


<nav class="site-nav">
  
  <ul id="menu" class="menu">
      
      
      
        
        <li class="menu-item menu-item-home">
      
    

    <a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i> <br>Home</a>

  </li>
      
      
      
        
        <li class="menu-item menu-item-archives">
      
    

    <a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i> <br>Archives</a>

  </li>
  </ul>

    

</nav>
</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <div id="posts" class="posts-expand">
        <article itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block home">
    <link itemprop="mainEntityOfPage" href="http://zwer.xyz/2018/12/05/数据库/20181205 常用数据库对象/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="zwer">
      <meta itemprop="description" content="记录学习的日常">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="zwer 的博客空间">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
            
            <a href="/2018/12/05/数据库/20181205 常用数据库对象/" class="post-title-link" itemprop="url">20181205</a>
          
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              
                
              

              <time title="Created: 2018-12-05 00:00:00" itemprop="dateCreated datePublished" datetime="2018-12-05T00:00:00+08:00">2018-12-05</time>
            </span>
          
            

            
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2018-12-08 15:06:05" itemprop="dateModified" datetime="2018-12-08T15:06:05+08:00">2018-12-08</time>
              </span>
            
          
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/数据库/" itemprop="url" rel="index"><span itemprop="name">数据库</span></a></span>

                
                
              
            </span>
          

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h3 id="1-用户和权限"><a href="#1-用户和权限" class="headerlink" title="1  用户和权限"></a>1  用户和权限</h3><h4 id="1-1-用户的创建"><a href="#1-1-用户的创建" class="headerlink" title="1.1 用户的创建"></a>1.1 用户的创建</h4><p>a）语法</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">user</span>  用户名  <span class="keyword">identified</span> <span class="keyword">by</span> 密码</span><br></pre></td></tr></table></figure>

<p>b) 创建用户 实例</p>
<ul>
<li>需要用 DBA 权限</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span>   <span class="keyword">user</span> szxy ideatified <span class="keyword">by</span> <span class="number">123</span></span><br></pre></td></tr></table></figure>

<p> PS： <code>SQLPlus</code> 切换用户</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">conn 用户名</span><br><span class="line"><span class="keyword">show</span>  <span class="keyword">user</span>   <span class="comment">--显示当前登录的用户</span></span><br></pre></td></tr></table></figure>

<h4 id="1-2-用户的权限"><a href="#1-2-用户的权限" class="headerlink" title="1.2 用户的权限"></a>1.2 用户的权限</h4><p>Oracle 中权限很多，为了方便管理用户，提供了角色的概念</p>
<p>角色代表一个身份，该身份拥有固定的权限，常见的角色：</p>
<p>​    DBA：数据库管理员</p>
<p>​    CONNECTION :临时用户拥有少量的权限</p>
<p>​    RESOURCE:比较靠谱的用户，拥有更多的权限，不能管理数据库</p>
<br>

<ul>
<li>授权 grant</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">grant</span> <span class="keyword">connect</span>,<span class="keyword">resource</span> <span class="keyword">to</span> sxzy;</span><br></pre></td></tr></table></figure>

<ul>
<li>撤销权限 revoke </li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">revoke</span> <span class="keyword">resource</span> <span class="keyword">from</span> szxy;</span><br></pre></td></tr></table></figure>

<h4 id="1-3-删除用户-drop"><a href="#1-3-删除用户-drop" class="headerlink" title="1.3  删除用户 drop"></a>1.3  删除用户 drop</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">drop</span> <span class="keyword">user</span> szxy;</span><br></pre></td></tr></table></figure>

<h4 id="1-4-修改用户"><a href="#1-4-修改用户" class="headerlink" title="1.4 修改用户"></a>1.4 修改用户</h4><br>

<h5 id="1-4-1-修改用户密码"><a href="#1-4-1-修改用户密码" class="headerlink" title="1.4.1 修改用户密码"></a>1.4.1 修改用户密码</h5><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">alter</span>  <span class="keyword">user</span>  szxy <span class="keyword">identified</span> <span class="keyword">by</span> abc；</span><br></pre></td></tr></table></figure>

<h5 id="1-4-2-锁定用户和解锁用户"><a href="#1-4-2-锁定用户和解锁用户" class="headerlink" title="1.4.2 锁定用户和解锁用户"></a>1.4.2 锁定用户和解锁用户</h5><ul>
<li>锁定用户</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">alter</span> <span class="keyword">user</span> szxy <span class="keyword">account</span> <span class="keyword">lock</span>;</span><br></pre></td></tr></table></figure>

<ul>
<li>解锁用户</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">alter</span> <span class="keyword">user</span>  szxy <span class="keyword">account</span>  <span class="keyword">unlock</span>;</span><br></pre></td></tr></table></figure>

<h3 id="2-数据库表"><a href="#2-数据库表" class="headerlink" title="2  数据库表"></a>2  数据库表</h3><br>

<br>

<h4 id="2-1-Oracle-中的数据类型"><a href="#2-1-Oracle-中的数据类型" class="headerlink" title="2.1  Oracle 中的数据类型"></a>2.1  Oracle 中的数据类型</h4><h5 id="2-1-1-字符类型"><a href="#2-1-1-字符类型" class="headerlink" title="2.1.1 字符类型"></a>2.1.1 字符类型</h5><p>a） varchar</p>
<p> 可变长度字符串，效率<strong>低</strong></p>
<p>b） char  固定长度字符串</p>
<p>不可变长度的字符串，效率较<strong>高</strong></p>
<p>邮箱  电话号码 </p>
<h5 id="2-1-2-数值类型"><a href="#2-1-2-数值类型" class="headerlink" title="2.1.2  数值类型"></a>2.1.2  数值类型</h5><p>number 类型 ： 存储整数和浮点数</p>
<h4 id="2-1-3-日期时间类型"><a href="#2-1-3-日期时间类型" class="headerlink" title="2.1.3 日期时间类型"></a>2.1.3 日期时间类型</h4><p>a） date，存放日期和时间</p>
<p>b） timestamp ，比date更精确地日期时间类型</p>
<h5 id="2-1-4-lob-类型"><a href="#2-1-4-lob-类型" class="headerlink" title="2.1.4  lob 类型"></a>2.1.4  lob 类型</h5><p>a） blob，用于存放二进制数据，可以用于存放文件，图片，音频，视频等二进制数据。</p>
<p>b） clob，用于存放大文本信息。</p>
<h4 id="2-2-创建表格"><a href="#2-2-创建表格" class="headerlink" title="2.2 创建表格"></a>2.2 创建表格</h4><p>​    创建学生表</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 字段中包含学号、名字，性别，年龄，日期，班级，邮箱</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> test_table(</span><br><span class="line">	sno <span class="built_in">number</span>(<span class="number">4</span>),</span><br><span class="line">    sname varchar2(<span class="number">12</span>),</span><br><span class="line">    gender <span class="built_in">char</span>(<span class="number">3</span>),</span><br><span class="line">    age <span class="built_in">number</span>(<span class="number">3</span>),</span><br><span class="line">    sdate <span class="built_in">date</span>,</span><br><span class="line">    clazz varchar2(<span class="number">20</span>),</span><br><span class="line">    email varchar2(<span class="number">50</span>)</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<h4 id="2-3-修改表格"><a href="#2-3-修改表格" class="headerlink" title="2.3  修改表格"></a>2.3  修改表格</h4><h5 id="2-3-1-添加字段"><a href="#2-3-1-添加字段" class="headerlink" title="2.3.1 添加字段"></a>2.3.1 添加字段</h5><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> student <span class="keyword">add</span>(<span class="built_in">number</span>(<span class="number">3</span>));</span><br></pre></td></tr></table></figure>

<h5 id="2-3-2-修改字段的类型"><a href="#2-3-2-修改字段的类型" class="headerlink" title="2.3.2 修改字段的类型"></a>2.3.2 修改字段的类型</h5><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> student <span class="keyword">modify</span>(score <span class="built_in">number</span>(<span class="number">5</span>,<span class="number">2</span>);</span><br></pre></td></tr></table></figure>

<h5 id="2-3-3-重命名"><a href="#2-3-3-重命名" class="headerlink" title="2.3.3 重命名"></a>2.3.3 重命名</h5><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> student <span class="keyword">rename</span> <span class="keyword">column</span> score <span class="keyword">to</span> grade;</span><br></pre></td></tr></table></figure>

<h5 id="2-3-4-删除字段"><a href="#2-3-4-删除字段" class="headerlink" title="2.3.4 删除字段"></a>2.3.4 删除字段</h5><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> student <span class="keyword">drop</span> colnmn grade;</span><br></pre></td></tr></table></figure>

<h5 id="2-3-4-重命名表格名"><a href="#2-3-4-重命名表格名" class="headerlink" title="2.3.4 重命名表格名"></a>2.3.4 重命名表格名</h5><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">rename</span> student <span class="keyword">to</span> stu;</span><br></pre></td></tr></table></figure>

<h4 id="2-4-删除表格"><a href="#2-4-删除表格" class="headerlink" title="2.4  删除表格"></a>2.4  删除表格</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">drop</span> <span class="keyword">table</span> stu;</span><br></pre></td></tr></table></figure>

<h3 id="3-数据库完整性约束-constraint"><a href="#3-数据库完整性约束-constraint" class="headerlink" title="3 数据库完整性约束  constraint"></a>3 数据库完整性约束  constraint</h3><blockquote>
<p>用于对表格的数据进行限制，保证表格数据的完整性和一致性</p>
</blockquote>
<p><strong>完整性约束条件</strong></p>
<ul>
<li><p>域完整性约束 (非空 not null 检查 check )</p>
</li>
<li><p>实体完整性约束（唯一 unique，主键 primary）</p>
</li>
<li><p>参数完整性约束（外键 foreign key ）<br><img src="http://www.zwer.xyz/picGo/20181208094412.png" alt></p>
</li>
</ul>
<p><strong>数据库表的约束</strong></p>
<p><img src="http://www.zwer.xyz/picGo/20181207200724.png" alt></p>
<p><strong>命令规则</strong></p>
<p><img src="http://www.zwer.xyz/picGo/20181207200843.png" alt></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">constraints 约束名 约束类型</span><br></pre></td></tr></table></figure>

<h4 id="13-1-主键约束"><a href="#13-1-主键约束" class="headerlink" title="13.1 主键约束"></a>13.1 主键约束</h4><blockquote>
<p>主键是用于唯一标识一条记录的字段，必须保证既非空，又保证唯一。</p>
<p>一张表中只能有一个主键</p>
</blockquote>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 字段中包含学号、名字，性别，年龄，日期，班级，邮箱</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> student(</span><br><span class="line">	sno <span class="built_in">number</span>(<span class="number">4</span>),</span><br><span class="line">    sname varchar2(<span class="number">12</span>),</span><br><span class="line">    gender <span class="built_in">char</span>(<span class="number">3</span>),</span><br><span class="line">    age <span class="built_in">number</span>(<span class="number">3</span>),</span><br><span class="line">    sdate <span class="built_in">date</span>,</span><br><span class="line">    clazz varchar2(<span class="number">20</span>),</span><br><span class="line">    email varchar2(<span class="number">50</span>),</span><br><span class="line">    <span class="comment">-- 表级别添加主键约束</span></span><br><span class="line">	<span class="comment">--constraints pk_student primaray key(sno)</span></span><br><span class="line">    <span class="comment">-- 快捷方式</span></span><br><span class="line">    primary <span class="keyword">key</span>(sno)</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> student(</span><br><span class="line">    <span class="comment">-- 列级约束</span></span><br><span class="line">	sno <span class="built_in">number</span>(<span class="number">4</span>) <span class="keyword">constraints</span> pk_sno primary <span class="keyword">key</span>,</span><br><span class="line">    sname varchar2(<span class="number">12</span>),</span><br><span class="line">    gender <span class="built_in">char</span>(<span class="number">3</span>),</span><br><span class="line">    age <span class="built_in">number</span>(<span class="number">3</span>),</span><br><span class="line">    sdate <span class="built_in">date</span>,</span><br><span class="line">    clazz varchar2(<span class="number">20</span>),</span><br><span class="line">    email varchar2(<span class="number">50</span>)</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> student(</span><br><span class="line">	sno <span class="built_in">number</span>(<span class="number">4</span>),</span><br><span class="line">    sname varchar2(<span class="number">12</span>),</span><br><span class="line">    gender <span class="built_in">char</span>(<span class="number">3</span>),</span><br><span class="line">    age <span class="built_in">number</span>(<span class="number">3</span>),</span><br><span class="line">    sdate <span class="built_in">date</span>,</span><br><span class="line">    clazz varchar2(<span class="number">20</span>),</span><br><span class="line">    email varchar2(<span class="number">50</span>),</span><br><span class="line">    <span class="comment">-- 表级约束  混合约束</span></span><br><span class="line">	<span class="keyword">constraints</span> pk_student primary <span class="keyword">key</span>(sno,email)</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<h4 id="13-2-非空约束"><a href="#13-2-非空约束" class="headerlink" title="13.2 非空约束"></a>13.2 非空约束</h4><blockquote>
<p>字段值不允许为空，非空约束<strong>只能在列级</strong></p>
</blockquote>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 字段中包含学号、名字，性别，年龄，日期，班级，邮箱</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> student(</span><br><span class="line">	sno <span class="built_in">number</span>(<span class="number">4</span>),</span><br><span class="line">    sname varchar2(<span class="number">12</span>) <span class="keyword">constraints</span> nn_sname <span class="keyword">not</span> <span class="literal">null</span>,</span><br><span class="line">    gender <span class="built_in">char</span>(<span class="number">3</span>),</span><br><span class="line">    age <span class="built_in">number</span>(<span class="number">3</span>),</span><br><span class="line">    sdate <span class="built_in">date</span>,</span><br><span class="line">    clazz varchar2(<span class="number">20</span>),</span><br><span class="line">    email varchar2(<span class="number">50</span>),</span><br><span class="line">    <span class="comment">-- 表级约束  混合约束</span></span><br><span class="line">	<span class="keyword">constraints</span> pk_student primary <span class="keyword">key</span>(sno,email)</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<h4 id="13-3-唯一性约束-unique"><a href="#13-3-唯一性约束-unique" class="headerlink" title="13.3 唯一性约束 (unique)"></a>13.3 唯一性约束 (unique)</h4><blockquote>
<p>要求字段值不能重复</p>
</blockquote>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 字段中包含学号、名字，性别，年龄，日期，班级，邮箱</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> student(</span><br><span class="line">	sno <span class="built_in">number</span>(<span class="number">4</span>),</span><br><span class="line">    sname varchar2(<span class="number">12</span>),</span><br><span class="line">    gender <span class="built_in">char</span>(<span class="number">3</span>),</span><br><span class="line">    age <span class="built_in">number</span>(<span class="number">3</span>),</span><br><span class="line">    sdate <span class="built_in">date</span>,</span><br><span class="line">    clazz varchar2(<span class="number">20</span>),</span><br><span class="line">    email varchar2(<span class="number">50</span>) <span class="keyword">constraints</span> uk_stduent_email <span class="keyword">unique</span>,<span class="comment">-- 唯一性约束</span></span><br><span class="line">	<span class="keyword">constraints</span> pk_student primary <span class="keyword">key</span>(sno)</span><br><span class="line">    <span class="comment">-- constraints uk_student_email unique (email)</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<h4 id="13-4-检查约束-check"><a href="#13-4-检查约束-check" class="headerlink" title="13.4 检查约束 check"></a>13.4 检查约束 check</h4><blockquote>
<p>作用：限定字段值的<strong>取值范围</strong></p>
</blockquote>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 字段中包含学号、名字，性别，年龄，日期，班级，邮箱</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> student(</span><br><span class="line">	sno <span class="built_in">number</span>(<span class="number">4</span>),</span><br><span class="line">    sname varchar2(<span class="number">12</span>),</span><br><span class="line">    gender <span class="built_in">char</span>(<span class="number">3</span>),</span><br><span class="line">    age <span class="built_in">number</span>(<span class="number">3</span>),</span><br><span class="line">    sdate <span class="built_in">date</span>,</span><br><span class="line">    clazz varchar2(<span class="number">20</span>),</span><br><span class="line">    email varchar2(<span class="number">50</span>) <span class="keyword">constraints</span> uk_stduent_email <span class="keyword">unique</span>,<span class="comment">-- 唯一性约束</span></span><br><span class="line">	<span class="keyword">constraints</span> pk_student primary <span class="keyword">key</span>(sno),</span><br><span class="line">    <span class="keyword">constraints</span> ck_student <span class="keyword">check</span> (age <span class="keyword">between</span> <span class="number">18</span> <span class="keyword">and</span> <span class="number">30</span>)</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<h4 id="13-5-外键约束"><a href="#13-5-外键约束" class="headerlink" title="13.5  外键约束"></a>13.5  外键约束</h4><blockquote>
<p>约束表与表之间的关系，两张表的依赖关系</p>
</blockquote>
<blockquote>
<p>以 <code>emp</code> 和 <code>dept</code> 例子，<code>emp</code> 依赖于 <code>dept</code> 表</p>
</blockquote>
<blockquote>
<p>所以 <code>dept</code> 称为 主表（主表），<code>emp</code> 称为 从表(子表)</p>
</blockquote>
<blockquote>
<p>即在创建表的时候，先创建主表再创建从表。</p>
</blockquote>
<p>a) 外键约束的问题：</p>
<p>默认情况下，主表中数据再被引用时，无法删除，默认情况下，需要先删除从表中的所有数据，</p>
<p>再删除主表中的数据。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">drop</span> <span class="keyword">table</span> clazz;</span><br><span class="line"><span class="comment">-- 创建班级表</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> clazz(</span><br><span class="line">       cno varchar2(<span class="number">10</span>),</span><br><span class="line">       cname varchar2(<span class="number">20</span>),</span><br><span class="line">       croom <span class="built_in">number</span>,</span><br><span class="line">       <span class="keyword">constraints</span> pk_clazz_cno primary <span class="keyword">key</span>(cno),</span><br><span class="line">       <span class="keyword">constraints</span> uk_clazz_cname <span class="keyword">unique</span> (cname)</span><br><span class="line">);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> clazz <span class="keyword">values</span>(<span class="string">'1001'</span>,<span class="string">'大数据'</span>,<span class="string">'206'</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> clazz <span class="keyword">values</span>(<span class="string">'1002'</span>,<span class="string">'人工智能'</span>,<span class="string">'307'</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> clazz(cno) <span class="keyword">values</span>(<span class="string">'1003'</span>);</span><br><span class="line"><span class="keyword">select</span> *  <span class="keyword">from</span> clazz;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">drop</span> <span class="keyword">table</span> student;</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> student(</span><br><span class="line">  sno <span class="built_in">number</span>(<span class="number">11</span>),</span><br><span class="line">    sname varchar2(<span class="number">20</span>) <span class="keyword">constraints</span> nn_sname <span class="keyword">not</span> <span class="literal">null</span>, <span class="comment">-- 非空</span></span><br><span class="line">    gender <span class="built_in">char</span>(<span class="number">3</span>),</span><br><span class="line">    age <span class="built_in">number</span>(<span class="number">3</span>),</span><br><span class="line">    sdate <span class="built_in">date</span>,</span><br><span class="line">    clazz varchar2(<span class="number">20</span>),</span><br><span class="line">    email varchar2(<span class="number">50</span>)， </span><br><span class="line">    cno varchar2(<span class="number">10</span>),</span><br><span class="line">   <span class="keyword">constraints</span> pk_student_sno primary <span class="keyword">key</span>(sno),</span><br><span class="line">   <span class="keyword">constraints</span> uk_student_email <span class="keyword">unique</span> (email),</span><br><span class="line">   <span class="keyword">constraints</span> ch_student_age <span class="keyword">check</span> (age <span class="keyword">between</span> <span class="number">18</span> <span class="keyword">and</span> <span class="number">35</span>),</span><br><span class="line">   <span class="keyword">constraints</span> fk_studnet_cno <span class="keyword">foreign</span> <span class="keyword">key</span>(cno)   <span class="keyword">references</span> clazz (cno)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> student <span class="keyword">values</span>(<span class="string">'100101'</span>,<span class="string">'小白'</span>,<span class="string">'男'</span>,<span class="number">20</span>,<span class="keyword">sysdate</span>,<span class="string">'Java666'</span>,<span class="string">'bai@163.com'</span>,<span class="string">'1001'</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> student <span class="keyword">values</span>(<span class="string">'100201'</span>,<span class="string">'小李'</span>,<span class="string">'男'</span>,<span class="number">35</span>,<span class="keyword">sysdate</span>,<span class="string">'Java666'</span>,<span class="string">'li@163.com'</span>,<span class="string">'1002'</span>);</span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> student;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 删除 </span></span><br><span class="line"><span class="keyword">delete</span>   <span class="keyword">from</span> clazz <span class="keyword">where</span> cno=<span class="string">'1003'</span>;</span><br></pre></td></tr></table></figure>

<ul>
<li>可以在定义外键时，设置 级联删除  on delete cascade</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 设置级联删除</span></span><br><span class="line"><span class="keyword">drop</span> <span class="keyword">table</span> student;</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> student(</span><br><span class="line">  sno <span class="built_in">number</span>(<span class="number">11</span>),</span><br><span class="line">    sname varchar2(<span class="number">20</span>) <span class="keyword">constraints</span> nn_sname <span class="keyword">not</span> <span class="literal">null</span>, <span class="comment">-- 非空</span></span><br><span class="line">    gender <span class="built_in">char</span>(<span class="number">3</span>),</span><br><span class="line">    age <span class="built_in">number</span>(<span class="number">3</span>),</span><br><span class="line">    sdate <span class="built_in">date</span>,</span><br><span class="line">    clazz varchar2(<span class="number">20</span>),</span><br><span class="line">    email varchar2(<span class="number">50</span>)， </span><br><span class="line">    cno varchar2(<span class="number">10</span>),</span><br><span class="line">   <span class="keyword">constraints</span> pk_student_sno primary <span class="keyword">key</span>(sno),</span><br><span class="line">   <span class="keyword">constraints</span> uk_student_email <span class="keyword">unique</span> (email),</span><br><span class="line">   <span class="keyword">constraints</span> ch_student_age <span class="keyword">check</span> (age <span class="keyword">between</span> <span class="number">18</span> <span class="keyword">and</span> <span class="number">35</span>),</span><br><span class="line">   <span class="keyword">constraints</span> fk_studnet_cno <span class="keyword">foreign</span> <span class="keyword">key</span>(cno)   <span class="keyword">references</span> clazz (cno) <span class="keyword">on</span> <span class="keyword">delete</span> <span class="keyword">cascade</span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">--</span></span><br></pre></td></tr></table></figure>

<ul>
<li><p>可以在定义外键时，设置删除策略为 set null (设空)，</p>
<p>表示当删除除主表的信息时，将从表中的相关数据设置为 null</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">drop</span> <span class="keyword">table</span> student;</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> student(</span><br><span class="line">  sno <span class="built_in">number</span>(<span class="number">11</span>),</span><br><span class="line">    sname varchar2(<span class="number">20</span>) <span class="keyword">constraints</span> nn_sname <span class="keyword">not</span> <span class="literal">null</span>, <span class="comment">-- 非空</span></span><br><span class="line">    gender <span class="built_in">char</span>(<span class="number">3</span>),</span><br><span class="line">    age <span class="built_in">number</span>(<span class="number">3</span>),</span><br><span class="line">    sdate <span class="built_in">date</span>,</span><br><span class="line">    clazz varchar2(<span class="number">20</span>),</span><br><span class="line">    email varchar2(<span class="number">50</span>)， </span><br><span class="line">    cno varchar2(<span class="number">10</span>),</span><br><span class="line">   <span class="keyword">constraints</span> pk_student_sno primary <span class="keyword">key</span>(sno),</span><br><span class="line">   <span class="keyword">constraints</span> uk_student_email <span class="keyword">unique</span> (email),</span><br><span class="line">   <span class="keyword">constraints</span> ch_student_age <span class="keyword">check</span> (age <span class="keyword">between</span> <span class="number">18</span> <span class="keyword">and</span> <span class="number">35</span>),</span><br><span class="line">   <span class="keyword">constraints</span> fk_studnet_cno <span class="keyword">foreign</span> <span class="keyword">key</span>(cno)   <span class="keyword">references</span> clazz (cno) <span class="keyword">on</span> <span class="keyword">delete</span> <span class="keyword">set</span>  <span class="literal">null</span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">--  set null；</span></span><br><span class="line"><span class="keyword">delete</span> <span class="keyword">from</span> clazz <span class="keyword">where</span> cno = <span class="string">'1001'</span>;</span><br></pre></td></tr></table></figure>
</li>
<li><p>强制删除  （不推荐）</p>
<p>先删除外键约束，再删除表格</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">drop</span> <span class="keyword">table</span> clazz  <span class="keyword">cascade</span> <span class="keyword">constraints</span>;</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h4 id="13-6-修改表格时添加约束"><a href="#13-6-修改表格时添加约束" class="headerlink" title="13.6  修改表格时添加约束"></a>13.6  修改表格时添加约束</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> student <span class="keyword">add</span> <span class="keyword">constraints</span> pk_student_sno primary <span class="keyword">key</span>(sno);</span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> student <span class="keyword">add</span> <span class="keyword">constraints</span> uk_student_sname <span class="keyword">unique</span> (sname);</span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> student <span class="keyword">add</span> <span class="keyword">constraints</span> ck_student_age <span class="keyword">check</span> (age <span class="keyword">between</span> <span class="number">18</span> <span class="keyword">and</span> <span class="number">35</span>);</span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> student <span class="keyword">add</span> <span class="keyword">constraints</span> fk_studnet_cno <span class="keyword">foreign</span> <span class="keyword">key</span>(cno) <span class="keyword">references</span> clazz(cno);</span><br></pre></td></tr></table></figure>

<h3 id="4-序列-（sequence）"><a href="#4-序列-（sequence）" class="headerlink" title="4  序列 （sequence）"></a>4  序列 （sequence）</h3><blockquote>
<p>序列是 Oracle 中特有的对象，用于生成一个自动递增的数列，当做主键</p>
</blockquote>
<h4 id="4-1-创建序列"><a href="#4-1-创建序列" class="headerlink" title="4.1  创建序列"></a>4.1  创建序列</h4><p>a）语法</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">sequence</span> seq-<span class="keyword">name</span></span><br><span class="line">	<span class="keyword">increment</span> <span class="keyword">by</span> n</span><br><span class="line">	<span class="keyword">start</span> <span class="keyword">with</span> n</span><br><span class="line">	maxvalue n | <span class="keyword">nomaxvalue</span>  //<span class="number">10</span>^<span class="number">27</span> <span class="keyword">or</span> <span class="number">-1</span> </span><br><span class="line">	<span class="keyword">minvalue</span> n | <span class="keyword">no</span> <span class="keyword">minvalue</span></span><br><span class="line">	<span class="keyword">cycle</span> | <span class="keyword">nocycle</span></span><br><span class="line">	<span class="keyword">cache</span> n |nocache</span><br></pre></td></tr></table></figure>

<ul>
<li>increment by, 代表每次增长的步长，默认是 1，可以是负数，表示每次递减；</li>
<li>start with，从那个值开始，默认是 1</li>
<li>maxvalue， 序列能达到的最大值，默认是 nomaxvalue，此时最大值是 10^27</li>
</ul>
<p>负数的最大值是 -1</p>
<ul>
<li>minvalue，序列能到达的最小值</li>
<li>nominvalue，此时正数的最小值是-1，负数的最小值是 - 10^27</li>
<li>cycle | nocycle ，表示是否循环，如果是 cycle ，达到最大值是会重新开始</li>
</ul>
<p>，如果是 nocycle ，最大值后会报错 </p>
<ul>
<li>cache | nocache，表示高速缓存，可以优化序列，缓存的默认值是 20 </li>
</ul>
<p>  b) 创建 sequence </p>
  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">sequence</span> seq_student;</span><br></pre></td></tr></table></figure>

<h4 id="4-2-序列的使用"><a href="#4-2-序列的使用" class="headerlink" title="4.2 序列的使用"></a>4.2 序列的使用</h4><h5 id="4-2-1-nextval-（查看序列的下一个值）"><a href="#4-2-1-nextval-（查看序列的下一个值）" class="headerlink" title="4.2.1 nextval （查看序列的下一个值）"></a>4.2.1 <code>nextval</code> （查看序列的下一个值）</h5><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 查看序列的下一个值</span></span><br><span class="line"><span class="keyword">select</span> seq_stundent.nextval  <span class="keyword">from</span> dual;</span><br></pre></td></tr></table></figure>

<h5 id="4-2-2-currval-查看序列的当前值"><a href="#4-2-2-currval-查看序列的当前值" class="headerlink" title="4.2.2  currval (查看序列的当前值)"></a>4.2.2  <code>currval</code> (查看序列的当前值)</h5><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 查看当前序列</span></span><br><span class="line"><span class="keyword">select</span> seq_student.currval <span class="keyword">from</span> dual;</span><br></pre></td></tr></table></figure>

<h4 id="4-2-3-在插入数据时使用序列"><a href="#4-2-3-在插入数据时使用序列" class="headerlink" title="4.2.3  在插入数据时使用序列"></a>4.2.3  在插入数据时使用序列</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 使用序列添加一个学生信息</span></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> student <span class="keyword">values</span>(seq_student.nextval,<span class="string">'小名'</span>,<span class="string">''</span>)</span><br></pre></td></tr></table></figure>

<h4 id="4-3-删除序列"><a href="#4-3-删除序列" class="headerlink" title="4.3  删除序列"></a>4.3  删除序列</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">drop</span> <span class="keyword">sequence</span>  seq_student;</span><br></pre></td></tr></table></figure>

<h3 id="5-索引"><a href="#5-索引" class="headerlink" title="5 索引"></a>5 索引</h3><blockquote>
<p>为了提高查询效率，可以建立类似目录的数据库对象，提高数据的查询速度</p>
</blockquote>
<blockquote>
<p> 索引类型默认采用 B 树（平衡树）数据结构，数据全部在叶子节点上。</p>
</blockquote>
<p><img src="http://www.zwer.xyz/picGo/20181208095325.png" alt></p>
<p><strong>索引的创建有两种情况</strong></p>
<ul>
<li>自动：当在表上定义一个 primary key 或 unique 约束条件时， Oracle 数据库会自动创建一个对应的唯一索引</li>
<li>手动：用户可以创建索引</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 手动创建索引  排序</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">index</span> idx_name <span class="keyword">on</span> student(sname <span class="keyword">desc</span>)</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 删除索引</span></span><br><span class="line"><span class="keyword">drop</span> <span class="keyword">index</span> idx_name</span><br></pre></td></tr></table></figure>

<p><strong>开发中使用索引的要点：</strong><br>• 1. 索引数据可能要占用大量的存储空间。<br>• 2. 索引改善检索操作的性能，但降低数据插入、修改和删除的性能。在执行这些操作时，<br>DBMS必须动态地更新索引。<br>• 3.限制表中索引的数目。索引越多，在修改表时对索引做出修改的工作量越大<br>• 4. 并非所有数据都适合于索引。唯一性不好的数据（如省）从索引得到的好处不比具有更多<br>可能值的数据（如姓名）从索引得到的好处多<br>• 5. 索引用于数据过滤和数据排序。如果你经常以某种特定的顺序排序数据，则该数据可能是<br>索引的备选。<br>• 5. 可以在索引中定义多个列（如省加城市），这样的索引只在以省加城市的顺序排序时有用。<br>如果想按城市排序，则这种索引没有用处。</p>
<h3 id="6-视图（view）"><a href="#6-视图（view）" class="headerlink" title="6  视图（view）"></a>6  视图（view）</h3><blockquote>
<p>视图是从若干基本表和(或)    其他视图构造出来的<strong>表</strong> 。视图中并不会存放数据，只会存放视图的定义语句，在用户使用视图时，才去动态检索数据</p>
</blockquote>
<h4 id="6-1-创建视图"><a href="#6-1-创建视图" class="headerlink" title="6.1 创建视图"></a>6.1 创建视图</h4><p>a）语法</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> [<span class="keyword">or</span> <span class="keyword">replace</span> ] <span class="keyword">view</span> 视图名 <span class="keyword">as</span> (查询) [<span class="keyword">with</span> <span class="keyword">read</span> <span class="keyword">only</span>]</span><br></pre></td></tr></table></figure>

<p>b) 创建视图</p>
<p>[^1]: 创建视图，不能使用 order by 子句</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span>  <span class="keyword">or</span> <span class="keyword">replace</span> <span class="keyword">view</span> v_student <span class="keyword">as</span> (<span class="keyword">select</span> * <span class="keyword">from</span> student);</span><br><span class="line"><span class="comment">-- 只读视图,只能对视图进行查询(DQL)操作，不能执行增删改(DML) 操作</span></span><br><span class="line"><span class="keyword">create</span>  <span class="keyword">or</span> <span class="keyword">replace</span> <span class="keyword">view</span> v_student <span class="keyword">as</span> (<span class="keyword">select</span> * <span class="keyword">from</span> student) <span class="keyword">with</span> <span class="keyword">read</span>-<span class="keyword">only</span>;</span><br></pre></td></tr></table></figure>

<p>c) 查询视图</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> *  <span class="keyword">from</span> v_student;</span><br></pre></td></tr></table></figure>

<p>d） 新增</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> v_student <span class="keyword">values</span>(<span class="number">10</span>,<span class="string">'笑笑'</span>,<span class="string">'女'</span>,<span class="number">20</span>,<span class="keyword">sysdate</span>,<span class="string">'Java666'</span>,<span class="string">'xiao@qq.com'</span>,<span class="number">1001</span>);</span><br></pre></td></tr></table></figure>

<p>e） 更新</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">update</span> v_studnet <span class="keyword">set</span> age= <span class="number">31</span> <span class="keyword">where</span> sno = <span class="number">1001</span>;</span><br></pre></td></tr></table></figure>

<p>f） 删除</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">delete</span> <span class="keyword">from</span> v_student <span class="keyword">where</span> sno = <span class="number">2</span>;</span><br></pre></td></tr></table></figure>

<h4 id="6-2-视图的功能"><a href="#6-2-视图的功能" class="headerlink" title="6.2 视图的功能"></a>6.2 视图的功能</h4><ul>
<li>限制对表格数据的访问</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">or</span> <span class="keyword">replace</span> <span class="keyword">view</span> v_student2 <span class="keyword">as</span> (<span class="keyword">select</span> sno,sname,age <span class="keyword">from</span> student) <span class="keyword">with</span> <span class="keyword">read</span> <span class="keyword">only</span>;</span><br></pre></td></tr></table></figure>

<ul>
<li>相同数据的不同访问</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">view</span> v_student <span class="keyword">as</span> (<span class="keyword">select</span> *  <span class="keyword">from</span> student);</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">or</span> <span class="keyword">replace</span> <span class="keyword">view</span> v_student2 <span class="keyword">as</span> (<span class="keyword">select</span> sno,sname,age <span class="keyword">from</span> student) <span class="keyword">with</span> <span class="keyword">read</span> <span class="keyword">only</span>;</span><br></pre></td></tr></table></figure>

<ul>
<li>将复杂的查询简单化 :baby_chick:</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 统计每个班级的人数</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">or</span> <span class="keyword">replace</span> <span class="keyword">view</span> v_student3 <span class="keyword">as</span>(</span><br><span class="line">  <span class="keyword">select</span> c.*,<span class="keyword">count</span>(s.sno) cnt  <span class="comment">-- count函数必须使用别名，不然会报错</span></span><br><span class="line">  <span class="keyword">from</span> clazz c</span><br><span class="line">  <span class="keyword">left</span> <span class="keyword">join</span> student s</span><br><span class="line">  <span class="keyword">on</span> s.cno = c.cno</span><br><span class="line">  <span class="keyword">group</span> <span class="keyword">by</span> c.cno,c.cname,c.croom     </span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<h5 id="•-总结"><a href="#•-总结" class="headerlink" title="• 总结"></a>• 总结</h5><p>• 视图是一个虚拟表，对应一条SELECT语句，可将它的输出看作一个表<br>• 视图不存储数据<br>• 改变基本表的数据，也会反应到基于该表的视图上<br>• 视图可以基于基本表的若干行，若干列<br>• 视图可以基于一个表、多个表，甚至是基于其他的视图<br>• 使用视图可以提高数据访问的安全性，只显示指定的行列数据<br>• 使用视图可以降低查询的难度，定制数据显示<br>• 可以对视图进行CRUD操作，实际上是对基本表的CRUD操作<br>• 如果视图对应多个表，一般不允许添加操作，可以通过触发器解决<br>• 使用with read only定义只读视图</p>
<h3 id="7-事务-transaction"><a href="#7-事务-transaction" class="headerlink" title="7  事务 transaction"></a>7  事务 transaction</h3><h4 id="7-1-事务的定义："><a href="#7-1-事务的定义：" class="headerlink" title="7.1 事务的定义："></a>7.1 事务的定义：</h4><blockquote>
<p>一个操作序列，这些操作要么都做，要么都不做，一个不可分割的工作单元，是数据库环境中。事务是为了保证数据的完整性</p>
</blockquote>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> t_account(</span><br><span class="line">    aid <span class="built_in">number</span>(<span class="number">5</span>),</span><br><span class="line">    aname varchar2(<span class="number">20</span>) <span class="keyword">constraints</span> nn_aname <span class="keyword">not</span> <span class="literal">null</span>,</span><br><span class="line">    amoney <span class="built_in">number</span>(<span class="number">5</span>,<span class="number">2</span>),</span><br><span class="line">    <span class="keyword">constraints</span> pk_aid primary <span class="keyword">key</span>(aid)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_account <span class="keyword">values</span>(<span class="number">1</span>,<span class="string">'张三'</span>,<span class="number">100</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_account <span class="keyword">values</span>(<span class="number">2</span>,<span class="string">'李四'</span>，<span class="number">10</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> *  <span class="keyword">from</span> t_account;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 模拟 张三给李四转账 20 元操作 </span></span><br><span class="line"><span class="keyword">update</span> t_account <span class="keyword">set</span> amoney = amoney <span class="number">-20</span> <span class="keyword">where</span> aid = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">update</span> t_account <span class="keyword">set</span> amoney = amoney +<span class="number">20</span> <span class="keyword">where</span> aid = <span class="number">2</span>; </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 提交</span></span><br><span class="line"><span class="keyword">commit</span></span><br><span class="line"><span class="comment">-- 回滚 </span></span><br><span class="line"><span class="keyword">rollback</span></span><br></pre></td></tr></table></figure>

<h4 id="7-3-事务的特征（ACID）"><a href="#7-3-事务的特征（ACID）" class="headerlink" title="7.3  事务的特征（ACID）"></a>7.3  事务的特征（ACID）</h4><ul>
<li><p>原子性 (Atomicity)</p>
<p>要么全做，要么全不做</p>
</li>
<li><p>一致性(Consistency)</p>
<p>事务的执行前后状态是一致的</p>
</li>
<li><p>隔离性(Isolation)</p>
<p>多个用户并发访问同一张表时，相互隔离，互不干扰</p>
</li>
<li><p>持久性(Durability)</p>
<p>事务一旦提交，对数据库中的数据改变是永久性的</p>
</li>
</ul>
<h4 id="7-3-commit-和-rollback"><a href="#7-3-commit-和-rollback" class="headerlink" title="7.3  commit 和 rollback"></a>7.3  commit 和 rollback</h4><p>Commit 表示事务成功地结束，此时告诉系统，数据库要进入一个新的正确状态，该<br>事务对数据库的所有更新都以交付实施。每个 Commit 语句都可以看成是一个事务成<br>功的结束，同时也是另一个事务的开始。</p>
<p>• Rollback 表示事务不成功的结束，此时告诉系统，已发生错误，数据库可能处在不正<br>确的状态，该事务对数据库的更新必须被撤销，数据库应恢复该事务到初始状态。<br>每个 Rollback 语句同时也是另一个事务的开始。</p>
<p>• 一旦执行了 commit 语句，将目前对数据库的操作提交给数据库（实际写入DB），以<br>后就不能用 rollback 进行撤销。</p>
<h3 id="8-rowid和-rownum"><a href="#8-rowid和-rownum" class="headerlink" title="8  rowid和 rownum"></a>8  <code>rowid</code>和 <code>rownum</code></h3><blockquote>
</blockquote>
<h4 id="8-1-rowid"><a href="#8-1-rowid" class="headerlink" title="8.1  rowid"></a>8.1  <code>rowid</code></h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> c.*,<span class="keyword">rowid</span>  <span class="keyword">from</span> clazz c;</span><br><span class="line"><span class="keyword">select</span> *  <span class="keyword">from</span> calzz c <span class="keyword">where</span> <span class="keyword">rowid</span>=<span class="string">''</span>;</span><br></pre></td></tr></table></figure>

<h4 id="8-2-rownum-伪列"><a href="#8-2-rownum-伪列" class="headerlink" title="8.2 rownum 伪列"></a>8.2 <code>rownum</code> 伪列</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> emp <span class="keyword">order</span> <span class="keyword">by</span> sal <span class="keyword">desc</span>;</span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> emp <span class="keyword">where</span> <span class="keyword">rownum</span> &lt;= <span class="number">5</span> <span class="keyword">order</span> <span class="keyword">by</span> sal <span class="keyword">desc</span>;</span><br><span class="line"><span class="comment">-- 先过滤，再排序，可以使用子查询</span></span><br><span class="line"><span class="comment">-- 显示前5行数据 Top-5</span></span><br><span class="line"><span class="keyword">select</span> e.*</span><br><span class="line"><span class="keyword">from</span>(</span><br><span class="line">  <span class="keyword">select</span> * <span class="keyword">from</span> emp  <span class="keyword">order</span> <span class="keyword">by</span> sal <span class="keyword">desc</span>) e</span><br><span class="line"><span class="keyword">where</span> <span class="keyword">rownum</span> &lt;=<span class="number">5</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 分页，每页显示5条数据</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 第一步</span></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> emp <span class="keyword">order</span> <span class="keyword">by</span> sal <span class="keyword">desc</span>;</span><br><span class="line"><span class="comment">-- 第二步，查询前 10 数据</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">rownum</span> ,e.*</span><br><span class="line"><span class="keyword">from</span>(</span><br><span class="line">  <span class="keyword">select</span> * <span class="keyword">from</span> emp e <span class="keyword">order</span> <span class="keyword">by</span> sal <span class="keyword">desc</span>) e </span><br><span class="line"><span class="keyword">where</span> <span class="keyword">rownum</span> &lt;=<span class="number">10</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 第二步 查询第二页的数据</span></span><br><span class="line"><span class="keyword">select</span> tt.*</span><br><span class="line"><span class="keyword">from</span>(</span><br><span class="line">  <span class="keyword">select</span> <span class="keyword">rownum</span> rnm,e.*</span><br><span class="line">  <span class="keyword">from</span>(</span><br><span class="line">    <span class="keyword">select</span> * <span class="keyword">from</span> emp e <span class="keyword">order</span> <span class="keyword">by</span> sal <span class="keyword">desc</span></span><br><span class="line">  )e <span class="keyword">where</span> <span class="keyword">rownum</span> &lt;=<span class="number">10</span> </span><br><span class="line">)tt <span class="keyword">where</span> tt.rnm &gt;<span class="number">5</span> <span class="keyword">and</span> tt.rnm &lt;=<span class="number">10</span>;</span><br><span class="line">  </span><br><span class="line"></span><br><span class="line"><span class="comment">-- 第三步 查询第三页的数据</span></span><br><span class="line"><span class="keyword">select</span> tt.*</span><br><span class="line"><span class="keyword">from</span>(</span><br><span class="line">  <span class="keyword">select</span> <span class="keyword">rownum</span> rnm,e.*</span><br><span class="line">  <span class="keyword">from</span>(</span><br><span class="line">    <span class="keyword">select</span> * <span class="keyword">from</span> emp e <span class="keyword">order</span> <span class="keyword">by</span> sal <span class="keyword">desc</span></span><br><span class="line">  )e <span class="keyword">where</span> <span class="keyword">rownum</span> &lt;=<span class="number">3</span>*<span class="number">5</span> </span><br><span class="line">)tt <span class="keyword">where</span> tt.rnm &gt;<span class="number">2</span>*<span class="number">5</span>;</span><br></pre></td></tr></table></figure>

<h4 id="8-3-分页查询-jack-o-lantern"><a href="#8-3-分页查询-jack-o-lantern" class="headerlink" title="8.3 分页查询 :jack_o_lantern:"></a>8.3 分页查询 :jack_o_lantern:</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 当前是第几页  page</span></span><br><span class="line"><span class="comment">-- 每页显示的记录数 size</span></span><br><span class="line"><span class="keyword">select</span> tt.*</span><br><span class="line"><span class="keyword">from</span>(</span><br><span class="line">  <span class="keyword">select</span> <span class="keyword">rownum</span> rnm,e.*</span><br><span class="line">  <span class="keyword">from</span>(</span><br><span class="line">    <span class="keyword">select</span> * <span class="keyword">from</span> emp e <span class="keyword">order</span> <span class="keyword">by</span> sal <span class="keyword">desc</span></span><br><span class="line">  )e <span class="keyword">where</span> <span class="keyword">rownum</span> &lt;= page*<span class="keyword">size</span></span><br><span class="line">)tt <span class="keyword">where</span> tt.rnm &gt; (page<span class="number">-1</span>)*<span class="keyword">size</span></span><br></pre></td></tr></table></figure>

<ul>
<li><input disabled type="checkbox"> </li>
</ul>

        
      
    </div>

    
    
    
      <footer class="post-footer">
          <div class="post-eof"></div>
        
      </footer>
  </div>
  
  
  
  </article>

    
        <article itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block home">
    <link itemprop="mainEntityOfPage" href="http://zwer.xyz/2018/11/28/数据库/20181128 SQL 语言/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="zwer">
      <meta itemprop="description" content="记录学习的日常">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="zwer 的博客空间">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
            
            <a href="/2018/11/28/数据库/20181128 SQL 语言/" class="post-title-link" itemprop="url">20181128 SQL 语言</a>
          
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              
                
              

              <time title="Created: 2018-11-28 19:00:00" itemprop="dateCreated datePublished" datetime="2018-11-28T19:00:00+08:00">2018-11-28</time>
            </span>
          
            

            
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2018-12-08 17:45:45" itemprop="dateModified" datetime="2018-12-08T17:45:45+08:00">2018-12-08</time>
              </span>
            
          
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/数据库/" itemprop="url" rel="index"><span itemprop="name">数据库</span></a></span>

                
                
              
            </span>
          

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h3 id="1-SQL-语言基础"><a href="#1-SQL-语言基础" class="headerlink" title="1 SQL 语言基础"></a>1 SQL 语言基础</h3><h4 id="1-1-SQL-语言定义"><a href="#1-1-SQL-语言定义" class="headerlink" title="1.1  SQL 语言定义"></a>1.1  SQL 语言定义</h4><ul>
<li>SQL，Structured Query Language 结构化查询语言</li>
<li>SQL 是所有关系型数据库的操作的标准语言</li>
<li>SQL 是非过程化语言-只需要告诉做什么，不需要关注怎么做</li>
</ul>
<h4 id="1-2-SQL-的用途"><a href="#1-2-SQL-的用途" class="headerlink" title="1.2  SQL 的用途"></a>1.2  SQL 的用途</h4><ul>
<li><p>数据库数据的增删改查操作(GRUD)</p>
</li>
<li><p>数据库对象（用户，表格，序列，索引)的创建，修改和删除操作</p>
</li>
<li><p>用户权限/角色的授予和取消</p>
</li>
<li><p>事务 (Transaction)</p>
</li>
</ul>
<h4 id="1-3-SQL-语言的分类"><a href="#1-3-SQL-语言的分类" class="headerlink" title="1.3  SQL 语言的分类"></a>1.3  SQL 语言的分类</h4><p>a)  DQL ，Data Query Language ，执行查询   select</p>
<p>b) DML,Data Manipulation Language，执行增删改的任务 insert delete update</p>
<p>c) DLL,Data Definition Language ,用于操作数库对象   add，modify，drop</p>
<p>d) DCL,Data Control Language，用于操作用户权限，grant，    revoke(撤与)</p>
<p>e) TCL, Transaction Control Language,    事务控制语言 commit，rollback</p>
<h4 id="1-4-关系数据库基本概念"><a href="#1-4-关系数据库基本概念" class="headerlink" title="1.4 关系数据库基本概念"></a>1.4 关系数据库基本概念</h4><ul>
<li><p>关系：整个二维表</p>
</li>
<li><p>关系名：表格名称</p>
</li>
<li><p>元组：行数据(记录)</p>
</li>
<li><p>属性：列数据(字段)</p>
</li>
<li><p>属性名：列名称(字段名)</p>
</li>
<li><p>主键：唯一确定元组的属性组(关键字)</p>
</li>
<li><p>域：属性的取值范围</p>
</li>
</ul>
<h3 id="2-select-子句"><a href="#2-select-子句" class="headerlink" title="2 select 子句"></a>2 select 子句</h3><h4 id="2-1-通配符"><a href="#2-1-通配符" class="headerlink" title="2.1 通配符 *"></a>2.1 通配符 *</h4><h4 id="2-2-select-用于指定查询表格中的列信息"><a href="#2-2-select-用于指定查询表格中的列信息" class="headerlink" title="2.2 select 用于指定查询表格中的列信息"></a>2.2 select 用于指定查询表格中的列信息</h4><h4 id="2-3-在-Oracle-中-双引号表示原样输出"><a href="#2-3-在-Oracle-中-双引号表示原样输出" class="headerlink" title="2.3 在 Oracle 中 双引号表示原样输出"></a>2.3 在 Oracle 中 双引号表示原样输出</h4><p>a) 查询<code>emp</code> 表格中所有的数据</p>
<ul>
<li>通配符 *</li>
</ul>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">seleclt  * from emp;</span><br></pre></td></tr></table></figure>

<p>b) 查询所有员工的编号，姓名，工作职位</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span>  empno,ename,job <span class="keyword">from</span> emp;</span><br></pre></td></tr></table></figure>

<p>c）查询所有员工的姓名，工作职位，年薪</p>
<p>​    年薪  as 可省略 别名中尽量不要使用特殊符号，若要使用，用<strong>双引号括</strong>起来。</p>
<p>​        在 Oracle 中，双引号中表示原样输出</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> ename job sal*<span class="number">12</span> <span class="keyword">as</span> annualsalary <span class="keyword">from</span> emp;</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> ename,job,sal*<span class="number">12</span> <span class="string">"年 薪"</span> <span class="keyword">from</span> emp;</span><br></pre></td></tr></table></figure>

<h3 id="3-distinct-字符串连接符-order-by"><a href="#3-distinct-字符串连接符-order-by" class="headerlink" title="3 distinct 字符串连接符 order by"></a>3 distinct 字符串连接符 order by</h3><h4 id="3-1-distinct-用于去除重复行信息"><a href="#3-1-distinct-用于去除重复行信息" class="headerlink" title="3.1  distinct 用于去除重复行信息"></a>3.1  distinct 用于去除重复行信息</h4><p>a） 查询所有的职位信息</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">distinct</span> job <span class="keyword">from</span> emp;</span><br></pre></td></tr></table></figure>

<p>b)  查询所有员工的姓名和职位</p>
<p>​    distinct 只能去除重复行，distinct 的作用的范围它后面的所有的列</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 加不加distinct，查询效果都一样</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">distinct</span> ename,job  <span class="keyword">from</span> emp;</span><br></pre></td></tr></table></figure>

<h4 id="3-2-字符串连接符"><a href="#3-2-字符串连接符" class="headerlink" title="3.2  字符串连接符 ||"></a>3.2  字符串连接符 ||</h4><blockquote>
<p>Oracle 中， 用单引号表示字符串</p>
</blockquote>
<p>a)  查询所有员工的姓名，职位和薪资，以 ‘姓名：xxx’的形式</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="string">'姓名:'</span>||ename,<span class="string">'工作职位:'</span>||job,<span class="string">'薪资:'</span>||sal <span class="keyword">from</span> emp;</span><br></pre></td></tr></table></figure>

<h4 id="3-3-order-by-子句"><a href="#3-3-order-by-子句" class="headerlink" title="3.3 order by 子句"></a>3.3 order by 子句</h4><blockquote>
<p>用于排序（数字、字符串、日期    ）</p>
</blockquote>
<blockquote>
<p>order by 子句写在<strong>最后</strong></p>
</blockquote>
<p>默认情况，以升序排列 ，支持多字段排序，别名排序</p>
<p>a）查询所有员工的信息，按照工资升序排列</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> emp <span class="keyword">order</span> <span class="keyword">by</span> sal;</span><br></pre></td></tr></table></figure>

<p>b）查询所有员工的信息，按照标号降序排列</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> emp <span class="keyword">order</span> <span class="keyword">by</span>  empno <span class="keyword">desc</span>;</span><br></pre></td></tr></table></figure>

<p>c）查询所有员工的信息，按照入职日期降序排列</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> emp <span class="keyword">order</span> <span class="keyword">by</span> hiredate <span class="keyword">desc</span>;</span><br></pre></td></tr></table></figure>

<p>d）查询所有员工的信息，按照姓名排序</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> emp <span class="keyword">order</span> <span class="keyword">by</span> ename <span class="keyword">asc</span>;</span><br></pre></td></tr></table></figure>

<p>e）查询所有员工的信息，按照薪资降序排序，如果薪资相同，将新员工排在前面</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> emp <span class="keyword">order</span> <span class="keyword">by</span> sal <span class="keyword">desc</span>, hiredate <span class="keyword">desc</span>;</span><br></pre></td></tr></table></figure>

<p>f）查询所有员工的姓名和年薪，按照薪资排序</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="string">'姓名:'</span>||ename <span class="keyword">as</span> <span class="string">"姓名"</span>, <span class="string">'年薪:'</span>||sal*<span class="number">12</span>  <span class="keyword">as</span> <span class="string">"年薪"</span> <span class="keyword">from</span> emp <span class="keyword">order</span> <span class="keyword">by</span> sal*<span class="number">12</span>;</span><br></pre></td></tr></table></figure>

<h3 id="4-where-子句-等值条件和非等值条件"><a href="#4-where-子句-等值条件和非等值条件" class="headerlink" title="4 where 子句 等值条件和非等值条件"></a>4 where 子句 等值条件和非等值条件</h3><h4 id="4-1-where-子句"><a href="#4-1-where-子句" class="headerlink" title="4.1 where 子句"></a>4.1 where 子句</h4><blockquote>
<p> 用于条件过滤</p>
</blockquote>
<p>a） 查询 十个部门的所有员工的信息</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> emp <span class="keyword">where</span> deptno = <span class="number">10</span> ;</span><br></pre></td></tr></table></figure>

<p>b） 查询 SCOTT 的详细信息</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> emp <span class="keyword">where</span> ename = <span class="string">'SCOTT'</span>;</span><br></pre></td></tr></table></figure>

<p>字符串必须加单引号，而且大小写敏感</p>
<p>c）查询 1980-4-19 入职的公司人员的所有信息 </p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> emp <span class="keyword">where</span> hiredate = <span class="string">'19-4月-87'</span>;</span><br></pre></td></tr></table></figure>

<ul>
<li>日期必须用单引号括起来</li>
<li>日期格式必须是 DD-MM月-YY年 的格式</li>
</ul>
<h4 id="4-2-等值条件和非等值条件"><a href="#4-2-等值条件和非等值条件" class="headerlink" title="4.2 等值条件和非等值条件"></a>4.2 等值条件和非等值条件</h4><p>a） 查询 工资在1500-3000 范围中的员工信息</p>
<ul>
<li><p>and</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> emp <span class="keyword">where</span>  sal &gt;= <span class="number">1500</span>  <span class="keyword">and</span> sal &lt;= <span class="number">3000</span>;</span><br></pre></td></tr></table></figure>
</li>
<li><p>between   and  表示一个范围 包含边界</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> emp <span class="keyword">where</span> sal <span class="keyword">between</span> <span class="number">1500</span> <span class="keyword">and</span> <span class="number">3000</span>;</span><br></pre></td></tr></table></figure>

</li>
</ul>
<p>b）查询 SCOTT 和  KING 的详细信息</p>
<ul>
<li>or </li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> emp <span class="keyword">where</span> ename = <span class="string">'SCOTT'</span> <span class="keyword">or</span> ename = <span class="string">'KING'</span>;</span><br></pre></td></tr></table></figure>

<ul>
<li>in </li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> emp <span class="keyword">where</span> ename <span class="keyword">in</span>(<span class="string">'SCOTT'</span>,<span class="string">'KING'</span>);</span><br></pre></td></tr></table></figure>

<p>c) 查询所有员工的信息，排除20部门</p>
<ul>
<li>!=  </li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> emp <span class="keyword">where</span> deptno != <span class="string">'20'</span>;</span><br></pre></td></tr></table></figure>

<ul>
<li>&lt;&gt; </li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> emp <span class="keyword">where</span> deptno &lt;&gt; <span class="number">20</span>;</span><br></pre></td></tr></table></figure>

<h4 id="4-3-模糊查询"><a href="#4-3-模糊查询" class="headerlink" title="4.3 模糊查询"></a>4.3 模糊查询</h4><blockquote>
<p> 使用 like(像) 查询，配合通配符实现 </p>
</blockquote>
<blockquote>
<p> ‘ -‘  表示 任意一个字符</p>
</blockquote>
<blockquote>
<p> ‘%’ 表示 任意个任意字符</p>
</blockquote>
<p>a） 查询首字母为 A 员工姓名的所有信息</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> emp <span class="keyword">where</span>  ename <span class="keyword">like</span>  <span class="string">'A%'</span>;</span><br></pre></td></tr></table></figure>

<p>b) 查询姓名中第二字母为 A 员工姓名的所有信息</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> emp <span class="keyword">where</span> ename <span class="keyword">like</span> <span class="string">'_A%'</span>;</span><br></pre></td></tr></table></figure>

<p>c） 查询姓名中带有字母   C 的员工的所有信息</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> emp <span class="keyword">where</span> ename <span class="keyword">like</span> <span class="string">'%C%'</span>;</span><br></pre></td></tr></table></figure>

<p>d）查询姓名中带有下划线_  员工的所有信息</p>
<p>escape 声明转义字符，注意转义字符只能是一个字符</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> emp <span class="keyword">where</span> ename <span class="keyword">like</span> <span class="string">'%t_%'</span> escape <span class="string">'t'</span>；</span><br></pre></td></tr></table></figure>

<h4 id="4-4-IS-NULL"><a href="#4-4-IS-NULL" class="headerlink" title="4.4 IS NULL"></a>4.4 IS NULL</h4><blockquote>
<p> 用于判断空值</p>
</blockquote>
<p>a） 查询所有没有提成的员工信息</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> *  <span class="keyword">from</span> emp <span class="keyword">where</span> comm <span class="keyword">is</span> <span class="literal">null</span>;</span><br></pre></td></tr></table></figure>

<p>b）查询所有有提成的员工信息</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> emp <span class="keyword">where</span> comm <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">null</span>;</span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> emp <span class="keyword">where</span> <span class="keyword">not</span> comm <span class="keyword">is</span> <span class="literal">null</span>;</span><br></pre></td></tr></table></figure>

<h4 id="4-5-and-和-or-的优先级"><a href="#4-5-and-和-or-的优先级" class="headerlink" title="4.5  and  和 or 的优先级"></a>4.5  and  和 or 的优先级</h4><blockquote>
<p> and 的优先级大于 or  的优先级</p>
</blockquote>
<p>a） 查询所有 CLERK 的信息和工资大于 1250 的 SALESMAN 的信息</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> *  <span class="keyword">from</span> emp <span class="keyword">where</span> job = <span class="string">'CLERK'</span> <span class="keyword">or</span> job = <span class="string">'SALESMAN'</span> <span class="keyword">and</span> sal &gt; <span class="number">1250</span>;</span><br></pre></td></tr></table></figure>

<p>b） 查询所有的 CLEAK 和 SALESMAN 的工资同时大于1250</p>
<p>​    加括号的优先级最高</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> *  <span class="keyword">from</span> emp <span class="keyword">where</span> (job = <span class="string">'CLERK'</span> <span class="keyword">or</span> job = <span class="string">'SALESMAN'</span>) <span class="keyword">and</span> sal &gt; <span class="number">1250</span>;</span><br></pre></td></tr></table></figure>

<h3 id="5-函数"><a href="#5-函数" class="headerlink" title="5 函数"></a>5 函数</h3><h4 id="5-1-字符函数"><a href="#5-1-字符函数" class="headerlink" title="5.1 字符函数"></a>5.1 字符函数</h4><h5 id="5-1-1-lower-upper-initcap"><a href="#5-1-1-lower-upper-initcap" class="headerlink" title="5.1.1  lower upper initcap"></a>5.1.1  lower upper initcap</h5><p>a） lower ，将所有字母小写</p>
<p>b） upper，将所有字母大写</p>
<p>c）initcap，将所有单词的首字母大写</p>
<p>查询所有员工的姓名，分别显示所有字母小写、所有字母大写，字母首字母大写    </p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">lower</span>(ename),<span class="keyword">upper</span>(ename),initcap(ename) <span class="keyword">from</span> emp;</span><br></pre></td></tr></table></figure>

<p>PS: 在 Oracle 中，提供了一个虚拟的表格 dual，用于测试，可以从 dual 表 中查询任何数据</p>
<h5 id="5-1-2-length"><a href="#5-1-2-length" class="headerlink" title="5.1.2 length"></a>5.1.2 length</h5><p>用于字符串的长度查询</p>
<p>a）查询所有员工的姓名及其姓名的长度</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> ename,<span class="keyword">length</span>(ename) <span class="keyword">from</span> emp;</span><br></pre></td></tr></table></figure>

<p>b）查询指定员工的姓名的长度为5的信息</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> ename <span class="keyword">from</span> emp <span class="keyword">where</span> <span class="keyword">length</span>(ename)=<span class="number">5</span>;</span><br></pre></td></tr></table></figure>

<h5 id="5-1-3-replace"><a href="#5-1-3-replace" class="headerlink" title="5.1.3 replace"></a>5.1.3 replace</h5><blockquote>
<p> 用于字符串的替换</p>
</blockquote>
<p>a）查询所有员工的姓名，将A替换为a</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> ename,<span class="keyword">replace</span>(ename,<span class="string">'A'</span>,<span class="string">'a'</span>) <span class="keyword">from</span> emp;</span><br></pre></td></tr></table></figure>

<h5 id="5-1-4-arrow-up-small-substr"><a href="#5-1-4-arrow-up-small-substr" class="headerlink" title="5.1.4 :arrow_up_small: substr"></a>5.1.4 :arrow_up_small: substr</h5><blockquote>
<p> 用于进行字符串的截取     </p>
</blockquote>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">substr(字段名，截取开始的位置，截取的长度（既可以是正向截取，也可以是反向截取）)</span><br></pre></td></tr></table></figure>

<p>​    PS：第三个参数可以省略，表示一直截取到末尾，所有可以简写</p>
<p>​         第二个参数可以是<strong>负数</strong>，表示从末尾开始截取，截取的长度是该负数的绝对值</p>
<p>a） 查询所有员工的姓名，并显示姓名的前三个字母</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> ename,<span class="keyword">substr</span>(ename,<span class="number">0</span>,<span class="number">3</span>) <span class="keyword">from</span> emp;</span><br></pre></td></tr></table></figure>

<p>b）查询所有员工的姓名，并显示姓名的后三个字母</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> ename,<span class="keyword">substr</span>(ename,<span class="keyword">length</span>(ename)<span class="number">-2</span>,<span class="number">3</span>),<span class="keyword">substr</span>(ename,<span class="keyword">length</span>(ename)<span class="number">-2</span>) <span class="keyword">from</span> emp;</span><br></pre></td></tr></table></figure>

<p><img src="http://www.zwer.xyz/picGo/20181201111907.png" alt></p>
<h4 id="5-2-数值函数"><a href="#5-2-数值函数" class="headerlink" title="5.2 数值函数"></a>5.2 数值函数</h4><h5 id="5-2-1-ceil"><a href="#5-2-1-ceil" class="headerlink" title="5.2.1  ceil"></a>5.2.1  ceil</h5><blockquote>
<p> 向上取整  </p>
</blockquote>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">ceil</span>(<span class="number">1234.00001</span>) <span class="keyword">from</span> dual;</span><br></pre></td></tr></table></figure>

<h5 id="5-2-2-floor"><a href="#5-2-2-floor" class="headerlink" title="5.2.2 floor"></a>5.2.2 floor</h5><blockquote>
<p> 向下取整</p>
</blockquote>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">floor</span>(<span class="number">1234.9999</span>) <span class="keyword">from</span> dual;</span><br></pre></td></tr></table></figure>

<h5 id="5-2-3-round"><a href="#5-2-3-round" class="headerlink" title="5.2.3 round"></a>5.2.3 round</h5><blockquote>
<p>四舍五入</p>
</blockquote>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">round</span>(<span class="number">123.345</span>),<span class="keyword">round</span>(<span class="number">123.567</span>) <span class="keyword">from</span> dual; <span class="comment">--123 124</span></span><br></pre></td></tr></table></figure>

<p>二个参数，第一个参数表示要处理的数，第二个参数可以控制四舍五入的位数</p>
<p>正数表示小数点，负数表示小数点前</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">round</span>(<span class="number">123.34343</span>,<span class="number">2</span>),<span class="keyword">round</span>(<span class="number">123.3434</span>,<span class="number">-2</span>),<span class="keyword">round</span>(<span class="number">123.3434</span>,<span class="number">-1</span>) <span class="keyword">from</span> dual;</span><br></pre></td></tr></table></figure>

<p><img src="http://www.zwer.xyz/picGo/20181201110916.png" alt="round 函数"></p>
<h5 id="5-2-3-trunc"><a href="#5-2-3-trunc" class="headerlink" title="5.2.3  trunc"></a>5.2.3  trunc</h5><blockquote>
<p>截断</p>
</blockquote>
<blockquote>
<p> 若指定保留小数的位数，则从保留小数位后面的数开始截断，否则小数位全部截断。</p>
</blockquote>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> trunc(<span class="number">123.34232434</span>),trunc(<span class="number">123243.23432</span>,<span class="number">2</span>),trunc(<span class="number">123</span>) <span class="keyword">from</span> dual;</span><br></pre></td></tr></table></figure>

<p><img src="http://www.zwer.xyz/picGo/20181201111159.png" alt></p>
<h4 id="5-3-日期函数"><a href="#5-3-日期函数" class="headerlink" title="5.3 日期函数"></a>5.3 日期函数</h4><h5 id="5-3-1-months-between"><a href="#5-3-1-months-between" class="headerlink" title="5.3.1 months_between"></a>5.3.1 months_between</h5><blockquote>
<p> 计算两个月份之前的减法</p>
</blockquote>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--获取当前时间</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">sysdate</span> <span class="keyword">from</span> dual;</span><br></pre></td></tr></table></figure>

<p>查询所有员工入职的月份</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> months_between(<span class="keyword">sysdate</span>,hiredate) <span class="keyword">from</span> emp;   </span><br><span class="line"><span class="keyword">select</span> months_between(hiredate,<span class="keyword">sysdate</span>) <span class="keyword">from</span> emp;  <span class="comment">-- 负数</span></span><br><span class="line"><span class="keyword">select</span> months_between(<span class="keyword">sysdate</span>,<span class="string">'3-9月-2016'</span>)  <span class="keyword">as</span> <span class="string">"入学时间到现在的月份"</span> <span class="keyword">from</span>  dual;</span><br><span class="line"><span class="keyword">select</span> <span class="keyword">floor</span>(months_between(<span class="keyword">sysdate</span>,<span class="keyword">to_date</span>(<span class="string">'2016-9-3 2:00'</span>,<span class="string">'YYYY-MM-DD HH:MI'</span>)) ) <span class="string">"入学时间到现在的月份"</span> <span class="keyword">from</span> dual; <span class="comment">--26</span></span><br></pre></td></tr></table></figure>

<h5 id="5-3-2-add-months"><a href="#5-3-2-add-months" class="headerlink" title="5.3.2 add_months"></a>5.3.2 add_months</h5><blockquote>
<p> 给日期加减月数</p>
</blockquote>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> add_months(<span class="keyword">sysdate</span>,<span class="number">1</span>) <span class="keyword">from</span> dual;</span><br><span class="line"><span class="keyword">select</span> add_months(<span class="keyword">sysdate</span>,<span class="number">-27</span>) <span class="keyword">from</span> dual;</span><br></pre></td></tr></table></figure>

<h5 id="5-3-3-last-day"><a href="#5-3-3-last-day" class="headerlink" title="5.3.3 last_day"></a>5.3.3 last_day</h5><blockquote>
<p> 计算给定日期所在月份的最后一天</p>
</blockquote>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">last_day</span>(<span class="keyword">sysdate</span>) <span class="keyword">from</span> dual;</span><br><span class="line"><span class="keyword">select</span> <span class="keyword">last_day</span>(<span class="string">'1-2月-2018'</span>) <span class="keyword">from</span> dual;</span><br></pre></td></tr></table></figure>

<h5 id="5-3-4-next-day"><a href="#5-3-4-next-day" class="headerlink" title="5.3.4 next_day"></a>5.3.4 next_day</h5><blockquote>
<p> 基于给定日期计算下个<strong>给定星期几</strong>是什么日期</p>
</blockquote>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> next_day(<span class="keyword">sysdate</span>,<span class="string">'星期五'</span>) <span class="keyword">from</span> dual;</span><br><span class="line"><span class="keyword">select</span> next_day(<span class="string">'8-12月-2018'</span>,<span class="string">'星期六'</span>) <span class="keyword">from</span> dual;</span><br></pre></td></tr></table></figure>

<h4 id="5-4-转换函数"><a href="#5-4-转换函数" class="headerlink" title="5.4 转换函数"></a>5.4 转换函数</h4><blockquote>
<p> 用于在不同数据类型键进行转换，数值类型，字符串类型，日期类</p>
</blockquote>
<h5 id="5-4-1-to-number"><a href="#5-4-1-to-number" class="headerlink" title="5.4.1 to_number"></a>5.4.1 to_number</h5><blockquote>
<p> 将字符串转换为数字   L999,999,999.000</p>
</blockquote>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> to_number(<span class="string">'$12,456,789'</span>,<span class="string">'$999,999,999.00'</span>) <span class="keyword">as</span> <span class="string">"将字符串转换为数字"</span> <span class="keyword">from</span> dual;</span><br></pre></td></tr></table></figure>

<h5 id="5-4-2-to-date"><a href="#5-4-2-to-date" class="headerlink" title="5.4.2 to_date"></a>5.4.2 to_date</h5><blockquote>
<p> 将字符串转换为日期   YYYY-MM-DD HH24:MI:SS  </p>
</blockquote>
<blockquote>
<p> HH24 表示 24 小时制，而 HH 表示 12 小时制</p>
</blockquote>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">to_date</span>(<span class="string">'2018-12-14 14:30:00'</span>,<span class="string">'YYYY-MM-DD HH24:MI:SS'</span>) <span class="keyword">as</span> <span class="string">"六级考试时间"</span> <span class="keyword">from</span> dual;</span><br></pre></td></tr></table></figure>

<h5 id="5-4-3-to-char"><a href="#5-4-3-to-char" class="headerlink" title="5.4.3 to_char"></a>5.4.3 to_char</h5><blockquote>
<p> 将数字或日期转换为字符串  </p>
</blockquote>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> to_char(<span class="number">123456789</span>,<span class="string">'L999,999,999.00'</span>) <span class="keyword">as</span> <span class="string">"人民币"</span> <span class="keyword">from</span> dual;</span><br><span class="line"><span class="keyword">select</span> to_char(<span class="number">123456789</span>,<span class="string">'$999,999,999.00'</span>) <span class="keyword">as</span> <span class="string">"美元"</span> <span class="keyword">from</span> dual;</span><br><span class="line"><span class="keyword">select</span> to_char(<span class="keyword">sysdate</span>,<span class="string">'YYYY"年",MM"月",DD"日" HH24:MI:SS'</span>) <span class="keyword">as</span> <span class="string">"当前时间"</span> <span class="keyword">from</span> dual;</span><br></pre></td></tr></table></figure>

<p><img src="http://www.zwer.xyz/picGo/20181201120024.png" alt></p>
<h4 id="5-5-通用函数-其他函数"><a href="#5-5-通用函数-其他函数" class="headerlink" title="5.5 通用函数 (其他函数)"></a>5.5 通用函数 (其他函数)</h4><h5 id="5-5-1-nvl"><a href="#5-5-1-nvl" class="headerlink" title="5.5.1  nvl"></a>5.5.1  nvl</h5><blockquote>
<p>nvl (判断是否为空的字段名，要替换的值)</p>
</blockquote>
<blockquote>
<p>用来处理空值，如果某个字段为空，则使用对应的数据进行替换</p>
</blockquote>
<p>注意：替换的数据类型必须<strong>原数据类型一致</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 查询所有员工的的姓名，提升，工资，工资+提升 的信息</span></span><br><span class="line"><span class="keyword">select</span> ename,comm,sal+comm <span class="keyword">from</span> emp;</span><br><span class="line"><span class="keyword">select</span> ename,comm,sal+nvl(comm,<span class="number">0</span>) total <span class="keyword">from</span> emp;</span><br></pre></td></tr></table></figure>

<h5 id="5-5-2-nvl2"><a href="#5-5-2-nvl2" class="headerlink" title="5.5.2 nvl2"></a>5.5.2 nvl2</h5><p>有三个参数，如果第一个参数不为空，则使用第二个参数，如果为空，</p>
<p>则使用第三个参数</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> ename,comm,nvl2(comm,sal+comm,sal)total <span class="keyword">from</span> emp;</span><br></pre></td></tr></table></figure>

<h5 id="5-5-3-decode"><a href="#5-5-3-decode" class="headerlink" title="5.5.3 decode"></a>5.5.3 decode</h5><p>类似于 switch…case…</p>
<p>将所有工作职位的英文名称换成中文显示</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">distinct</span> job,<span class="keyword">decode</span>(job,<span class="string">'CLERK'</span>,<span class="string">'职员'</span>,<span class="string">'SALESMAN'</span>,<span class="string">'销售'</span>,<span class="string">'PRESIDENT'</span>,<span class="string">'总经理'</span>,<span class="string">'MANAGER'</span>,<span class="string">'项目经理'</span>,<span class="string">'ANALYST'</span>,<span class="string">'分析师'</span>) job <span class="keyword">from</span> emp;</span><br></pre></td></tr></table></figure>

<p><img src="http://www.zwer.xyz/picGo/20181201150345.png" alt></p>
<h4 id="5-6-分组函数-聚组函数-多行函数"><a href="#5-6-分组函数-聚组函数-多行函数" class="headerlink" title="5.6 分组函数(聚组函数)  多行函数"></a>5.6 分组函数(聚组函数)  多行函数</h4><p>PS： 注意所有的分组函数都不对空值进行处理</p>
<h5 id="5-6-1-sum"><a href="#5-6-1-sum" class="headerlink" title="5.6.1 sum"></a>5.6.1 sum</h5><blockquote>
<p>求和</p>
</blockquote>
<p>​    查询所有员工的工资总和</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">sum</span>(sal) total <span class="keyword">from</span> emp;</span><br></pre></td></tr></table></figure>

<h5 id="5-6-2-avg"><a href="#5-6-2-avg" class="headerlink" title="5.6.2 avg"></a>5.6.2 avg</h5><blockquote>
<p>求平均数</p>
</blockquote>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 查询平均工资</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">avg</span>(sal) total <span class="keyword">from</span> emp;</span><br></pre></td></tr></table></figure>

<h5 id="5-6-3-max"><a href="#5-6-3-max" class="headerlink" title="5.6.3 max"></a>5.6.3 max</h5><blockquote>
<p>求最大值</p>
</blockquote>
<p>统计公司员工中工资最高者</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">max</span>(sal) <span class="keyword">from</span> emp;</span><br></pre></td></tr></table></figure>

<h5 id="5-6-4-min"><a href="#5-6-4-min" class="headerlink" title="5.6.4 min"></a>5.6.4 min</h5><blockquote>
<p> 求最小值</p>
</blockquote>
<p>统计公司员工中工资最低者</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">min</span>(sal) <span class="keyword">from</span> emp;</span><br></pre></td></tr></table></figure>

<h5 id="5-6-5-count"><a href="#5-6-5-count" class="headerlink" title="5.6.5 count"></a>5.6.5 count</h5><blockquote>
<p> 计数</p>
</blockquote>
<p>统计公司中人员总数</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">count</span>(empno) <span class="keyword">from</span> emp;</span><br><span class="line"><span class="keyword">select</span> <span class="keyword">count</span>(*) <span class="keyword">from</span> emp;</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">select count(*) from emp;  </span><br><span class="line">-- * 表示所有满足统计条件的字段，并且不对空值进行处理</span><br></pre></td></tr></table></figure>

<h3 id="6-分组查询-group-by-having"><a href="#6-分组查询-group-by-having" class="headerlink" title="6 分组查询 group by  having"></a>6 分组查询 group by  having</h3><p>进行分组查询， ground by 子句可以将查询分为若干个组</p>
<h5 id="6-1-1分组查询"><a href="#6-1-1分组查询" class="headerlink" title="6.1.1分组查询"></a>6.1.1分组查询</h5><p>注意：出现在 select 列表中的<strong>字段</strong>，如果不是包括在多行函数中，那么该字段</p>
<p>必须<strong>同时在 group by 子句中出现</strong></p>
<p>a） 统计每个部门的编号，最高工资和最低工资</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> deptno,<span class="keyword">max</span>(sal)k,<span class="keyword">min</span>(sal) </span><br><span class="line"><span class="keyword">from</span> emp </span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> deptno </span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> deptno;</span><br></pre></td></tr></table></figure>

<h5 id="6-1-2-带-where-子句的分组查询"><a href="#6-1-2-带-where-子句的分组查询" class="headerlink" title="6.1.2 带 where 子句的分组查询"></a>6.1.2 带 where 子句的分组查询</h5><p>a）查询每个部门的人数和平均工资，排除 10 部门</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> deptno,<span class="keyword">count</span>(deptno),trunc(<span class="keyword">avg</span>(sal)) </span><br><span class="line"><span class="keyword">from</span> emp </span><br><span class="line"><span class="keyword">where</span> deptno &lt;&gt; <span class="number">10</span> </span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> deptno </span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> deptno;</span><br></pre></td></tr></table></figure>

<h5 id="6-1-3-having"><a href="#6-1-3-having" class="headerlink" title="6.1.3 having"></a>6.1.3 having</h5><p>注意：</p>
<ul>
<li>where 子句 不允许使用分组函数    </li>
</ul>
<p>a）查询每个部门的总工资和平均工资，排除平均工资低于1600的部门</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> deptno,<span class="keyword">sum</span>(sal),trunc(<span class="keyword">avg</span>(sal)) </span><br><span class="line"><span class="keyword">from</span> emp </span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> deptno </span><br><span class="line"><span class="keyword">having</span> <span class="keyword">avg</span>(sal) &gt; <span class="number">1600</span> </span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> deptno;</span><br></pre></td></tr></table></figure>

<h5 id="6-1-4-select-语句的执行顺序-arrow-up-small"><a href="#6-1-4-select-语句的执行顺序-arrow-up-small" class="headerlink" title="6.1.4 select 语句的执行顺序 :arrow_up_small:"></a>6.1.4 select 语句的执行顺序 :arrow_up_small:</h5><p> from -&gt; where - &gt;     group by -&gt; select - &gt; having  -.&gt; ord    er by</p>
<p>a）在 emp 表中，列出 工资最小 &lt; 2000 的职位</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> job</span><br><span class="line"><span class="keyword">from</span> emp</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> job</span><br><span class="line"><span class="keyword">having</span> <span class="keyword">avg</span>(sal) &gt; <span class="number">2000</span></span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> job</span><br></pre></td></tr></table></figure>

<p>b）在 emp 表中，列出 平均工资大于 1200 元的部门和工作搭配的组合</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> deptno,job</span><br><span class="line"><span class="keyword">from</span> emp </span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> deptno,job</span><br><span class="line"><span class="keyword">having</span> <span class="keyword">avg</span>(sal) &gt; <span class="number">1200</span></span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> deptno</span><br></pre></td></tr></table></figure>

<p><img src="C:%5CUsers%5CLenovo%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1543650935180.png" alt="1543650935180"></p>
<p>思考题：</p>
<ul>
<li>统计人数小于 4 的部门的平均工资</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">select deptno,avg(sal)</span><br><span class="line">from emp </span><br><span class="line">group by deptno</span><br><span class="line">having count(deptno) &lt; 4;</span><br></pre></td></tr></table></figure>

<ul>
<li>统计个部门的最高工资，排除最高工资小于 3000 的部门 </li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> deptno,<span class="keyword">max</span>(sal)</span><br><span class="line"><span class="keyword">from</span> emp</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> deptno</span><br><span class="line"><span class="keyword">having</span> <span class="keyword">max</span>(sal) &gt; <span class="number">3000</span></span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> deptno;</span><br></pre></td></tr></table></figure>

<h3 id="7-DML"><a href="#7-DML" class="headerlink" title="7  DML"></a>7  DML</h3><blockquote>
<p>DML，Data Manipulation Language, (数据库操作语言)，执行增删改查</p>
</blockquote>
<h5 id="7-1-复制一个测试表格"><a href="#7-1-复制一个测试表格" class="headerlink" title="7.1 复制一个测试表格"></a>7.1 复制一个测试表格</h5><p>a)     复制一个 emp 表格，并命名为 temp</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> temp <span class="keyword">as</span> (<span class="keyword">select</span> * <span class="keyword">from</span> emp); <span class="comment">-- 复制表格</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">view</span> v_temp <span class="keyword">as</span>(<span class="keyword">select</span> * <span class="keyword">from</span> emp); <span class="comment">-- 创建视图</span></span><br></pre></td></tr></table></figure>

<p>b） 复制一个 emp 表格，只复制表结构，不复制表内容</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> temp2 <span class="keyword">as</span> (<span class="keyword">select</span> * <span class="keyword">from</span> emp <span class="keyword">where</span> <span class="number">1</span> = <span class="number">3</span>);</span><br></pre></td></tr></table></figure>

<h5 id="7-2-新增-（insert-into）"><a href="#7-2-新增-（insert-into）" class="headerlink" title="7.2 新增  （insert into）"></a>7.2 新增  （insert into）</h5><p>a） 语法</p>
<p>insert  into 表名 [(列1，列2….)] values(值1，值2);</p>
<p>b） 向 temp2 表格中插入一条数据</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> temp2(EMPNO,ENAME,JOB,MGR,HIREDATE,SAL,COMM,DEPTNO) <span class="keyword">values</span>(</span><br><span class="line"><span class="string">'1234'</span>,<span class="string">'小方'</span>,<span class="string">'学生'</span>,<span class="string">'1111'</span>,<span class="keyword">to_date</span>(<span class="string">'2018-12-1'</span>,<span class="string">'yyyy-mm-dd'</span>),<span class="number">500</span>,<span class="number">90</span>,<span class="number">10</span>);</span><br></pre></td></tr></table></figure>

<p>c） 当表格的每一列都要插入数据时，可以省略列名</p>
<p>需要列的位置与值的位置是<strong>对应的</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> temp2 <span class="keyword">values</span>(<span class="string">'4567'</span>,<span class="string">'小孔'</span>,<span class="string">'学生'</span>,<span class="string">'1112'</span>,<span class="keyword">to_date</span>(<span class="string">'18-12-1'</span>,<span class="string">'yy-mm-dd'</span>),<span class="number">500</span>,<span class="number">80</span>,<span class="number">20</span>);</span><br></pre></td></tr></table></figure>

<h5 id="7-3-修改-update"><a href="#7-3-修改-update" class="headerlink" title="7.3 修改(update)"></a>7.3 修改(update)</h5><p>a）语法</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">update</span> 表名 <span class="keyword">set</span> 列<span class="number">1</span>= 值<span class="number">1</span>[列=值...][<span class="keyword">where</span> 条件]</span><br></pre></td></tr></table></figure>

<p>b) 将 10 部门的工资调高 10%</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">update</span> temp2 <span class="keyword">set</span> sal=sal*<span class="number">1.1</span></span><br></pre></td></tr></table></figure>

<h5 id="7-4-删除-delete-from"><a href="#7-4-删除-delete-from" class="headerlink" title="7.4 删除(delete from )"></a>7.4 删除(delete from )</h5><p>a) 语法</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">delete</span> [<span class="keyword">from</span>] 表名 [<span class="keyword">where</span> 条件]</span><br></pre></td></tr></table></figure>

<p>b) 删除编号为 12345 的人员的信息</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">delete</span> <span class="keyword">from</span> temp2 <span class="keyword">where</span> empno=<span class="number">1234</span>;   <span class="comment">-- 删除单条记录</span></span><br><span class="line"><span class="keyword">drop</span> <span class="keyword">table</span> temp2 					<span class="comment">-- 删除整张表格，不保留表结构</span></span><br><span class="line"><span class="keyword">delete</span> temp2					    <span class="comment">-- 仅删除表格中的数据，保留表结构</span></span><br></pre></td></tr></table></figure>

<h3 id="8-SQL-99-多表连接查询"><a href="#8-SQL-99-多表连接查询" class="headerlink" title="8 SQL 99  多表连接查询"></a>8 SQL 99  多表连接查询</h3><h5 id="8-1-cross-join-交叉连接"><a href="#8-1-cross-join-交叉连接" class="headerlink" title="8.1  cross  join   交叉连接"></a>8.1  cross  join   交叉连接</h5><blockquote>
<p> 交叉连接会产生一个笛卡尔积</p>
</blockquote>
<blockquote>
<p> 在笛卡尔积，有很多无意义的数据，所以需要消除,使用 where 子句 </p>
</blockquote>
<blockquote>
<p> 表的别名直接在后面加别名，中间用空格隔开</p>
</blockquote>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> *  <span class="keyword">from</span> emp <span class="keyword">cross</span> <span class="keyword">join</span> dept;</span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> emp <span class="keyword">cross</span> <span class="keyword">join</span> dept <span class="keyword">where</span> emp.deptno = dept.deptno;</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> emp.*,dept.dname,dept.loc </span><br><span class="line"><span class="keyword">from</span> emp <span class="keyword">cross</span> <span class="keyword">join</span> dept </span><br><span class="line"><span class="keyword">where</span> emp.deptno = dept.deptno;</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> e.*,d.dname,d.loc </span><br><span class="line"><span class="keyword">from</span> emp e </span><br><span class="line"><span class="keyword">cross</span> <span class="keyword">join</span> dept d </span><br><span class="line"><span class="keyword">where</span> e.deptno = d.deptno;</span><br></pre></td></tr></table></figure>

<h5 id="8-2-natural-join-自然连接"><a href="#8-2-natural-join-自然连接" class="headerlink" title="8.2 natural join 自然连接"></a>8.2 natural join 自然连接</h5><blockquote>
<p> natural join 用于针对多张表的同名字段进行等值连接</p>
</blockquote>
<p>特点：</p>
<p>a）在自然连接时，自动进行所有通名列的等值连接，不需要写连接的条件</p>
<p>b）<strong>同名列只显示一列，而且在使用时，不能加表前缀</strong></p>
<p>查询所有员工的姓名，部门编号和部门名称</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> e.ename,deptno,d.dname </span><br><span class="line"><span class="keyword">from</span> emp e </span><br><span class="line"><span class="keyword">natural</span> <span class="keyword">join</span> dept d</span><br></pre></td></tr></table></figure>

<h5 id="8-3-using-子句"><a href="#8-3-using-子句" class="headerlink" title="8.3  using 子句"></a>8.3  using 子句</h5><blockquote>
<p> 用来指定进行等值连接的同名字段，针对自然连接提供的。</p>
</blockquote>
<ul>
<li>PS： 使用 using 子句，后面的加的字段名必须用 圆括号()括起来</li>
</ul>
<p>a） 查询 20 部门的员工的姓名，工资，部门编号和部门名称</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> e.ename,e.sal,deptno,d.dname  </span><br><span class="line"><span class="keyword">from</span> emp e </span><br><span class="line"><span class="keyword">natural</span> <span class="keyword">join</span> dept d </span><br><span class="line"><span class="keyword">where</span> deptno = <span class="number">20</span>;</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> e.ename,e.sal,deptno,d.dname </span><br><span class="line"><span class="keyword">from</span> emp e </span><br><span class="line"><span class="keyword">join</span> dept d  </span><br><span class="line"><span class="keyword">using</span> (deptno)   <span class="comment">-- 使用圆括号 ()</span></span><br><span class="line"><span class="keyword">where</span> deptno = <span class="number">20</span>;</span><br></pre></td></tr></table></figure>

<h5 id="8-4-on-子句"><a href="#8-4-on-子句" class="headerlink" title="8.4  on 子句"></a>8.4  on 子句</h5><p>on 子句使用非常广泛的子句</p>
<p>它可以被用来<strong>指定连接的条件</strong>(既可以指定等值连接，也可以非等值连接)</p>
<p>a) 查询所有员工的姓名，工资和工资等级</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> e.ename,e.sal,s.grade <span class="keyword">from</span> emp e <span class="keyword">join</span> salgrade s  <span class="keyword">on</span> e.sal &gt;= s.losal <span class="keyword">and</span> e.sal &lt;= s.hisal;</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> e.ename,e.sal,s.grade <span class="keyword">from</span> emp e <span class="keyword">join</span> salgrade s  <span class="keyword">on</span> e.sal <span class="keyword">between</span> s.losal <span class="keyword">and</span> s.hisal;</span><br></pre></td></tr></table></figure>

<p>b) 查询 30 部门员工的编号，姓名，部门名称和所在地</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> e.empno,e.ename,d.dname,d.loc </span><br><span class="line"><span class="keyword">from</span> emp e </span><br><span class="line"><span class="keyword">join</span> dept d </span><br><span class="line"><span class="keyword">on</span>  e.deptno = d.deptno </span><br><span class="line"><span class="keyword">where</span> e.deptno = <span class="number">30</span></span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> e.ename <span class="keyword">asc</span>;</span><br></pre></td></tr></table></figure>

<p>c) 查询 所有员工姓名 ，部门名称，工资和工资等级</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> e.ename,e.deptno,e.sal,s.grade</span><br><span class="line"><span class="keyword">from</span> emp  e</span><br><span class="line"><span class="keyword">join</span> dept d</span><br><span class="line"><span class="keyword">on</span> e.deptno = d.deptno   <span class="comment">-- 可以替换为自然连接</span></span><br><span class="line"><span class="keyword">join</span> salgrade s </span><br><span class="line"><span class="keyword">on</span> e.sal <span class="keyword">between</span> s.losal <span class="keyword">and</span> s.hisal </span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> e.ename,e.deptno <span class="keyword">desc</span>;</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> e.ename,deptno,e.sal,s.grade</span><br><span class="line"><span class="keyword">from</span> emp  e</span><br><span class="line"><span class="keyword">natural</span> <span class="keyword">join</span> dept d  <span class="comment">-- 自然连接 </span></span><br><span class="line"><span class="keyword">join</span> salgrade s </span><br><span class="line"><span class="keyword">on</span> e.sal <span class="keyword">between</span> s.losal <span class="keyword">and</span> s.hisal  <span class="comment">-- 非等值连接</span></span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> e.ename,deptno <span class="keyword">desc</span>;</span><br></pre></td></tr></table></figure>

<ul>
<li>n 张表 至少需要 n-1个连接条件</li>
</ul>
<h4 id="8-5-外连接"><a href="#8-5-外连接" class="headerlink" title="8.5 外连接"></a>8.5 外连接</h4><p>外连接除了显示满足连接的条件，也能显示不满足连接条件的数据</p>
<h5 id="8-5-1-左外连接"><a href="#8-5-1-左外连接" class="headerlink" title="8.5.1 左外连接"></a>8.5.1 左外连接</h5><p>left [outer] join,表示 左外连接，可以显示左表中不满足连接条件的数据</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">select</span> e.ename,e.job,d.deptno,d.dname</span><br><span class="line"><span class="keyword">from</span> dept d</span><br><span class="line"><span class="keyword">left</span> <span class="keyword">join</span> emp  e</span><br><span class="line"><span class="keyword">on</span> e.deptno = d.deptno</span><br></pre></td></tr></table></figure>

<h5 id="8-5-1-右外连接"><a href="#8-5-1-右外连接" class="headerlink" title="8.5.1 右外连接"></a>8.5.1 右外连接</h5><p>right [outer] join ，表示右外连接，可以显示右表中不满足连接条件的数据</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">select</span> e.ename,e.job,d.deptno,d.dname</span><br><span class="line"><span class="keyword">from</span> emp  e</span><br><span class="line"><span class="keyword">right</span> <span class="keyword">join</span> dept d</span><br><span class="line"><span class="keyword">on</span> e.deptno = d.deptno</span><br></pre></td></tr></table></figure>

<h5 id="8-5-1-全外连接"><a href="#8-5-1-全外连接" class="headerlink" title="8.5.1 全外连接"></a>8.5.1 全外连接</h5><p>full [outer] join ，表示 全外连接，可以显示左右表中不满足连接条件的数据</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> e1.empno,e1.ename,e2.ename</span><br><span class="line"><span class="keyword">from</span> emp e1</span><br><span class="line"><span class="keyword">full</span> <span class="keyword">join</span> emp e2    <span class="comment">--全外连接</span></span><br><span class="line"><span class="keyword">on</span> e1.mgr = e2.empno</span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> e1.ename</span><br></pre></td></tr></table></figure>

<p><img src="http://www.zwer.xyz/picGo/20181203211659.png" alt></p>
<ul>
<li>内连接：只返回满足条件的数据 </li>
</ul>
<h5 id="8-6-自连接"><a href="#8-6-自连接" class="headerlink" title="8.6 自连接"></a>8.6 自连接</h5><p>自连接是发生在<strong>同一个表格</strong>中的连接</p>
<p>a）查询所有员工的编号，姓名和领导的编号及姓名</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> e1.empno,e1.ename,e2.ename</span><br><span class="line"><span class="keyword">from</span> emp e1</span><br><span class="line"><span class="keyword">join</span> emp e2</span><br><span class="line"><span class="keyword">on</span> e1.mgr = e2.empno</span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> e1.ename;</span><br></pre></td></tr></table></figure>

<p><img src="http://www.zwer.xyz/picGo/20181203211514.png" alt></p>
<p>b）查询所有员工的编号，姓名和领导的编号及姓名还有大BOSS –King</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> e1.empno,e1.ename,e2.ename</span><br><span class="line"><span class="keyword">from</span> emp e1</span><br><span class="line"><span class="keyword">left</span> <span class="keyword">join</span> emp e2  </span><br><span class="line"><span class="keyword">on</span> e1.mgr = e2.empno</span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> e1.ename</span><br></pre></td></tr></table></figure>

<p><img src="http://www.zwer.xyz/picGo/20181203211600.png" alt></p>
<p>c) 查询所有员工的编号，姓名和领导的编号及姓名还有普通员工</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> e1.empno,e1.ename,e2.ename</span><br><span class="line"><span class="keyword">from</span> emp e1</span><br><span class="line"><span class="keyword">full</span> <span class="keyword">join</span> emp e2    <span class="comment">--全外连接</span></span><br><span class="line"><span class="keyword">on</span> e1.mgr = e2.empno</span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> e1.ename</span><br></pre></td></tr></table></figure>

<p><img src="http://www.zwer.xyz/picGo/20181203211659.png" alt></p>
<h3 id="9-SQL-92-多表查询"><a href="#9-SQL-92-多表查询" class="headerlink" title="9  SQL 92 多表查询"></a>9  SQL 92 多表查询</h3><h4 id="9-1-笛卡尔积"><a href="#9-1-笛卡尔积" class="headerlink" title="9.1 笛卡尔积"></a>9.1 笛卡尔积</h4><p>多张表通过逗号分隔，</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> emp,dept ;</span><br></pre></td></tr></table></figure>

<p>通过 where 子句 消除无意义的连接</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> emp e,dept d</span><br><span class="line"><span class="keyword">where</span> e.deptno = d.deptno;</span><br></pre></td></tr></table></figure>

<h4 id="9-2-等值连接"><a href="#9-2-等值连接" class="headerlink" title="9.2  等值连接"></a>9.2  等值连接</h4><p>a) 查询员工的名字，工作职位，部门名称。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> e.ename,e.job,d.dname</span><br><span class="line"><span class="keyword">from</span> emp e,dept d</span><br><span class="line"><span class="keyword">where</span> e.deptno = d.deptno;</span><br></pre></td></tr></table></figure>

<h4 id="9-3-非等值连接"><a href="#9-3-非等值连接" class="headerlink" title="9.3 非等值连接"></a>9.3 非等值连接</h4><p>a) 查询 所有员工的姓名，工资和工资等级 </p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> e.ename,e.sal,s.grade</span><br><span class="line"><span class="keyword">from</span> emp e,salgrade s</span><br><span class="line"><span class="keyword">where</span> e.sal <span class="keyword">between</span> s.losal <span class="keyword">and</span> s.hisal</span><br></pre></td></tr></table></figure>

<h4 id="9-4-外连接"><a href="#9-4-外连接" class="headerlink" title="9.4 外连接"></a>9.4 外连接</h4><p>通过 “（+）”  符号实现外连接</p>
<h5 id="9-4-1-左外连接"><a href="#9-4-1-左外连接" class="headerlink" title="9.4.1 左外连接"></a>9.4.1 左外连接</h5><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> e.ename,e.job,d.deptno,d.dname</span><br><span class="line"><span class="keyword">from</span> emp e,dept d</span><br><span class="line"><span class="keyword">where</span> e.deptno = d.deptno(+);</span><br></pre></td></tr></table></figure>

<h5 id="9-4-2-右外连接"><a href="#9-4-2-右外连接" class="headerlink" title="9.4.2 右外连接"></a>9.4.2 右外连接</h5><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> e.ename,e.job,d.deptno,d.dname</span><br><span class="line"><span class="keyword">from</span> emp e,dept d</span><br><span class="line"><span class="keyword">where</span> e.deptno(+) = d.deptno;</span><br></pre></td></tr></table></figure>

<p>注意： SQL92 不支持全外连接</p>
<h4 id="9-5-自连接"><a href="#9-5-自连接" class="headerlink" title="9.5 自连接"></a>9.5 自连接</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> e1.empno,e2.ename</span><br><span class="line"><span class="keyword">from</span> emp e1,emp e2</span><br><span class="line"><span class="keyword">where</span> e1.mgr = e2.empno</span><br></pre></td></tr></table></figure>

<h3 id="10-子查询"><a href="#10-子查询" class="headerlink" title="10 子查询"></a>10 子查询</h3><blockquote>
<p>用于当一次查询的<u>结果</u>作为另一次查询所需要的时候，可以使用子查询</p>
</blockquote>
<h4 id="10-1-单行子查询"><a href="#10-1-单行子查询" class="headerlink" title="10.1 单行子查询"></a>10.1 单行子查询</h4><blockquote>
<p> 子查询的返回结果是<u>单行数据</u></p>
</blockquote>
<p>a) 查询所有此 CLERK(人名) 工资高的员工的信息</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * </span><br><span class="line"><span class="keyword">from</span> emp </span><br><span class="line"><span class="keyword">where</span> sal &gt; (<span class="keyword">select</span> sal <span class="keyword">from</span> emp <span class="keyword">where</span> ename= <span class="string">'CLARK'</span>);</span><br></pre></td></tr></table></figure>

<p>b) 查询工资高于平均工资的雇员名字和工资</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> e.ename,e.sal</span><br><span class="line"><span class="keyword">from</span> emp e</span><br><span class="line"><span class="keyword">where</span> sal &gt; (<span class="keyword">select</span> <span class="keyword">avg</span>(sal) <span class="keyword">from</span> emp);</span><br></pre></td></tr></table></figure>

<p>c) 查询和 SCOTT 同一部门且比他工资低的雇员的名字和工资</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> ename,sal</span><br><span class="line"><span class="keyword">from</span> emp </span><br><span class="line"><span class="keyword">where</span> deptno =  (<span class="keyword">select</span> deptno <span class="keyword">from</span> emp <span class="keyword">where</span> ename = <span class="string">'SCOTT'</span>)</span><br><span class="line"><span class="keyword">and</span> sal &lt; (<span class="keyword">select</span> sal <span class="keyword">from</span> emp <span class="keyword">where</span>  ename = <span class="string">'SCOTT'</span>);</span><br></pre></td></tr></table></figure>

<p>d) 查询职务和 SCOTT 相同，比SCOTT 雇佣时间早的雇员信息</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> *</span><br><span class="line"><span class="keyword">from</span> emp</span><br><span class="line"><span class="keyword">where</span> job = (<span class="keyword">select</span> job <span class="keyword">from</span> emp <span class="keyword">where</span> ename = <span class="string">'SCOTT'</span>)</span><br><span class="line"><span class="keyword">and</span> hiredate &lt; (<span class="keyword">select</span> hiredate <span class="keyword">from</span> emp <span class="keyword">where</span> ename = <span class="string">'SCOTT'</span> );</span><br></pre></td></tr></table></figure>

<h4 id="10-2-多行子查询"><a href="#10-2-多行子查询" class="headerlink" title="10.2 多行子查询"></a>10.2 多行子查询</h4><blockquote>
<p>子查询的返回结果是多行数据。此时，不能在使用普通的比较运算符了。</p>
</blockquote>
<p>多行记录比较运算符：</p>
<ul>
<li>any： 跟结果中任何一个数据进行比较</li>
<li>all：跟结果中所有额数据进行比较</li>
<li>in：等于结果中的任一</li>
</ul>
<p>a) 查询工资低于任何一个  CLERK  的工资雇员信息</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * </span><br><span class="line"><span class="keyword">from</span> emp </span><br><span class="line"><span class="keyword">where</span> sal &lt; <span class="keyword">any</span>(<span class="keyword">select</span> sal <span class="keyword">from</span> emp <span class="keyword">where</span> job = <span class="string">'CLERK'</span>)</span><br><span class="line"><span class="keyword">and</span> job &lt;&gt; <span class="string">'CLERK'</span>;</span><br></pre></td></tr></table></figure>

<p>b）查询工资比所有的 “SALESMAN” 都高的雇员的编号、名字和工资</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> emp;</span><br><span class="line"><span class="keyword">select</span> empno,ename,sal</span><br><span class="line"> <span class="keyword">from</span> emp </span><br><span class="line"> <span class="keyword">where</span> sal  &gt; <span class="keyword">all</span>(<span class="keyword">select</span> sal <span class="keyword">from</span> emp <span class="keyword">where</span> job = <span class="string">'SALESMAN'</span>)</span><br></pre></td></tr></table></figure>

<p>c）查询部门 20 中职务中 同部门10 中的雇员一样的雇员的信息</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * </span><br><span class="line"><span class="keyword">from</span> emp e</span><br><span class="line"><span class="keyword">where</span> e.job <span class="keyword">in</span>(<span class="keyword">select</span> job <span class="keyword">from</span> emp <span class="keyword">where</span> deptno = <span class="string">'10'</span>)</span><br><span class="line"><span class="keyword">and</span> e.deptno = <span class="number">20</span>;</span><br></pre></td></tr></table></figure>

<h4 id="10-3-不相关子查询和相关子查询-blue-heart"><a href="#10-3-不相关子查询和相关子查询-blue-heart" class="headerlink" title="10.3 不相关子查询和相关子查询 :blue_heart:"></a>10.3 不相关子查询和相关子查询 :blue_heart:</h4><blockquote>
<p> 不相关子查询：子查询<u>不会用到外查询的数据</u>，子查询<u>可以独立运行</u></p>
</blockquote>
<blockquote>
<p>相关子查询：子查询<u>会用到外查询的数据</u>，子查询<u>不能</u>独立运行</p>
</blockquote>
<p>a）（不相关） 查询本部门最高工资的员工</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * </span><br><span class="line"><span class="keyword">from</span>  emp e</span><br><span class="line"><span class="keyword">where</span> (e.deptno,e.sal) <span class="keyword">in</span> (<span class="keyword">select</span> deptno,<span class="keyword">max</span>(sal) sal <span class="keyword">from</span> emp <span class="keyword">group</span> <span class="keyword">by</span> deptno)</span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> sal <span class="keyword">desc</span>;</span><br></pre></td></tr></table></figure>

<p>b)  （相关） 查询本部门最高工资的员工</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> *</span><br><span class="line"><span class="keyword">from</span> emp e</span><br><span class="line"><span class="keyword">where</span> sal = (<span class="keyword">select</span> <span class="keyword">max</span>(sal) <span class="keyword">from</span> emp <span class="keyword">where</span> deptno = e.deptno)</span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> sal <span class="keyword">desc</span>;</span><br></pre></td></tr></table></figure>

<h4 id="10-4-子查询可以作为一张表格进行多表连接查询-artificial-satellite"><a href="#10-4-子查询可以作为一张表格进行多表连接查询-artificial-satellite" class="headerlink" title="10.4   子查询可以作为一张表格进行多表连接查询 :artificial_satellite:"></a>10.4   子查询可以作为一张表格进行多表连接查询 :artificial_satellite:</h4><p>a) 查询每个部们平均薪水的<strong>等级</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> t.deptno,t.avg_sal,s.grade</span><br><span class="line"><span class="keyword">from</span> salgrade s</span><br><span class="line"><span class="keyword">join</span>(</span><br><span class="line">     <span class="keyword">select</span> deptno,<span class="keyword">avg</span>(sal) avg_sal <span class="keyword">from</span> emp <span class="keyword">group</span> <span class="keyword">by</span> deptno</span><br><span class="line">)t</span><br><span class="line"><span class="keyword">on</span> t.avg_sal <span class="keyword">between</span> s.losal <span class="keyword">and</span> s.hisal;</span><br></pre></td></tr></table></figure>

<h3 id="总结-call-me-hand"><a href="#总结-call-me-hand" class="headerlink" title="总结:call_me_hand:"></a>总结:call_me_hand:</h3><h4 id="1-Oracle-中-单双引号的区别："><a href="#1-Oracle-中-单双引号的区别：" class="headerlink" title="1 Oracle 中 单双引号的区别："></a>1 Oracle 中 单双引号的区别：</h4><p> 在 Oracle 中，单引号表示<strong>字符串</strong>，而双引号表示<strong>原样输出</strong></p>
<h4 id="2-Oracle-中加号的作用："><a href="#2-Oracle-中加号的作用：" class="headerlink" title="2 Oracle 中加号的作用："></a>2 Oracle 中加号的作用：</h4><p>在 Oracle中，加号不表示 Java 中的字符串连接符，而仅仅表示<strong>加号</strong>，用于数值相加</p>
<h4 id="3-字符函数中的-substr-方法的使用："><a href="#3-字符函数中的-substr-方法的使用：" class="headerlink" title="3 字符函数中的 substr 方法的使用："></a>3 字符函数中的 substr 方法的使用：</h4><p>substr(字段名，截取开始的位置，[截取的的长度])  </p>
<p>PS： [] 中的参数可省略不写，表示直接截取到字符串的末尾</p>
<p>若指定截取的长度，既可以正数，表示从截取位置开始，正向截取，</p>
<p>也可以是负数，表示从字符串末尾开始，反向截取，直到截取开始位置（包括起始位置上）</p>
<h4 id="4-自连接的使用"><a href="#4-自连接的使用" class="headerlink" title="4 自连接的使用"></a>4 自连接的使用</h4><p>自己与自己查询</p>
<h4 id="5-相关与不相关查询"><a href="#5-相关与不相关查询" class="headerlink" title="5 相关与不相关查询"></a>5 相关与不相关查询</h4><p>PS： 空值不能参与运算</p>

        
      
    </div>

    
    
    
      <footer class="post-footer">
          <div class="post-eof"></div>
        
      </footer>
  </div>
  
  
  
  </article>

    
        <article itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block home">
    <link itemprop="mainEntityOfPage" href="http://zwer.xyz/2018/11/23/数据库/20181123 Oracle 数据库的使用/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="zwer">
      <meta itemprop="description" content="记录学习的日常">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="zwer 的博客空间">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
            
            <a href="/2018/11/23/数据库/20181123 Oracle 数据库的使用/" class="post-title-link" itemprop="url">20181123 Oracle 数据库的使用</a>
          
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              
                
              

              <time title="Created: 2018-11-23 00:00:00" itemprop="dateCreated datePublished" datetime="2018-11-23T00:00:00+08:00">2018-11-23</time>
            </span>
          
            

            
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2019-02-24 11:28:27" itemprop="dateModified" datetime="2019-02-24T11:28:27+08:00">2019-02-24</time>
              </span>
            
          
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Java/" itemprop="url" rel="index"><span itemprop="name">Java</span></a></span>

                
                
                  , 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Java/Oracle/" itemprop="url" rel="index"><span itemprop="name">Oracle</span></a></span>

                
                
                  , 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Java/Oracle/数据库/" itemprop="url" rel="index"><span itemprop="name">数据库</span></a></span>

                
                
                  , 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Java/Oracle/数据库/后端/" itemprop="url" rel="index"><span itemprop="name">后端</span></a></span>

                
                
              
            </span>
          

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h3 id="1-数据库相关概念"><a href="#1-数据库相关概念" class="headerlink" title="1 数据库相关概念"></a>1 数据库相关概念</h3><h4 id="1-1-数据库基本概念"><a href="#1-1-数据库基本概念" class="headerlink" title="1.1 数据库基本概念"></a>1.1 数据库基本概念</h4><p>• <strong>数据</strong></p>
<p>• 描述事物的符号</p>
<p>• 多种表现形式：文本，图形，音频，视频</p>
<p>• <strong>数据库（Database, DB）</strong></p>
<p>• 粮库 车库</p>
<p>• 存放数据的仓库 存放在计算机中，按照一定格式存放 可为用户共享</p>
<p>• <strong>数据库管理系统</strong>（Database Management System, DBMS）</p>
<p>• 如何科学的组织和存储数据，如何高效的获取和维护数据，靠数据库管理系统完成• Oracle MySQL SQL Server DB2 FoxPro，Access</p>
<p> • <strong>数据库应用程序</strong>（DBAS）</p>
<p>• 在数据库管理系统基础上，使用数据库管理系统的语法，开发直接面对最终用户的应用程序</p>
<p>• 学生管理系统、人事管理系统、图书管理系统SSXXTT  数据库相关概念 C• 数据库管理员（ Database Administrator, DBA ）</p>
<p>• 数据库管理系统的操作者</p>
<p>• 最终用户</p>
<p>• 数据库应用程序的使用者</p>
<p>• 数据库系统（ Database System, DBS ）</p>
<p>• 数据库+数据库管理系统+数据库应用程序+数据库管理员+最终用户</p>
<h4 id="1-2-数据库结构"><a href="#1-2-数据库结构" class="headerlink" title="1.2 数据库结构"></a>1.2 数据库结构</h4><h5 id="1-2-1-树形结构"><a href="#1-2-1-树形结构" class="headerlink" title="1.2.1 树形结构"></a>1.2.1 树形结构</h5><h5 id="1-2-2-网状"><a href="#1-2-2-网状" class="headerlink" title="1.2.2  网状"></a>1.2.2  网状</h5><h5 id="1-2-3-关系型数据"><a href="#1-2-3-关系型数据" class="headerlink" title="1.2.3 关系型数据"></a>1.2.3 <strong>关系型数据</strong></h5><ul>
<li>采用关系（二维表）结构储存与管理数据</li>
<li>采用结构化查询语言（SQL）作为客户端程数据库服务器间沟通的桥梁</li>
</ul>
<h5 id="1-2-4-对象数据库"><a href="#1-2-4-对象数据库" class="headerlink" title="1.2.4 对象数据库"></a>1.2.4 <strong>对象数据库</strong></h5><p>• 把面向对象的方法和数据库技术结合起来可以使数据库系统的分析、设计最大程度地与人们对客观世<br>界的认识相一致</p>
<h5 id="1-2-5-NOSQL数据库"><a href="#1-2-5-NOSQL数据库" class="headerlink" title="1.2.5 NOSQL数据库**"></a>1.2.5 NOSQL数据库**</h5><p>• Not Only SQL数据库 泛指非关系数据库。如MongoDB<br>• 关系数据库在超大规模和高并发的web2.0纯动态网站已经显得力不从心，暴露了很多难以克服的问题。<br>NoSQL数据库的产生就是为了解决大规模数据集合多重数据种类带来的挑战，尤其是大数据应用难题</p>
<h4 id="1-3-关系型数据"><a href="#1-3-关系型数据" class="headerlink" title="1.3 关系型数据"></a>1.3 关系型数据</h4><p><code>Oracel</code> 商业大型数据库</p>
<p><code>Mysql</code> 是 小型开源数据库</p>
<h3 id="2-oracle-入门"><a href="#2-oracle-入门" class="headerlink" title="2 oracle 入门"></a>2 oracle 入门</h3><h4 id="2-1-Oracle-公司"><a href="#2-1-Oracle-公司" class="headerlink" title="2.1 Oracle 公司"></a>2.1 Oracle 公司</h4><p>Oracle（甲骨文）公司<br>• 1977年，三人合伙创办（Software Development Laboratories，SDL）<br>• 1979年，更名为Relational Software Inc.，RSI • 1983年，为了突出核心产品 ，RSI更名为Oracle<br>• 2002年04月26日，启用“甲骨文”作为中文注册商标<br>• 2009年4月20日，甲骨文公司收购SUN。<br>• 2013年，甲骨文超越 IBM ，成为继Microsoft 后全球第二大软件公司</p>
<p><img src="https://ws1.sinaimg.cn/large/0075WAZ9gy1fxls6d0ebpj303o029jrp.jpg" alt></p>
<h4 id="2-2-Oracle-数据库"><a href="#2-2-Oracle-数据库" class="headerlink" title="2.2 Oracle 数据库"></a>2.2 Oracle 数据库</h4><p>a  使用 Oracle 11g(grid)</p>
<p>b 安装前准备</p>
<p> 环境要求 </p>
<ul>
<li><p>修改计算机名，不要存放中文和特殊符号   Oracle数据库会使用主机名</p>
</li>
<li><p>注意安装路径，不要有中文和特殊符号</p>
</li>
<li><p>修改 windows 的登录名，不要哟中文和特殊符号</p>
</li>
<li><p>安装前关闭防火墙，关闭杀毒软件</p>
</li>
<li><p>安装时尽量不做其他操作</p>
</li>
</ul>
<h4 id="2-3-Oracle-安装"><a href="#2-3-Oracle-安装" class="headerlink" title="2.3 Oracle 安装"></a>2.3 Oracle 安装</h4><p>• 概念介绍</p>
<p>• 全局数据库名 </p>
<p>• 唯一标识Oracle数据库的名称</p>
<p>• 数据库实例名SID </p>
<p>• 和操作系统交互，Oracle数据库的一个引用</p>
<p>• 每个启动的数据库都对应一个数据库实例，由这个实例来访问和控制数据库</p>
<p>• 为了运行数据库，Oracle系统所运行的所有进程和分配的内存结构的组合体</p>
<p>• 两者名称通常相同</p>
<p><img src="https://ws1.sinaimg.cn/large/0075WAZ9gy1fxlsa4y2tcj30e90fcweo.jpg" alt></p>
<h3 id="3-Oracle-目录结构和系统"><a href="#3-Oracle-目录结构和系统" class="headerlink" title="3  Oracle 目录结构和系统"></a>3  Oracle 目录结构和系统</h3><h4 id="3-1-目录"><a href="#3-1-目录" class="headerlink" title="3.1 目录"></a>3.1 目录</h4><p>a) D:\Software\oracle\oradata\orcl, 是用于存放 Oracl数据文件的目录</p>
<p>b) D:\Software\oracle\product\11.2.0\dbhome_1,  数据库安装位置</p>
<p>c) D:\Software\oracle\product\11.2.0\dbhome_1\jdbc\lib, 存放 jdbc 数据库连接的驱动位置</p>
<p>d) D:\Software\oracle\product\11.2.0\dbhome_1\jdk, Oracle 内置的 java 开发工具集</p>
<p>e) D:\Software\oracle\product\11.2.0\dbhome_1\NETWORK\ADMIN,存放 Oracle 的配置信息(监听配置和本地网络服务名配置）</p>
<h4 id="3-2-Oracle-系统用户"><a href="#3-2-Oracle-系统用户" class="headerlink" title="3.2 Oracle 系统用户"></a>3.2 Oracle 系统用户</h4><p>a) Oracle 数据库是基于用户的, 使用数据库时, 必须先登录要操作的用户.</p>
<p>b) Oracle 安装完成后, 自带一些用户, 被称之为系统用户</p>
<p>c) SYS, 是 Oracle 中权限最高的账户, 理解为超级管理员</p>
<p>d) SYSTEM, 是管理员(DBA), 权限比 SYS 少, 普通管理员</p>
<p>e) SCOTT, 是 Oracle 提供的一个测试用户, 其中自带了四张测试用表格, 可以供用户学习使用. SCOTT 用户的密码通常是 tiger(老虎)</p>
<h4 id="3-3-服务介绍"><a href="#3-3-服务介绍" class="headerlink" title="3.3  服务介绍"></a>3.3  服务介绍</h4><p>a) OracleServiceORCL, 数据库的实例服务, 是 Oracle 的核心服务,Oracle 要使用, 必须开启这个服务.</p>
<p>b) OracleOraDb11g_home1TNSListener, 数据库监听服务, 用来监听Oracle 数据</p>
<p><img src="https://ws1.sinaimg.cn/large/0075WAZ9gy1fxlsaqlgk1j30e6048aaa.jpg" alt></p>
<h4 id="3-6-练习表介绍-C"><a href="#3-6-练习表介绍-C" class="headerlink" title="3.6 练习表介绍 C"></a>3.6 练习表介绍 C</h4><p>• 用户</p>
<p>• scott </p>
<p>• 数据库表</p>
<p>​    • Dept 部门表</p>
<p>• Emp 员工表</p>
<p>• Salgrade 工资等级表</p>
<p>• Bonus 奖金表</p>
<p>• 表和表之间的关系</p>
<p>• 员工属于某个部门</p>
<h3 id="4-Oracle-客户端"><a href="#4-Oracle-客户端" class="headerlink" title="4 Oracle 客户端"></a>4 Oracle 客户端</h3><h4 id="4-1-SQL-Plus"><a href="#4-1-SQL-Plus" class="headerlink" title="4.1 SQL Plus"></a>4.1 SQL Plus</h4><p>是一个命令行客户端，oracle 自带</p>
<p>使用效果不好</p>
<p><img src="https://ws1.sinaimg.cn/large/0075WAZ9gy1fxlsbm3dsvj30nw06hjrb.jpg" alt></p>
<h4 id="4-2-PLSQL-Developer"><a href="#4-2-PLSQL-Developer" class="headerlink" title="4.2 PLSQL  Developer"></a>4.2 PLSQL  Developer</h4><p>图形界面，显示效果好</p>
<p><img src="https://ws1.sinaimg.cn/large/0075WAZ9gy1fxlscfm8qyj30p00dyabl.jpg" alt></p>
<h3 id="5-Oracle常用命令及练习表"><a href="#5-Oracle常用命令及练习表" class="headerlink" title="5 Oracle常用命令及练习表"></a>5 Oracle常用命令及练习表</h3><h4 id="5-1-查看用户的所有表"><a href="#5-1-查看用户的所有表" class="headerlink" title="5.1 查看用户的所有表"></a>5.1 查看用户的所有表</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> 表名;</span><br></pre></td></tr></table></figure>

<p>举个栗子：select * from EMP</p>
<h4 id="5-2-查看表结构"><a href="#5-2-查看表结构" class="headerlink" title="5.2 查看表结构"></a>5.2 查看表结构</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">desc 表名</span><br></pre></td></tr></table></figure>

<p>举个栗子：<code>desc EMP</code></p>
<p><img src="https://ws1.sinaimg.cn/large/0075WAZ9gy1fxlsd3mqaxj308d042jr6.jpg" alt></p>
<h4 id="5-3-查询表数据"><a href="#5-3-查询表数据" class="headerlink" title="5.3 查询表数据"></a>5.3 查询表数据</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from 表名</span><br></pre></td></tr></table></figure>

<h4 id="5-4-显示当前用户"><a href="#5-4-显示当前用户" class="headerlink" title="5.4 显示当前用户"></a>5.4 显示当前用户</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">show user</span><br></pre></td></tr></table></figure>

<h4 id="5-5-退出"><a href="#5-5-退出" class="headerlink" title="5.5 退出"></a>5.5 退出</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">exit</span><br></pre></td></tr></table></figure>

<h4 id="5-6-常用表"><a href="#5-6-常用表" class="headerlink" title="5.6 常用表"></a>5.6 常用表</h4><h3 id="6-Oracle-连接配置"><a href="#6-Oracle-连接配置" class="headerlink" title="6  Oracle 连接配置"></a>6  Oracle 连接配置</h3><h4 id="6-1-配置监听器和本地网络服务名-A"><a href="#6-1-配置监听器和本地网络服务名-A" class="headerlink" title="6.1  配置监听器和本地网络服务名 A"></a>6.1  配置监听器和本地网络服务名 A</h4><p>Oracle采用服务器/客户端访问方式</p>
<p>• 服务器端使用监听器对客户端的访问进行监听<br>• 客户端访问服务器端时必须明确四个参数，包括<br>• 访问协议   TCP<br>• 服务器IP地址:服务器监听端口   1521<br>• 服务器端的哪个数据库实例  orcl</p>
<p><img src="https://ws1.sinaimg.cn/large/0075WAZ9gy1fxlr5r8ag0j30g405z76e.jpg" alt></p>
<p>Oracle产品安装完成后，服务器和客户端都需要进行网络配置才能实现网络连接</p>
<p>• 服务器端配置监听器，客户端配置本地网络服务名（包括四个连接参数）<br>• 在安装Oracle服务器软件时自动配置一个监听器，并且自动创建了和数据库实例名相<br>同的本地网络服务名<br>• listener.ora和tnsnames.ora分别用来存储监听器和本地网络服务名的信息<br>• Oracle中的 Net Manager工具和Net Configuration Assistant都能用来配置监听器和网络服务名</p>
<h5 id="6-1-1-配置-listener-ora-文件"><a href="#6-1-1-配置-listener-ora-文件" class="headerlink" title="6.1.1 配置 listener.ora 文件"></a>6.1.1 配置 listener.ora 文件</h5><p><img src="https://ws1.sinaimg.cn/large/0075WAZ9gy1fxlrgs1lenj30lh0btwez.jpg" alt></p>
<h5 id="6-1-2-配置-tnsnames-ora-文件"><a href="#6-1-2-配置-tnsnames-ora-文件" class="headerlink" title="6.1.2 配置  tnsnames.ora 文件"></a>6.1.2 配置  tnsnames.ora 文件</h5><p><img src="https://ws1.sinaimg.cn/large/0075WAZ9gy1fxlrmet58aj30mp0comxr.jpg" alt></p>
<h4 id="6-2-使用-Oracle-数据库-可能出现的问题"><a href="#6-2-使用-Oracle-数据库-可能出现的问题" class="headerlink" title="6.2  使用 Oracle 数据库 可能出现的问题"></a>6.2  使用 Oracle 数据库 可能出现的问题</h4><p><img src="https://ws1.sinaimg.cn/large/0075WAZ9gy1fxlr8g68doj30ip096die.jpg" alt></p>
<p><img src="https://ws1.sinaimg.cn/large/0075WAZ9gy1fxlra2zgluj30ip06q3zw.jpg" alt></p>
<p>​                原因：监听服务没有开启</p>
<p><img src="https://ws1.sinaimg.cn/large/0075WAZ9gy1fxlrbu93umj30hl07lmyz.jpg" alt></p>
<p>​            原因：    1.  监听服务刚启动，还没有反应过来</p>
<p>​                       2.  配置信息可能读取不到，需要重新配置</p>
<p>​          </p>
<h4 id="6-3-创建用户和授予权限-B"><a href="#6-3-创建用户和授予权限-B" class="headerlink" title="6.3 创建用户和授予权限 B"></a>6.3 创建用户和授予权限 B</h4><p>• <strong>创建用户</strong></p>
<p>• CREATE USER bjsxt IDENTIFIED BY bjsxt; </p>
<p>• <strong>分配权限或角色</strong></p>
<p>• GRANT CONNECT,RESOURCE TO bjsxt; </p>
<p>• <strong>取消权限或角色</strong></p>
<p>• REVOKE RESOURCE FROM bjsxt;</p>
<p> • 权限指执行特定类型SQL 命令或访问其他对象的权利</p>
<p>• 角色是具有名称的一组权限的组合</p>
<p>• <strong>常用系统预定义角色</strong></p>
<p>• CONNECT：临时用户</p>
<p>• RESOURCE：更为可靠和正式的用户</p>
<p>• DBA：数据库管理员角色，拥有管理数据库的最高权限</p>

        
      
    </div>

    
    
    
      <footer class="post-footer">
          <div class="post-eof"></div>
        
      </footer>
  </div>
  
  
  
  </article>

    
        <article itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block home">
    <link itemprop="mainEntityOfPage" href="http://zwer.xyz/2018/11/19/Java/20181119 服务器项目/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="zwer">
      <meta itemprop="description" content="记录学习的日常">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="zwer 的博客空间">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
            
            <a href="/2018/11/19/Java/20181119 服务器项目/" class="post-title-link" itemprop="url">20181119 服务器项目</a>
          
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              
                
              

              <time title="Created: 2018-11-19 21:39:00" itemprop="dateCreated datePublished" datetime="2018-11-19T21:39:00+08:00">2018-11-19</time>
            </span>
          
            

            
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2018-12-05 12:20:58" itemprop="dateModified" datetime="2018-12-05T12:20:58+08:00">2018-12-05</time>
              </span>
            
          
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Java/" itemprop="url" rel="index"><span itemprop="name">Java</span></a></span>

                
                
              
            </span>
          

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h3 id="1-复习Socket"><a href="#1-复习Socket" class="headerlink" title="1 复习Socket"></a>1 复习Socket</h3><h4 id="1-1-编写服务器用到的知识点"><a href="#1-1-编写服务器用到的知识点" class="headerlink" title="1.1 编写服务器用到的知识点"></a>1.1 编写服务器用到的知识点</h4><p>1) Socket 编程</p>
<p>2) HTML</p>
<p>3) HTTP 协议</p>
<p>4) 反射</p>
<p>5) XML 解析</p>
<p>6) 服务器编写</p>
<h4 id="1-2-复习-Socket-编程"><a href="#1-2-复习-Socket-编程" class="headerlink" title="1.2 复习 Socket 编程"></a>1.2 复习 Socket 编程</h4><p>1) C/S 结构:客户端与服务器端一次双向通信</p>
<p>2) B/S 结构:浏览器与服</p>
<p>服务器与客户端单次双向通信</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.szxy.socket.server;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.DataInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.DataOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.net.ServerSocket;</span><br><span class="line"><span class="keyword">import</span> java.net.Socket;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Server</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"Server start..."</span>);</span><br><span class="line">		<span class="comment">//创建 ServerSocket 对象</span></span><br><span class="line">		ServerSocket server=<span class="keyword">null</span>;</span><br><span class="line">		<span class="comment">//监听客户端的请求，并获得输入流</span></span><br><span class="line">		Socket client=<span class="keyword">null</span>;</span><br><span class="line">		DataInputStream dis=<span class="keyword">null</span>;</span><br><span class="line">		<span class="comment">//获得输出流</span></span><br><span class="line">		DataOutputStream dos=<span class="keyword">null</span>;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			server = <span class="keyword">new</span> ServerSocket(<span class="number">8888</span>);</span><br><span class="line">			client = server.accept();</span><br><span class="line">			dis = <span class="keyword">new</span> DataInputStream(client.getInputStream());</span><br><span class="line">			System.out.println(dis.readUTF());</span><br><span class="line">			dos = <span class="keyword">new</span> DataOutputStream(client.getOutputStream());</span><br><span class="line">			dos.writeUTF(<span class="string">"Hello Client!"</span>);</span><br><span class="line">		&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">			<span class="comment">// TODO 自动生成的 catch 块</span></span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;<span class="keyword">finally</span>&#123;</span><br><span class="line">			<span class="comment">//关闭</span></span><br><span class="line">			IOClose.CloseAll(dos,dis,client,server);</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.szxy.socket.client;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.DataInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.DataOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.net.Socket;</span><br><span class="line"><span class="keyword">import</span> java.net.UnknownHostException;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 客户端</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> wzer</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		<span class="comment">//创建Socket对象</span></span><br><span class="line">		Socket client=<span class="keyword">null</span>;</span><br><span class="line">		<span class="comment">//获得输出流</span></span><br><span class="line">		DataOutputStream dos=<span class="keyword">null</span>;</span><br><span class="line">		<span class="comment">//获得输入流</span></span><br><span class="line">		DataInputStream dis=<span class="keyword">null</span>;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			client = <span class="keyword">new</span>  Socket(<span class="string">"localhost"</span>, <span class="number">8888</span>);</span><br><span class="line">			dos = <span class="keyword">new</span> DataOutputStream(client.getOutputStream());</span><br><span class="line">			dos.writeUTF(<span class="string">"Hello Server"</span>);</span><br><span class="line">			dis = <span class="keyword">new</span> DataInputStream(client.getInputStream());</span><br><span class="line">			System.out.println(dis.readUTF());</span><br><span class="line">		&#125; <span class="keyword">catch</span> (UnknownHostException e) &#123;</span><br><span class="line">			<span class="comment">// TODO 自动生成的 catch 块</span></span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">			<span class="comment">// TODO 自动生成的 catch 块</span></span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;<span class="keyword">finally</span>&#123;</span><br><span class="line">			<span class="comment">//关闭</span></span><br><span class="line">			IOClose.CloseAll(dis,dos,client);</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>服务器与浏览器单向通信</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.szxy.socket.server;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.BufferedReader;</span><br><span class="line"><span class="keyword">import</span> java.io.BufferedWriter;</span><br><span class="line"><span class="keyword">import</span> java.io.DataInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.DataOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStreamReader;</span><br><span class="line"><span class="keyword">import</span> java.io.OutputStreamWriter;</span><br><span class="line"><span class="keyword">import</span> java.net.ServerSocket;</span><br><span class="line"><span class="keyword">import</span> java.net.Socket;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BrowerServer</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"Server start..."</span>);</span><br><span class="line">		<span class="comment">//创建 ServerSocket 对象</span></span><br><span class="line">		ServerSocket server=<span class="keyword">null</span>;</span><br><span class="line">		<span class="comment">//监听客户端的请求，并获得输入流</span></span><br><span class="line">		Socket client=<span class="keyword">null</span>;</span><br><span class="line">		BufferedReader br =<span class="keyword">null</span>;</span><br><span class="line">		<span class="comment">//获得输出流</span></span><br><span class="line">		BufferedWriter bw =<span class="keyword">null</span>;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			server = <span class="keyword">new</span> ServerSocket(<span class="number">8888</span>);</span><br><span class="line">			client = server.accept();</span><br><span class="line">			</span><br><span class="line">			br = <span class="keyword">new</span> BufferedReader(<span class="keyword">new</span> InputStreamReader(client.getInputStream(),<span class="string">"utf-8"</span>));</span><br><span class="line">			String str=<span class="keyword">null</span>;</span><br><span class="line">			<span class="comment">// br.readLine().length</span></span><br><span class="line">			<span class="keyword">while</span>((str=br.readLine()).length()&gt;<span class="number">0</span>)&#123;</span><br><span class="line">				System.out.println(str);</span><br><span class="line">			&#125;</span><br><span class="line">			bw = <span class="keyword">new</span> BufferedWriter(<span class="keyword">new</span> OutputStreamWriter(client.getOutputStream(),<span class="string">"utf-8"</span>));</span><br><span class="line">			bw.write(<span class="string">"Hello client!"</span>);</span><br><span class="line">			</span><br><span class="line">		&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">			<span class="comment">// TODO 自动生成的 catch 块</span></span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;<span class="keyword">finally</span>&#123;</span><br><span class="line">			<span class="comment">//关闭</span></span><br><span class="line">			IOClose.CloseAll(bw,br,client,server);</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="2-HTML"><a href="#2-HTML" class="headerlink" title="2 HTML"></a>2 HTML</h3><p>作用：显示数据</p>
<h4 id="2-1-HTML-编写"><a href="#2-1-HTML-编写" class="headerlink" title="2.1 HTML 编写"></a>2.1 HTML 编写</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span>HTML 网页<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">h1</span>&gt;</span></span><br><span class="line">            Hello World</span><br><span class="line">        <span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="2-2-form-表单"><a href="#2-2-form-表单" class="headerlink" title="2.2 form 表单"></a>2.2 form 表单</h4><p>作用：与用户之间进行交互</p>
<p>method: 请求方式 get/post</p>
<p>​    get:不安全 数据量小  </p>
<p>​    post:安全  请求数据量大</p>
<p>post 请求方式会在请求的正文中，然后发送给服务器。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span>HTML 网页<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">"http://localhost:8888"</span> <span class="attr">method</span>=<span class="string">"get"</span>&gt;</span></span><br><span class="line">        	<span class="tag">&lt;<span class="name">p</span>&gt;</span></span><br><span class="line">                用户名：<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">id</span>=<span class="string">"unname"</span> <span class="attr">name</span>=<span class="string">"userName"</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">p</span>&gt;</span>  </span><br><span class="line">            <span class="tag">&lt;<span class="name">p</span>&gt;</span></span><br><span class="line">                密码：<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"password"</span> <span class="attr">id</span>=<span class="string">"pwd"</span> <span class="attr">name</span>=<span class="string">"passWd"</span>&gt;</span>	</span><br><span class="line">            <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">p</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"submit"</span> <span class="attr">value</span>=<span class="string">"提交"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="3-HTTP-协议"><a href="#3-HTTP-协议" class="headerlink" title="3 HTTP 协议"></a>3 HTTP 协议</h3><h4 id="3-1-协议"><a href="#3-1-协议" class="headerlink" title="3.1 协议"></a>3.1 协议</h4><p>1) 应用层:HTTP、FTP、TELNET、SNMP、DNS<br>2) 传输层:TCP、UDP<br>3) 网络层:IP</p>
<h4 id="3-2HTTP-协议简介"><a href="#3-2HTTP-协议简介" class="headerlink" title="3.2HTTP 协议简介"></a>3.2HTTP 协议简介</h4><p>HTTP:Hypertext Transfer Protocol 超文本传输协议,是网络应用层的协议，建立在 TCP/IP 协议基础上，HTTP 使用可靠的 TCP 连接，默认端口为 80。<br>用户打开 Web 浏览器(常见的 HTTP 客户端)，输入 URL<br>地址，就能接收到远程 HTTP 服务器端发送过来的网页，即HTTP 遵循请求(Request)/应答(Response)模型。Web 浏览器向 Web 服务器发送请求，Web 服务器处理请求并返回适当的应答，所有 HTTP 连接都被构造成一套请求与应答。HTTP 客户端和服务器分别由不同的软件开发商提供，它们都可以用任意的编程语言编写，如用.NET 编写的客户程序与用 Java 编写的服务器程序顺利通信，就必须遵守 HTTP 协<br>议，这样才能彼此都懂对方发送的消息，HTTP 协议严格规定了 HTTP 请求和 HTTP 响应的数据格式。</p>
<h4 id="3-3HTTP-请求格式"><a href="#3-3HTTP-请求格式" class="headerlink" title="3.3HTTP 请求格式"></a>3.3HTTP 请求格式</h4><p>1) 请求方式、URI(统一资源定位符)、HTTP 协议/版本<br>2) 请求头 Request Header<br>​    a) 请求头包含许多有关客户端环境和请求正文的有用信息。例如，请求头可以声明浏览器所用的语言，请求正文的长度等。<br>3) 请求正文 Requet Content (只有在 post 方式才有)<br>请求头和请求正文之间必须有符号行（回车符或行结束符），<br>请请求头分开。这个行非常重要，它表示请求头已结束，接<br>下来的是请求正文。通常 post 方式的数据存放于此，请求正<br>文中可以包含客户提交的查询字符串等信息。在实际应用中，<br>HTTP 请求正文可以包含更多的内容</p>
<p><strong>示例：</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">GET /Log?username=123&amp;pwd=123&amp;hobby=baketball HTTP/1.1</span><br><span class="line">Host: localhost:8888</span><br><span class="line">Connection: keep-alive</span><br><span class="line">Cache-Control: max-age=0</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br></pre></td></tr></table></figure>

<p><img src="C:%5CUsers%5CLenovo%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1543980368379.png" alt="1543980368379"></p>
<h4 id="3-4HTTP-响应格式"><a href="#3-4HTTP-响应格式" class="headerlink" title="3.4HTTP 响应格式"></a>3.4HTTP 响应格式</h4><p>1) HTTP 协议版本、状态代码、描述<br>2) 响应头(Response Head)<br>3) 响应正文(Respose Content)</p>
<p><img src="C:%5CUsers%5CLenovo%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1543980429389.png" alt="1543980429389"></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.szxy.socket.server;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.BufferedWriter;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.OutputStreamWriter;</span><br><span class="line"><span class="keyword">import</span> java.net.ServerSocket;</span><br><span class="line"><span class="keyword">import</span> java.net.Socket;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BrowerServer2</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		String CRLF=<span class="string">"\r\n"</span>;<span class="comment">//换行</span></span><br><span class="line">		String BLANK=<span class="string">" "</span>;<span class="comment">//空格</span></span><br><span class="line">		<span class="comment">//(1)创建ServerSocket对象</span></span><br><span class="line">		ServerSocket server=<span class="keyword">null</span>;</span><br><span class="line">		<span class="comment">//(2)监听是否有客户端发送请求</span></span><br><span class="line">		Socket client=<span class="keyword">null</span>;</span><br><span class="line">		InputStream is=<span class="keyword">null</span>;</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			server = <span class="keyword">new</span> ServerSocket(<span class="number">8888</span>);</span><br><span class="line">			client = server.accept();</span><br><span class="line">			<span class="comment">//获取来自浏览器的请求信息</span></span><br><span class="line">			is=client.getInputStream();</span><br><span class="line">			<span class="keyword">byte</span> [] buf=<span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">20480</span>];</span><br><span class="line">			<span class="keyword">int</span> len=is.read(buf);</span><br><span class="line">			System.out.println(<span class="keyword">new</span> String(buf,<span class="number">0</span>,len));</span><br><span class="line">			<span class="comment">/**对Web浏览器的请求作出响应*/</span></span><br><span class="line">			StringBuilder sb=<span class="keyword">new</span> StringBuilder();</span><br><span class="line">			StringBuilder sbContent=<span class="keyword">new</span> StringBuilder();<span class="comment">//响应的文本</span></span><br><span class="line">			sbContent.append(<span class="string">"&lt;html&gt;&lt;head&gt;&lt;title&gt;响应结果&lt;/title&gt;&lt;/head&gt;"</span>);</span><br><span class="line">			sbContent.append(<span class="string">"&lt;body&gt;登录成功&lt;/body&gt;&lt;/html&gt;"</span>);</span><br><span class="line">			</span><br><span class="line">			<span class="comment">//(1)拼接响应头</span></span><br><span class="line">			sb.append(<span class="string">"HTTP/1.1"</span>).append(BLANK).append(<span class="number">200</span>).append(BLANK).append(<span class="string">"OK"</span>);</span><br><span class="line">			sb.append(CRLF);<span class="comment">//换行</span></span><br><span class="line">			sb.append(<span class="string">"Content-Type: text/html;charset=utf-8"</span>);</span><br><span class="line">			sb.append(CRLF);<span class="comment">//换行</span></span><br><span class="line">			sb.append(<span class="string">"Content-Length:"</span>).append(sbContent.toString().getBytes().length).append(CRLF);</span><br><span class="line">			sb.append(CRLF);<span class="comment">//换行,代表响应头与响应的正文部门之间的空行</span></span><br><span class="line">			sb.append(sbContent);</span><br><span class="line">			</span><br><span class="line">			<span class="comment">//通过流输出 </span></span><br><span class="line">			BufferedWriter bw=<span class="keyword">new</span> BufferedWriter(<span class="keyword">new</span> OutputStreamWriter(client.getOutputStream(),<span class="string">"utf-8"</span>));</span><br><span class="line">			bw.write(sb.toString());</span><br><span class="line">			bw.flush();</span><br><span class="line">			bw.close();</span><br><span class="line">			</span><br><span class="line">		&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">			<span class="comment">// TODO Auto-generated catch block</span></span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;<span class="keyword">finally</span>&#123;</span><br><span class="line">		<span class="comment">//(6)关闭流</span></span><br><span class="line">			IOClose.CloseAll(is,client,server);</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">	浏览器访问</span></span><br><span class="line"><span class="comment">	</span></span><br><span class="line"><span class="comment">	</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>

<p><img src="C:%5CUsers%5CLenovo%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1542715446421.png" alt="1542715446421"></p>
<h3 id="4-Tomcat-快速应用"><a href="#4-Tomcat-快速应用" class="headerlink" title="4 Tomcat 快速应用"></a>4 Tomcat 快速应用</h3><h4 id="4-1Tomcat-简介"><a href="#4-1Tomcat-简介" class="headerlink" title="4.1Tomcat 简介"></a>4.1Tomcat 简介</h4><p>Tomcat 是 在 SUN 公 司 的 JSWDK（ <code>JavaServer WebDevelopmentKit</code> ,是 SUN 公司推出的小型 Servlet/JSP 调试工具）的基础上发展起来的一个优秀的 Servlet 容器，Tomcat<br>本身完全用 Java 语言编写。</p>
<h4 id="4-2Tomcat-使用"><a href="#4-2Tomcat-使用" class="headerlink" title="4.2Tomcat 使用"></a>4.2Tomcat 使用</h4><p>1) 配置 <code>Tomcat</code>  JAVA_HOME    Java JDK 的根目录</p>
<p><img src="C:%5CUsers%5CLenovo%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1542718075921.png" alt="1542718075921"></p>
<p>b) CATALINA_HOME    Tomcat 根目录</p>
<p><img src="C:%5CUsers%5CLenovo%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1542718083794.png" alt="1542718083794"></p>
<p>2) 启动和关闭 </p>
<p>Tomcat启动 Tomcat 服务器:startup.bat<br>关闭 Tomcat 服务器:shutdown.bat</p>
<p>3) 部署项目到服务器在 <code>webapps</code>目录下新建目录存放.html 面页 访问项目</p>
<h3 id="5-Tomcat-服务器运行原理"><a href="#5-Tomcat-服务器运行原理" class="headerlink" title="5 Tomcat 服务器运行原理"></a>5 Tomcat 服务器运行原理</h3><h4 id="5-1Tomcat-的运行原理"><a href="#5-1Tomcat-的运行原理" class="headerlink" title="5.1Tomcat 的运行原理"></a>5.1Tomcat 的运行原理</h4><p><strong>客户浏览器发出要求访问特定的 Servlet 的请求。</strong></p>
<p>1) Tomcat 服务器接收到客户请求并解析。</p>
<p>2) Tomcat 服 务 器 创 建 一 个 <code>ServletRequest</code>对 象 ， 在<code>ServletRequest</code> 对象中包含了客户请求信息及其他关于客户的信息，如请求头，请求正文，以及客户机的 IP 地址等。</p>
<p>3) Tomcat 服务器创建一个<code>ServletResponse</code> 对象</p>
<p>4) Tomcat 服务器调用客户所请求的 Servlet 的 service 服务方法，并且把 <code>ServletRequst</code> 对象和 <code>ServletResponse</code> 对象做为参数传给该服务方法。</p>
<p>5) Servlet 从<code>ServletRequest</code>对象中可获取客户的请求信息。</p>
<p>6) Servlet 利用 <code>ServletResponse</code> 对象来生成响应结果</p>
<p>7) Tomcat 服务器把 Servlet 生成的响应结果发送给客户。</p>
<p><img src="C:%5CUsers%5CLenovo%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1542718369651.png" alt="1542718369651"></p>
<h3 id="6-http-工具查看网络交互过程"><a href="#6-http-工具查看网络交互过程" class="headerlink" title="6  http 工具查看网络交互过程"></a>6  http 工具查看网络交互过程</h3><h4 id="6-1-下载并安装"><a href="#6-1-下载并安装" class="headerlink" title="6.1 下载并安装"></a>6.1 下载并安装</h4><p>链接：<a href="https://pan.baidu.com/s/1OPIaYkwCGP_boRQ62dHuug" target="_blank" rel="noopener">https://pan.baidu.com/s/1OPIaYkwCGP_boRQ62dHuug</a><br>提取码：3bv8 </p>
<h4 id="6-2-HttpWatch-的使用"><a href="#6-2-HttpWatch-的使用" class="headerlink" title="6.2 HttpWatch 的使用"></a>6.2 <code>HttpWatch</code> 的使用</h4><p>1) IE 浏 览 器  –&gt; 查 看 –&gt;  浏 览 器 栏 –&gt;  <code>HttpWatch Professional</code><br>2) 输入网址<br>3) 分析数据</p>
<h3 id="7-整体架构和接口-编写XML文件"><a href="#7-整体架构和接口-编写XML文件" class="headerlink" title="7 整体架构和接口_编写XML文件"></a>7 整体架构和接口_编写XML文件</h3><h4 id="7-1-整体架构和接口"><a href="#7-1-整体架构和接口" class="headerlink" title="7.1 整体架构和接口"></a>7.1 整体架构和接口</h4><h5 id="Entity-类-实体类"><a href="#Entity-类-实体类" class="headerlink" title="Entity 类  实体类"></a>Entity 类  实体类</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.szxy.server;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * &lt;servlet&gt;</span></span><br><span class="line"><span class="comment">		&lt;servlet-name&gt;login&lt;/servlet-name&gt;</span></span><br><span class="line"><span class="comment">		&lt;servlet-class&gt;cn.szxy.servlet.LoginServlet&lt;/servlet-class&gt;</span></span><br><span class="line"><span class="comment">	&lt;/servlet&gt;</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> wzer</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Entity</span> </span>&#123;<span class="comment">//一个 servlet-name 对应 一个 实体类</span></span><br><span class="line">	<span class="keyword">private</span> String name;<span class="comment">// servlet-name</span></span><br><span class="line">	<span class="keyword">private</span> String clazz;<span class="comment">// servlet-class</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> name;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.name = name;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getClazz</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> clazz;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setClazz</span><span class="params">(String clazz)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.clazz = clazz;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">Entity</span><span class="params">(String name, String clazz)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">super</span>();</span><br><span class="line">		<span class="keyword">this</span>.name = name;</span><br><span class="line">		<span class="keyword">this</span>.clazz = clazz;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">Entity</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">super</span>();</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="Mapping类-映射"><a href="#Mapping类-映射" class="headerlink" title="Mapping类  映射"></a>Mapping类  映射</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.szxy.server;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * </span></span><br><span class="line"><span class="comment"> * &lt;servlet-mapping&gt;</span></span><br><span class="line"><span class="comment">		&lt;servlet-name&gt;login&lt;/servlet-name&gt;</span></span><br><span class="line"><span class="comment">		&lt;url-pattern&gt;/LoginServlet&lt;/url-pattern&gt;</span></span><br><span class="line"><span class="comment">	&lt;/servlet-mapping&gt;</span></span><br><span class="line"><span class="comment">	&lt;servlet-mapping&gt;</span></span><br><span class="line"><span class="comment">		&lt;servlet-name&gt;login&lt;/servlet-name&gt;</span></span><br><span class="line"><span class="comment">		&lt;url-pattern&gt;/Log&lt;/url-pattern&gt;</span></span><br><span class="line"><span class="comment">	&lt;/servlet-mapping&gt;</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> wzer</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Mapping</span> </span>&#123;<span class="comment">//映射关系，多路径访问</span></span><br><span class="line">		<span class="keyword">private</span> String name; <span class="comment">//servlet-name</span></span><br><span class="line">		<span class="keyword">private</span> List&lt;String&gt; urlPattern; <span class="comment">//url-pattern</span></span><br><span class="line">		<span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">			<span class="keyword">return</span> name;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">			<span class="keyword">this</span>.name = name;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="function"><span class="keyword">public</span> List&lt;String&gt; <span class="title">getUrlPattern</span><span class="params">()</span> </span>&#123;</span><br><span class="line">			<span class="keyword">return</span> urlPattern;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setUrlPattern</span><span class="params">(List&lt;String&gt; urlPattern)</span> </span>&#123;</span><br><span class="line">			<span class="keyword">this</span>.urlPattern = urlPattern;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="function"><span class="keyword">public</span> <span class="title">Mapping</span><span class="params">(String name, List&lt;String&gt; urlPattern)</span> </span>&#123;</span><br><span class="line">			<span class="keyword">super</span>();</span><br><span class="line">			<span class="keyword">this</span>.name = name;</span><br><span class="line">			<span class="keyword">this</span>.urlPattern = urlPattern;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="function"><span class="keyword">public</span> <span class="title">Mapping</span><span class="params">()</span> </span>&#123;</span><br><span class="line">			<span class="keyword">this</span>.urlPattern = <span class="keyword">new</span> ArrayList&lt;String&gt;();</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="7-2-编写-XML文件"><a href="#7-2-编写-XML文件" class="headerlink" title="7.2  编写 XML文件"></a>7.2  编写 XML文件</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">web-app</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>login<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>cn.szxy.servlet.LoginServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>login<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/LoginServlet<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/Log<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>Regsin<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>cn.szxy.servlet.RegisnServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">web-app</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src="C:%5CUsers%5CLenovo%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1542723988088.png" alt="1542723988088"></p>
<p>#### </p>
<h3 id="8-DOM4J-解析-XML-文档"><a href="#8-DOM4J-解析-XML-文档" class="headerlink" title="8  DOM4J 解析 XML 文档"></a>8  DOM4J 解析 XML 文档</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.szxy.server;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.Iterator;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.dom4j.Document;</span><br><span class="line"><span class="keyword">import</span> org.dom4j.DocumentException;</span><br><span class="line"><span class="keyword">import</span> org.dom4j.Element;</span><br><span class="line"><span class="keyword">import</span> org.dom4j.io.SAXReader;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">WebDOM4J</span> </span>&#123;<span class="comment">// 解析 XML 文档</span></span><br><span class="line">	<span class="keyword">private</span> List&lt;Entity&gt; entity;</span><br><span class="line">	<span class="keyword">private</span> List&lt;Mapping&gt; mapping;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> List&lt;Entity&gt; <span class="title">getEntity</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> entity;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setEntity</span><span class="params">(List&lt;Entity&gt; entity)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.entity = entity;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> List&lt;Mapping&gt; <span class="title">getMapping</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> mapping;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setMapping</span><span class="params">(List&lt;Mapping&gt; mapping)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.mapping = mapping;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">WebDOM4J</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.entity = <span class="keyword">new</span>  ArrayList&lt;Entity&gt;();</span><br><span class="line">		<span class="keyword">this</span>.mapping = <span class="keyword">new</span> ArrayList&lt;Mapping&gt;();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">WebDOM4J</span><span class="params">(List&lt;Entity&gt; entity, List&lt;Mapping&gt; mapping)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">super</span>();</span><br><span class="line">		<span class="keyword">this</span>.entity = entity;</span><br><span class="line">		<span class="keyword">this</span>.mapping = mapping;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">private</span> Document <span class="title">getDocuement</span><span class="params">()</span></span>&#123;</span><br><span class="line">		Document doc=<span class="keyword">null</span>;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			<span class="comment">//创建 SAXReader 对象</span></span><br><span class="line">			SAXReader reader = <span class="keyword">new</span> SAXReader();</span><br><span class="line">			<span class="comment">//调用 read 方法</span></span><br><span class="line">			<span class="keyword">return</span> reader.read(<span class="string">"src/cn/szxy/WEB_INFO/web.xml"</span>);</span><br><span class="line">		&#125; <span class="keyword">catch</span> (DocumentException e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">null</span>;	</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">parse</span><span class="params">(Document doc)</span></span>&#123;</span><br><span class="line">		<span class="comment">//获得 根节点 root</span></span><br><span class="line">		Element root = doc.getRootElement();</span><br><span class="line">		<span class="comment">//遍历节点</span></span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			Class c = Class.forName(<span class="string">"cn.szxy.server.Entity"</span>);</span><br><span class="line">		&#125; <span class="keyword">catch</span> (ClassNotFoundException e) &#123;</span><br><span class="line">			<span class="comment">// TODO 自动生成的 catch 块</span></span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">for</span>(Iterator&lt;Element&gt; iter = root.elementIterator(<span class="string">"servlet"</span>);iter.hasNext();)&#123;</span><br><span class="line">			Element subEle = iter.next(); <span class="comment">//获得每个serlvet</span></span><br><span class="line">			<span class="comment">//System.out.println(subEle);</span></span><br><span class="line">			Entity t  = <span class="keyword">new</span> Entity(); <span class="comment">// 存储 servlet-name和 servlet-class</span></span><br><span class="line">			<span class="keyword">for</span>(Iterator&lt;Element&gt; subIter = subEle.elementIterator();subIter.hasNext();)&#123;</span><br><span class="line">				Element ele = subIter.next();</span><br><span class="line">				System.out.println(ele.getName()+<span class="string">"\t"</span>+ele.getText());</span><br><span class="line">				<span class="keyword">if</span>(<span class="string">"servlet-name"</span>.equals(ele.getName()))&#123;</span><br><span class="line">					t.setName(ele.getText());</span><br><span class="line">				&#125;<span class="keyword">else</span> <span class="keyword">if</span>(<span class="string">"servlet-class"</span>.equals(ele.getName()))&#123;</span><br><span class="line">					t.setClazz(ele.getText());</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">			entity.add(t);</span><br><span class="line">		&#125;	</span><br><span class="line">		<span class="keyword">for</span> (Entity list : entity) &#123;</span><br><span class="line">			System.out.println(list.getName()+<span class="string">"\t"</span>+list.getClazz());</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="comment">// servlet-mapping</span></span><br><span class="line">		<span class="keyword">for</span>(Iterator&lt;Element&gt; iter = root.elementIterator(<span class="string">"servlet-mapping"</span>);iter.hasNext();)&#123;</span><br><span class="line">			Element subEle = iter.next(); <span class="comment">//获得每个serlvet</span></span><br><span class="line">			<span class="comment">//System.out.println(subEle);</span></span><br><span class="line">			Mapping m = <span class="keyword">new</span> Mapping();</span><br><span class="line">			<span class="keyword">for</span>(Iterator&lt;Element&gt; subIter = subEle.elementIterator();subIter.hasNext();)&#123;</span><br><span class="line">				Element ele = subIter.next();</span><br><span class="line">				<span class="comment">//System.out.println(ele.getName()+"\t"+ele.getText());</span></span><br><span class="line">				<span class="keyword">if</span>(<span class="string">"servlet-name"</span>.equals(ele.getName()))&#123;</span><br><span class="line">					m.setName(ele.getText());</span><br><span class="line">				&#125;<span class="keyword">else</span> <span class="keyword">if</span>(<span class="string">"url-pattern"</span>.equals(ele.getName()))&#123;</span><br><span class="line">					<span class="comment">//获得集合对象，调用集合对象的添加方法  ---------</span></span><br><span class="line">					m.getUrlPattern().add(ele.getText());</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">			mapping.add(m);</span><br><span class="line">		&#125;	</span><br><span class="line">		<span class="keyword">for</span>(Mapping m:mapping)&#123;</span><br><span class="line">			<span class="comment">//System.out.println(m.getName()+"----");</span></span><br><span class="line">			<span class="keyword">for</span>(String s:m.getUrlPattern())&#123;</span><br><span class="line">				System.out.println(s);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;	</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		WebDOM4J dom4j = <span class="keyword">new</span> WebDOM4J();</span><br><span class="line">		dom4j.parse(dom4j.getDocuement());</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="8-2-总结："><a href="#8-2-总结：" class="headerlink" title="8.2 总结："></a>8.2 总结：</h4><p>1 把 XML文档中 信息解析到 Entity 类  和 Mapping 类。</p>
<p>2   获得集合对象，调用集合对象的添加方法,添加元素<br>​    <code>m.getUrlPattern().add(ele.getText());</code></p>
<p>3  根据传入节点的值 遍历该节点下面的</p>
<p><code>for(Iterator&lt;Element&gt; iter = root.elementIterator(&quot;servlet&quot;);iter.hasNext();)</code></p>
<h3 id="9-根据反射创建-Serlvet对象"><a href="#9-根据反射创建-Serlvet对象" class="headerlink" title="9 根据反射创建 Serlvet对象"></a>9 根据反射创建 <code>Serlvet</code>对象</h3><h4 id="9-1-编写-ServletContext-类"><a href="#9-1-编写-ServletContext-类" class="headerlink" title="9.1 编写 ServletContext 类"></a>9.1 编写 <code>ServletContext</code> 类</h4><p>​    Servlet 上下文，就是一个容器，用于存储映射关系</p>
<h4 id="9-2-编写-WebApp-类"><a href="#9-2-编写-WebApp-类" class="headerlink" title="9.2 编写 WebApp 类"></a>9.2 编写 <code>WebApp</code> 类</h4><p>1) 初始化程序运行的数据</p>
<p>2) 根据不同的 <code>url</code> 创建所请求的 Servlet </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.szxy.server;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> cn.szxy.servlet.Servlet;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 初始化 程序运行的数据</span></span><br><span class="line"><span class="comment"> * </span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> wzer</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">WebApp</span> </span>&#123;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> ServletContext context;</span><br><span class="line">	<span class="keyword">static</span>&#123;</span><br><span class="line">		context = <span class="keyword">new</span> ServletContext();</span><br><span class="line">		<span class="comment">//分别获得对应的关系的map集合</span></span><br><span class="line">		Map&lt;String,String&gt; servlet = context.getServlet();</span><br><span class="line">		Map&lt;String,String&gt; mapping = context.getMapping();</span><br><span class="line">		<span class="comment">//创建 解析的 XML 文档</span></span><br><span class="line">		WebDOM4J dom4j = <span class="keyword">new</span> WebDOM4J();</span><br><span class="line">		dom4j.parse(dom4j.getDocuement());</span><br><span class="line">		<span class="comment">//获取解析之后的List集合</span></span><br><span class="line">		List&lt;Entity&gt; entityList = dom4j.getEntity();</span><br><span class="line">		List&lt;Mapping&gt; mappingList = dom4j.getMapping();</span><br><span class="line">		<span class="comment">//将 List中数据放入 Map中</span></span><br><span class="line">		<span class="keyword">for</span> (Entity  entity : entityList) &#123;</span><br><span class="line">			servlet.put(entity.getName(),entity.getClazz());</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="comment">//System.out.println(servlet);</span></span><br><span class="line">		<span class="keyword">for</span> (Mapping map : mappingList) &#123;</span><br><span class="line">			<span class="comment">//遍历 url-patterns 集合</span></span><br><span class="line">			List&lt;String&gt; urlpatterns = map.getUrlPattern();</span><br><span class="line">			<span class="keyword">for</span> (String str: urlpatterns) &#123;</span><br><span class="line">				mapping.put(str, map.getName());</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="comment">//System.out.println(mapping);</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * 获得映射关系，获得servlet-class</span></span><br><span class="line"><span class="comment">	 * </span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Servlet <span class="title">getServlet</span><span class="params">(String url)</span> </span>&#123;</span><br><span class="line">		<span class="comment">//判断 url 格式是否正确</span></span><br><span class="line">		<span class="keyword">if</span>(url==<span class="keyword">null</span>||url.trim().equals(<span class="string">""</span>))&#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="comment">//如果 url 正确</span></span><br><span class="line">		<span class="comment">//根据 url 的key 去获取 servlet-name 的值</span></span><br><span class="line">		String name = context.getMapping().get(url);</span><br><span class="line">		<span class="comment">//根据 servlet-name的key 去获取 servlet-class 的value</span></span><br><span class="line">		String servletclass = context.getServlet().get(name);</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			<span class="comment">//根据反射，获得servlet-class对象</span></span><br><span class="line">			Class clazz = Class.forName(servletclass);</span><br><span class="line">			<span class="comment">//调用无参构造方法 创建 Servlet 对象</span></span><br><span class="line">			Servlet servlet = (Servlet)clazz.newInstance();</span><br><span class="line">			<span class="keyword">return</span> servlet;</span><br><span class="line">		&#125; <span class="keyword">catch</span> (ClassNotFoundException e) &#123;</span><br><span class="line">			<span class="comment">// TODO 自动生成的 catch 块</span></span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125; <span class="keyword">catch</span> (InstantiationException e) &#123;</span><br><span class="line">			<span class="comment">// TODO 自动生成的 catch 块</span></span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125; <span class="keyword">catch</span> (IllegalAccessException e) &#123;</span><br><span class="line">			<span class="comment">// TODO 自动生成的 catch 块</span></span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		System.out.println(getServlet(<span class="string">"/Log"</span>));</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="10-封装-Request-请求"><a href="#10-封装-Request-请求" class="headerlink" title="10 封装  Request 请求"></a>10 封装  Request 请求</h3><h4 id="10-1-编写-Server"><a href="#10-1-编写-Server" class="headerlink" title="10.1 编写 Server"></a>10.1 编写 Server</h4><p>1) 启动服务</p>
<p><img src="C:%5CUsers%5CLenovo%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1542801240035.png" alt="1542801240035"></p>
<p>2) 关闭服务</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.szxy.server;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"><span class="keyword">import</span> java.net.ServerSocket;</span><br><span class="line"><span class="keyword">import</span> java.net.Socket;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> cn.szxy.util.IOUtilClose;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Server</span> </span>&#123;<span class="comment">//服务器</span></span><br><span class="line">	ServerSocket server;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">start</span><span class="params">()</span></span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.start(<span class="number">9999</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">start</span><span class="params">(<span class="keyword">int</span> port)</span></span>&#123;</span><br><span class="line">		<span class="comment">//创建 ServerSocket 对象</span></span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			server = <span class="keyword">new</span> ServerSocket(port);</span><br><span class="line">			<span class="keyword">this</span>.receive();</span><br><span class="line">		&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">			<span class="comment">// TODO 自动生成的 catch 块</span></span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">receive</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="comment">// 监听客户端的请求</span></span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			Socket  client = server.accept();</span><br><span class="line">			InputStream is = client.getInputStream();</span><br><span class="line">			<span class="comment">/*byte[] buf = new byte[10240];</span></span><br><span class="line"><span class="comment">		    //读取字节数组的长度</span></span><br><span class="line"><span class="comment">			int len = is.read(buf);</span></span><br><span class="line"><span class="comment">			System.out.println(new String(buf,0,len));*/</span></span><br><span class="line">			</span><br><span class="line">			<span class="comment">/*Request req = new Request(is);</span></span><br><span class="line"><span class="comment">			req.show();*/</span></span><br><span class="line">		&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">			<span class="comment">// TODO 自动生成的 catch 块</span></span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">stop</span><span class="params">()</span></span>&#123;</span><br><span class="line">		IOUtilClose.CloseALL(server);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">//测试 方法</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"启动服务器..."</span>);</span><br><span class="line">		Server server = <span class="keyword">new</span> Server();</span><br><span class="line">		server.start();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="10-2-编写-HTML"><a href="#10-2-编写-HTML" class="headerlink" title="10.2 编写 HTML"></a>10.2 编写 HTML</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>Login<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">"http://localhost:9999/Log"</span> <span class="attr">method</span>=<span class="string">"post"</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">p</span>&gt;</span>用户名:<span class="tag">&lt;/<span class="name">p</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"username"</span> <span class="attr">id</span>=<span class="string">"username"</span>/&gt;</span><span class="tag">&lt;<span class="name">br</span>/&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">p</span>&gt;</span>密码:<span class="tag">&lt;/<span class="name">p</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"password"</span> <span class="attr">name</span>=<span class="string">"pwd"</span> <span class="attr">id</span>=<span class="string">"paaword"</span>/&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">p</span>&gt;</span>兴趣:&amp;nbsp;&amp;nbsp;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"checkbox"</span> <span class="attr">name</span>=<span class="string">"hobby"</span> <span class="attr">value</span>=<span class="string">"baketball"</span> /&gt;</span>篮球</span><br><span class="line">		    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"checkbox"</span> <span class="attr">name</span>=<span class="string">"hobby"</span> <span class="attr">value</span>=<span class="string">"football"</span> /&gt;</span>足球</span><br><span class="line">	   		<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"checkbox"</span> <span class="attr">name</span>=<span class="string">"hobby"</span> <span class="attr">value</span>=<span class="string">"pingpang"</span> /&gt;</span>乒乓球<span class="tag">&lt;<span class="name">br</span>/&gt;</span></span><br><span class="line">	   		<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"submit"</span>  <span class="attr">value</span>=<span class="string">"提交"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line">	</span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="10-3-封装-Request-method-url"><a href="#10-3-封装-Request-method-url" class="headerlink" title="10.3 封装 Request_method_url"></a>10.3 封装 Request_method_url</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.szxy.server;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Request</span> </span>&#123;<span class="comment">//接受客户端的请求  </span></span><br><span class="line">	<span class="keyword">private</span> InputStream is; </span><br><span class="line">	<span class="keyword">private</span> String requstInfo; <span class="comment">//请求信息</span></span><br><span class="line">	<span class="keyword">private</span> String method; <span class="comment">//请求方法</span></span><br><span class="line">	<span class="keyword">private</span> String url; <span class="comment">//路径</span></span><br><span class="line">	 </span><br><span class="line">	<span class="keyword">private</span> Map&lt;String,List&lt;String&gt;&gt; parametermapValues;<span class="comment">// 请求参数</span></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String CRLF = <span class="string">"\r\n"</span>; <span class="comment">//换行</span></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String BLANK = <span class="string">"\t"</span>; <span class="comment">//空白</span></span><br><span class="line">	</span><br><span class="line">	<span class="comment">//构造函数，初始化属性</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">Request</span><span class="params">()</span></span>&#123;</span><br><span class="line">		parametermapValues=<span class="keyword">new</span> HashMap&lt;String,List&lt;String&gt;&gt;();</span><br><span class="line">		requstInfo = <span class="string">""</span>;</span><br><span class="line">		method = <span class="string">""</span>;</span><br><span class="line">		url = <span class="string">""</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">Request</span><span class="params">(InputStream is)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>();<span class="comment">//调用无参构造函数</span></span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			<span class="keyword">this</span>.is = is;</span><br><span class="line">			<span class="keyword">byte</span>[] buf = <span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">20480</span>];</span><br><span class="line">			<span class="keyword">int</span> len = is.read(buf);</span><br><span class="line">			requstInfo = <span class="keyword">new</span> String(buf,<span class="number">0</span>,len);</span><br><span class="line">		&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">			<span class="keyword">return</span>;	</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="comment">//调用本类中的分解请求信息的方法</span></span><br><span class="line">		<span class="keyword">this</span>.parseRequestInfo();</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">//分解请求信息的方法</span></span><br><span class="line">	<span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">parseRequestInfo</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		String paraString=<span class="string">""</span>;<span class="comment">//用于存储请求参数</span></span><br><span class="line">		<span class="comment">//获得第一行</span></span><br><span class="line">		String firstLine = requstInfo.substring(<span class="number">0</span>,requstInfo.indexOf(CRLF)).trim(); </span><br><span class="line">		<span class="keyword">int</span> index = firstLine.indexOf(<span class="string">"/"</span>); <span class="comment">//截取到第一个参数结束</span></span><br><span class="line">		<span class="keyword">this</span>.method = firstLine.substring(<span class="number">0</span>,index).trim();<span class="comment">//请求的第一个参数 请求方法    含头不含尾</span></span><br><span class="line">		String urlString = firstLine.substring(index, firstLine.indexOf(<span class="string">"HTTP/"</span>)).trim();<span class="comment">//获得文件路径</span></span><br><span class="line">		<span class="comment">//判断 get请求 还是 post请求</span></span><br><span class="line">		<span class="keyword">if</span>(method.equalsIgnoreCase(<span class="keyword">this</span>.method))&#123;</span><br><span class="line">			<span class="keyword">if</span>(urlString.contains(<span class="string">"?"</span>))&#123;</span><br><span class="line">				String[] urlArray = urlString.split(<span class="string">"\\?"</span>);</span><br><span class="line">				<span class="keyword">this</span>.url = urlArray[<span class="number">0</span>];</span><br><span class="line">				paraString = urlArray[<span class="number">1</span>];	</span><br><span class="line">			&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">				<span class="keyword">this</span>.url = urlString;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;<span class="keyword">else</span>&#123;<span class="comment">//post不包含请求参数</span></span><br><span class="line">			<span class="keyword">this</span>.url = urlString;</span><br><span class="line">			paraString =requstInfo.substring(requstInfo.lastIndexOf(CRLF));</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span>(paraString.equals(<span class="string">""</span>))&#123;</span><br><span class="line">			<span class="keyword">return</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		System.out.println(paraString);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">//用于测试</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">show</span><span class="params">()</span></span>&#123;</span><br><span class="line">		System.out.println(<span class="keyword">this</span>.url);</span><br><span class="line">		System.out.println(<span class="keyword">this</span>.method);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="11-封装-Request-存储参数-处理中文"><a href="#11-封装-Request-存储参数-处理中文" class="headerlink" title="11  封装 Request  存储参数  处理中文"></a>11  封装 Request  <em>存储参数</em>  处理中文</h3><h4 id="11-1-编写分解参数的方法"><a href="#11-1-编写分解参数的方法" class="headerlink" title="11.1 编写分解参数的方法"></a>11.1 编写分解参数的方法</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">	username=Tom&amp;pwd=123&amp;hobby=football&amp;hobby=baketball</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">parseParam</span><span class="params">(String paraString)</span></span>&#123;</span><br><span class="line">		String[] token = paraString.split(<span class="string">"&amp;"</span>);<span class="comment">//根据 &amp; 符号切割成字符数组</span></span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; token.length; i++) &#123;</span><br><span class="line">			String keyValues = token[i];</span><br><span class="line">			String[] keyValue = keyValues.split(<span class="string">"="</span>);</span><br><span class="line">			<span class="keyword">if</span>(keyValue.length ==<span class="number">1</span>)&#123;<span class="comment">// 只有参数名，没有参数值</span></span><br><span class="line">				keyValue = Arrays.copyOf(keyValue, <span class="number">2</span>);</span><br><span class="line">				keyValue[<span class="number">1</span>] = <span class="keyword">null</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="comment">//把参数名和参数值放入集合中</span></span><br><span class="line">			String key = keyValue[<span class="number">0</span>];</span><br><span class="line">			String value= keyValue[<span class="number">1</span>]==<span class="keyword">null</span>?<span class="keyword">null</span>:decode(keyValue[<span class="number">1</span>].trim(),<span class="string">"utf-8"</span>);</span><br><span class="line">			</span><br><span class="line">			<span class="comment">//放到集合存储</span></span><br><span class="line">			<span class="keyword">if</span>(!parametermapValues.containsKey(key))&#123;</span><br><span class="line">				parametermapValues.put(key, <span class="keyword">new</span> ArrayList&lt;String&gt;());</span><br><span class="line">			&#125;</span><br><span class="line">			List&lt;String&gt;  values = parametermapValues.get(key);</span><br><span class="line">			values.add(value);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<h4 id="11-2-编写根据页面上的-name-获取多个值的方法"><a href="#11-2-编写根据页面上的-name-获取多个值的方法" class="headerlink" title="11.2 编写根据页面上的 name 获取多个值的方法"></a>11.2 编写根据页面上的 name 获取多个值的方法</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//根据表单 元素的name获取多个值</span></span><br><span class="line">	<span class="keyword">public</span> String [] getParametermapValues(String key)&#123;</span><br><span class="line">		List&lt;String&gt; values = parametermapValues.get(key);</span><br><span class="line">		<span class="keyword">if</span>(values==<span class="keyword">null</span>)&#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">		&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">			<span class="keyword">return</span> values.toArray(<span class="keyword">new</span> String[<span class="number">0</span>]);<span class="comment">//将集合转成 数组</span></span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<h4 id="11-3-编写根据页面上的-name-获取单个值的方法"><a href="#11-3-编写根据页面上的-name-获取单个值的方法" class="headerlink" title="11.3 编写根据页面上的 name 获取单个值的方法"></a>11.3 编写根据页面上的 name 获取单个值的方法</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//根据表单元素的name获取单个值</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getParameter</span><span class="params">(String name)</span></span>&#123;</span><br><span class="line">		String[] values = <span class="keyword">this</span>.getParametermapValues(name);</span><br><span class="line">		<span class="keyword">if</span>(values==<span class="keyword">null</span>)&#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">		&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">			<span class="keyword">return</span> values[<span class="number">0</span>];</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<h4 id="11-4-编写解码的方法"><a href="#11-4-编写解码的方法" class="headerlink" title="11.4 编写解码的方法"></a>11.4 编写解码的方法</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//处理中文 ，因为浏览器对中文进行编码，所以需要解码</span></span><br><span class="line">	<span class="function"><span class="keyword">private</span> String <span class="title">decode</span><span class="params">(String value,String code)</span></span>&#123;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			<span class="keyword">return</span> URLDecoder.decode(value, code);</span><br><span class="line">		&#125; <span class="keyword">catch</span> (UnsupportedEncodingException e) &#123;</span><br><span class="line">			<span class="comment">// TODO 自动生成的 catch 块</span></span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<h4 id="11-5-Request-类"><a href="#11-5-Request-类" class="headerlink" title="11.5  Request 类"></a>11.5  Request 类</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.szxy.server;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.UnsupportedEncodingException;</span><br><span class="line"><span class="keyword">import</span> java.net.URLDecoder;</span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.Arrays;</span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Request</span> </span>&#123;<span class="comment">//接受客户端的请求  </span></span><br><span class="line">	<span class="keyword">private</span> InputStream is; </span><br><span class="line">	<span class="keyword">private</span> String requstInfo; <span class="comment">//请求信息</span></span><br><span class="line">	<span class="keyword">private</span> String method; <span class="comment">//请求方法</span></span><br><span class="line">	<span class="keyword">private</span> String url; <span class="comment">//路径</span></span><br><span class="line">	 </span><br><span class="line">	<span class="keyword">private</span> Map&lt;String,List&lt;String&gt;&gt; parametermapValues;<span class="comment">// 请求参数</span></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String CRLF = <span class="string">"\r\n"</span>; <span class="comment">//换行</span></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String BLANK = <span class="string">"\t"</span>; <span class="comment">//空白</span></span><br><span class="line">	</span><br><span class="line">	<span class="comment">//构造函数，初始化属性</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">Request</span><span class="params">()</span></span>&#123;</span><br><span class="line">		parametermapValues=<span class="keyword">new</span> HashMap&lt;String,List&lt;String&gt;&gt;();</span><br><span class="line">		requstInfo = <span class="string">""</span>;</span><br><span class="line">		method = <span class="string">""</span>;</span><br><span class="line">		url = <span class="string">""</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">Request</span><span class="params">(InputStream is)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>();<span class="comment">//调用无参构造函数</span></span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			<span class="keyword">this</span>.is = is;</span><br><span class="line">			<span class="keyword">byte</span>[] buf = <span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">20480</span>];</span><br><span class="line">			<span class="keyword">int</span> len = is.read(buf);</span><br><span class="line">			requstInfo = <span class="keyword">new</span> String(buf,<span class="number">0</span>,len);</span><br><span class="line">		&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">			<span class="keyword">return</span>;	</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="comment">//调用本类中的分解请求信息的方法</span></span><br><span class="line">		<span class="keyword">this</span>.parseRequestInfo();</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">//分解请求信息的方法</span></span><br><span class="line">	<span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">parseRequestInfo</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		String paraString=<span class="string">""</span>;<span class="comment">//用于存储请求参数</span></span><br><span class="line">		<span class="comment">//获得第一行</span></span><br><span class="line">		String firstLine = requstInfo.substring(<span class="number">0</span>,requstInfo.indexOf(CRLF)).trim(); </span><br><span class="line">		<span class="keyword">int</span> index = firstLine.indexOf(<span class="string">"/"</span>); <span class="comment">//截取到第一个参数结束</span></span><br><span class="line">		<span class="keyword">this</span>.method = firstLine.substring(<span class="number">0</span>,index).trim();<span class="comment">//请求的第一个参数 请求方法    含头不含尾</span></span><br><span class="line">		String urlString = firstLine.substring(index, firstLine.indexOf(<span class="string">"HTTP/"</span>)).trim();<span class="comment">//获得文件路径</span></span><br><span class="line">		<span class="comment">//判断 get请求 还是 post请求</span></span><br><span class="line">		<span class="keyword">if</span>(method.equalsIgnoreCase(<span class="keyword">this</span>.method))&#123;</span><br><span class="line">			<span class="keyword">if</span>(urlString.contains(<span class="string">"?"</span>))&#123;</span><br><span class="line">				String[] urlArray = urlString.split(<span class="string">"\\?"</span>);</span><br><span class="line">				<span class="keyword">this</span>.url = urlArray[<span class="number">0</span>];</span><br><span class="line">				paraString = urlArray[<span class="number">1</span>];	</span><br><span class="line">			&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">				<span class="keyword">this</span>.url = urlString;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;<span class="keyword">else</span>&#123;<span class="comment">//post不包含请求参数</span></span><br><span class="line">			<span class="keyword">this</span>.url = urlString;</span><br><span class="line">			paraString =requstInfo.substring(requstInfo.lastIndexOf(CRLF));</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span>(paraString.equals(<span class="string">""</span>))&#123;</span><br><span class="line">			<span class="keyword">return</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="comment">//调用分解 请求参数的方法</span></span><br><span class="line">		<span class="keyword">this</span>.parseParam(paraString);</span><br><span class="line">		<span class="comment">//System.out.println(paraString);</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 *  分解 请求参数</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">parseParam</span><span class="params">(String paraString)</span></span>&#123;</span><br><span class="line">		String[] token = paraString.split(<span class="string">"&amp;"</span>);</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; token.length; i++) &#123;</span><br><span class="line">			String keyValues = token[i];</span><br><span class="line">			String[] keyValue = keyValues.split(<span class="string">"="</span>);</span><br><span class="line">			<span class="keyword">if</span>(keyValue.length ==<span class="number">1</span>)&#123;<span class="comment">// 只有参数名，没有参数值</span></span><br><span class="line">				keyValue = Arrays.copyOf(keyValue, <span class="number">2</span>);</span><br><span class="line">				keyValue[<span class="number">1</span>] = <span class="keyword">null</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="comment">//把参数名和参数值放入集合中</span></span><br><span class="line">			String key = keyValue[<span class="number">0</span>];</span><br><span class="line">			String value= keyValue[<span class="number">1</span>]==<span class="keyword">null</span>?<span class="keyword">null</span>:decode(keyValue[<span class="number">1</span>].trim(),<span class="string">"utf-8"</span>);</span><br><span class="line">			</span><br><span class="line">			<span class="comment">//放到集合存储</span></span><br><span class="line">			<span class="keyword">if</span>(!parametermapValues.containsKey(key))&#123;</span><br><span class="line">				parametermapValues.put(key, <span class="keyword">new</span> ArrayList&lt;String&gt;());</span><br><span class="line">			&#125;</span><br><span class="line">			List&lt;String&gt;  values = parametermapValues.get(key);</span><br><span class="line">			values.add(value);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">//根据表单 元素的name获取多个值</span></span><br><span class="line">	<span class="keyword">public</span> String [] getParametermapValues(String key)&#123;</span><br><span class="line">		List&lt;String&gt; values = parametermapValues.get(key);</span><br><span class="line">		<span class="keyword">if</span>(values==<span class="keyword">null</span>)&#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">		&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">			<span class="keyword">return</span> values.toArray(<span class="keyword">new</span> String[<span class="number">0</span>]);<span class="comment">//将集合转成 数组</span></span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">//根据表单元素的name获取单个值</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getParameter</span><span class="params">(String name)</span></span>&#123;</span><br><span class="line">		String[] values = <span class="keyword">this</span>.getParametermapValues(name);</span><br><span class="line">		<span class="keyword">if</span>(values==<span class="keyword">null</span>)&#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">		&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">			<span class="keyword">return</span> values[<span class="number">0</span>];</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//处理中文 ，因为浏览器对中文进行编码，所以需要解码</span></span><br><span class="line">	<span class="function"><span class="keyword">private</span> String <span class="title">decode</span><span class="params">(String value,String code)</span></span>&#123;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			<span class="keyword">return</span> URLDecoder.decode(value, code);</span><br><span class="line">		&#125; <span class="keyword">catch</span> (UnsupportedEncodingException e) &#123;</span><br><span class="line">			<span class="comment">// TODO 自动生成的 catch 块</span></span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//用于测试</span></span><br><span class="line">		<span class="comment">/*public void show()&#123;</span></span><br><span class="line"><span class="comment">			System.out.println(this.url);</span></span><br><span class="line"><span class="comment">			System.out.println(this.method);</span></span><br><span class="line"><span class="comment">		&#125;*/</span></span><br><span class="line">		</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		Request req = <span class="keyword">new</span> Request();</span><br><span class="line">		req.parseParam(<span class="string">"usr=a%20a&amp;pwd=&amp;hoby=foot&amp;hoby=baket"</span>);</span><br><span class="line">		System.out.println(req.parametermapValues);</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//调用获得多个值</span></span><br><span class="line">		String[] str = req.getParametermapValues(<span class="string">"hoby"</span>);</span><br><span class="line">		<span class="keyword">for</span> (String string : str) &#123;</span><br><span class="line">			System.out.println(string);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="comment">//调用获得一个值</span></span><br><span class="line">		System.out.println(req.getParameter(<span class="string">"usr"</span>));</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="11-6-总结"><a href="#11-6-总结" class="headerlink" title="11.6 总结"></a>11.6 总结</h4><p>1 字符串的分割</p>
<p>2 集合的使用  </p>
<p>3 集合的嵌套  Map中有List集合  </p>
<h3 id="12-封装-Response"><a href="#12-封装-Response" class="headerlink" title="12 封装 Response"></a>12 封装 Response</h3><h4 id="12-1-封装-Response"><a href="#12-1-封装-Response" class="headerlink" title="12.1 封装 Response"></a>12.1 封装 Response</h4><p>1) 构造响应头</p>
<p>2) 推送到客户端</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.szxy.server;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.BufferedWriter;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.OutputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.OutputStreamWriter;</span><br><span class="line"><span class="keyword">import</span> java.io.UnsupportedEncodingException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> cn.szxy.util.IOUtilClose;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Response</span> </span>&#123;<span class="comment">//响应</span></span><br><span class="line">	<span class="keyword">private</span> StringBuilder headInfo;<span class="comment">//响应头</span></span><br><span class="line">	<span class="keyword">private</span> StringBuilder content;<span class="comment">//响应内容</span></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">int</span> length;<span class="comment">//响应内容的长度</span></span><br><span class="line">	<span class="comment">//流</span></span><br><span class="line">	<span class="keyword">private</span> BufferedWriter bw;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//两个常量，换行和空格</span></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String CRLF=<span class="string">"\r\n"</span>;<span class="comment">//换行</span></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String BLANK=<span class="string">" "</span>;<span class="comment">//空格</span></span><br><span class="line">	</span><br><span class="line">	<span class="comment">//构造方法</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">Response</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		headInfo=<span class="keyword">new</span> StringBuilder();</span><br><span class="line">		content=<span class="keyword">new</span> StringBuilder();</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">//带参构造方法</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">Response</span><span class="params">(OutputStream os)</span></span>&#123;</span><br><span class="line">		<span class="keyword">this</span>();<span class="comment">//调用本类的无参构造方法</span></span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			bw=<span class="keyword">new</span> BufferedWriter(<span class="keyword">new</span> OutputStreamWriter(os, <span class="string">"utf-8"</span>));</span><br><span class="line">		&#125; <span class="keyword">catch</span> (UnsupportedEncodingException e) &#123;</span><br><span class="line">			headInfo=<span class="keyword">null</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">//构造正文部分</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> Response <span class="title">print</span><span class="params">(String info)</span></span>&#123;</span><br><span class="line">		content.append(info);</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			length+=info.getBytes(<span class="string">"utf-8"</span>).length;</span><br><span class="line">		&#125; <span class="keyword">catch</span> (UnsupportedEncodingException e) &#123;</span><br><span class="line">			<span class="comment">// TODO Auto-generated catch block</span></span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> Response <span class="title">println</span><span class="params">(String info)</span></span>&#123;</span><br><span class="line">		content.append(info).append(CRLF);</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			length+=(info+CRLF).getBytes(<span class="string">"utf-8"</span>).length;</span><br><span class="line">		&#125; <span class="keyword">catch</span> (UnsupportedEncodingException e) &#123;</span><br><span class="line">			<span class="comment">// TODO Auto-generated catch block</span></span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//构造响应头</span></span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">createHeadInfo</span><span class="params">(<span class="keyword">int</span> code)</span></span>&#123;</span><br><span class="line">		headInfo.append(<span class="string">"HTTP/1.1"</span>).append(BLANK).append(code).append(BLANK);</span><br><span class="line">		<span class="keyword">switch</span> (code) &#123;</span><br><span class="line">		<span class="keyword">case</span> <span class="number">200</span>:</span><br><span class="line">			headInfo.append(<span class="string">"OK"</span>);</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">case</span> <span class="number">500</span>:</span><br><span class="line">			headInfo.append(<span class="string">"SERVER ERROR"</span>);</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">default</span>:</span><br><span class="line">			headInfo.append(<span class="string">"NOT FOUND"</span>);</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		headInfo.append(CRLF);</span><br><span class="line">		headInfo.append(<span class="string">"Content-Type:text/html;charset=utf-8"</span>).append(CRLF);</span><br><span class="line">		headInfo.append(<span class="string">"Content-Length:"</span>+length).append(CRLF);</span><br><span class="line">		headInfo.append(CRLF);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * 推送到客户机的浏览器</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@param</span> code</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">pushToClient</span><span class="params">(<span class="keyword">int</span> code)</span></span>&#123;</span><br><span class="line">		<span class="keyword">if</span> (headInfo==<span class="keyword">null</span>) &#123;</span><br><span class="line">			code=<span class="number">500</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			<span class="comment">//调用本类中的构造响应头</span></span><br><span class="line">			<span class="keyword">this</span>.createHeadInfo(code);</span><br><span class="line">			bw.write(headInfo.toString());</span><br><span class="line">			bw.write(content.toString());</span><br><span class="line">			bw.flush();</span><br><span class="line">			<span class="keyword">this</span>.close();</span><br><span class="line">		&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">			<span class="comment">// TODO Auto-generated catch block</span></span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">close</span><span class="params">()</span></span>&#123;</span><br><span class="line">		IOUtilClose.CloseALL(bw);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="12-2-编写相应的-Servlet-构造响应内容"><a href="#12-2-编写相应的-Servlet-构造响应内容" class="headerlink" title="12.2 编写相应的 Servlet 构造响应内容"></a>12.2 编写相应的 Servlet 构造响应内容</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.szxy.servlet;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> cn.szxy.server.Request;</span><br><span class="line"><span class="keyword">import</span> cn.szxy.server.Response;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LoginServlet</span> <span class="keyword">extends</span> <span class="title">Servlet</span></span>&#123;</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doGet</span><span class="params">(Request req, Response rep)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">			<span class="comment">//获取请求参数</span></span><br><span class="line">		String name=req.getParameter(<span class="string">"username"</span>);</span><br><span class="line">		String pwd=req.getParameter(<span class="string">"pwd"</span>);</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">if</span>(<span class="keyword">this</span>.login(name, pwd))&#123;</span><br><span class="line">			<span class="comment">//调用响应中的构建内容的方</span></span><br><span class="line">			rep.println(name+<span class="string">"登录成功"</span>);</span><br><span class="line">		&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">			rep.println(name+<span class="string">"登录失败，对不起，账号或密码不正确"</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">private</span> <span class="keyword">boolean</span> <span class="title">login</span><span class="params">(String name,String pwd)</span></span>&#123;</span><br><span class="line">		<span class="keyword">if</span> (<span class="string">"bjsxt"</span>.equals(name)&amp;&amp;<span class="string">"123"</span>.equals(pwd)) &#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doPost</span><span class="params">(Request req, Response rep)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">		<span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="12-3-启动服务器进行"><a href="#12-3-启动服务器进行" class="headerlink" title="12.3 启动服务器进行"></a>12.3 启动服务器进行</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.szxy.server;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.BufferedWriter;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.OutputStreamWriter;</span><br><span class="line"><span class="keyword">import</span> java.net.ServerSocket;</span><br><span class="line"><span class="keyword">import</span> java.net.Socket;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> cn.szxy.servlet.Servlet;</span><br><span class="line"><span class="keyword">import</span> cn.szxy.util.IOUtilClose;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Server</span> </span>&#123;<span class="comment">//服务器</span></span><br><span class="line">	ServerSocket server;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">start</span><span class="params">()</span></span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.start(<span class="number">9999</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">start</span><span class="params">(<span class="keyword">int</span> port)</span></span>&#123;</span><br><span class="line">		<span class="comment">//创建 ServerSocket 对象</span></span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			server = <span class="keyword">new</span> ServerSocket(port);</span><br><span class="line">			<span class="keyword">this</span>.receive();</span><br><span class="line">		&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">receive</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="comment">// 监听客户端的请求</span></span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			Socket  client = server.accept();</span><br><span class="line">			<span class="comment">//封装请求信息</span></span><br><span class="line">			Request req = <span class="keyword">new</span> Request(client.getInputStream());</span><br><span class="line">			</span><br><span class="line">			<span class="comment">/*做出响应*/</span></span><br><span class="line">			<span class="comment">/*StringBuilder sb = new StringBuilder();</span></span><br><span class="line"><span class="comment">			sb.append("HTTP/1.1").append(" ").append("200").append(" ").append("OK").append("\r\n");</span></span><br><span class="line"><span class="comment">			sb.append("Content-Type:text/html;charset=utf-8").append("\r\n");</span></span><br><span class="line"><span class="comment">			String str="&lt;html&gt;&lt;head&gt;&lt;title&gt;响应结果&lt;/title&gt;&lt;/head&gt;&lt;body&gt;成功&lt;/body&gt;&lt;/html&gt;";</span></span><br><span class="line"><span class="comment">			sb.append("\r\n");</span></span><br><span class="line"><span class="comment">			sb.append(str);</span></span><br><span class="line"><span class="comment">			//通过输出流发出去</span></span><br><span class="line"><span class="comment">			BufferedWriter bw = new BufferedWriter(new OutputStreamWriter(client.getOutputStream(),"utf-8"));</span></span><br><span class="line"><span class="comment">			bw.write(sb.toString());</span></span><br><span class="line"><span class="comment">			bw.flush();</span></span><br><span class="line"><span class="comment">			bw.close();*/</span></span><br><span class="line">			</span><br><span class="line">			Response resp = <span class="keyword">new</span> Response(client.getOutputStream());</span><br><span class="line">			Servlet servlet = WebApp.getServlet(req.getUrl());  <span class="comment">//获得servlet-class</span></span><br><span class="line">			<span class="keyword">int</span> code=<span class="number">200</span>;</span><br><span class="line">			<span class="keyword">if</span> (servlet==<span class="keyword">null</span>) &#123;</span><br><span class="line">				code=<span class="number">404</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="comment">//调用Servlet中的服务的方法</span></span><br><span class="line">			<span class="keyword">try</span> &#123;</span><br><span class="line">				servlet.service(req, resp);</span><br><span class="line">			&#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">				<span class="comment">// TODO Auto-generated catch block</span></span><br><span class="line">				e.printStackTrace();</span><br><span class="line">			&#125;</span><br><span class="line">			resp.pushToClient(code);</span><br><span class="line">			IOUtilClose.CloseALL(client);</span><br><span class="line">			</span><br><span class="line">		</span><br><span class="line">		&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">			<span class="comment">// TODO 自动生成的 catch 块</span></span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">stop</span><span class="params">()</span></span>&#123;</span><br><span class="line">		IOUtilClose.CloseALL(server);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">//测试 方法</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"启动服务器..."</span>);</span><br><span class="line">		Server server = <span class="keyword">new</span> Server();</span><br><span class="line">		server.start();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="13-多线程"><a href="#13-多线程" class="headerlink" title="13 多线程"></a>13 多线程</h3><h4 id="13-1-Dispatcher-调度-类"><a href="#13-1-Dispatcher-调度-类" class="headerlink" title="13.1 Dispatcher (调度) 类"></a>13.1 Dispatcher (调度) 类</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.szxy.server;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.net.Socket;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> cn.szxy.servlet.Servlet;</span><br><span class="line"><span class="keyword">import</span> cn.szxy.util.IOUtilClose;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 一个请求一个响应	</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> wzer</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Dispatcher</span> <span class="keyword">implements</span> <span class="title">Runnable</span></span>&#123;</span><br><span class="line">	<span class="keyword">private</span> Request req;</span><br><span class="line">	<span class="keyword">private</span> Response resp;</span><br><span class="line">	<span class="keyword">private</span> Socket client;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">int</span> code;<span class="comment">//状态码</span></span><br><span class="line">	<span class="comment">//构造函数  初始化</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">Dispatcher</span><span class="params">(Socket client)</span> </span>&#123;</span><br><span class="line">		<span class="comment">// 把局部变量的值赋给 成员变量</span></span><br><span class="line">		<span class="keyword">this</span>.client = client;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			<span class="keyword">this</span>.req = <span class="keyword">new</span> Request(<span class="keyword">this</span>.client.getInputStream());</span><br><span class="line">			<span class="keyword">this</span>.resp = <span class="keyword">new</span> Response(<span class="keyword">this</span>.client.getOutputStream());</span><br><span class="line">		&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">			<span class="keyword">this</span>.code = <span class="number">500</span>;</span><br><span class="line">			<span class="keyword">return</span> ;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="comment">//根据不同的 URL 创建指定的 Servlet</span></span><br><span class="line">		<span class="comment">//System.out.println(req.getUrl());</span></span><br><span class="line">		Servlet servlet = WebApp.getServlet(req.getUrl());</span><br><span class="line">		<span class="keyword">if</span>(servlet==<span class="keyword">null</span>)&#123;</span><br><span class="line">			<span class="keyword">this</span>.code = <span class="number">404</span>;</span><br><span class="line">		&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">			<span class="comment">//调用 servlet 相应的 service 方法</span></span><br><span class="line">			<span class="keyword">try</span> &#123;</span><br><span class="line">				servlet.service(req, resp);</span><br><span class="line">			&#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">				<span class="keyword">this</span>.code =<span class="number">500</span>;</span><br><span class="line">			&#125; </span><br><span class="line">		&#125;</span><br><span class="line">		resp.pushToClient(code);</span><br><span class="line">		IOUtilClose.CloseALL(client);  </span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="13-2-Servlet-类"><a href="#13-2-Servlet-类" class="headerlink" title="13.2 Servlet 类"></a>13.2 Servlet 类</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.szxy.server;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.BufferedWriter;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.OutputStreamWriter;</span><br><span class="line"><span class="keyword">import</span> java.net.ServerSocket;</span><br><span class="line"><span class="keyword">import</span> java.net.Socket;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> cn.szxy.servlet.Servlet;</span><br><span class="line"><span class="keyword">import</span> cn.szxy.util.IOUtilClose;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Server</span> </span>&#123;<span class="comment">//服务器</span></span><br><span class="line">	<span class="keyword">private</span> ServerSocket server;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">boolean</span> isShutdown = <span class="keyword">false</span>;<span class="comment">//默认没有出错</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">start</span><span class="params">()</span></span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.start(<span class="number">8888</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">start</span><span class="params">(<span class="keyword">int</span> port)</span></span>&#123;</span><br><span class="line">		<span class="comment">//创建 ServerSocket 对象</span></span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			server = <span class="keyword">new</span> ServerSocket(port);</span><br><span class="line">			<span class="keyword">this</span>.receive();</span><br><span class="line">		&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">receive</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			<span class="keyword">while</span>(!isShutdown)&#123;</span><br><span class="line">				<span class="comment">// 监听客户端的请求</span></span><br><span class="line">				Socket  client = server.accept();</span><br><span class="line">				<span class="comment">//创建线程类对象</span></span><br><span class="line">				Dispatcher  dis = <span class="keyword">new</span> Dispatcher(client);</span><br><span class="line">				<span class="comment">//创建代理类并启动线程</span></span><br><span class="line">				<span class="keyword">new</span> Thread(dis).start();	</span><br><span class="line">			&#125;</span><br><span class="line">		&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">			<span class="keyword">this</span>.stop();<span class="comment">//出现错误，关闭服务器		</span></span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">stop</span><span class="params">()</span></span>&#123;</span><br><span class="line">		isShutdown = <span class="keyword">true</span>;</span><br><span class="line">		IOUtilClose.CloseALL(server);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">//测试 方法</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"启动服务器..."</span>);</span><br><span class="line">		Server server = <span class="keyword">new</span> Server();</span><br><span class="line">		server.start();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="13-3-bug"><a href="#13-3-bug" class="headerlink" title="13.3 bug"></a>13.3 bug</h4><p>​    在处理网站 小图标没有添加对应的 Servlet 去处理，导致程序出现空指针异常。</p>
<h3 id="14-处理小-bug"><a href="#14-处理小-bug" class="headerlink" title="14 处理小 bug"></a>14 处理小 bug</h3><h4 id="14-1-新建-FaviconServlet-类"><a href="#14-1-新建-FaviconServlet-类" class="headerlink" title="14.1 新建 FaviconServlet 类"></a>14.1 新建 <code>FaviconServlet</code> 类</h4><p>只需创建好 <code>FAViconServlet</code>， 不需要对数据进行处理</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.szxy.servlet;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> cn.szxy.server.Request;</span><br><span class="line"><span class="keyword">import</span> cn.szxy.server.Response;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">FaviconServlet</span> <span class="keyword">extends</span> <span class="title">Servlet</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doGet</span><span class="params">(Request req, Response resp)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">		<span class="comment">// TODO 自动生成的方法存根</span></span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doPost</span><span class="params">(Request req, Response resp)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">		<span class="comment">// TODO 自动生成的方法存根</span></span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="14-2-配置-web-xml"><a href="#14-2-配置-web-xml" class="headerlink" title="14.2  配置 web.xml"></a>14.2  配置 web.xml</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="line">&lt;web-app&gt;</span><br><span class="line">	&lt;servlet&gt;</span><br><span class="line">		&lt;servlet-name&gt;login&lt;/servlet-name&gt;</span><br><span class="line">		&lt;servlet-class&gt;cn.szxy.servlet.LoginServlet&lt;/servlet-class&gt;</span><br><span class="line">	&lt;/servlet&gt;</span><br><span class="line">	&lt;servlet-mapping&gt;</span><br><span class="line">		&lt;servlet-name&gt;login&lt;/servlet-name&gt;</span><br><span class="line">		&lt;url-pattern&gt;/LoginServlet&lt;/url-pattern&gt;</span><br><span class="line">		&lt;url-pattern&gt;/Log&lt;/url-pattern&gt;</span><br><span class="line">	&lt;/servlet-mapping&gt;</span><br><span class="line">	&lt;servlet&gt;</span><br><span class="line">		&lt;servlet-name&gt;Regsin&lt;/servlet-name&gt;</span><br><span class="line">		&lt;servlet-class&gt;cn.szxy.servlet.RegisnServlet&lt;/servlet-class&gt;</span><br><span class="line">	&lt;/servlet&gt;</span><br><span class="line">	</span><br><span class="line">	&lt;servlet&gt;</span><br><span class="line">		&lt;servlet-name&gt;Favicon&lt;/servlet-name&gt;</span><br><span class="line">		&lt;servlet-class&gt;cn.szxy.servlet.FaviconServlet&lt;/servlet-class&gt;</span><br><span class="line">	&lt;/servlet&gt;</span><br><span class="line">	&lt;servlet-mapping&gt;</span><br><span class="line">		&lt;servlet-name&gt;Favicon&lt;/servlet-name&gt;</span><br><span class="line">		&lt;url-pattern&gt;/favicon.ico&lt;/url-pattern&gt;</span><br><span class="line">	&lt;/servlet-mapping&gt;</span><br><span class="line">&lt;/web-app&gt;</span><br></pre></td></tr></table></figure>

<h3 id="15总结和期望"><a href="#15总结和期望" class="headerlink" title="15总结和期望"></a>15总结和期望</h3><h4 id="15-1-项目总结涉及知识点"><a href="#15-1-项目总结涉及知识点" class="headerlink" title="15.1 项目总结涉及知识点"></a>15.1 项目总结涉及知识点</h4><p>1) 集合</p>
<p>2) IO</p>
<p>3) 多线程</p>
<p>4) 网络编程</p>
<p>5) 面向对象</p>
<p>6) 反射</p>
<p>7) XML</p>
<p>8) HTML</p>
<h4 id="15-2-项目思路"><a href="#15-2-项目思路" class="headerlink" title="15.2 项目思路"></a>15.2 项目思路</h4><p>1) 先分析</p>
<p>2) 搭建项目框架</p>
<p>3) 一步一步实现，先从会的开始实现</p>
<p>4) 整体思路，宏观使用面向对象，微观使用面向过程</p>
<p>5) 注重代码的调试</p>
<h4 id="15-3-思想是从键盘中敲出来的"><a href="#15-3-思想是从键盘中敲出来的" class="headerlink" title="15.3 思想是从键盘中敲出来的"></a>15.3 思想是从键盘中敲出来的</h4><p>1) 多注重实战</p>
<p>2) 学知识不是目的，目的是对知识的<strong>综合运用,</strong>才能将知识转化为<strong>能力</strong></p>
<p>3) 不要气馁，每天进步一点点，人最大的敌人是自己，今天的自己比昨天的自己有进步，就是成功。</p>
<p>4) 今天所有的付出，都会在明天以 RMB 的形式还给你。</p>
<p>5) 加油！</p>
<p><strong>记住：你不拼一把，永远不知道自己有多优秀</strong></p>

        
      
    </div>

    
    
    
      <footer class="post-footer">
          <div class="post-eof"></div>
        
      </footer>
  </div>
  
  
  
  </article>

    
        <article itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block home">
    <link itemprop="mainEntityOfPage" href="http://zwer.xyz/2018/11/18/Java/20181118 多线程并发技术/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="zwer">
      <meta itemprop="description" content="记录学习的日常">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="zwer 的博客空间">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
            
            <a href="/2018/11/18/Java/20181118 多线程并发技术/" class="post-title-link" itemprop="url">20181118 多线程并发技术</a>
          
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              
                
              

              <time title="Created: 2018-11-18 19:30:00" itemprop="dateCreated datePublished" datetime="2018-11-18T19:30:00+08:00">2018-11-18</time>
            </span>
          
            

            
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2019-02-27 22:13:45" itemprop="dateModified" datetime="2019-02-27T22:13:45+08:00">2019-02-27</time>
              </span>
            
          
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Java/" itemprop="url" rel="index"><span itemprop="name">Java</span></a></span>

                
                
              
            </span>
          

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h3 id="1-线程知识回顾"><a href="#1-线程知识回顾" class="headerlink" title="1 线程知识回顾"></a>1 线程知识回顾</h3><h4 id="1-1-程序、进程、线程"><a href="#1-1-程序、进程、线程" class="headerlink" title="1.1 程序、进程、线程"></a>1.1 程序、进程、线程</h4><p>程序： 计算机指令中的集合</p>
<p>进程： 运行中的程序</p>
<p>线程： 是进程中一个“单一的连续控制流程” (<code>a singlesThread,equential</code>flow of control)/执行路径<br>线程又被称为轻量级进程(lightweight process)。</p>
<h4 id="1-2-在-Java-中创建线程的两种方式"><a href="#1-2-在-Java-中创建线程的两种方式" class="headerlink" title="1.2 在 Java 中创建线程的两种方式"></a>1.2 在 Java 中创建线程的两种方式</h4><p>1) 继承 Thread<br>2) 实现 Runnable 接口</p>
<h4 id="1-3-线程的生命周期"><a href="#1-3-线程的生命周期" class="headerlink" title="1.3 线程的生命周期"></a>1.3 线程的生命周期</h4><p><img src="C:%5CUsers%5CLenovo%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1542542458554.png" alt="1542542458554"></p>
<h4 id="1-4-同步与死锁"><a href="#1-4-同步与死锁" class="headerlink" title="1.4 同步与死锁"></a>1.4 同步与死锁</h4><p>1) 同步方法 同步监视器为当前对象 this</p>
<p>2) 同步代码块(同步监视器/共享资源的对象){}过多的同步就会导致死锁</p>
<h4 id="1-5-线程间的通信"><a href="#1-5-线程间的通信" class="headerlink" title="1.5 线程间的通信"></a>1.5 线程间的通信</h4><p>1) wait()</p>
<p>2) notify()</p>
<p>3) <code>notifyAll()</code></p>
<h4 id="1-6-案例"><a href="#1-6-案例" class="headerlink" title="1.6 案例"></a>1.6 案例</h4><p>编写两个线程,一个线程打印 1-52 的整数，另一个线程打印字母 A-Z。打印顺序为 12A34B56C….5152Z。即按照整数和字母的顺序从小到大打印，并且每打印两个整数后，打印一个字母，交替循环打印，直到打印到整数 52 和字母 Z 结束。</p>
<p>要求：1) 编写打印类 Printer，声明私有属性 index，初始值为 1，用来表示是第几次打印。</p>
<p>2) 在打印类 Printer 中编写打印数字的方法 <code>print(int i)</code>，3 的倍数就使用 wait()方法等待，否则就输出 <code>i</code>，使用 <code>notifyAll()</code>进行唤醒其它线程。</p>
<p>3) 在打印类 Printer 中编写打印字母的方法 print(char c)，不是 3 的倍数就等待，否则就打印输出字母 c，使用 <code>notifyAll()</code>进行唤醒其它线程。</p>
<p>4) 编写打印数字的线程 <code>NumberPrinter</code>继承 Thread 类，声私有属性 private Printer p;在构造方法中进行赋值，实现父类的 run 方法，调用 Printer 类中的输出数字的方法。</p>
<p>5) 编写打印字母的线程<code>LetterPrinter</code> 继承 Thread 类，声明私有属性 private Printer p;在构造方法中进行赋值，实现父类的run 方法，调用 Printer 类中的输出字母的方法。</p>
<p>6) 编写测试类 Test，创建打印类对象，创建两个线程类对象，启动线程</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.szxy.reviewThread;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 打印数字和字母</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> wzer</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Printer</span> </span>&#123;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">int</span> index=<span class="number">1</span>;<span class="comment">//打印的位置</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">synchronized</span> <span class="keyword">void</span> <span class="title">PrintNum</span><span class="params">(<span class="keyword">int</span> num)</span></span>&#123;</span><br><span class="line">		<span class="keyword">if</span>(index%<span class="number">3</span>==<span class="number">0</span>)&#123;</span><br><span class="line">			<span class="keyword">try</span> &#123;</span><br><span class="line">				<span class="keyword">this</span>.wait();</span><br><span class="line">			&#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">				<span class="comment">// TODO 自动生成的 catch 块</span></span><br><span class="line">				e.printStackTrace();</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		System.out.print(num);</span><br><span class="line">		index++;</span><br><span class="line">		<span class="keyword">super</span>.notify();</span><br><span class="line">	&#125;</span><br><span class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">synchronized</span> <span class="keyword">void</span> <span class="title">PrinChar</span><span class="params">(<span class="keyword">char</span> c)</span></span>&#123;</span><br><span class="line">	   <span class="keyword">if</span>(index%<span class="number">3</span>!=<span class="number">0</span>)&#123;</span><br><span class="line">		   <span class="keyword">try</span> &#123;</span><br><span class="line">			<span class="keyword">this</span>.wait();</span><br><span class="line">		&#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">			<span class="comment">// TODO 自动生成的 catch 块</span></span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">	   &#125;</span><br><span class="line">	   System.out.print(c);</span><br><span class="line">	   index++;</span><br><span class="line">	   <span class="keyword">super</span>.notify();</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.szxy.reviewThread;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 打印数字</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> wzer</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PrintNumber</span> <span class="keyword">implements</span> <span class="title">Runnable</span></span>&#123;</span><br><span class="line">	<span class="keyword">private</span> Printer printer;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">PrintNumber</span><span class="params">(Printer p)</span> </span>&#123;</span><br><span class="line">		<span class="comment">// TODO 自动生成的构造函数存根</span></span><br><span class="line">		<span class="keyword">this</span>.printer = p;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="comment">// TODO 自动生成的方法存根</span></span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=<span class="number">52</span>;i++)</span><br><span class="line">		printer.PrintNum(i);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.szxy.reviewThread;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 打印字母</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> wzer</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PrintChar</span> <span class="keyword">implements</span> <span class="title">Runnable</span></span>&#123;</span><br><span class="line">	<span class="keyword">private</span> Printer printer;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">PrintChar</span><span class="params">(Printer p)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.printer = p;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="comment">// TODO 自动生成的方法存根</span></span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">char</span> c=<span class="string">'A'</span>;c&lt;=<span class="string">'Z'</span>;c++)&#123;</span><br><span class="line">			printer.PrinChar(c);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">	<span class="keyword">package</span> cn.szxy.reviewThread;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 利用多线程打印</span></span><br><span class="line"><span class="comment"> * 12A34B56C78D910E1112F1314G1516H1718I1920J2122K2324L2526M2728N2930O3132P3334Q3536R3738S3940T4142U4344V4546W4748X4950Y5152Z</span></span><br><span class="line"><span class="comment"> * 这个序列</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> wzer</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		Printer printer = <span class="keyword">new</span> Printer();<span class="comment">//共享资源</span></span><br><span class="line">		</span><br><span class="line">		<span class="comment">//创建线程</span></span><br><span class="line">		Thread num = <span class="keyword">new</span> Thread(<span class="keyword">new</span> PrintNumber(printer));</span><br><span class="line">		Thread ch = <span class="keyword">new</span> Thread(<span class="keyword">new</span> PrintChar(printer));</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//启动线程</span></span><br><span class="line">		num.start();</span><br><span class="line">		ch.start();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="2-执行多线程的第三种方式"><a href="#2-执行多线程的第三种方式" class="headerlink" title="2 执行多线程的第三种方式"></a>2 执行多线程的第三种方式</h3><h4 id="2-1-实现线程前两种方式的缺点"><a href="#2-1-实现线程前两种方式的缺点" class="headerlink" title="2.1 实现线程前两种方式的缺点"></a>2.1 实现线程前两种方式的缺点</h4><p>1) 没有返回值</p>
<p>2) 不支持泛型</p>
<p>3) 异常必须处理</p>
<h4 id="2-2-实现多线程的第三种方式"><a href="#2-2-实现多线程的第三种方式" class="headerlink" title="2.2 实现多线程的第三种方式"></a>2.2 实现多线程的第三种方式</h4><p>实现 Callable 接口，重写 call 方法Callable 功能更加强大</p>
<p>1) Future 接 口 位 于<code>java.util.concurrent</code>包 中 ,可 以 对 具 体Runnable、Callable 任务的执行结果进行取消(cancel 方法，尝试取消执行此任务)、查询是否完成(i<code>sDone</code>方法)、获取结果(get 方法,等待完成，然后检索其结果)等。</p>
<p>2) <code>FutrueTask</code>是<code>Futrue</code>接口的唯一的实现类</p>
<p>3)<code>FutureTask</code> 同时实现了 Runnable, Future 接口。它既可以作为 Runnable 被线程执行，又可以作为 Future 得到Callable 的返回值</p>
<p><img src="C:%5CUsers%5CLenovo%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1542544545063.png" alt="1542544545063"></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.szxy.TestCallable;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.Callable;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * String数组前面要加 包名，不然编译器不认识</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> wzer</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &lt;String&gt;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Fruit</span>&lt;<span class="title">String</span>&gt; <span class="keyword">implements</span> <span class="title">Callable</span>&lt;<span class="title">String</span>&gt;</span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">call</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">		java.lang.String [] str= &#123;<span class="string">"apple"</span>,<span class="string">"banana"</span>,<span class="string">"orange"</span>,<span class="string">"pear"</span>,<span class="string">"grape"</span>&#125;;</span><br><span class="line">		<span class="keyword">int</span> index=(<span class="keyword">int</span>)(Math.random()*<span class="number">5</span>);</span><br><span class="line">		<span class="keyword">return</span> (String) str[index];</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>​    </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.szxy.TestCallable;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.ExecutionException;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.FutureTask;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 实现多线程的第三种</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> wzer</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> InterruptedException, ExecutionException </span>&#123;</span><br><span class="line">		<span class="comment">//创建任务</span></span><br><span class="line">		Fruit fruit = <span class="keyword">new</span> Fruit();</span><br><span class="line">		<span class="comment">//（2）交能任务管理 </span></span><br><span class="line">		<span class="comment">/**任务管理器是一个实现类，实现了RunnableFutrue接口,</span></span><br><span class="line"><span class="comment">		 * RunnableFutrue是Futrue与Runnable接口的子接口*/</span></span><br><span class="line">		FutureTask&lt;String&gt; task=<span class="keyword">new</span> FutureTask&lt;&gt;(fruit); <span class="comment">//可以看成是Runnable接口的实现类</span></span><br><span class="line">		<span class="comment">//创建代理类并启动线程</span></span><br><span class="line">		Thread t=<span class="keyword">new</span> Thread(task);</span><br><span class="line">		t.start();</span><br><span class="line">		System.out.println(<span class="string">"获取结果:"</span>+task.get());</span><br><span class="line">		<span class="comment">//判断任务是否执行完成</span></span><br><span class="line">		System.out.println(<span class="string">"任务是否执行完成:"</span>+task.isDone());</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="2-3-总结"><a href="#2-3-总结" class="headerlink" title="2.3 总结"></a>2.3 总结</h4><p>实现第三种多线程方法需要实现 Callable 接口 </p>
<p>在主方法 调用的时候，创建 Callable 接口的实现类的对象，创建  <code>FutureTask</code>  类对象，并添加 Callable 接口的实现类 ，最后使用代理，通过 Thread 类开启线程模式。</p>
<h3 id="3-线程同步-Lock-锁"><a href="#3-线程同步-Lock-锁" class="headerlink" title="3 线程同步 Lock 锁"></a>3 线程同步 Lock 锁</h3><h4 id="3-1-线程同步的第三种方法"><a href="#3-1-线程同步的第三种方法" class="headerlink" title="3.1 线程同步的第三种方法"></a>3.1 线程同步的第三种方法</h4><p>Lock 锁:对需要上锁的地方上锁</p>
<p>1) JDK1.5 后新增的功能</p>
<p>2) 与 Synchronized 相比，Lock 可提供多种锁方案，更灵活</p>
<p>3) <code>Java.util.concurrent.locks</code>中的 Lock 是一个接口，它的实现类是一个 Java 类，而不是作为语言的特性（关键字）来实现注意：如果同步代码有异常，要将 <code>unLock()</code>放到 finally 中</p>
<h4 id="3-2-步骤"><a href="#3-2-步骤" class="headerlink" title="3.2 步骤"></a>3.2 步骤</h4><p>1) 创建 Lock 对象</p>
<p>2) 调用 lock()方法上锁</p>
<p>3) 调用 unlock()方法解锁</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.szxy.TestLock;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.locks.Lock;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.locks.ReentrantLock;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestLock</span> <span class="keyword">implements</span> <span class="title">Runnable</span> </span>&#123;</span><br><span class="line">	<span class="keyword">int</span> index =<span class="number">0</span>;</span><br><span class="line">	Lock lock = <span class="keyword">new</span> ReentrantLock();<span class="comment">//创建锁对象</span></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	</span><br><span class="line">		<span class="comment">// TODO 自动生成的方法存根</span></span><br><span class="line">		<span class="comment">//synchronized (this) &#123;</span></span><br><span class="line">		lock.lock();</span><br><span class="line">			<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;<span class="number">10</span>;i++)&#123;</span><br><span class="line">				<span class="keyword">try</span> &#123;</span><br><span class="line">					index++;</span><br><span class="line">					Thread.sleep(<span class="number">300</span>);</span><br><span class="line">				&#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">					<span class="comment">// TODO 自动生成的 catch 块</span></span><br><span class="line">					e.printStackTrace();</span><br><span class="line">				&#125;</span><br><span class="line">				System.out.println(Thread.currentThread().getName()+<span class="string">"执行第"</span>+index+<span class="string">"次"</span>);</span><br><span class="line">			&#125;</span><br><span class="line">		lock.unlock();</span><br><span class="line">		<span class="comment">//&#125;</span></span><br><span class="line">		</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.szxy.TestLock;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		TestLock tl = <span class="keyword">new</span> TestLock();</span><br><span class="line">		<span class="comment">//使用代理</span></span><br><span class="line">		<span class="keyword">new</span> Thread(tl,<span class="string">"A"</span>).start();</span><br><span class="line">		<span class="keyword">new</span> Thread(tl,<span class="string">"B"</span>).start();</span><br><span class="line">		<span class="keyword">new</span> Thread(tl,<span class="string">"C"</span>).start();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="3-3Lock-与-synchronized-的区别"><a href="#3-3Lock-与-synchronized-的区别" class="headerlink" title="3.3Lock 与 synchronized 的区别"></a>3.3Lock 与 synchronized 的区别</h4><p>1) Lock 是 显 示 锁 (手 动 开 启 和 关 闭 锁 ,别 忘 关 闭锁),synchronized 是隐式锁</p>
<p>2) Lock 只有代码块锁，synchronized 有代码块锁和方法锁</p>
<p>3) 使用 Lock 锁，JVM 将花费较少的时间来调度线程，性能更好，并且具有更好的扩展性（提供更多的子类）</p>
<p>4) Lock 确保当一个线程位于代码的<strong>临界区</strong>时，另一个线不进入临界区。如果其他线程试图进入锁定的代码，则它将一直等待(即被阻止)，直到该对象被释放。lock()方法会对 Lock 实例对象进行加锁，因此所有对该对象调用 lock()方法的线程都会被阻塞，直到该 Lock 对象的 unlock()法被</p>
<h4 id="3-4-总结"><a href="#3-4-总结" class="headerlink" title="3.4  总结"></a>3.4  总结</h4><p>   创建锁对象 <code>Lock lock = new ReentrantLock();</code>//创建锁对象   父类接口指向子类实现</p>
<h3 id="4-线程池"><a href="#4-线程池" class="headerlink" title="4 线程池"></a>4 线程池</h3><h4 id="4-1-什么是线程池"><a href="#4-1-什么是线程池" class="headerlink" title="4.1 什么是线程池"></a>4.1 什么是线程池</h4><p>存放线程的池子</p>
<p>创建和销毁对象是非常耗费时间的</p>
<p>创建对象：需要分配内存等资源销毁对象：虽然不需要程序员操心，但是垃圾回收器会在后台一直跟踪并销毁对于经常创建和销毁、使用量特别大的资源，比如并发情况下的线程，对性能影响很大。</p>
<p>思路：</p>
<p>创建好多个线程，放入线程池中，使用时直接获取引用，不使用时放回池中。可以避免频繁创建销毁、实现重复利用</p>
<p>生活案例：在尚学堂借用和归还电脑、共享单车</p>
<p>技术案例：线程池、数据库连接池</p>
<p>JDK1.5 起，提供了内置线程池</p>
<h4 id="4-2-线程池的好处"><a href="#4-2-线程池的好处" class="headerlink" title="4.2 线程池的好处"></a>4.2 线程池的好处</h4><p>1) 提高响应速度（减少了创建新线程的时间）<br>2) 降低资源消耗（重复利用线程池中线程，不需要每次都创建）</p>
<p>3) 提高线程的可管理性：避免线程无限制创建、从而销毁系统资源，降低系统稳定性，甚至内存溢出或者 CPU 耗尽 </p>
<h4 id="4-3-线程池的应用场合"><a href="#4-3-线程池的应用场合" class="headerlink" title="4.3 线程池的应用场合"></a>4.3 线程池的应用场合</h4><p>1) 需要大量线程，并且完成任务的时间短</p>
<p>2) 对性能要求苛刻</p>
<p>3) 接受突发性的大量请求</p>
<h4 id="4-4-使用线程池执行大量的-Runnable-命令"><a href="#4-4-使用线程池执行大量的-Runnable-命令" class="headerlink" title="4.4 使用线程池执行大量的 Runnable 命令"></a>4.4 使用线程池执行大量的 Runnable 命令</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.szxy.ThreadPool;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.ExecutorService;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.Executors;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RunableThread</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		<span class="comment">//如何创建一个线程池</span></span><br><span class="line">		<span class="comment">//(1)创建一个线程池，线程池中只有一个线程对象</span></span><br><span class="line">		<span class="comment">//ExecutorService pool1=Executors.newSingleThreadExecutor();</span></span><br><span class="line">		<span class="comment">//(2)创建一个线程池，线程池中有线程的数量固定</span></span><br><span class="line">		<span class="comment">//ExecutorService pool1=Executors.newFixedThreadPool(10);</span></span><br><span class="line">		<span class="comment">//(3)创建一个线程池，线程池中的线程的数量可以动态的改变</span></span><br><span class="line">		ExecutorService pool1=Executors.newCachedThreadPool();</span><br><span class="line">		</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=<span class="number">20</span>;i++)&#123;</span><br><span class="line">			 <span class="keyword">final</span> <span class="keyword">int</span> n = i;</span><br><span class="line">			 Runnable command = <span class="keyword">new</span> Runnable() &#123;<span class="comment">//匿名内部类</span></span><br><span class="line">				<span class="meta">@Override</span></span><br><span class="line">				<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">					<span class="comment">// TODO 自动生成的方法存根</span></span><br><span class="line">					<span class="keyword">try</span> &#123;</span><br><span class="line">						Thread.sleep(<span class="number">2000</span>);</span><br><span class="line">					&#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">						<span class="comment">// TODO 自动生成的 catch 块</span></span><br><span class="line">						e.printStackTrace();</span><br><span class="line">					&#125;</span><br><span class="line">					System.out.println(n);</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;;</span><br><span class="line">			pool1.execute(command);</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		pool1.shutdown();</span><br><span class="line">	</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="4-5-使用线程池执行大量的-Callable"><a href="#4-5-使用线程池执行大量的-Callable" class="headerlink" title="4.5 使用线程池执行大量的 Callable"></a>4.5 使用线程池执行大量的 Callable</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.szxy.ThreadPool;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.Callable;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.ExecutionException;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.ExecutorService;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.Executors;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.Future;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CallableThread</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> InterruptedException, ExecutionException </span>&#123;</span><br><span class="line">		<span class="comment">//1  创建单个线程池</span></span><br><span class="line">		<span class="comment">//ExecutorService pool1 = Executors.newSingleThreadExecutor();</span></span><br><span class="line">		<span class="comment">//2 创建10个线程池</span></span><br><span class="line">		<span class="comment">//ExecutorService pool1 = Executors.newFixedThreadPool(10);</span></span><br><span class="line">		<span class="comment">//3 动态线程池</span></span><br><span class="line">		ExecutorService pool1 = Executors.newCachedThreadPool();</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//创建一个集合</span></span><br><span class="line">		List&lt;Future&gt; list = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;<span class="number">20</span>;i++)&#123;</span><br><span class="line">			<span class="comment">// 创建任务</span></span><br><span class="line">			Callable&lt;Integer&gt; task = <span class="keyword">new</span> Callable&lt;Integer&gt;()&#123;</span><br><span class="line">				<span class="meta">@Override</span></span><br><span class="line">				<span class="function"><span class="keyword">public</span> Integer <span class="title">call</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">					Thread.sleep(<span class="number">2000</span>);</span><br><span class="line">					<span class="keyword">return</span> ((<span class="keyword">int</span>)(Math.random()*<span class="number">10</span>));</span><br><span class="line">				&#125;</span><br><span class="line">				</span><br><span class="line">			&#125;;</span><br><span class="line">			<span class="comment">//提交任务</span></span><br><span class="line">		   Future f  = pool1.submit(task);</span><br><span class="line">		   list.add(f);</span><br><span class="line">		   <span class="comment">//System.out.println(f.get());</span></span><br><span class="line">		&#125;</span><br><span class="line">			System.out.println(<span class="string">"ok?"</span>);</span><br><span class="line">			<span class="keyword">for</span>(Future f:list)&#123;</span><br><span class="line">				System.out.println(f.get());</span><br><span class="line">			&#125;</span><br><span class="line">			System.out.println(<span class="string">"ok!"</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="4-6-总结"><a href="#4-6-总结" class="headerlink" title="4.6 总结"></a>4.6 总结</h4><p>1 创建线程池所使用的类有 <code>ExecutorService</code>   Executors</p>
<p>2 创建线程池有 3 中 模式 ,创建单个线程池 Single，创建指定数目的线程池 Fixed，创建动态的线程池 Cached</p>
<p>3  在使用线程池执行 Callable 时，需要先创建一个 List 集合</p>
<p>将得到的结果添加到集合中，然后用 get 方法打印输出</p>
<h3 id="5-任务调度-Timer-Task"><a href="#5-任务调度-Timer-Task" class="headerlink" title="5 任务调度 Timer Task"></a>5 任务调度 Timer Task</h3><h4 id="5-1-调度"><a href="#5-1-调度" class="headerlink" title="5.1 调度"></a>5.1 调度</h4><p>任务：就是事情</p>
<p>调度：在不同的时间点或者在指定的时间点或者间隔多长时间我去运行这个任务。</p>
<p>就是生活中的闹钟</p>
<h4 id="5-2-相关的类Timer-类-位于-java-util包中"><a href="#5-2-相关的类Timer-类-位于-java-util包中" class="headerlink" title="5.2 相关的类Timer 类:位于 java.util包中"></a>5.2 相关的类Timer 类:位于 <code>java.util</code>包中</h4><h4 id="5-3-案例实现时间的动态刷新"><a href="#5-3-案例实现时间的动态刷新" class="headerlink" title="5.3 案例实现时间的动态刷新"></a>5.3 案例实现时间的动态刷新</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.szxy.TimerTask;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Date;</span><br><span class="line"><span class="keyword">import</span> java.util.TimerTask;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 任务</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> wzer</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Clock</span> <span class="keyword">extends</span> <span class="title">TimerTask</span></span>&#123;</span><br><span class="line">	<span class="keyword">long</span> time =<span class="number">1000</span>;</span><br><span class="line">	<span class="meta">@Override</span>	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;<span class="comment">//要执行的任务</span></span><br><span class="line">		Date d = <span class="keyword">new</span> Date(time);</span><br><span class="line">		System.out.println(d.toLocaleString());</span><br><span class="line">		time+=<span class="number">1000</span>;	</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.szxy.TimerTask;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Date;</span><br><span class="line"><span class="keyword">import</span> java.util.Timer;</span><br><span class="line"><span class="keyword">import</span> java.util.TimerTask;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestTimerTask</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		<span class="comment">//创建时间</span></span><br><span class="line">		Timer t = <span class="keyword">new</span> Timer();</span><br><span class="line">		<span class="comment">//创建任务</span></span><br><span class="line">		TimerTask task = <span class="keyword">new</span> Clock();</span><br><span class="line">		<span class="comment">//调用        执行任务         任务的开始时间	        每隔多久执行	 </span></span><br><span class="line">		t.schedule(task,<span class="keyword">new</span> Date(System.currentTimeMillis()+<span class="number">1000</span>), <span class="number">1000</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="6-ThreadLocal"><a href="#6-ThreadLocal" class="headerlink" title="6  ThreadLocal"></a>6  <code>ThreadLocal</code></h3><h4 id="6-1ThreadLocal"><a href="#6-1ThreadLocal" class="headerlink" title="6.1ThreadLocal"></a>6.1ThreadLocal</h4><p><code>ThreadLocal</code>直译为“本地线程”，其实它就是一容器，用于存放线程的局部变量</p>
<p>作用：为解决多线程程序的并发问题</p>
<ul>
<li><p>这个类提供线程局部变量。  这些变量与其正常的对应方式不同，因为访问一个的每个线程（通过其<code>get</code>或<code>set</code>方法）都有自己独立初始化<strong>的变量副本</strong>。 </p>
</li>
<li><p><code>ThreadLocal</code>实例通常是希望将状态与线程关联的类中的私有静态字段（例如，用户ID或事务ID）。 </p>
</li>
</ul>
<h4 id="6-2-案例实现一个序列号的生成器程序"><a href="#6-2-案例实现一个序列号的生成器程序" class="headerlink" title="6.2 案例实现一个序列号的生成器程序"></a>6.2 案例实现一个序列号的生成器程序</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.szxy.TestThreadLocal;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 接口</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> wzer</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Sequence</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getNumber</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.szxy.TestThreadLocal;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SequenceImpl</span> <span class="keyword">implements</span> <span class="title">Sequence</span></span>&#123;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">int</span> number = <span class="number">0</span>;</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getNumber</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.number++;</span><br><span class="line">		<span class="keyword">return</span> number;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">	<span class="keyword">package</span> cn.szxy.TestThreadLocal;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SequenceImpl2</span> <span class="keyword">implements</span> <span class="title">Sequence</span></span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> ThreadLocal&lt;Integer&gt; numberContainer = <span class="keyword">new</span> ThreadLocal&lt;Integer&gt;()&#123;</span><br><span class="line">		<span class="function"><span class="keyword">protected</span> Integer <span class="title">initialValue</span><span class="params">()</span> </span>&#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;;</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getNumber</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		numberContainer.set(numberContainer.get()+<span class="number">1</span>);</span><br><span class="line">		<span class="keyword">return</span> numberContainer.get();</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.szxy.TestThreadLocal;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyTread</span> <span class="keyword">implements</span> <span class="title">Runnable</span></span>&#123;</span><br><span class="line">	<span class="keyword">private</span> Sequence seq;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">MyTread</span><span class="params">(Sequence seq)</span> </span>&#123;</span><br><span class="line">		<span class="comment">// TODO 自动生成的构造函数存根</span></span><br><span class="line">		<span class="keyword">this</span>.seq = seq;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="comment">// TODO 自动生成的方法存根</span></span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=<span class="number">3</span>;i++)&#123;</span><br><span class="line">			System.out.println(Thread.currentThread().getName()+<span class="string">"---&gt;number= "</span>+seq.getNumber());</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.szxy.TestThreadLocal;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 测试类</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> wzer</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		<span class="comment">//创建共享资源</span></span><br><span class="line">		<span class="comment">//Sequence seq = new SequenceImpl();</span></span><br><span class="line">		Sequence seq = <span class="keyword">new</span> SequenceImpl2();</span><br><span class="line">		<span class="comment">//创建线程</span></span><br><span class="line">		MyTread t = <span class="keyword">new</span> MyTread(seq);</span><br><span class="line">		<span class="comment">//开启线程</span></span><br><span class="line">		<span class="keyword">new</span> Thread(t,<span class="string">"A"</span>).start();</span><br><span class="line">		<span class="keyword">new</span> Thread(t,<span class="string">"B"</span>).start();</span><br><span class="line">		<span class="keyword">new</span> Thread(t,<span class="string">"C"</span>).start();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*每次运行结果的次序都是不一样的</span></span><br><span class="line"><span class="comment">    B---&gt;number= 1</span></span><br><span class="line"><span class="comment">    C---&gt;number= 1</span></span><br><span class="line"><span class="comment">    A---&gt;number= 1</span></span><br><span class="line"><span class="comment">    C---&gt;number= 2</span></span><br><span class="line"><span class="comment">    B---&gt;number= 2</span></span><br><span class="line"><span class="comment">    C---&gt;number= 3</span></span><br><span class="line"><span class="comment">    A---&gt;number= 2</span></span><br><span class="line"><span class="comment">    B---&gt;number= 3</span></span><br><span class="line"><span class="comment">    A---&gt;number= 3</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>

<h4 id="6-3-ThreadLocakJDK-源码分析"><a href="#6-3-ThreadLocakJDK-源码分析" class="headerlink" title="6.3 ThreadLocakJDK 源码分析"></a>6.3 <code>ThreadLocak</code>JDK 源码分析</h4><p>通过集合的方式，添加线程对象到 map集合中</p>
<p><img src="C:%5CUsers%5CLenovo%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1542633774883.png" alt="1542633774883"></p>
<p><img src="C:%5CUsers%5CLenovo%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1542633869679.png" alt="1542633869679"></p>
<h4 id="6-4-ThreadLocal-的-API"><a href="#6-4-ThreadLocal-的-API" class="headerlink" title="6.4 ThreadLocal 的 API"></a>6.4 <code>ThreadLocal</code> 的 API</h4><p><img src="C:%5CUsers%5CLenovo%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1542629233167.png" alt="1542629233167"></p>
<p>#### </p>
<h3 id="7-ThreadLocal-的应用"><a href="#7-ThreadLocal-的应用" class="headerlink" title="7 ThreadLocal 的应用"></a>7 <code>ThreadLocal</code> 的应用</h3><p><code>ThreadLocal</code> 的使用场景为:用来解决数据库连接、Session管理等</p>
<h4 id="7-1ThreadLocal在数据库连接上的应用"><a href="#7-1ThreadLocal在数据库连接上的应用" class="headerlink" title="7.1ThreadLocal在数据库连接上的应用"></a>7.1ThreadLocal在数据库连接上的应用</h4><p>当你在一个类中使用 static 成员变量时，一定要问自己这个 static 成员变量</p>
<p>需要考虑“线程安全吗？”（也就是说多个线程需要自己独立的 static 成员变量吗？）</p>
<p>如果需要那就需要使用<code>ThreadLocal</code></p>
<p><img src="C:%5CUsers%5CLenovo%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1542632141376.png" alt="1542632141376"></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.szxy.TestThreadLocal2.DBUtil;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.sql.Connection;</span><br><span class="line"><span class="keyword">import</span> java.sql.DriverManager;</span><br><span class="line"><span class="keyword">import</span> java.sql.SQLException;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 数据库连接</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> wzer</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DBUtil</span> </span>&#123;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String DRIVER=<span class="string">"com.mysql.jdbc.Driver"</span>;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String	USER=<span class="string">"root"</span>;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String PWD=<span class="string">"root"</span>;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String URL=<span class="string">"jdbc:mysql://localhost:3306/test?useUnicode=true&amp;characterEncoding=utf8"</span>;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//定义一个数据库连接</span></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> Connection conn=<span class="keyword">null</span>;</span><br><span class="line">	<span class="comment">//获取连接</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span>   <span class="keyword">static</span> Connection <span class="title">getConnection</span><span class="params">()</span></span>&#123;</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			Class.forName(DRIVER);</span><br><span class="line">			</span><br><span class="line">			<span class="keyword">if</span>(conn==<span class="keyword">null</span>)&#123;</span><br><span class="line">				</span><br><span class="line">				conn=DriverManager.getConnection(URL, USER, PWD);</span><br><span class="line">			&#125;</span><br><span class="line">			</span><br><span class="line">		&#125; <span class="keyword">catch</span> (ClassNotFoundException e) &#123;</span><br><span class="line">			<span class="comment">// TODO Auto-generated catch block</span></span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">			<span class="comment">// TODO Auto-generated catch block</span></span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125; </span><br><span class="line">		<span class="keyword">return</span> conn;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">//关闭连接的方法</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span>   <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">colseConnection</span><span class="params">()</span></span>&#123;</span><br><span class="line">		<span class="keyword">if</span> (conn!=<span class="keyword">null</span>) &#123;</span><br><span class="line">			<span class="keyword">try</span> &#123;</span><br><span class="line">				conn.close();</span><br><span class="line">			</span><br><span class="line">			&#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">				<span class="comment">// TODO Auto-generated catch block</span></span><br><span class="line">				e.printStackTrace();</span><br><span class="line">			&#125;</span><br><span class="line">			</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		System.out.println(getConnection());</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.szxy.TestThreadLocal2.DBUtil;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.sql.Connection;</span><br><span class="line"><span class="keyword">import</span> java.sql.DriverManager;</span><br><span class="line"><span class="keyword">import</span> java.sql.SQLException;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 数据库连接</span></span><br><span class="line"><span class="comment"> * 去掉类中的 static 关键字</span></span><br><span class="line"><span class="comment"> * 即去掉 Connection 对象共享</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> wzer</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DBUtil2</span> </span>&#123;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String DRIVER=<span class="string">"com.mysql.jdbc.Driver"</span>;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String	USER=<span class="string">"root"</span>;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String PWD=<span class="string">"root"</span>;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String URL=<span class="string">"jdbc:mysql://localhost:3306/test?useUnicode=true&amp;characterEncoding=utf8"</span>;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//定义一个数据库连接    static 共享本类的资源  不需要</span></span><br><span class="line">	<span class="keyword">private</span> Connection conn=<span class="keyword">null</span>;</span><br><span class="line">	<span class="comment">//获取连接</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span>  Connection <span class="title">getConnection</span><span class="params">()</span></span>&#123;</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			Class.forName(DRIVER);</span><br><span class="line">			</span><br><span class="line">			<span class="keyword">if</span>(conn==<span class="keyword">null</span>)&#123;</span><br><span class="line">				</span><br><span class="line">				conn=DriverManager.getConnection(URL, USER, PWD);</span><br><span class="line">			&#125;</span><br><span class="line">			</span><br><span class="line">		&#125; <span class="keyword">catch</span> (ClassNotFoundException e) &#123;</span><br><span class="line">			<span class="comment">// TODO Auto-generated catch block</span></span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">			<span class="comment">// TODO Auto-generated catch block</span></span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125; </span><br><span class="line">		<span class="keyword">return</span> conn;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">//关闭连接的方法</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span>  <span class="keyword">void</span> <span class="title">colseConnection</span><span class="params">()</span></span>&#123;</span><br><span class="line">		<span class="keyword">if</span> (conn!=<span class="keyword">null</span>) &#123;</span><br><span class="line">			<span class="keyword">try</span> &#123;</span><br><span class="line">				conn.close();</span><br><span class="line">			</span><br><span class="line">			&#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">				<span class="comment">// TODO Auto-generated catch block</span></span><br><span class="line">				e.printStackTrace();</span><br><span class="line">			&#125;</span><br><span class="line">			</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		<span class="comment">//System.out.println(getConnection());</span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.szxy.TestThreadLocal2.DBUtil;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.sql.Connection;</span><br><span class="line"><span class="keyword">import</span> java.sql.DriverManager;</span><br><span class="line"><span class="keyword">import</span> java.sql.SQLException;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 使用 Threadlocal </span></span><br><span class="line"><span class="comment"> * 让每个用户即每个线程都自己一个连接的副本</span></span><br><span class="line"><span class="comment"> * 根据这个连接的副本，每个线程可以进行增删改查</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> wzer</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DBUtil3</span> </span>&#123;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String DRIVER=<span class="string">"com.mysql.jdbc.Driver"</span>;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String	USER=<span class="string">"root"</span>;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String PWD=<span class="string">"root"</span>;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String URL=<span class="string">"jdbc:mysql://localhost:3306/test?useUnicode=true&amp;characterEncoding=utf8"</span>;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> ThreadLocal&lt;Connection&gt; connectionContainer = <span class="keyword">new</span> ThreadLocal&lt;Connection&gt;()&#123;</span><br><span class="line">		<span class="function"><span class="keyword">protected</span> Connection <span class="title">initialValue</span><span class="params">()</span> </span>&#123;</span><br><span class="line">			<span class="keyword">try</span> &#123;</span><br><span class="line">				Class.forName(DRIVER);</span><br><span class="line">				</span><br><span class="line">				<span class="keyword">if</span>(conn==<span class="keyword">null</span>)&#123;</span><br><span class="line">					</span><br><span class="line">					conn=DriverManager.getConnection(URL, USER, PWD);</span><br><span class="line">				&#125;</span><br><span class="line">				</span><br><span class="line">			&#125; <span class="keyword">catch</span> (ClassNotFoundException e) &#123;</span><br><span class="line">				<span class="comment">// TODO Auto-generated catch block</span></span><br><span class="line">				e.printStackTrace();</span><br><span class="line">			&#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">				<span class="comment">// TODO Auto-generated catch block</span></span><br><span class="line">				e.printStackTrace();</span><br><span class="line">			&#125; </span><br><span class="line">			<span class="keyword">return</span> conn;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="function"><span class="keyword">public</span> Connection <span class="title">getConnectionContainer</span><span class="params">()</span></span>&#123;</span><br><span class="line">			<span class="keyword">return</span> connectionContainer.get();<span class="comment">//获得连接的副本</span></span><br><span class="line">		&#125;</span><br><span class="line">	&#125;;</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//定义一个数据库连接</span></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> Connection conn=<span class="keyword">null</span>;</span><br><span class="line">	<span class="comment">//获取连接</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span>   <span class="keyword">static</span> Connection <span class="title">getConnection</span><span class="params">()</span></span>&#123;</span><br><span class="line">		<span class="keyword">return</span> connectionContainer.get();</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">//关闭连接的方法</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span>   <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">colseConnection</span><span class="params">()</span></span>&#123;</span><br><span class="line">		<span class="keyword">if</span> (conn!=<span class="keyword">null</span>) &#123;</span><br><span class="line">			<span class="keyword">try</span> &#123;</span><br><span class="line">				conn.close();</span><br><span class="line">			</span><br><span class="line">			&#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">				<span class="comment">// TODO Auto-generated catch block</span></span><br><span class="line">				e.printStackTrace();</span><br><span class="line">			&#125;</span><br><span class="line">			</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		System.out.println(getConnection());</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.szxy.TestThreadLocal2.DBUtil;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.mysql.jdbc.Connection;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 调用 数据连接</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> wzer</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Dao</span></span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">insert</span><span class="params">()</span></span>&#123;</span><br><span class="line">		<span class="comment">//连接数据</span></span><br><span class="line">		<span class="comment">//System.out.println(Thread.currentThread().getName()+" insert() "+DBUtil.getConnection());</span></span><br><span class="line">		<span class="comment">/*Connection con = (Connection) new DBUtil2().getConnection();</span></span><br><span class="line"><span class="comment">		System.out.println(Thread.currentThread().getName()+" issert() "+con);*/</span></span><br><span class="line">		Connection con = (Connection) <span class="keyword">new</span> DBUtil3().getConnection();</span><br><span class="line">		System.out.println(Thread.currentThread().getName()+<span class="string">" issert() "</span>+con);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">delete</span><span class="params">()</span></span>&#123;</span><br><span class="line">		<span class="comment">//连接数据</span></span><br><span class="line">		<span class="comment">//System.out.println(Thread.currentThread().getName()+" delete() "+DBUtil.getConnection());</span></span><br><span class="line">		<span class="comment">/*Connection con = (Connection) new DBUtil2().getConnection();</span></span><br><span class="line"><span class="comment">		System.out.println(Thread.currentThread().getName()+" delete() "+con);*/</span></span><br><span class="line">		Connection con = (Connection) <span class="keyword">new</span> DBUtil3().getConnection();</span><br><span class="line">		System.out.println(Thread.currentThread().getName()+<span class="string">" delete() "</span>+con);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span>  <span class="keyword">void</span> <span class="title">update</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="comment">// TODO 自动生成的方法存根</span></span><br><span class="line">		<span class="comment">//连接数据</span></span><br><span class="line">		<span class="comment">//System.out.println(Thread.currentThread().getName()+" update() "+DBUtil.getConnection());</span></span><br><span class="line">		<span class="comment">/*Connection con = (Connection) new DBUtil2().getConnection();</span></span><br><span class="line"><span class="comment">		System.out.println(Thread.currentThread().getName()+" update() "+con);*/</span></span><br><span class="line">		Connection con = (Connection) <span class="keyword">new</span> DBUtil3().getConnection();</span><br><span class="line">		System.out.println(Thread.currentThread().getName()+<span class="string">" update() "</span>+con);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">select</span><span class="params">()</span></span>&#123;</span><br><span class="line">		<span class="comment">//连接数据</span></span><br><span class="line">		<span class="comment">//System.out.println(Thread.currentThread().getName()+" select() "+DBUtil.getConnection());</span></span><br><span class="line">		<span class="comment">/*Connection con = (Connection) new DBUtil2().getConnection();</span></span><br><span class="line"><span class="comment">		System.out.println(Thread.currentThread().getName()+" select() "+con);*/</span></span><br><span class="line">		Connection con = (Connection) <span class="keyword">new</span> DBUtil3().getConnection();</span><br><span class="line">		System.out.println(Thread.currentThread().getName()+<span class="string">" select() "</span>+con);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.szxy.TestThreadLocal2.DBUtil;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 测试类</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> wzer</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		MyThread  t = <span class="keyword">new</span> MyThread();</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">new</span> Thread(t,<span class="string">"A"</span>).start();</span><br><span class="line">		<span class="keyword">new</span> Thread(t,<span class="string">"B"</span>).start();</span><br><span class="line">		<span class="keyword">new</span> Thread(t,<span class="string">"C"</span>).start();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyThread</span> <span class="keyword">implements</span> <span class="title">Runnable</span></span>&#123;</span><br><span class="line">	Dao d = <span class="keyword">new</span> Dao();<span class="comment">//数据连接操作</span></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="comment">// TODO 自动生成的方法存根</span></span><br><span class="line">			d.insert();</span><br><span class="line">			d.delete();</span><br><span class="line">			d.update();</span><br><span class="line">			d.select();</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*  为每个用户也就每个线程只分配一个数据库连接对象供增删改查的方法</span></span><br><span class="line"><span class="comment">	A issert() com.mysql.jdbc.JDBC4Connection@1b84a4d5</span></span><br><span class="line"><span class="comment">    A delete() com.mysql.jdbc.JDBC4Connection@1b84a4d5</span></span><br><span class="line"><span class="comment">    A update() com.mysql.jdbc.JDBC4Connection@1b84a4d5</span></span><br><span class="line"><span class="comment">    A select() com.mysql.jdbc.JDBC4Connection@1b84a4d5</span></span><br><span class="line"><span class="comment">    C issert() com.mysql.jdbc.JDBC4Connection@1b84a4d5</span></span><br><span class="line"><span class="comment">    C delete() com.mysql.jdbc.JDBC4Connection@1b84a4d5</span></span><br><span class="line"><span class="comment">    C update() com.mysql.jdbc.JDBC4Connection@1b84a4d5</span></span><br><span class="line"><span class="comment">    C select() com.mysql.jdbc.JDBC4Connection@1b84a4d5</span></span><br><span class="line"><span class="comment">    B issert() com.mysql.jdbc.JDBC4Connection@781b849a</span></span><br><span class="line"><span class="comment">    B delete() com.mysql.jdbc.JDBC4Connection@781b849a</span></span><br><span class="line"><span class="comment">    B update() com.mysql.jdbc.JDBC4Connection@781b849a</span></span><br><span class="line"><span class="comment">    B select() com.mysql.jdbc.JDBC4Connection@781b849a</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>

<h4 id="7-2-总结"><a href="#7-2-总结" class="headerlink" title="7.2 总结"></a>7.2 总结</h4><p>通过 <code>ThreadLocal</code> 可以实现数据库，为每个用户也就每个线程</p>
<p>只分配一个数据库连接对象 供增删改查的方法</p>

        
      
    </div>

    
    
    
      <footer class="post-footer">
          <div class="post-eof"></div>
        
      </footer>
  </div>
  
  
  
  </article>

    
        <article itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block home">
    <link itemprop="mainEntityOfPage" href="http://zwer.xyz/2018/11/16/Java/20181116 XML 技术/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="zwer">
      <meta itemprop="description" content="记录学习的日常">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="zwer 的博客空间">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
            
            <a href="/2018/11/16/Java/20181116 XML 技术/" class="post-title-link" itemprop="url">20181116 XML 技术</a>
          
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              
                
              

              <time title="Created: 2018-11-16 19:00:00" itemprop="dateCreated datePublished" datetime="2018-11-16T19:00:00+08:00">2018-11-16</time>
            </span>
          
            

            
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2018-11-17 11:36:42" itemprop="dateModified" datetime="2018-11-17T11:36:42+08:00">2018-11-17</time>
              </span>
            
          
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Java/" itemprop="url" rel="index"><span itemprop="name">Java</span></a></span>

                
                
                  , 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Java/XML/" itemprop="url" rel="index"><span itemprop="name">XML</span></a></span>

                
                
              
            </span>
          

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h4 id="1-XML-的概念"><a href="#1-XML-的概念" class="headerlink" title="1 XML 的概念"></a>1 XML 的概念</h4><h5 id="1-1-XML-概念"><a href="#1-1-XML-概念" class="headerlink" title="1.1 XML 概念"></a>1.1 XML 概念</h5><p>XML 指可扩展标记语言</p>
<p>XML 没有预定义标签，需要自行定义标签</p>
<h5 id="1-2-XML-的特点"><a href="#1-2-XML-的特点" class="headerlink" title="1.2 XML 的特点"></a>1.2 XML 的特点</h5><p>XML 数据以 纯文本格式存储</p>
<p>实现不同应用程序之间的数据通信</p>
<p>实现不同平台间的数据通信</p>
<p>实现不同平台间的数据共享</p>
<p>使用 XML将不同的程序、不同的平台之间联系起来</p>
<h5 id="1-3-XML-的作用"><a href="#1-3-XML-的作用" class="headerlink" title="1.3 XML 的作用"></a>1.3 XML 的作用</h5><p>数据存储和数据传输</p>
<h5 id="1-4-XML-和-HTML"><a href="#1-4-XML-和-HTML" class="headerlink" title="1.4 XML 和 HTML"></a>1.4 XML 和 HTML</h5><p>XML 主要作用是数据存储和传输（传输）</p>
<p>HTML 主要作用是用来显示数据（显示）</p>
<h5 id="1-5-一个标准的-XML-文档"><a href="#1-5-一个标准的-XML-文档" class="headerlink" title="1.5 一个标准的 XML 文档"></a>1.5 一个标准的 XML 文档</h5><p><img src="C:%5CUsers%5CLenovo%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1542367851625.png" alt="1542367851625"></p>
<p><img src="C:%5CUsers%5CLenovo%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1542367864692.png" alt="1542367864692"></p>
<h5 id="1-6-XML-文件的体系"><a href="#1-6-XML-文件的体系" class="headerlink" title="1.6 XML 文件的体系"></a>1.6 XML 文件的体系</h5><p>1 XHTML 可扩展标识语言</p>
<p>2 WSDL Web Services Description Language 网络服务描述语言,这种文档可描述某个 Web service</p>
<p>3  WAP 和 WML 手持设备的标记语言</p>
<p>4  RSS（ 广 泛 用 于 网 上 新 闻 频 道 ） ： Really SimpleSyndication 简易信息聚合，使用 RSS 订阅能更快地获取信息，网站提供 RSS 输出，有利于让用户获取网站内容的最新更新</p>
<p>5  RDF 和 OWL: 重要的语义网技术语义网是为资产管理、企业整合及网络数据的共享和重用提供的一个框架。</p>
<p>6  SMIL 同步多媒体集成语言,它是由万维网联盟规定的多媒体操纵语言。最新的 SMIL 版本是 2001 年 8 月推出的SMIL 2.0 版本,它通过时序排列对声音、影像、文字及图形文件进行顺序安排,然后将这些媒体表现看起来是同步</p>
<h4 id="2-XML-基本语法"><a href="#2-XML-基本语法" class="headerlink" title="2  XML 基本语法"></a>2  XML 基本语法</h4><h5 id="2-1-XML-基本语法"><a href="#2-1-XML-基本语法" class="headerlink" title="2.1 XML 基本语法"></a>2.1 XML 基本语法</h5><p>1) 有且只有一个根元素<br>2) XML 文档声明必须放在文档的第一行<br>3) 所有标签必须成对出现<br>4) XML 的标签严格区分大小写<br>5) XML 必须正确嵌套<br>6) XML 中的属性值必须加引号<br>7) XML 中，一些特殊字符需要使用“实体”<br>8) XML 中可以应用适当的注释</p>
<h5 id="2-2XML-元素"><a href="#2-2XML-元素" class="headerlink" title="2.2XML 元素"></a>2.2XML 元素</h5><p> XML 元素指的是开始标签到结束标签的部分<br>一个元素中可以包含<br>1) 其他元素<br>2) 文本<br>3) 属性<br>4) 以上的混合</p>
<h5 id="2-3XML-命名规则"><a href="#2-3XML-命名规则" class="headerlink" title="2.3XML 命名规则"></a>2.3XML 命名规则</h5><p>1) 名称可以包含字母、数字及其他字符<br>2) 名称不能以<strong>数字或者标点符号开始</strong><br>3) 名称不能以字母 xml 开始<br>4) 名称不能包含空格</p>
<h4 id="3-Schema"><a href="#3-Schema" class="headerlink" title="3  Schema"></a>3  Schema</h4><h5 id="3-1-Schema-概念"><a href="#3-1-Schema-概念" class="headerlink" title="3.1 Schema 概念"></a>3.1 Schema 概念</h5><p>DTD 文档类型定义作用：验证是否是“有效”的 XMLPCDATA(Parsed Character DATA)的意思是被解析的字符数据CDATA（Unparsed Character Data）不应由 XML 解析器进行解析的文本数使用 DTD 的局限性</p>
<p>1) DTD 不遵守 XML 语法</p>
<p>2) DTD 数据类型有限</p>
<p>3) DTD 不可扩展</p>
<p>4) DTD 不支持命名空间</p>
<h5 id="3-2Schema-技术"><a href="#3-2Schema-技术" class="headerlink" title="3.2Schema 技术"></a>3.2Schema 技术</h5><p>Schema 是 DTD 的代替者，名称为 XML Schema，用于描述XML 文档结构，比 DTD 更加强大，最主要的特征之一就是XML Schema 支持数据类型</p>
<p>1) Schema 是用 XML 验证 XML 遵循 XML 的语法</p>
<p>2) Schema 可以用能处理 XML 文档的工具处理</p>
<p>3) Schema 大大扩充了数据类型，而且还可以自定义数据类型</p>
<p>4) Schema 支持元素的继承</p>
<p>) Schema 支持属性组3.3Schema 的文档结构所有的 Schema 文档使用 schema 作为其根元素<a href="http://www.w3.org/2001/XMLSchema:用于验证当前" target="_blank" rel="noopener">http://www.w3.org/2001/XMLSchema:用于验证当前</a> Schema文档的命名空间(用于验证Schema本身)同时它还规定了来自命名空间 <a href="http://www.w3.org/2001/XMLSchema" target="_blank" rel="noopener">http://www.w3.org/2001/XMLSchema</a> 的元素和数据类型应该使用前缀 <code>xs:xmlns</code>相当于 java 中的 import, :<code>xs</code>“小名”,在使用时要写加“小名”做前缀（XML 使用 Schema 验证,那 Schema 也是一个 XML，谁来验证它？DTD）</p>
<h5 id="3-3-使用-Schema-验证-XML-文档"><a href="#3-3-使用-Schema-验证-XML-文档" class="headerlink" title="3.3 使用 Schema 验证 XML 文档"></a>3.3 使用 Schema 验证 XML 文档</h5><p>1) 创建 <code>SchemaFactory</code>工厂</p>
<p>2) 建立验证文件对象</p>
<p>3) 利用 <code>SchemaFactory</code>工厂对象，接收验证的文件对象，生成 Schema 对象</p>
<p>4) 产生对此 schema 的验证器</p>
<p>5) 要验证的数据（准备数据源）</p>
<p>6) 开始</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.szxy;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.File;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.xml.transform.Source;</span><br><span class="line"><span class="keyword">import</span> javax.xml.transform.stream.StreamSource;</span><br><span class="line"><span class="keyword">import</span> javax.xml.validation.Schema;</span><br><span class="line"><span class="keyword">import</span> javax.xml.validation.SchemaFactory;</span><br><span class="line"><span class="keyword">import</span> javax.xml.validation.Validator;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.xml.sax.SAXException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> SAXException </span>&#123;</span><br><span class="line">		<span class="comment">// 1 创建Scheme 工厂</span></span><br><span class="line">		SchemaFactory sch = SchemaFactory.newInstance(<span class="string">"http://www.w3.org/2001/XMLSchema"</span>);</span><br><span class="line">		<span class="comment">// 2 建立验证文件</span></span><br><span class="line">		File  schemafile  = <span class="keyword">new</span> File(<span class="string">"book.xsd"</span>);</span><br><span class="line">		<span class="comment">// 3 利用SchemaFactory对象，接收	验证的文件对象，生成Scheme对象</span></span><br><span class="line">		Schema schema = sch.newSchema(schemafile);</span><br><span class="line">		<span class="comment">// 4 产生Schema 验证器</span></span><br><span class="line">		Validator validator = schema.newValidator();</span><br><span class="line">		<span class="comment">//5 要验证的数据源</span></span><br><span class="line">		Source  source = <span class="keyword">new</span> StreamSource(<span class="string">"book.xml"</span>);</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			validator.validate(source);</span><br><span class="line">			System.out.println(<span class="string">"验证成功"</span>);</span><br><span class="line">		&#125; <span class="keyword">catch</span> (SAXException e) &#123;</span><br><span class="line">			<span class="comment">// TODO 自动生成的 catch 块</span></span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">			<span class="comment">// TODO 自动生成的 catch 块</span></span><br><span class="line">			e.printStackTrace();</span><br><span class="line">			System.out.println(<span class="string">"失败"</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--  &lt;!DOCTYPE books [</span></span><br><span class="line"><span class="comment">	&lt;!ELEMENT books (book*)&gt;</span></span><br><span class="line"><span class="comment">	&lt;!ELEMENT book (name,author,price)&gt;</span></span><br><span class="line"><span class="comment">	&lt;!ELEMENT name (#PCDATA)&gt;</span></span><br><span class="line"><span class="comment">	&lt;!ELEMENT author (#PCDATA)&gt;</span></span><br><span class="line"><span class="comment">	&lt;!ELEMENT price (#PCDATA)&gt;</span></span><br><span class="line"><span class="comment">	&lt;!ATTLIST book id CDATA #REQUIRED&gt;</span></span><br><span class="line"><span class="comment">]&gt;--&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">books</span> <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag"> <span class="attr">xsi:noNamespaceSchemaLocation</span>=<span class="string">"&#123;book.xsd&#125;"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">book</span> <span class="attr">id</span>=<span class="string">"1"</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">name</span>&gt;</span>Java<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">author</span>&gt;</span>Tom<span class="tag">&lt;/<span class="name">author</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">price</span>&gt;</span>34.23<span class="tag">&lt;/<span class="name">price</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">book</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">book</span> <span class="attr">id</span>=<span class="string">"2"</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">name</span>&gt;</span>Java2<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">author</span>&gt;</span>Tom2<span class="tag">&lt;/<span class="name">author</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">price</span>&gt;</span>34.231<span class="tag">&lt;/<span class="name">price</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">book</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">book</span> <span class="attr">id</span>=<span class="string">"3"</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">name</span>&gt;</span>Java1<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">author</span>&gt;</span>Tom1<span class="tag">&lt;/<span class="name">author</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">price</span>&gt;</span>34.231<span class="tag">&lt;/<span class="name">price</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">book</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">books</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">xs:schema</span> <span class="attr">xmlns:xs</span>=<span class="string">"http://www.w3.org/2001/XMLSchema"</span> &gt;</span><span class="comment">&lt;!-- xs是xmlns的小名--&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">xs:element</span> <span class="attr">name</span>=<span class="string">"books"</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">xs:complexType</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">xs:sequence</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">xs:element</span> <span class="attr">name</span>=<span class="string">"book"</span> <span class="attr">maxOccurs</span>=<span class="string">"unbounded"</span>&gt;</span></span><br><span class="line">					<span class="tag">&lt;<span class="name">xs:complexType</span>&gt;</span></span><br><span class="line">						<span class="tag">&lt;<span class="name">xs:sequence</span>&gt;</span></span><br><span class="line">							<span class="tag">&lt;<span class="name">xs:element</span> <span class="attr">name</span>=<span class="string">"name"</span> <span class="attr">type</span>=<span class="string">"xs:string"</span>&gt;</span><span class="tag">&lt;/<span class="name">xs:element</span>&gt;</span></span><br><span class="line">							<span class="tag">&lt;<span class="name">xs:element</span> <span class="attr">name</span>=<span class="string">"author"</span> <span class="attr">type</span>=<span class="string">"xs:string"</span>&gt;</span><span class="tag">&lt;/<span class="name">xs:element</span>&gt;</span></span><br><span class="line">							<span class="tag">&lt;<span class="name">xs:element</span> <span class="attr">name</span>=<span class="string">"price"</span> <span class="attr">type</span>=<span class="string">"xs:double"</span>&gt;</span><span class="tag">&lt;/<span class="name">xs:element</span>&gt;</span></span><br><span class="line">						<span class="tag">&lt;/<span class="name">xs:sequence</span>&gt;</span></span><br><span class="line">						<span class="tag">&lt;<span class="name">xs:attribute</span> <span class="attr">name</span>=<span class="string">"id"</span> <span class="attr">type</span>=<span class="string">"xs:positiveInteger"</span> <span class="attr">use</span>=<span class="string">"required"</span>&gt;</span><span class="tag">&lt;/<span class="name">xs:attribute</span>&gt;</span></span><br><span class="line">					<span class="tag">&lt;/<span class="name">xs:complexType</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;/<span class="name">xs:element</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;/<span class="name">xs:sequence</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">xs:complexType</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">xs:element</span>&gt;</span>	 </span><br><span class="line"><span class="tag">&lt;/<span class="name">xs:schema</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="4-DOM-方法解析-XML-数据"><a href="#4-DOM-方法解析-XML-数据" class="headerlink" title="4 DOM 方法解析 XML 数据"></a>4 DOM 方法解析 XML 数据</h4><p>在 Java 程序中读取 XML 文件的过程称为解析 XML</p>
<h5 id="4-1-解析-XML-文件的方式"><a href="#4-1-解析-XML-文件的方式" class="headerlink" title="4.1 解析 XML 文件的方式"></a>4.1 解析 XML 文件的方式</h5><p>1) DOM 解析 (java 官方提供)</p>
<p>2) SAX 解析(java 官方提供)</p>
<p>3) JDOM 解析(第三方提供)</p>
<p>4) DOM4J 解析(第三方提供)</p>
<h5 id="4-2-DOM-解析-XML-的步骤"><a href="#4-2-DOM-解析-XML-的步骤" class="headerlink" title="4.2 DOM 解析 XML 的步骤"></a>4.2 DOM 解析 XML 的步骤</h5><p>1) 创建一个<code>DocumentBuilderFactory</code> 的对象</p>
<p>2) 创建一个<code>DocumentBuilder</code>对象</p>
<p>3) 通过<code>DocumentBuilder</code>的parse(…)方法得到Document对象</p>
<p>4) 通过 <code>getElementsByTagName(...)</code>方法获取到节点的列表</p>
<p>5) 通过 for 循环遍历每一个节点 </p>
<p>6) 得到每个节点的属性和属性值</p>
<p>7) 得到每个节点的节点名和节点值</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.szxy.DOM;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Collection;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.xml.parsers.DocumentBuilder;</span><br><span class="line"><span class="keyword">import</span> javax.xml.parsers.DocumentBuilderFactory;</span><br><span class="line"><span class="keyword">import</span> javax.xml.parsers.ParserConfigurationException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.w3c.dom.Document;</span><br><span class="line"><span class="keyword">import</span> org.w3c.dom.NamedNodeMap;</span><br><span class="line"><span class="keyword">import</span> org.w3c.dom.Node;</span><br><span class="line"><span class="keyword">import</span> org.w3c.dom.NodeList;</span><br><span class="line"><span class="keyword">import</span> org.xml.sax.SAXException;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 通过DOM方式 解析 book.xml文档</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> wzer</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestDOM</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> ParserConfigurationException, SAXException, IOException </span>&#123;</span><br><span class="line">		<span class="comment">//1) 创建一个DocumentBuilderFactory 的对象</span></span><br><span class="line">			DocumentBuilderFactory dbf = DocumentBuilderFactory.newInstance();</span><br><span class="line">		<span class="comment">//2) 创建一个 DocumentBuilder对象</span></span><br><span class="line">			DocumentBuilder db = dbf.newDocumentBuilder();</span><br><span class="line">		<span class="comment">//3) 通过DocumentBuilder的parse(...)方法得到Document对象</span></span><br><span class="line">			Document document = db.parse(<span class="string">"book.xml"</span>);</span><br><span class="line">		<span class="comment">//4) 通过 getElementsByTagName(...)方法获取到节点的列表</span></span><br><span class="line">			NodeList bookList = document.getElementsByTagName(<span class="string">"book"</span>);</span><br><span class="line">			</span><br><span class="line">		<span class="comment">//5) 通过 for 循环遍历每一个节点 </span></span><br><span class="line">			<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;bookList.getLength();i++)&#123;</span><br><span class="line">				Node book = bookList.item(i);</span><br><span class="line">				NamedNodeMap attr = book.getAttributes();</span><br><span class="line">				<span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;attr.getLength();j++)&#123;</span><br><span class="line">					Node id = attr.item(j);</span><br><span class="line">					System.out.println(<span class="string">"属性的名称"</span>+id.getNodeName()+<span class="string">"\t属性的值"</span>+id.getNodeValue());</span><br><span class="line">				&#125;</span><br><span class="line">				</span><br><span class="line">			&#125;</span><br><span class="line">		<span class="comment">//6) 得到每个节点的属性和属性值</span></span><br><span class="line">			System.out.println(<span class="string">"得到每个节点的属性和属性值"</span>);</span><br><span class="line">			<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;bookList.getLength();i++)&#123;</span><br><span class="line">				Node book = bookList.item(i);</span><br><span class="line">				NodeList subNode = book.getChildNodes();</span><br><span class="line">				<span class="comment">//7) 得到每个节点的节点名和节点值</span></span><br><span class="line">				<span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;subNode.getLength();j++)&#123;</span><br><span class="line">					Node childNode = subNode.item(j);</span><br><span class="line">					<span class="comment">//System.out.println(childNode.getNodeName());</span></span><br><span class="line">					<span class="keyword">short</span> type = childNode.getNodeType();</span><br><span class="line">					<span class="keyword">if</span>(type==Node.ELEMENT_NODE)&#123;</span><br><span class="line">						System.out.println(<span class="string">"节点的名称:"</span>+childNode.getNodeName()+<span class="string">"\t"</span>+childNode.getTextContent());</span><br><span class="line">					&#125;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="总结："><a href="#总结：" class="headerlink" title="总结："></a>总结：</h5><p>1 Document类 导入的是  <code>import org.w3c.dom.Document;</code></p>
<p>2 理清节点与子节点的关系 </p>
<p>3 节点的计算方式 (空文本也属于节点，遍历if判断需要去掉)</p>
<h4 id="5-SAX-方式解析XML-数据"><a href="#5-SAX-方式解析XML-数据" class="headerlink" title="5 SAX 方式解析XML 数据"></a>5 SAX 方式解析XML 数据</h4><h5 id="5-1-SAX-的概述"><a href="#5-1-SAX-的概述" class="headerlink" title="5.1 SAX 的概述"></a>5.1 SAX 的概述</h5><p>SAX，全称 Simple API for XML，是一种以事件驱动的<br>XMl API,SAX 与 DOM 不同的是它<strong>边扫描边解析</strong>，自顶向下<br>依次解析，由于边扫描边解析，所以它解析 XML 具有速度<br>快，占用内存少的优点</p>
<h5 id="5-2-SAX-解析-XML-的步骤"><a href="#5-2-SAX-解析-XML-的步骤" class="headerlink" title="5.2 SAX 解析 XML 的步骤"></a>5.2 SAX 解析 XML 的步骤</h5><p>1) 创建 SAXParserFactory 的对象<br>2) 创建 SAXParser 对象 (解析器)<br>3) 创建一个 DefaultHandler 的子类<br>4) 调用 parse 方法</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.szxy.sax;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.xml.parsers.ParserConfigurationException;</span><br><span class="line"><span class="keyword">import</span> javax.xml.parsers.SAXParser;</span><br><span class="line"><span class="keyword">import</span> javax.xml.parsers.SAXParserFactory;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.xml.sax.SAXException;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * SAX 解析 XML</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> wzer</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestSAX</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> ParserConfigurationException, SAXException, IOException </span>&#123;</span><br><span class="line">		<span class="comment">//1) 创建 SAXParserFactory 的对象</span></span><br><span class="line">		SAXParserFactory sax = SAXParserFactory.newInstance();</span><br><span class="line">		<span class="comment">//2) 创建 SAXParser 对象 (解析器)</span></span><br><span class="line">		SAXParser parser = sax.newSAXParser();</span><br><span class="line">		<span class="comment">//3) 创建一个 DefaultHandler 的子类</span></span><br><span class="line">		BookDefaultHandler dh = <span class="keyword">new</span> BookDefaultHandler();</span><br><span class="line">		<span class="comment">//4) 调用 parse 方法</span></span><br><span class="line">		parser.parse(<span class="string">"book.xml"</span>, dh);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.szxy.sax;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.xml.sax.Attributes;</span><br><span class="line"><span class="keyword">import</span> org.xml.sax.SAXException;</span><br><span class="line"><span class="keyword">import</span> org.xml.sax.helpers.DefaultHandler;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 创建一个 DefaultHandler 的子类</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> wzer</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BookDefaultHandler</span> <span class="keyword">extends</span> <span class="title">DefaultHandler</span> </span>&#123;</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">startDocument</span><span class="params">()</span> <span class="keyword">throws</span> SAXException </span>&#123;</span><br><span class="line">		<span class="comment">// TODO 自动生成的方法存根</span></span><br><span class="line">		<span class="keyword">super</span>.startDocument();</span><br><span class="line">		System.out.println(<span class="string">"XML 解析开始"</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">endDocument</span><span class="params">()</span> <span class="keyword">throws</span> SAXException </span>&#123;</span><br><span class="line">		<span class="comment">// TODO 自动生成的方法存根</span></span><br><span class="line">		<span class="keyword">super</span>.endDocument();</span><br><span class="line">		System.out.println(<span class="string">"XML 文档解析结束"</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">/**解析xml文档中的节点结束开始*/</span></span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">startElement</span><span class="params">(String uri, String localName, String qName,</span></span></span><br><span class="line"><span class="function"><span class="params">			Attributes attributes)</span> <span class="keyword">throws</span> SAXException </span>&#123;</span><br><span class="line">		<span class="comment">// TODO 自动生成的方法存根</span></span><br><span class="line">		<span class="keyword">super</span>.startElement(uri, localName, qName, attributes);</span><br><span class="line">		<span class="comment">//System.out.println("解析 XML 文档中的节点调用");</span></span><br><span class="line">		<span class="comment">//System.out.println("节点名称"+qName+"\t节点的属性"+attributes);</span></span><br><span class="line">		<span class="keyword">if</span>(<span class="string">"book"</span>.equals(qName))&#123;</span><br><span class="line">			<span class="keyword">int</span> count = attributes.getLength();</span><br><span class="line">			<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;count;i++)&#123;<span class="comment">//遍历每本书的id</span></span><br><span class="line">				String 	attName = attributes.getQName(i);</span><br><span class="line">				String attValue = attributes.getValue(i);</span><br><span class="line">				System.out.println(<span class="string">"节点的名称"</span>+attName+<span class="string">"\t"</span>+attValue);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;<span class="keyword">else</span> <span class="keyword">if</span>(!<span class="string">"books"</span>.equals(qName)&amp;&amp;!<span class="string">"book"</span>.equals(qName))&#123;</span><br><span class="line">				System.out.print(<span class="string">"节点的名称-&gt;"</span> +qName+<span class="string">"\t"</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">/**解析xml文档中的节点结束调用*/</span></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">endElement</span><span class="params">(String uri, String localName, String qName)</span></span></span><br><span class="line"><span class="function">			<span class="keyword">throws</span> SAXException </span>&#123;</span><br><span class="line">		<span class="comment">// TODO 自动生成的方法存根</span></span><br><span class="line">		<span class="keyword">super</span>.endElement(uri, localName, qName);</span><br><span class="line">		<span class="comment">//System.out.println("解析 XML 文档中的节点结束");</span></span><br><span class="line">		<span class="comment">//System.out.println("节点名称"+qName);</span></span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="comment">//输出标签中的文本</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">characters</span><span class="params">(<span class="keyword">char</span>[] ch, <span class="keyword">int</span> start, <span class="keyword">int</span> length)</span></span></span><br><span class="line"><span class="function">			<span class="keyword">throws</span> SAXException </span>&#123;</span><br><span class="line">		<span class="comment">// TODO 自动生成的方法存根</span></span><br><span class="line">		<span class="keyword">super</span>.characters(ch, start, length);</span><br><span class="line">		</span><br><span class="line">		String value = <span class="keyword">new</span> String(ch,start,length);</span><br><span class="line">		<span class="keyword">if</span>(!<span class="string">""</span>.equals(value.trim()))&#123;<span class="comment">//不等于空文本</span></span><br><span class="line">			System.out.println(value);</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="5-3-总结："><a href="#5-3-总结：" class="headerlink" title="5.3 总结："></a>5.3 总结：</h5><p>1 相较于 DOM 方式 解析 XML 文档，通过节点的方式逐层解析节点中的属性和子节点，SAX 方式是 直接边扫描边解析 XML 文档，并以自上而下的方式解析。</p>
<p>2 SAX 主要是通过创建一个 <code>DefaultHandler</code> 的子类，来解析 XML 文档</p>
<p>3 SAX较于 DOM 方式，个人感觉简单一点</p>
<h4 id="6-JDOM-解析-XML-文档"><a href="#6-JDOM-解析-XML-文档" class="headerlink" title="6 JDOM 解析 XML 文档"></a>6 JDOM 解析 XML 文档</h4><h5 id="6-1JDOM-概述"><a href="#6-1JDOM-概述" class="headerlink" title="6.1JDOM 概述"></a>6.1JDOM 概述</h5><p>JDOM 是一种解析 XML 的 Java 工具包，它基于树型结构，利用纯Java的技术对XML文档实现解析。所以中适合于Java语言</p>
<h5 id="6-2JDOM-解析-XML-的步骤"><a href="#6-2JDOM-解析-XML-的步骤" class="headerlink" title="6.2JDOM 解析 XML 的步骤"></a>6.2JDOM 解析 XML 的步骤</h5><p>1) 创建一个 <code>SAXBuilder</code>对象</p>
<p>2) 调用 build 方法，得到 Document 对象(通过 IO 流)</p>
<p>3) 获取根节点</p>
<p>4) 获取根节点的直接子节点的集合</p>
<p>5) 遍历</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> TestJDOM;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.FileInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.FileNotFoundException;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.jdom.Attribute;</span><br><span class="line"><span class="keyword">import</span> org.jdom.Document;</span><br><span class="line"><span class="keyword">import</span> org.jdom.Element;</span><br><span class="line"><span class="keyword">import</span> org.jdom.JDOMException;</span><br><span class="line"><span class="keyword">import</span> org.jdom.input.SAXBuilder;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestJDOM</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> FileNotFoundException, JDOMException, IOException </span>&#123;</span><br><span class="line">		<span class="comment">//1) 创建一个 SAXBuilder 对象</span></span><br><span class="line">			SAXBuilder sb = <span class="keyword">new</span> SAXBuilder();</span><br><span class="line">		<span class="comment">//2) 调用 build 方法，得到 Document 对象(通过 IO 流)</span></span><br><span class="line">			Document document = sb.build(<span class="keyword">new</span> FileInputStream(<span class="string">"book.xml"</span>));</span><br><span class="line">		<span class="comment">//3) 获取根节点</span></span><br><span class="line">			Element root = document.getRootElement();</span><br><span class="line">		<span class="comment">//4) 获取根节点的直接子节点的集合</span></span><br><span class="line">			List&lt;Element&gt; bookElm = root.getChildren(); <span class="comment">//book 2 本书</span></span><br><span class="line">		<span class="comment">//5) 遍历集合，得到book的每一个节点</span></span><br><span class="line">			<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;bookElm.size();i++)&#123;</span><br><span class="line">				Element book = bookElm.get(i);</span><br><span class="line">				<span class="comment">//得到属性的集合</span></span><br><span class="line">				List&lt;Attribute&gt; attrs = book.getAttributes();</span><br><span class="line">				<span class="keyword">for</span>(Attribute att:attrs)&#123;</span><br><span class="line">					System.out.println(att.getName()+<span class="string">"\t"</span>+att.getValue());</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">			</span><br><span class="line">		<span class="comment">//获得book 节点的的子节点</span></span><br><span class="line">			<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;bookElm.size();i++)&#123;</span><br><span class="line">				Element book = bookElm.get(i);</span><br><span class="line">				<span class="comment">//得到节点的名称和值</span></span><br><span class="line">				List&lt;Element&gt; subbook = book.getChildren();</span><br><span class="line">				System.out.println(<span class="string">"==================="</span>);</span><br><span class="line">				<span class="keyword">for</span>(Element ele:subbook)&#123;</span><br><span class="line">					System.out.println(ele.getName()+<span class="string">"\t"</span>+ele.getValue());</span><br><span class="line">				&#125;</span><br><span class="line">				</span><br><span class="line">			&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**运行结果</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">id	1</span></span><br><span class="line"><span class="comment">id	2</span></span><br><span class="line"><span class="comment">===================</span></span><br><span class="line"><span class="comment">name	Java</span></span><br><span class="line"><span class="comment">author	Tom</span></span><br><span class="line"><span class="comment">price	34.23</span></span><br><span class="line"><span class="comment">===================</span></span><br><span class="line"><span class="comment">name	Java2</span></span><br><span class="line"><span class="comment">author	Tom2</span></span><br><span class="line"><span class="comment">price	34.231</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">**/</span></span><br></pre></td></tr></table></figure>

<h5 id="6-3-总结："><a href="#6-3-总结：" class="headerlink" title="6.3  总结："></a>6.3  总结：</h5><p>1 JDOM 方式解析 XML 文档 值适合 Java 语言</p>
<p>2 导入Document的包是 <code>import org.jdom.Document;</code></p>
<p>3 主要通过集合遍历的方式解析 XML 文档</p>
<h4 id="7-DOM4J-方式解析"><a href="#7-DOM4J-方式解析" class="headerlink" title="7  DOM4J 方式解析"></a>7  DOM4J 方式解析</h4><p>DOM4J 是一个 Java 的 XML API，是 JDOM 的升级品，<br>用来读写 XML 文件的</p>
<h5 id="7-1-DOM4J-解析-XML-的步骤"><a href="#7-1-DOM4J-解析-XML-的步骤" class="headerlink" title="7.1 DOM4J 解析 XML 的步骤"></a>7.1 DOM4J 解析 XML 的步骤</h5><p>1) 创建 <code>SAXReader</code> 对象<br>2) 调用 read 方法<br>3) 获取根元素<br>4) 通过迭代器遍历直接节点</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> TestJDOM4J;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.FileInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.FileNotFoundException;</span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.Iterator;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.dom4j.Attribute;</span><br><span class="line"><span class="keyword">import</span> org.dom4j.Document;</span><br><span class="line"><span class="keyword">import</span> org.dom4j.DocumentException;</span><br><span class="line"><span class="keyword">import</span> org.dom4j.Element;</span><br><span class="line"><span class="keyword">import</span> org.dom4j.io.SAXReader;</span><br><span class="line"><span class="keyword">import</span> org.w3c.dom.Attr;</span><br><span class="line"><span class="keyword">import</span> org.w3c.dom.traversal.NodeIterator;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestJDOM4J</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> FileNotFoundException, DocumentException </span>&#123;</span><br><span class="line">		<span class="comment">//1) 创建 SAXReader 对象</span></span><br><span class="line">		SAXReader reader = <span class="keyword">new</span> SAXReader();</span><br><span class="line">		<span class="comment">//2) 调用 read 方法</span></span><br><span class="line">		Document doc = reader.read(<span class="keyword">new</span> FileInputStream(<span class="string">"book.xml"</span>));</span><br><span class="line">		<span class="comment">//3) 获取根元素</span></span><br><span class="line">		Element root = doc.getRootElement();</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//4) 通过迭代器遍历直接节点</span></span><br><span class="line">		<span class="keyword">for</span>(Iterator&lt;Element&gt; iterBook = root.elementIterator();iterBook.hasNext();)&#123;</span><br><span class="line">			Element bookele = iterBook.next();</span><br><span class="line">			<span class="comment">//System.out.println(bookele.getName());</span></span><br><span class="line">			<span class="keyword">for</span>(Iterator&lt;Attribute&gt; iterAttr = bookele.attributeIterator();iterAttr.hasNext();)&#123;</span><br><span class="line">				Attribute att = iterAttr.next();</span><br><span class="line">				System.out.println(att.getName()+<span class="string">"\t"</span>+att.getValue());</span><br><span class="line">			&#125;</span><br><span class="line">			 System.out.println(<span class="string">"----------------"</span>);</span><br><span class="line">		&#125;</span><br><span class="line">	   <span class="comment">//5 通过迭代器获得节点的名称和值</span></span><br><span class="line">		List&lt;Book&gt; books = <span class="keyword">new</span> ArrayList&lt;Book&gt;();</span><br><span class="line">		<span class="keyword">for</span>(Iterator&lt;Element&gt; iterBook = root.elementIterator();iterBook.hasNext();)&#123;</span><br><span class="line">			 Element bookEle = iterBook.next();<span class="comment">//得到每一本book	</span></span><br><span class="line">			 Book book = <span class="keyword">new</span> Book();</span><br><span class="line">			 <span class="keyword">for</span>(Iterator&lt;Element&gt; subbookEle = bookEle.elementIterator();subbookEle.hasNext();)&#123;</span><br><span class="line">				 Element subbook = subbookEle.next();</span><br><span class="line">				 System.out.println(subbook.getName()+<span class="string">"\t"</span>+subbook.getText());</span><br><span class="line">				 <span class="comment">/**</span></span><br><span class="line"><span class="comment">				  * 封装成 Book对象</span></span><br><span class="line"><span class="comment">				  */</span></span><br><span class="line">				 String nodename = subbook.getName();</span><br><span class="line">				 <span class="keyword">switch</span>(nodename)&#123;</span><br><span class="line">				 <span class="keyword">case</span> <span class="string">"name"</span>:</span><br><span class="line">					 book.setName(subbook.getText());</span><br><span class="line">					 <span class="keyword">break</span>;</span><br><span class="line">				 <span class="keyword">case</span> <span class="string">"author"</span>:</span><br><span class="line">					 book.setAuthor(subbook.getText());</span><br><span class="line">					 <span class="keyword">break</span>;</span><br><span class="line">				 <span class="keyword">case</span> <span class="string">"price"</span>:</span><br><span class="line">					 book.setPrice(Double.parseDouble(subbook.getText()));</span><br><span class="line">					 <span class="keyword">break</span>;</span><br><span class="line">				 &#125;</span><br><span class="line">			 &#125;</span><br><span class="line">			 books.add(book);</span><br><span class="line">			 System.out.println(<span class="string">"----------------"</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">for</span>(Book book:books)&#123;</span><br><span class="line">				System.out.println(book);</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> TestJDOM4J;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Book</span> </span>&#123;</span><br><span class="line">	<span class="keyword">private</span> String name;</span><br><span class="line">	<span class="keyword">private</span> String author;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">double</span> price;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> name;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.name = name;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getAuthor</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> author;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setAuthor</span><span class="params">(String author)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.author = author;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">double</span> <span class="title">getPrice</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> price;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setPrice</span><span class="params">(<span class="keyword">double</span> price)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.price = price;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">Book</span><span class="params">(String name, String athor, <span class="keyword">double</span> price)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">super</span>();</span><br><span class="line">		<span class="keyword">this</span>.name = name;</span><br><span class="line">		<span class="keyword">this</span>.author = author;</span><br><span class="line">		<span class="keyword">this</span>.price = price;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">Book</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">super</span>();</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="comment">// TODO 自动生成的方法存根</span></span><br><span class="line">		<span class="keyword">return</span> <span class="string">"name:"</span>+<span class="keyword">this</span>.getName()+<span class="string">"\tauthor:"</span>+<span class="keyword">this</span>.getAuthor()+<span class="string">"\tprice:"</span>+<span class="keyword">this</span>.price;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="7-2-总结："><a href="#7-2-总结：" class="headerlink" title="7.2 总结："></a>7.2 总结：</h5><p>1 导入的 document包是 <code>import org.dom4j.Document;</code></p>
<p>2 主要用 集合遍历</p>
<h5 id="7-3-四种解析-XML-的特点"><a href="#7-3-四种解析-XML-的特点" class="headerlink" title="7.3 四种解析 XML 的特点"></a>7.3 四种解析 XML 的特点</h5><p>1)DOM 解析:<br>形成了树结构，有助于更好的理解、掌握，且代码容易编写。<br>解析过程中，树结构保存在内存中，方便修改。<br>2)SAX 解析:<br>采用事件驱动模式，对内存耗费比较小。<br>适用于只处理 XML 文件中的数据时<br>3)JDOM 解析:<br>仅使用具体类，而不使用接口。<br>API 大量使用了 Collections 类。<br>4)DOM4J 解析:<br>JDOM 的一种智能分支，它合并了许多超出基本 XML 文档<br>表示的功能。<br>它使用接口和抽象基本类方法。<br>具有性能优异、灵活性好、功能强大和极端易用的特点。<br>是一个开放源码的文件</p>
<h4 id="8-XML-技术-快速获取节点"><a href="#8-XML-技术-快速获取节点" class="headerlink" title="8 XML 技术 快速获取节点"></a>8 XML 技术 快速获取节点</h4><h5 id="8-1-准备资源"><a href="#8-1-准备资源" class="headerlink" title="8.1 准备资源"></a>8.1 准备资源</h5><p>1) DOM4J 的 jar 包</p>
<p>2) Jaxen 的 jar 包</p>
<p>3)<code>Xpath</code> 中文文档</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.szxy.xml;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.FileInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.FileNotFoundException;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.dom4j.Attribute;</span><br><span class="line"><span class="keyword">import</span> org.dom4j.Document;</span><br><span class="line"><span class="keyword">import</span> org.dom4j.DocumentException;</span><br><span class="line"><span class="keyword">import</span> org.dom4j.Element;</span><br><span class="line"><span class="keyword">import</span> org.dom4j.Node;</span><br><span class="line"><span class="keyword">import</span> org.dom4j.io.SAXReader;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *  XML 技术快速 定位节点</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> wzer</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestXML</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> FileNotFoundException, DocumentException </span>&#123;</span><br><span class="line">		<span class="comment">//通过 SAXReader对象</span></span><br><span class="line">		SAXReader reader = <span class="keyword">new</span> SAXReader();</span><br><span class="line">		<span class="comment">//调用 read 方法</span></span><br><span class="line">		Document doc = reader.read(<span class="keyword">new</span> FileInputStream(<span class="string">"book.xml"</span>));</span><br><span class="line">		<span class="comment">//通过XML 技术获得节点</span></span><br><span class="line">		System.out.println(<span class="string">"-------//@id"</span>);</span><br><span class="line">		Node id = doc.selectSingleNode(<span class="string">"//@id"</span>);</span><br><span class="line">		System.out.println(id.getName()+<span class="string">"\t"</span>+id.getText());</span><br><span class="line">		</span><br><span class="line">		System.out.println(<span class="string">"-------//@id"</span>);</span><br><span class="line">		List&lt;Node&gt; ids = doc.selectNodes(<span class="string">"//@id"</span>);</span><br><span class="line">		<span class="keyword">for</span> (Node node : ids) &#123;</span><br><span class="line">			System.out.println(node.getName()+<span class="string">"\t"</span>+node.getText());</span><br><span class="line">		&#125;</span><br><span class="line">		System.out.println(<span class="string">"-------/books/book/author"</span>);</span><br><span class="line">		List&lt;Node&gt; booknodes = doc.selectNodes(<span class="string">"/books/book/author"</span>);</span><br><span class="line">		<span class="keyword">for</span> (Node node : booknodes) &#123;</span><br><span class="line">			System.out.println(node.getName()+<span class="string">"\t"</span>+node.getText());</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		System.out.println(<span class="string">"-------//author"</span>);</span><br><span class="line">		List&lt;Node&gt; authornodes = doc.selectNodes(<span class="string">"//author"</span>);</span><br><span class="line">		<span class="keyword">for</span> (Node node : authornodes) &#123;</span><br><span class="line">			System.out.println(node.getName()+<span class="string">"\t"</span>+node.getText());</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		System.out.println(<span class="string">"-------/books/book/author"</span>);</span><br><span class="line">		List&lt;Node&gt; authornodes1 = doc.selectNodes(<span class="string">"/books/book/author"</span>);</span><br><span class="line">		<span class="keyword">for</span> (Node node : authornodes1) &#123;</span><br><span class="line">			System.out.println(node.getName()+<span class="string">"\t"</span>+node.getText());</span><br><span class="line">		&#125;</span><br><span class="line">		System.out.println(<span class="string">"-------//book/*"</span>);</span><br><span class="line">		List&lt;Element&gt; booklist = doc.selectNodes(<span class="string">"//book/*"</span>);</span><br><span class="line">		<span class="keyword">for</span> (Element element : booklist) &#123;</span><br><span class="line">			System.out.println(element.getName()+<span class="string">"\t"</span>+element.getText());</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="8-2-总结："><a href="#8-2-总结：" class="headerlink" title="8.2 总结："></a>8.2 总结：</h5><p>1 导入架包 jdom4J 和 <code>jaxen</code></p>
<p>2 XPath 方式访问节点方便，尤其是有多个层级节点访问。</p>

        
      
    </div>

    
    
    
      <footer class="post-footer">
          <div class="post-eof"></div>
        
      </footer>
  </div>
  
  
  
  </article>

    
        <article itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block home">
    <link itemprop="mainEntityOfPage" href="http://zwer.xyz/2018/11/14/Java/20181114 网络编程/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="zwer">
      <meta itemprop="description" content="记录学习的日常">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="zwer 的博客空间">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
            
            <a href="/2018/11/14/Java/20181114 网络编程/" class="post-title-link" itemprop="url">20181114 网络编程</a>
          
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              
                
              

              <time title="Created: 2018-11-14 07:00:00" itemprop="dateCreated datePublished" datetime="2018-11-14T07:00:00+08:00">2018-11-14</time>
            </span>
          
            

            
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2018-11-16 15:00:26" itemprop="dateModified" datetime="2018-11-16T15:00:26+08:00">2018-11-16</time>
              </span>
            
          

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h4 id="1-网络编程的基本概念"><a href="#1-网络编程的基本概念" class="headerlink" title="1 网络编程的基本概念"></a>1 网络编程的基本概念</h4><h5 id="1-1-网络的概念"><a href="#1-1-网络的概念" class="headerlink" title="1.1  网络的概念"></a>1.1  网络的概念</h5><p>网络：一组相互连接的计算机，多台计算机组成，使用物理线路进行连接</p>
<p><img src="C:%5CUsers%5CLenovo%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1542195022406.png" alt="1542195022406"></p>
<p> 1 双绞线 局域网</p>
<p> 2  光纤 城域网</p>
<h5 id="2-2-网络的功能"><a href="#2-2-网络的功能" class="headerlink" title="2.2  网络的功能"></a>2.2  网络的功能</h5><p><img src="C:%5CUsers%5CLenovo%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1542193885268.png" alt="1542193885268"></p>
<h5 id="1-3-网络编程的三要素"><a href="#1-3-网络编程的三要素" class="headerlink" title="1.3  网络编程的三要素"></a>1.3  网络编程的三要素</h5><p>1 IP 地址</p>
<p>2 端口号   一个应用程序对应一个端口号</p>
<p>3 通信协议 通信的规则   TCP/UDP</p>
<p><img src="C:%5CUsers%5CLenovo%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1542194108801.png" alt="1542194108801"></p>
<h4 id="2-IP-端口号-Socket"><a href="#2-IP-端口号-Socket" class="headerlink" title="2  IP  端口号 Socket"></a>2  IP  端口号 Socket</h4><h5 id="2-1-IP-地址"><a href="#2-1-IP-地址" class="headerlink" title="2.1 IP 地址"></a>2.1 IP 地址</h5><p>含义：IP 地址用于标识网络上的唯一一台计算机,共 32 位，4 个 8位二进制数</p>
<p><img src="C:%5CUsers%5CLenovo%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1542195148982.png" alt="1542195148982"></p>
<p>IP 地址 = 网络 ID + 主机 ID</p>
<p>网络 ID： 标识计算机或网络设备所有的网段</p>
<p>主机ID： 标识识特定的主机或网络设备</p>
<p>特殊 IP 地址：</p>
<p>127.0.0.1 ：本机环路地址  用于本地测试</p>
<p>255.255.255.0  当前子网，一般用于当前子网广播信息</p>
<h5 id="2-2-端口号"><a href="#2-2-端口号" class="headerlink" title="2.2  端口号"></a>2.2  端口号</h5><p>含义：计算机中应用的标号(代表一个应用程序)，0-1024 系统使用或保留端口 ，端号口占 2 个字节，所以有效端口 0-65535</p>
<p>端口号：虚拟的概念，使用 0~65535 之间的整数</p>
<p>每个网络程序都会至少有一个端口号</p>
<h5 id="2-3-Socket-含义："><a href="#2-3-Socket-含义：" class="headerlink" title="2.3  Socket 含义："></a>2.3  Socket 含义：</h5><p> Socket 称为 “套接字” ,是 计算机之间通信的一种约定或一种方式</p>
<p>每一个客户端都使用一个 Socket 对象表示，服务器端使</p>
<p>用 <code>ServerSocket</code>等待客户端的连接。</p>
<p><img src="C:%5CUsers%5CLenovo%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1542195226268.png" alt="1542195226268"></p>
<h4 id="3-TCP-UDP"><a href="#3-TCP-UDP" class="headerlink" title="3 TCP UDP"></a>3 TCP UDP</h4><h5 id="3-1-数据的传输"><a href="#3-1-数据的传输" class="headerlink" title="3.1  数据的传输"></a>3.1  数据的传输</h5><p><strong>网络参考模式</strong></p>
<p>1 <strong>OSI 参考模式</strong> ：开放系统互联参考模型（Open System Interconnect）</p>
<p><img src="C:%5CUsers%5CLenovo%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1542195935309.png" alt="1542195935309"></p>
<p>2 <strong>TCP/IP 参考模型</strong>: 传输控制/网际协议 Transfer Control Protocol/Internet Protocol</p>
<p><img src="C:%5CUsers%5CLenovo%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1542196057412.png" alt="1542196057412"></p>
<h5 id="3-2-TCP-UDP-的区别"><a href="#3-2-TCP-UDP-的区别" class="headerlink" title="3.2 TCP/ UDP 的区别"></a>3.2 TCP/ UDP 的区别</h5><p><strong>TCP</strong>(Transfer Control protocol)</p>
<p>一种面向连接（连接导向）的、可靠的、基于字符流的传输控制协议</p>
<p><img src="C:%5CUsers%5CLenovo%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1542196101335.png" alt="1542196101335"></p>
<p><strong>特点</strong></p>
<p>1 面向连接</p>
<p>2 点到点的通信</p>
<p>3 高可靠性：<strong>三次握手</strong></p>
<p>4 占用系统资源多、效率低</p>
<p><strong>UDP</strong>(User Datagram Protocol)</p>
<p>一种无连接的传输层协议，提供面向事务的简单不可靠的信息传送服务</p>
<p><strong>特点</strong></p>
<p>1  非面向连接，传输不可靠，可能丢失<br>2  发送不管对方是否准备好，接收方收到也不确认<br>3  数据报的大小限制在 64k 内<br>4  非常简单的协议，开销小</p>
<p><img src="C:%5CUsers%5CLenovo%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1542195794178.png" alt="1542195794178"></p>
<h4 id="4-TCP-协议数据传输细节"><a href="#4-TCP-协议数据传输细节" class="headerlink" title="4  TCP 协议数据传输细节"></a>4  TCP 协议数据传输细节</h4><h5 id="4-1-TCP-通信原理"><a href="#4-1-TCP-通信原理" class="headerlink" title="4.1 TCP 通信原理"></a>4.1 TCP 通信原理</h5><p>服务器创建  <code>ServletSocket</code> ，在指定端口监听并处理请求客户端创建Socket，向服务器发送请求</p>
<p>TCP编程是 基于 IO 流的编程</p>
<p><img src="C:%5CUsers%5CLenovo%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1542196766454.png" alt="1542196766454"></p>
<h4 id="5-InetAddress-类-InetSocketAddress-类"><a href="#5-InetAddress-类-InetSocketAddress-类" class="headerlink" title="5  InetAddress 类     InetSocketAddress 类"></a>5  <code>InetAddress</code> 类     <code>InetSocketAddress</code> 类</h4><h5 id="5-1-InetAddress-类"><a href="#5-1-InetAddress-类" class="headerlink" title="5.1  InetAddress 类"></a>5.1  <code>InetAddress</code> 类</h5><p><img src="C:%5CUsers%5CLenovo%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1542196910390.png" alt="1542196910390"></p>
<h5 id="5-2-InetSocketAddress类"><a href="#5-2-InetSocketAddress类" class="headerlink" title="5.2 InetSocketAddress类"></a>5.2 <code>InetSocketAddress</code>类</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.szxy.net;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.net.InetAddress;</span><br><span class="line"><span class="keyword">import</span> java.net.InetSocketAddress;</span><br><span class="line"><span class="keyword">import</span> java.net.UnknownHostException;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 测试类  InetAddress InetSocketAddress</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> wzer</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestIP</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> UnknownHostException </span>&#123;</span><br><span class="line">		<span class="comment">//本地</span></span><br><span class="line">		InetAddress ia = InetAddress.getLocalHost();</span><br><span class="line">		System.out.println(<span class="string">"获的主机名："</span>+ia.getHostName());</span><br><span class="line">		System.out.println(<span class="string">"获的主机IP: "</span>+ia.getHostAddress());</span><br><span class="line">		<span class="comment">//域名</span></span><br><span class="line">		InetAddress ia1 = InetAddress.getByName(<span class="string">"www.baidu.com"</span>);</span><br><span class="line">		System.out.println(<span class="string">"获的主机名："</span>+ia1.getHostName());</span><br><span class="line">		System.out.println(<span class="string">"获的主机IP: "</span>+ia1.getHostAddress());</span><br><span class="line">		<span class="comment">//IP地址</span></span><br><span class="line">		InetAddress ia2 = InetAddress.getByName(<span class="string">"112.123.122.22"</span>);</span><br><span class="line">		System.out.println(<span class="string">"获的主机名："</span>+ia2.getHostName());</span><br><span class="line">		System.out.println(<span class="string">"获的主机IP: "</span>+ia2.getHostAddress());</span><br><span class="line">		<span class="comment">//如果 112.123.122.22 的域名不存在，则返回</span></span><br><span class="line">		</span><br><span class="line">		InetSocketAddress isa = <span class="keyword">new</span> InetSocketAddress(<span class="string">"localhost"</span>, <span class="number">9999</span>);</span><br><span class="line">		InetSocketAddress isa2 = <span class="keyword">new</span> InetSocketAddress(<span class="number">10002</span>);</span><br><span class="line">		InetSocketAddress isa1 = <span class="keyword">new</span> InetSocketAddress(ia, <span class="number">10001</span>);</span><br><span class="line">		System.out.println(<span class="string">"获的主机名："</span>+isa.getHostName());</span><br><span class="line">		System.out.println(<span class="string">"获的主机IP: "</span>+isa.getPort());</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="6-URL-类"><a href="#6-URL-类" class="headerlink" title="6 URL 类"></a>6 URL 类</h4><p><strong>URL</strong> (Uniform Resource Locator) </p>
<p>统一资源定位符，由 4 部分组成：协议 、存放资源 、端口、文件路径</p>
<h5 id="6-1-URL-类的常用方法"><a href="#6-1-URL-类的常用方法" class="headerlink" title="6.1 URL 类的常用方法"></a>6.1 URL 类的常用方法</h5><p><img src="C:%5CUsers%5CLenovo%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1542203760953.png" alt="1542203760953"></p>
<h5 id="6-2-URL-类的使用-爬虫"><a href="#6-2-URL-类的使用-爬虫" class="headerlink" title="6.2 URL 类的使用  爬虫"></a>6.2 URL 类的使用  爬虫</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.szxy.url;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.BufferedInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.BufferedReader;</span><br><span class="line"><span class="keyword">import</span> java.io.BufferedWriter;</span><br><span class="line"><span class="keyword">import</span> java.io.File;</span><br><span class="line"><span class="keyword">import</span> java.io.FileOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStreamReader;</span><br><span class="line"><span class="keyword">import</span> java.io.OutputStreamWriter;</span><br><span class="line"><span class="keyword">import</span> java.net.MalformedURLException;</span><br><span class="line"><span class="keyword">import</span> java.net.URL;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 网络爬虫</span></span><br><span class="line"><span class="comment"> * 爬取百度界面</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> wzer</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestURL2</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">		<span class="comment">//获取URL</span></span><br><span class="line">		URL url = <span class="keyword">new</span> URL(<span class="string">"https://www.baidu.com"</span>);</span><br><span class="line">		<span class="comment">//获取网页中的信息</span></span><br><span class="line">		InputStream is = url.openStream();</span><br><span class="line">		<span class="comment">//缓冲输入流</span></span><br><span class="line">		BufferedReader br = <span class="keyword">new</span> BufferedReader(<span class="keyword">new</span> InputStreamReader(is,<span class="string">"utf-8"</span>));</span><br><span class="line">		<span class="comment">//缓冲输入流</span></span><br><span class="line">		BufferedWriter bw = <span class="keyword">new</span> BufferedWriter(<span class="keyword">new</span> OutputStreamWriter(<span class="keyword">new</span> FileOutputStream(<span class="string">"index.html"</span>),<span class="string">"utf-8"</span>));</span><br><span class="line">		<span class="comment">//边读变写</span></span><br><span class="line">		String line = <span class="keyword">null</span>;</span><br><span class="line">		<span class="keyword">while</span>((line=br.readLine())!=<span class="keyword">null</span>)&#123;</span><br><span class="line">			bw.write(line);</span><br><span class="line">			bw.newLine();</span><br><span class="line">			bw.flush();</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="comment">//关闭流</span></span><br><span class="line">		bw.close();</span><br><span class="line">		br.close();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="7-基于-TCP-协议的-Socket-编程-单次双向通信"><a href="#7-基于-TCP-协议的-Socket-编程-单次双向通信" class="headerlink" title="7  基于 TCP 协议的 Socket 编程 -单次双向通信"></a>7  基于 TCP 协议的 Socket 编程 -单次双向通信</h4><p>单次双向通信，通过 IO 流 来读取或写入数据</p>
<p><img src="C:%5CUsers%5CLenovo%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1542203626460.png" alt="1542203626460"></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.szxy.tcp;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.DataInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.DataOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.OutputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.OutputStreamWriter;</span><br><span class="line"><span class="keyword">import</span> java.net.ServerSocket;</span><br><span class="line"><span class="keyword">import</span> java.net.Socket;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 服务器端  </span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> wzer</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestServer2</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"服务器启动-----"</span>);</span><br><span class="line">		<span class="comment">//创建服务器端对象</span></span><br><span class="line">		ServerSocket server = <span class="keyword">new</span> ServerSocket(<span class="number">9996</span>);</span><br><span class="line">		<span class="comment">//监听客户端的请求</span></span><br><span class="line">		Socket clien = server.accept();</span><br><span class="line">		<span class="comment">//获取输入流</span></span><br><span class="line">		InputStream is = clien.getInputStream();</span><br><span class="line">		DataInputStream dis = <span class="keyword">new</span> DataInputStream(is);</span><br><span class="line">		System.out.println(dis.readUTF());</span><br><span class="line">		<span class="comment">//获取输出流</span></span><br><span class="line">		OutputStream os = clien.getOutputStream();</span><br><span class="line">		DataOutputStream dos = <span class="keyword">new</span> DataOutputStream(os);</span><br><span class="line">		dos.writeUTF(<span class="string">"收到了"</span>);</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">if</span>(dos!=<span class="keyword">null</span>)&#123;</span><br><span class="line">			dos.close();</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span>(dis!=<span class="keyword">null</span>)&#123;</span><br><span class="line">			dis.close();</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span>(clien!=<span class="keyword">null</span>)&#123;</span><br><span class="line">			clien.close();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.szxy.tcp;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.DataInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.DataOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.OutputStream;</span><br><span class="line"><span class="keyword">import</span> java.net.Socket;</span><br><span class="line"><span class="keyword">import</span> java.nio.channels.SocketChannel;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 客户端</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> wzer</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestClient2</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"客户端启动"</span>);</span><br><span class="line">		<span class="comment">//创建客户端对象</span></span><br><span class="line">		Socket client = <span class="keyword">new</span> Socket(<span class="string">"127.0.0.1"</span>, <span class="number">9996</span>);</span><br><span class="line">		<span class="comment">//获取输出流</span></span><br><span class="line">		OutputStream os =client.getOutputStream();</span><br><span class="line">		DataOutputStream dos = <span class="keyword">new</span> DataOutputStream(os);</span><br><span class="line">		dos.writeUTF(<span class="string">"HelloWorld!!!"</span>);</span><br><span class="line">		<span class="comment">//获取输入流</span></span><br><span class="line">		InputStream is = client.getInputStream();</span><br><span class="line">		DataInputStream dis = <span class="keyword">new</span> DataInputStream(is);</span><br><span class="line">		System.out.println(dis.readUTF());</span><br><span class="line">		<span class="keyword">if</span>(dis!=<span class="keyword">null</span>)&#123;</span><br><span class="line">			dis.close();</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span>(dos!=<span class="keyword">null</span>)&#123;</span><br><span class="line">			dos.close();</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span>(client!=<span class="keyword">null</span>)&#123;</span><br><span class="line">			client.close();</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="8-基于-TCP-协议的-Socket编程-双向通信-实现模拟用户登录"><a href="#8-基于-TCP-协议的-Socket编程-双向通信-实现模拟用户登录" class="headerlink" title="8 基于 TCP 协议的 Socket编程 双向通信 实现模拟用户登录"></a>8 基于 TCP 协议的 Socket编程 双向通信 实现模拟用户登录</h4><h5 id="8-1-示意图"><a href="#8-1-示意图" class="headerlink" title="8.1  示意图"></a>8.1  示意图</h5><p><img src="C:%5CUsers%5CLenovo%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1542334908708.png" alt="1542334908708"></p>
<p>##### </p>
<h5 id="8-2-实践"><a href="#8-2-实践" class="headerlink" title="8.2 实践"></a>8.2 实践</h5><h5 id="用户类"><a href="#用户类" class="headerlink" title="用户类"></a>用户类</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.szxy.entity;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.Serializable;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 用户类</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> wzer</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="comment">// 对象要序列化，必须实现 Serializable 接口</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> <span class="keyword">implements</span> <span class="title">Serializable</span></span>&#123;</span><br><span class="line">	<span class="keyword">private</span> String userName;</span><br><span class="line">	<span class="keyword">private</span> String passWord;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">User</span><span class="params">(String userName, String passWord)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">super</span>();</span><br><span class="line">		<span class="keyword">this</span>.userName = userName;</span><br><span class="line">		<span class="keyword">this</span>.passWord = passWord;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">User</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">super</span>();</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getUserName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> userName;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setUserName</span><span class="params">(String userName)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.userName = userName;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getPass</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> passWord;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setPass</span><span class="params">(String pass)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.passWord = pass;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="服务器-多线程"><a href="#服务器-多线程" class="headerlink" title="服务器 多线程"></a>服务器 多线程</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.szxy.Server;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.DataOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.ObjectInputStream;</span><br><span class="line"><span class="keyword">import</span> java.net.Socket;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> cn.szxy.entity.User;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 服务器 多线程</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> wzer</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ServerThread</span> <span class="keyword">implements</span> <span class="title">Runnable</span></span>&#123;</span><br><span class="line">	<span class="keyword">private</span> Socket socket;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">ServerThread</span><span class="params">(Socket socket)</span> </span>&#123;</span><br><span class="line">		<span class="comment">// TODO 自动生成的构造函数存根</span></span><br><span class="line">		<span class="keyword">this</span>.socket = socket;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		System.out.println(Thread.currentThread().getName()+<span class="string">"请求登录"</span>);</span><br><span class="line">		<span class="comment">//2 获得输入流</span></span><br><span class="line">		ObjectInputStream ois=<span class="keyword">null</span>;</span><br><span class="line">		<span class="comment">//3 获得输出流</span></span><br><span class="line">		DataOutputStream dos =<span class="keyword">null</span>;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			ois = <span class="keyword">new</span> ObjectInputStream(socket.getInputStream());</span><br><span class="line">			User u = (User)ois.readObject();醃</span><br><span class="line">			System.out.println(socket.getInetAddress().getHostName()+<span class="string">"\t用户名: "</span>+u.getUserName()+<span class="string">"\t密码: "</span>+u.getPass());</span><br><span class="line">			</span><br><span class="line">			dos = <span class="keyword">new</span> DataOutputStream(socket.getOutputStream());</span><br><span class="line">			<span class="keyword">if</span>(u.getUserName().equals(<span class="string">"Tom"</span>)&amp;&amp;u.getPass().equals(<span class="string">"123"</span>))&#123;</span><br><span class="line">				dos.writeUTF(<span class="string">"登录成功"</span>);</span><br><span class="line">			&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">				dos.writeUTF(<span class="string">"用户名密码不正确"</span>);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125; <span class="keyword">catch</span> (ClassNotFoundException e) &#123;</span><br><span class="line">			<span class="comment">// TODO 自动生成的 catch 块</span></span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">			<span class="comment">// TODO 自动生成的 catch 块</span></span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;<span class="keyword">finally</span>&#123;</span><br><span class="line">			<span class="comment">// 4 关闭</span></span><br><span class="line">			<span class="keyword">if</span>(dos!=<span class="keyword">null</span>)&#123;</span><br><span class="line">				<span class="keyword">try</span> &#123;</span><br><span class="line">					dos.close();</span><br><span class="line">				&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">					<span class="comment">// TODO 自动生成的 catch 块</span></span><br><span class="line">					e.printStackTrace();</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">if</span>(ois!=<span class="keyword">null</span>)&#123;</span><br><span class="line">				<span class="keyword">try</span> &#123;</span><br><span class="line">					ois.close();</span><br><span class="line">				&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">					<span class="comment">// TODO 自动生成的 catch 块</span></span><br><span class="line">					e.printStackTrace();</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">if</span>(socket!=<span class="keyword">null</span>)&#123;</span><br><span class="line">				<span class="keyword">try</span> &#123;</span><br><span class="line">					socket.close();</span><br><span class="line">				&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">					<span class="comment">// TODO 自动生成的 catch 块</span></span><br><span class="line">					e.printStackTrace();</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">			</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		</span><br><span class="line"></span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="服务器端"><a href="#服务器端" class="headerlink" title="服务器端"></a>服务器端</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.szxy.Server;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.DataOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.ObjectInputStream;</span><br><span class="line"><span class="keyword">import</span> java.net.ServerSocket;</span><br><span class="line"><span class="keyword">import</span> java.net.Socket;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> cn.szxy.entity.User;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 服务器端</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> wzer</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Server</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException, ClassNotFoundException </span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"-------开启服务器---------"</span>);</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//1 创建  ServerSocket 对象,并监听 客户端 请求</span></span><br><span class="line">		ServerSocket server = <span class="keyword">new</span> ServerSocket(<span class="number">8001</span>);</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">while</span>(<span class="keyword">true</span>)&#123;</span><br><span class="line">			Socket socket = server.accept();</span><br><span class="line">			<span class="comment">//服务器 多线程  </span></span><br><span class="line">			<span class="keyword">new</span> Thread(<span class="keyword">new</span> ServerThread(socket)).start();</span><br><span class="line">		</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="客户端"><a href="#客户端" class="headerlink" title="客户端"></a>客户端</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.szxy.Client;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.DataInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.DataOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.ObjectOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.net.Socket;</span><br><span class="line"><span class="keyword">import</span> java.net.UnknownHostException;</span><br><span class="line"><span class="keyword">import</span> java.util.Scanner;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> cn.szxy.entity.User;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> *客户端</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> UnknownHostException, IOException </span>&#123;</span><br><span class="line">		<span class="comment">//1 创建Socket对象</span></span><br><span class="line">		<span class="comment">//localhost是指本地服务器的地址 8999是端口号</span></span><br><span class="line">		Socket client = <span class="keyword">new</span> Socket(<span class="string">"localhost"</span>,<span class="number">8001</span>);</span><br><span class="line">		<span class="comment">//2 获得输出流（对象序列化）</span></span><br><span class="line">		ObjectOutputStream oos = <span class="keyword">new</span> ObjectOutputStream(client.getOutputStream());</span><br><span class="line">		<span class="comment">//3 创建User对象,并序列化</span></span><br><span class="line">		User u =  getUser();<span class="comment">//new User("Tom","123");</span></span><br><span class="line">		oos.writeObject(u);</span><br><span class="line">		<span class="comment">//4 获得输入流</span></span><br><span class="line">		DataInputStream dis = <span class="keyword">new</span> DataInputStream(client.getInputStream());</span><br><span class="line">		System.out.println(dis.readUTF());</span><br><span class="line">		<span class="comment">//5 关闭流</span></span><br><span class="line">		<span class="keyword">if</span>(dis!=<span class="keyword">null</span>)&#123;</span><br><span class="line">			dis.close();</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span>(oos!=<span class="keyword">null</span>)&#123;</span><br><span class="line">			oos.close();</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span>(client!=<span class="keyword">null</span>)&#123;</span><br><span class="line">			client.close();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> User <span class="title">getUser</span><span class="params">()</span></span>&#123;</span><br><span class="line">		Scanner input = <span class="keyword">new</span> Scanner(System.in);</span><br><span class="line">		System.out.print(<span class="string">"请输入用户名: "</span>);</span><br><span class="line">		String userName = input.nextLine();</span><br><span class="line">		System.out.print(<span class="string">"请输入密码: "</span>);</span><br><span class="line">		String passWord = input.nextLine();</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">new</span> User(userName,passWord);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="总结："><a href="#总结：" class="headerlink" title="总结："></a>总结：</h5><p>1 在编写用户类的时候，由于需要对象序列化，所以必须让 User 类实现  Serializable 接口</p>
<p>2 在客户端发送 对象，必须使用 对象化(序列化)，而服务端接受后需要使用反序列化，并用</p>
<p>对应类型的变量接受。</p>
<p>3 在编写客户端服务端时，需要明确各端的流的方向和包装流的使用  </p>
<h4 id="9-基于-TCP-协议的-Socket-编程-–-聊天"><a href="#9-基于-TCP-协议的-Socket-编程-–-聊天" class="headerlink" title="9 基于 TCP 协议的 Socket 编程 – 聊天"></a>9 基于 TCP 协议的 Socket 编程 – 聊天</h4><h5 id="9-1-单次聊天的缺点"><a href="#9-1-单次聊天的缺点" class="headerlink" title="9.1 单次聊天的缺点"></a>9.1 单次聊天的缺点</h5><p>只能客户端先发送数据，然后才能接收数据，如果不发就收不到,(接收和发送是在一个线程中实现的)不符合实际情况</p>
<h5 id="9-2-解决方案"><a href="#9-2-解决方案" class="headerlink" title="9.2 解决方案"></a>9.2 解决方案</h5><p>(1)多次聊天可以使用循环来解决<br>(2)先发后收的问题可以使用线程来解决，一个接收数据的线程，一个发送数据的线程</p>
<h5 id="9-3-最终实现单个客户端与服务器端多次"><a href="#9-3-最终实现单个客户端与服务器端多次" class="headerlink" title="9.3 最终实现单个客户端与服务器端多次"></a>9.3 最终实现单个客户端与服务器端多次</h5><p><img src="C:%5CUsers%5CLenovo%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1542347678095.png" alt="1542347678095"></p>
<h5 id="9-4-聊天室-群聊"><a href="#9-4-聊天室-群聊" class="headerlink" title="9.4   聊天室_群聊"></a>9.4   聊天室_群聊</h5><p><img src="C:%5CUsers%5CLenovo%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1542347738757.png" alt="1542347738757"></p>
<ul>
<li><h5 id="目录结构"><a href="#目录结构" class="headerlink" title="目录结构"></a>目录结构</h5></li>
</ul>
<p><img src="C:%5CUsers%5CLenovo%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1542347962064.png" alt="1542347962064"></p>
<ul>
<li><h5 id="客户端-1"><a href="#客户端-1" class="headerlink" title="客户端"></a>客户端</h5></li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.szxy.chat.Client;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.DataInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStreamReader;</span><br><span class="line"><span class="keyword">import</span> java.net.Socket;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 接收的线程</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> wzer</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Receive</span> <span class="keyword">implements</span> <span class="title">Runnable</span></span>&#123;</span><br><span class="line">	<span class="keyword">private</span> DataInputStream dis;<span class="comment">// 获得输入流</span></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">boolean</span> flag = <span class="keyword">true</span>;<span class="comment">//根据异常的情况，是否停止当前线程</span></span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">Receive</span><span class="params">(Socket socket)</span></span>&#123;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			dis = <span class="keyword">new</span> DataInputStream(socket.getInputStream());</span><br><span class="line">		&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">			flag = <span class="keyword">false</span>;</span><br><span class="line">			CloseUtil.closeAll(dis,socket);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">private</span> String <span class="title">getMessage</span><span class="params">()</span></span>&#123;</span><br><span class="line">		String str = <span class="string">""</span>;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			str = dis.readUTF();</span><br><span class="line">		&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">			flag = <span class="keyword">false</span>;</span><br><span class="line">			CloseUtil.closeAll(dis);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> str;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="comment">// TODO 自动生成的方法存根</span></span><br><span class="line">		<span class="keyword">while</span>(flag)&#123;</span><br><span class="line">			System.out.println(<span class="keyword">this</span>.getMessage());</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.szxy.chat.Client;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.BufferedInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.BufferedReader;</span><br><span class="line"><span class="keyword">import</span> java.io.DataInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.DataOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStreamReader;</span><br><span class="line"><span class="keyword">import</span> java.net.Socket;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 发送的线程</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> wzer</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Send</span> <span class="keyword">implements</span> <span class="title">Runnable</span></span>&#123;</span><br><span class="line">	<span class="keyword">private</span> BufferedReader br;<span class="comment">//从键盘获得输入流</span></span><br><span class="line">	<span class="keyword">private</span> DataOutputStream dos;<span class="comment">//发送数据</span></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">boolean</span> flag = <span class="keyword">true</span>;<span class="comment">//根据异常的情况，是否停止当前线程</span></span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">Send</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="comment">//获得键盘输入的信息，并使用缓冲流，从键盘中读入的字符类型数据</span></span><br><span class="line">		br = <span class="keyword">new</span> BufferedReader(<span class="keyword">new</span> InputStreamReader(System.in));</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">Send</span><span class="params">(Socket socket)</span></span>&#123;</span><br><span class="line">		<span class="keyword">this</span>();<span class="comment">//调用本类的无参构造函数</span></span><br><span class="line">		<span class="keyword">try</span> &#123;<span class="comment">//获得输出流</span></span><br><span class="line">			dos = <span class="keyword">new</span> DataOutputStream(socket.getOutputStream());</span><br><span class="line">		&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">			flag = <span class="keyword">false</span>;</span><br><span class="line">			CloseUtil.closeAll(dos,socket);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">//获得键盘输入的信息</span></span><br><span class="line">	<span class="function"><span class="keyword">private</span> String <span class="title">getMessage</span><span class="params">()</span></span>&#123;</span><br><span class="line">		String str=<span class="string">""</span>;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			str = br.readLine();</span><br><span class="line">		&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">			flag = <span class="keyword">false</span>;</span><br><span class="line">			CloseUtil.closeAll(br);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> str;	</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">// 发出键盘输入的信息</span></span><br><span class="line">	<span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">send</span><span class="params">(String str)</span></span>&#123;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			dos.writeUTF(str);</span><br><span class="line">			dos.flush();<span class="comment">// 刷新缓冲区</span></span><br><span class="line">		&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">			flag = <span class="keyword">false</span>;</span><br><span class="line">			CloseUtil.closeAll(dos);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="comment">// TODO 自动生成的方法存根</span></span><br><span class="line">		<span class="keyword">while</span>(flag)&#123;</span><br><span class="line">			<span class="keyword">this</span>.send(getMessage());</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.szxy.chat.Client;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.net.Socket;</span><br><span class="line"><span class="keyword">import</span> java.net.UnknownHostException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> UnknownHostException, IOException </span>&#123;</span><br><span class="line">		<span class="comment">//1 创建Socket对象</span></span><br><span class="line">		Socket socket = <span class="keyword">new</span> Socket(<span class="string">"localhost"</span>,<span class="number">9999</span>);</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//2 发送和接受</span></span><br><span class="line">		Send send = <span class="keyword">new</span> Send(socket);</span><br><span class="line">		Receive receive = <span class="keyword">new</span> Receive(socket);</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//3 启动线程</span></span><br><span class="line">		<span class="keyword">new</span> Thread(send).start();</span><br><span class="line">		<span class="keyword">new</span> Thread(receive).start();</span><br><span class="line">	</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.szxy.chat.Client;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.Closeable;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CloseUtil</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">closeAll</span><span class="params">(Closeable ... able)</span></span>&#123;</span><br><span class="line">		<span class="keyword">for</span>(Closeable c:able)&#123;</span><br><span class="line">			<span class="keyword">if</span>(c!=<span class="keyword">null</span>)&#123;</span><br><span class="line">				<span class="keyword">try</span> &#123;</span><br><span class="line">					c.close();</span><br><span class="line">				&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">					<span class="comment">// TODO 自动生成的 catch 块</span></span><br><span class="line">					e.printStackTrace();</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li><p>服务器端</p>
</li>
<li><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.szxy.chat.Server;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.DataInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.DataOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.net.Socket;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.print.attribute.standard.Severity;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 转发类</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> wzer</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Channel</span> <span class="keyword">implements</span> <span class="title">Runnable</span></span>&#123;</span><br><span class="line">	<span class="keyword">private</span> Socket socket;</span><br><span class="line">	<span class="keyword">private</span> DataInputStream dis;</span><br><span class="line">	<span class="keyword">private</span> DataOutputStream dos;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">boolean</span> flag = <span class="keyword">true</span>;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">Channel</span><span class="params">(Socket socket)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">		<span class="comment">// TODO 自动生成的构造函数存根</span></span><br><span class="line">		<span class="keyword">this</span>.socket = socket;</span><br><span class="line">		dis = <span class="keyword">new</span> DataInputStream(socket.getInputStream());</span><br><span class="line">		dos = <span class="keyword">new</span> DataOutputStream(socket.getOutputStream());</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">// 获得客户端的信息</span></span><br><span class="line">	<span class="function"><span class="keyword">private</span>  String <span class="title">receive</span><span class="params">()</span></span>&#123;</span><br><span class="line">		String str=<span class="string">""</span>;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			str = dis.readUTF();</span><br><span class="line">		&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">			CloseUtil.closeAll(dis);</span><br><span class="line">			flag = <span class="keyword">false</span>;</span><br><span class="line">			Server.list.remove(<span class="keyword">this</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> str;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">// 转发来自 客户端的信息</span></span><br><span class="line">	<span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">send</span><span class="params">(String str)</span></span>&#123;</span><br><span class="line">		<span class="keyword">if</span>(str!=<span class="keyword">null</span>&amp;&amp;(str.length()!=<span class="number">0</span>))&#123;</span><br><span class="line">			<span class="keyword">try</span> &#123;</span><br><span class="line">				dos.writeUTF(Thread.currentThread().getName()+<span class="string">" "</span>+ str);</span><br><span class="line">				dos.flush(); <span class="comment">//刷新 缓存</span></span><br><span class="line">			&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">				CloseUtil.closeAll(dos,dis);</span><br><span class="line">				flag = <span class="keyword">false</span>;</span><br><span class="line">				Server.list.remove(<span class="keyword">this</span>);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">sendOthers</span><span class="params">()</span></span>&#123;</span><br><span class="line">		String str = <span class="keyword">this</span>.receive();</span><br><span class="line">		List&lt;Channel&gt; list = Server.list;</span><br><span class="line">		<span class="keyword">for</span>(Channel c:list)&#123;</span><br><span class="line">			<span class="keyword">if</span>(c==<span class="keyword">this</span>)&#123;<span class="comment">//自己就不转发</span></span><br><span class="line">				<span class="keyword">continue</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			c.send(str);<span class="comment">//发送出去</span></span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">while</span>(flag)&#123;</span><br><span class="line">			<span class="comment">//this.send(this.receive());</span></span><br><span class="line">			<span class="keyword">this</span>.sendOthers();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.szxy.chat.Server;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.DataInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.DataOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.net.ServerSocket;</span><br><span class="line"><span class="keyword">import</span> java.net.Socket;</span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 服务器</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> wzer</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Server</span></span>&#123;</span><br><span class="line">	<span class="keyword">static</span> List&lt;Channel&gt; list = <span class="keyword">new</span> ArrayList&lt;Channel&gt;();</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">		<span class="comment">// 创建服务器对象</span></span><br><span class="line">		System.out.println(<span class="string">"----------开启服务器--------"</span>);</span><br><span class="line">		ServerSocket server = <span class="keyword">new</span> ServerSocket(<span class="number">9999</span>);</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//收发</span></span><br><span class="line">		<span class="keyword">while</span>(<span class="keyword">true</span>)&#123;	</span><br><span class="line">			Socket socket = server.accept();</span><br><span class="line">			Channel c = <span class="keyword">new</span> Channel(socket);</span><br><span class="line">			list.add(c);<span class="comment">//将客户端添加到集合中</span></span><br><span class="line">			</span><br><span class="line">			<span class="keyword">new</span> Thread(c).start();</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.szxy.chat.Server;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.Closeable;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CloseUtil</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">closeAll</span><span class="params">(Closeable ... able)</span></span>&#123;</span><br><span class="line">		<span class="keyword">for</span>(Closeable c:able)&#123;</span><br><span class="line">			<span class="keyword">if</span>(c!=<span class="keyword">null</span>)&#123;</span><br><span class="line">				<span class="keyword">try</span> &#123;</span><br><span class="line">					c.close();</span><br><span class="line">				&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">					<span class="comment">// TODO 自动生成的 catch 块</span></span><br><span class="line">					e.printStackTrace();</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="10-UDP-协议-–模拟在线客服聊天"><a href="#10-UDP-协议-–模拟在线客服聊天" class="headerlink" title="10  UDP 协议 –模拟在线客服聊天"></a>10  UDP 协议 –模拟在线客服聊天</h4><p>1) 不需要利用 IO 流实现数据的传输</p>
<p>2) 每个数据发送单元被统一封装成数据包的方式，发送方将</p>
<p>数据包发送到网络中，数据包在网络中去寻找他的目的地。</p>
<p>3) <code>DatagramSocket</code>：用于发送或接收数据包</p>
<p>4) <code>DatagramPacket</code>：数据包</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.szxy.UDP;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.net.DatagramPacket;</span><br><span class="line"><span class="keyword">import</span> java.net.DatagramSocket;</span><br><span class="line"><span class="keyword">import</span> java.net.InetAddress;</span><br><span class="line"><span class="keyword">import</span> java.net.SocketException;</span><br><span class="line"><span class="keyword">import</span> java.util.Scanner;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 发送方</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> wzer</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test1</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">		<span class="comment">//创建Socke	</span></span><br><span class="line">		System.out.println(<span class="string">"发送方--------&gt;"</span>);</span><br><span class="line">		Scanner input = <span class="keyword">new</span> Scanner(System.in);</span><br><span class="line">		DatagramSocket ds = <span class="keyword">new</span> DatagramSocket(<span class="number">8888</span>);</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">while</span>(<span class="keyword">true</span>)&#123;<span class="comment">//实现多次聊天</span></span><br><span class="line">			String in = input.next();</span><br><span class="line">			<span class="keyword">byte</span>[] buf = in.getBytes();	</span><br><span class="line">	                        		<span class="comment">// 发送数据  发多少 发往那个主机  端口号    		    </span></span><br><span class="line">			DatagramPacket dp = <span class="keyword">new</span> DatagramPacket(buf,buf.length, InetAddress.getByName(<span class="string">"localhost"</span>), <span class="number">8999</span>);</span><br><span class="line">			ds.send(dp);</span><br><span class="line">			</span><br><span class="line">			<span class="comment">//准备接收数据</span></span><br><span class="line">			<span class="keyword">byte</span>[] buf2 = <span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">1024</span>];</span><br><span class="line">			</span><br><span class="line">			DatagramPacket dp2 = <span class="keyword">new</span> DatagramPacket(buf2, buf2.length, dp.getAddress(), dp.getPort());</span><br><span class="line">			<span class="comment">//接收数据</span></span><br><span class="line">			ds.receive(dp2);</span><br><span class="line">			</span><br><span class="line">			String  str = <span class="keyword">new</span> String(dp2.getData(),<span class="number">0</span>,dp2.getLength());</span><br><span class="line">			System.out.println(<span class="string">"客服: "</span>+str);</span><br><span class="line">			</span><br><span class="line">			<span class="keyword">if</span>(str.equals(<span class="string">"bye"</span>))&#123;</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="comment">//关闭</span></span><br><span class="line">		ds.close();</span><br><span class="line">		</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.szxy.UDP;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.net.DatagramPacket;</span><br><span class="line"><span class="keyword">import</span> java.net.DatagramSocket;</span><br><span class="line"><span class="keyword">import</span> java.net.SocketException;</span><br><span class="line"><span class="keyword">import</span> java.util.Scanner;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 接受方</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> wzer</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test2</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"接收方 ----&gt;"</span>);</span><br><span class="line">		DatagramSocket ds = <span class="keyword">new</span> DatagramSocket(<span class="number">8999</span>);</span><br><span class="line">		Scanner input = <span class="keyword">new</span> Scanner(System.in);</span><br><span class="line">		<span class="keyword">while</span>(<span class="keyword">true</span>)&#123;</span><br><span class="line">			<span class="comment">//准备接收数据</span></span><br><span class="line">			<span class="keyword">byte</span>[] buf = <span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">1024</span>];</span><br><span class="line">			<span class="comment">// 接收数据</span></span><br><span class="line">			DatagramPacket dp = <span class="keyword">new</span> DatagramPacket(buf,buf.length);</span><br><span class="line">			<span class="comment">//接受数据</span></span><br><span class="line">			ds.receive(dp);</span><br><span class="line">			String str = <span class="keyword">new</span> String(dp.getData(),<span class="number">0</span>,dp.getLength());</span><br><span class="line">			System.out.println(<span class="string">"发送方: "</span>+str);</span><br><span class="line">			</span><br><span class="line">			<span class="comment">//准备发送 数据</span></span><br><span class="line">			String in = input.next();</span><br><span class="line">			<span class="keyword">byte</span>[] buf2 = in.getBytes();	</span><br><span class="line">			</span><br><span class="line">			<span class="comment">//发送方的IP地址和端口号，之前已经发过来了</span></span><br><span class="line">			DatagramPacket dp2 = <span class="keyword">new</span> DatagramPacket(buf2,<span class="number">0</span>,buf2.length,dp.getAddress(),dp.getPort());</span><br><span class="line">			<span class="comment">//发送数据</span></span><br><span class="line">			ds.send(dp2);</span><br><span class="line">			</span><br><span class="line">			<span class="keyword">if</span>(str.equals(<span class="string">"bye"</span>))&#123;</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="comment">//ds.close();</span></span><br><span class="line">		&#125;</span><br><span class="line">			ds.close();</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


        
      
    </div>

    
    
    
      <footer class="post-footer">
          <div class="post-eof"></div>
        
      </footer>
  </div>
  
  
  
  </article>

    
        <article itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block home">
    <link itemprop="mainEntityOfPage" href="http://zwer.xyz/2018/11/12/Java/20181112 多线程技术/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="zwer">
      <meta itemprop="description" content="记录学习的日常">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="zwer 的博客空间">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
            
            <a href="/2018/11/12/Java/20181112 多线程技术/" class="post-title-link" itemprop="url">20181112 多线程技术</a>
          
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              
                
              

              <time title="Created: 2018-11-12 19:00:00" itemprop="dateCreated datePublished" datetime="2018-11-12T19:00:00+08:00">2018-11-12</time>
            </span>
          
            

            
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2018-11-14 18:55:23" itemprop="dateModified" datetime="2018-11-14T18:55:23+08:00">2018-11-14</time>
              </span>
            
          

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h4 id="1-多线程的概念"><a href="#1-多线程的概念" class="headerlink" title="1 多线程的概念"></a>1 多线程的概念</h4><h5 id="1-1-多线程的概念"><a href="#1-1-多线程的概念" class="headerlink" title="1.1 多线程的概念"></a>1.1 多线程的概念</h5><p>程序：Program，是一个指令的集合</p>
<p>进程：Process，(正在执行中的程序)(正在执行中的程序)是一个静态的概念。</p>
<p>进程是程序的一次静态态执行过程, 占用特定的地址空间.每个进程都是独立的，由 3 部分组成 cpu,data,code</p>
<p>缺点：内存的浪费，CPU 的负担</p>
<p>线程:是进程中一个“单一的连续控制流程” (a singlesThread,equential flow of control)/执行路径<br>线程又被称为轻量级进程(lightweight process)。</p>
<p>Threads run at the same time, independently of one another<br>一个进程可拥有多个并行的(concurrent)线程</p>
<p>一个进程中的线程共享相同的内存单元/内存地址空间?可以访问相同的变量和对象</p>
<p>而且它们从同一堆中分配对象 通信、数据交换、同步操作</p>
<p>由于线程间的通信是在同一地址空间上进行的，</p>
<p>所以不需要额外的通信机制，这就使得通信更简便而且信息传递的速度也更快</p>
<h5 id="1-2-进程与线程的区别"><a href="#1-2-进程与线程的区别" class="headerlink" title="1.2  进程与线程的区别"></a>1.2  进程与线程的区别</h5><p><img src="C:%5CUsers%5CLenovo%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1542029085567.png" alt="1542029085567"></p>
<h5 id="注意"><a href="#注意" class="headerlink" title="注意"></a>注意</h5><p>一个进程中包含了N个多，线程，如果线程关闭，进程不一定关闭</p>
<p>但是如果进程关闭了，线程一定关闭</p>
<p>CPU 调度执行的是线程</p>
<h4 id="2-通过继承Thread类实现多线程"><a href="#2-通过继承Thread类实现多线程" class="headerlink" title="2 通过继承Thread类实现多线程"></a>2 通过继承Thread类实现多线程</h4><h5 id="2-1-实现多线程的步骤"><a href="#2-1-实现多线程的步骤" class="headerlink" title="2.1 实现多线程的步骤"></a>2.1 实现多线程的步骤</h5><p>1 继承类Thread</p>
<p>2 重写run方法       </p>
<p>3 通过start方法启动线程</p>
<p>run方法中代码块都是线程体</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">		<span class="keyword">package</span> cn.szxy.thread;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> *线程类 </span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyThread</span> <span class="keyword">extends</span> <span class="title">Thread</span></span>&#123;</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	    <span class="comment">//线程体</span></span><br><span class="line">		<span class="keyword">int</span> i=<span class="number">0</span>;</span><br><span class="line">		<span class="keyword">while</span>(i&lt;<span class="number">10</span>)&#123;</span><br><span class="line">			System.out.println(<span class="string">"---MyThread---"</span>+i);</span><br><span class="line">			i++;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.szxy.thread;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 线程类   </span></span><br><span class="line"><span class="comment"> * cpu根据时间片的大小 </span></span><br><span class="line"><span class="comment"> * 让主线程和从线程交换执行</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> wzer</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;<span class="comment">//主线程</span></span><br><span class="line">		MyThread mt = <span class="keyword">new</span> MyThread();</span><br><span class="line">		mt.start();<span class="comment">//启动线程    也是从线程</span></span><br><span class="line">		<span class="keyword">int</span> i =<span class="number">0</span>;</span><br><span class="line">		<span class="keyword">while</span>(i &lt; <span class="number">10</span>)&#123;</span><br><span class="line">			i++;</span><br><span class="line">			System.out.println(<span class="string">"---main----"</span>+i);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>缺点：由于Java中的继承是单继承，所以当继承Thread类，就不能再继承其他类了</p>
<h4 id="3-通过实现接口-Runnable-实现多线程"><a href="#3-通过实现接口-Runnable-实现多线程" class="headerlink" title="3 通过实现接口 Runnable 实现多线程"></a>3 通过实现接口 Runnable 实现多线程</h4><h5 id="3-1-实现-Runnable-接口实现多线程"><a href="#3-1-实现-Runnable-接口实现多线程" class="headerlink" title="3.1 实现 Runnable 接口实现多线程"></a>3.1 实现 Runnable 接口实现多线程</h5><p>1 实现 Runnable</p>
<p>2 重写 run  方法</p>
<p>3 通过 Thread类的 构造方法 ，再使用 start方法启动线程</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.szxy.runnable;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 通过实现 Runable 接口 实现多线程</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> wzer</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyRunnable</span> <span class="keyword">implements</span> <span class="title">Runnable</span></span>&#123;</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="comment">// TODO 自动生成的方法存根</span></span><br><span class="line">		<span class="keyword">int</span> i=<span class="number">0</span>;</span><br><span class="line">		<span class="keyword">while</span>(i&lt;<span class="number">10</span>)&#123;</span><br><span class="line">			System.out.println(<span class="string">"---MyRunnable---"</span>+i);</span><br><span class="line">			i++;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.szxy.runnable;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 测试类</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> wzer</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		MyRunnable mr = <span class="keyword">new</span> MyRunnable();</span><br><span class="line">	</span><br><span class="line">		<span class="keyword">new</span> Thread(mr).start();<span class="comment">//从线程</span></span><br><span class="line">		</span><br><span class="line">		main(); <span class="comment">//主线程</span></span><br><span class="line">		</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">		<span class="keyword">int</span> i=<span class="number">0</span>;</span><br><span class="line">		<span class="keyword">while</span>(i&lt;<span class="number">10</span>)&#123;</span><br><span class="line">			System.out.println(<span class="string">"---main---"</span>+i);</span><br><span class="line">			i++;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="3-2-静态代理模式"><a href="#3-2-静态代理模式" class="headerlink" title="3.2 静态代理模式"></a>3.2 静态代理模式</h5><p>Thread -&gt; 代理角色</p>
<p><code>MyRunable</code> -&gt; 真实角色</p>
<p>代理角色与真实角色实现共同的接口 Runnable 接口</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.szxy.runnable.proxy;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 接口</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> wzer</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Marry</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">marry</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.szxy.runnable.proxy;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * 真实类  靠代理类帮助的</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">You</span> <span class="keyword">implements</span> <span class="title">Marry</span></span>&#123;</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">marry</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="comment">// TODO 自动生成的方法存根</span></span><br><span class="line">		System.out.println(<span class="string">"恭喜你与xxx喜结良缘"</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">package</span> cn.szxy.runnable.proxy;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * 代理类  帮助真实类做事情</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MarryCompany</span> <span class="keyword">implements</span> <span class="title">Marry</span></span>&#123;</span><br><span class="line">	<span class="keyword">private</span> Marry m;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">MarryCompany</span><span class="params">(Marry m)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.m = m;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">marry</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="comment">// TODO 自动生成的方法存根</span></span><br><span class="line">		before();</span><br><span class="line">		m.marry();</span><br><span class="line">		after();</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">before</span><span class="params">()</span></span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"婚前准备。。。。"</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span>  <span class="keyword">void</span> <span class="title">after</span><span class="params">()</span></span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"婚后收拾。。。。"</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.szxy.runnable.proxy;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 静态代理</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> wzer</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		Marry  mr = <span class="keyword">new</span> You();</span><br><span class="line">		</span><br><span class="line">		MarryCompany mrc = <span class="keyword">new</span> MarryCompany(mr);</span><br><span class="line">		</span><br><span class="line">		mrc.marry();</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="4-线程状态-线程的生命周期"><a href="#4-线程状态-线程的生命周期" class="headerlink" title="4 线程状态 线程的生命周期"></a>4 线程状态 线程的生命周期</h4><h5 id="4-1-线程状态"><a href="#4-1-线程状态" class="headerlink" title="4.1  线程状态"></a>4.1  线程状态</h5><p>新生状态  new创建线程类的对象</p>
<p>就绪状态  start方法启用  万事具备，只欠”CPU”    有资格，无资源</p>
<p>运行状态    有资格，有资源</p>
<p>阻塞状态    无资格,”让”资源</p>
<p>终止状态/死亡状态</p>
<p><img src="C:%5CUsers%5CLenovo%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1542025685034.png" alt="1542025685034"></p>
<p>总结：</p>
<p>1 线程不知道什么时候会被选中执行</p>
<p>2 遇到等待 IO 输入或其他的阻塞状态，由运行状态进入阻塞状态</p>
<p>3 导致阻塞的事件结果，就绪状态，等待 CPU 选中</p>
<p>4 运行状态，给定的时间片内没有执行完 run 方法中的代码，进入就绪状态，下一次被CPU选中，从上次”断”掉的地方，继续执行</p>
<h4 id="5-多线程的安全性问题"><a href="#5-多线程的安全性问题" class="headerlink" title="5 多线程的安全性问题"></a>5 多线程的安全性问题</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.szxy.ticket;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 卖票了</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> wzer</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestTicket</span>  <span class="keyword">implements</span> <span class="title">Runnable</span></span>&#123;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">int</span> ticket = <span class="number">100</span>;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;<span class="number">100</span>;i++)&#123;</span><br><span class="line">			<span class="keyword">if</span>(ticket!=<span class="number">0</span>)</span><br><span class="line">				System.out.println(Thread.currentThread().getName()+<span class="string">"卖出第"</span>+ticket--+<span class="string">"片"</span>);	</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.szxy.ticket;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		TestTicket tt = <span class="keyword">new</span> TestTicket();</span><br><span class="line">		</span><br><span class="line">			<span class="keyword">new</span> Thread(tt,<span class="string">"A 窗口"</span>).start();</span><br><span class="line">			<span class="keyword">new</span> Thread(tt,<span class="string">"B 窗口"</span>).start();</span><br><span class="line">			<span class="keyword">new</span> Thread(tt,<span class="string">"C 窗口"</span>).start();</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>总结：由于时间片的问题，线程每次开始的位置都是上次停下来的位置然后继续往后执行，</p>
<p>若此时票数为 1 ，则可能出现 票数为负数的情形，还有多个窗口卖同一张票的情况，主要由于线程的安全性差，虽然速度较快。</p>
<p>所以必须控制 线程对票的使用 </p>
<h4 id="6-获取线程基本信息的方法"><a href="#6-获取线程基本信息的方法" class="headerlink" title="6 获取线程基本信息的方法"></a>6 获取线程基本信息的方法</h4><h5 id="6-1-线程操作的常用方法"><a href="#6-1-线程操作的常用方法" class="headerlink" title="6.1 线程操作的常用方法"></a>6.1 线程操作的常用方法</h5><p>Thread类的<code>toString</code>方法  得到[线程名称，线程优先级，线程组名称]</p>
<p>Thread类的<code>getName</code>方法  获取线程的名称</p>
<p>Thread类的 <code>isAlive</code> 方法 判断线程是否处于活动状态</p>
<p><img src="C:%5CUsers%5CLenovo%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1542027413891.png" alt="1542027413891"></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.szxy.method;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 线程类</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> wzer</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyRunnable</span> <span class="keyword">implements</span> <span class="title">Runnable</span></span>&#123;</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="comment">// TODO 自动生成的方法存根</span></span><br><span class="line">		show();</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">show</span><span class="params">()</span></span>&#123;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;<span class="number">11</span>;i++)&#123;</span><br><span class="line">			System.out.println(Thread.currentThread().getName()+<span class="string">"-&gt;"</span>+i);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.szxy.method;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * 测试Thread类的方法</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestThradmethod</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		<span class="comment">//currentThread()方法会调用Thread类的toString方法，</span></span><br><span class="line">		<span class="comment">//得到[线程名 线程优先级 线程组名]</span></span><br><span class="line">		System.out.println(<span class="string">"获得本线程"</span>+Thread.currentThread());</span><br><span class="line">		</span><br><span class="line">		MyRunnable mr = <span class="keyword">new</span> MyRunnable();</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//创建线程</span></span><br><span class="line">		Thread t1 = <span class="keyword">new</span> Thread(mr);</span><br><span class="line">		System.out.println(<span class="string">"mr线程存在的状态: "</span>+t1.isAlive());</span><br><span class="line">		<span class="comment">//启动线程</span></span><br><span class="line">		t1.start();</span><br><span class="line">		System.out.println(<span class="string">"mr线程存在的状态: "</span>+t1.isAlive());</span><br><span class="line">		main();<span class="comment">//主线程</span></span><br><span class="line">		</span><br><span class="line">		System.out.println(<span class="string">"mr线程存在的状态: "</span>+t1.isAlive());</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;<span class="number">11</span>;i++)&#123;</span><br><span class="line">			System.out.println(Thread.currentThread().getName()+<span class="string">"-----&gt;"</span>+i);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="7-暂停线程的方法-sleep方法"><a href="#7-暂停线程的方法-sleep方法" class="headerlink" title="7 暂停线程的方法 sleep方法"></a>7 暂停线程的方法 sleep方法</h4><h5 id="7-1-暂停线程的方法"><a href="#7-1-暂停线程的方法" class="headerlink" title="7.1 暂停线程的方法"></a>7.1 暂停线程的方法</h5><p>Thread类的join方法</p>
<p>导致调用它的线程会进入阻塞状态，但不会影响其他线程的状态。</p>
<p>Thread类的sleep方法</p>
<p>导致线程进入阻塞状态 在哪个线程就对哪个线程起作用</p>
<p>Thread类的yield方法</p>
<p>暂时使用 CPU</p>
<p><img src="C:%5CUsers%5CLenovo%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1542030235907.png" alt="1542030235907"></p>
<p>​    </p>
<h4 id="8-线程访问的优先级"><a href="#8-线程访问的优先级" class="headerlink" title="8 线程访问的优先级"></a>8 线程访问的优先级</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.szxy.priority;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> cn.szxy.runnable.MyRunnable;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestPriority</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"最高优先级："</span>+Thread.MAX_PRIORITY);</span><br><span class="line">		System.out.println(<span class="string">"最低优先级："</span>+Thread.MIN_PRIORITY);</span><br><span class="line">		System.out.println(<span class="string">"最低优先级："</span>+Thread.currentThread().getPriority());</span><br><span class="line">		</span><br><span class="line">		Thread t1 = <span class="keyword">new</span> Thread(<span class="keyword">new</span> MyRunnable());</span><br><span class="line">		System.out.println(<span class="string">"设置线程t1的当前的优先级"</span>);</span><br><span class="line">		t1.setPriority(<span class="number">8</span>);</span><br><span class="line">		System.out.println(<span class="string">"当前线程t1的优先级："</span>+t1.getPriority());</span><br><span class="line">		t1.start();</span><br><span class="line">		main();</span><br><span class="line">		<span class="comment">/**</span></span><br><span class="line"><span class="comment">		 * 优先级越高有可能先被调度，但不一定</span></span><br><span class="line"><span class="comment">		 */</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">		<span class="keyword">int</span> i=<span class="number">0</span>;</span><br><span class="line">		<span class="keyword">while</span>(i&lt;<span class="number">10</span>)&#123;</span><br><span class="line">			System.out.println(<span class="string">"main----&gt; "</span>+i);</span><br><span class="line">			i++;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="9-线程同步-具体实现"><a href="#9-线程同步-具体实现" class="headerlink" title="9 线程同步 具体实现"></a>9 线程同步 具体实现</h4><h5 id="9-1-同步代码块"><a href="#9-1-同步代码块" class="headerlink" title="9.1  同步代码块"></a>9.1  同步代码块</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.szxy.ticket;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 卖票了</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> wzer</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestTicket1</span>  <span class="keyword">implements</span> <span class="title">Runnable</span></span>&#123;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">int</span> ticket = <span class="number">100</span>;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">synchronized</span> (<span class="keyword">this</span>) &#123;<span class="comment">//同步代码块 监视这个 TestTicket1 对象</span></span><br><span class="line">			<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;<span class="number">100</span>;i++)&#123;<span class="comment">//每个窗口排了一百个人</span></span><br><span class="line">				<span class="keyword">if</span>(ticket &gt; <span class="number">0</span>)&#123;</span><br><span class="line">					<span class="keyword">try</span> &#123;</span><br><span class="line">						Thread.sleep(<span class="number">40</span>);</span><br><span class="line">					&#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">						<span class="comment">// TODO 自动生成的 catch 块</span></span><br><span class="line">						e.printStackTrace();</span><br><span class="line">					&#125;</span><br><span class="line">					System.out.println(Thread.currentThread().getName()+<span class="string">"卖出第"</span>+ticket--+<span class="string">"片"</span>);</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="9-2-同步方法"><a href="#9-2-同步方法" class="headerlink" title="9.2  同步方法"></a>9.2  同步方法</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.szxy.ticket;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 卖票了</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> wzer</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestTicket2</span>  <span class="keyword">implements</span> <span class="title">Runnable</span></span>&#123;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">int</span> ticket = <span class="number">100</span>;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">synchronized</span> (<span class="keyword">this</span>) &#123;<span class="comment">//同步代码块 监视这个 TestTicket1 对象</span></span><br><span class="line">			<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;<span class="number">100</span>;i++)&#123;<span class="comment">//每个窗口排了一百个人</span></span><br><span class="line">				sellTicket();</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">private</span> <span class="keyword">synchronized</span> <span class="keyword">void</span> <span class="title">sellTicket</span><span class="params">()</span></span>&#123;</span><br><span class="line">		<span class="keyword">if</span>(ticket &gt; <span class="number">0</span>)&#123;</span><br><span class="line">			<span class="keyword">try</span> &#123;</span><br><span class="line">				Thread.sleep(<span class="number">40</span>);</span><br><span class="line">			&#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">				<span class="comment">// TODO 自动生成的 catch 块</span></span><br><span class="line">				e.printStackTrace();</span><br><span class="line">			&#125;</span><br><span class="line">			System.out.println(Thread.currentThread().getName()+<span class="string">"卖出第"</span>+ticket--+<span class="string">"片"</span>);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.szxy.ticket;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		TestTicket2 tt = <span class="keyword">new</span> TestTicket2();</span><br><span class="line">		</span><br><span class="line">			<span class="keyword">new</span> Thread(tt,<span class="string">"A 窗口"</span>).start();</span><br><span class="line">			<span class="keyword">new</span> Thread(tt,<span class="string">"B 窗口"</span>).start();</span><br><span class="line">			<span class="keyword">new</span> Thread(tt,<span class="string">"C 窗口"</span>).start();</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>同步监视器只能是对象 ，推荐使用共享资源的对象</p>
<p>可以当前对象this，也可以是其它的对象</p>
<h4 id="10-死锁"><a href="#10-死锁" class="headerlink" title="10  死锁"></a>10  死锁</h4><h5 id="10-1-死锁原因"><a href="#10-1-死锁原因" class="headerlink" title="10.1 死锁原因"></a>10.1 死锁原因</h5><p>由于两个对象之间相互竞争资源，并且竞争资源是对方所有加锁的</p>
<p><img src="https://gss2.bdstatic.com/-fo3dSag_xI4khGkpoWK1HF6hhy/baike/c0%3Dbaike80%2C5%2C5%2C80%2C26/sign=7a4ee20578cb0a46912f836b0a0a9d41/810a19d8bc3eb1354547b744a51ea8d3fc1f4448.jpg" alt="1542192667000"></p>
<h5 id="10-2-死锁避免"><a href="#10-2-死锁避免" class="headerlink" title="10.2  死锁避免"></a>10.2  死锁避免</h5><p>不要让两个对象同时持有对象锁，采用<strong>互斥</strong>方式来解决</p>
<h5 id="10-2-银行家算法"><a href="#10-2-银行家算法" class="headerlink" title="10.2 银行家算法"></a>10.2 银行家算法</h5><p>该算法需要检查申请者对资源的最大需求量，如果系统现存的各类资源可以满足申请者的请求，就满足申请者的请求。这样申请者就可很快完成其计算，然后释放它<br>占用的资源，从而保证了系统中的所有进程都能完成，所以可避免死锁的发生（计算资源的大小，计算出来后，永远按照从大到小的方式来获得锁）</p>
<h4 id="11-生产者和消费者模式"><a href="#11-生产者和消费者模式" class="headerlink" title="11  生产者和消费者模式"></a>11  生产者和消费者模式</h4><p>单缓冲区  生产一个消费一个，模拟生产者和消费者问题</p>
<p>数据错乱 的解决方法   -&gt; 线程同步</p>
<h5 id="11-1-生产者-消费者模式产生的问题"><a href="#11-1-生产者-消费者模式产生的问题" class="headerlink" title="11.1 生产者-消费者模式产生的问题"></a>11.1 生产者-消费者模式产生的问题</h5><p> 重复生产和重复取走解决方案 -&gt; 线程间的通信</p>
<h5 id="11-2-线程间通信的方法"><a href="#11-2-线程间通信的方法" class="headerlink" title="11.2 线程间通信的方法"></a>11.2 线程间通信的方法</h5><p>wait():调用了 wait()方法的线程进入等待池进池中的线程不去竞争对象锁,直到其它的线程通锁池</p>
<p>notify():随机唤醒一个在该对象上等待的线程程进行锁池，开始竞争该对锁上的锁</p>
<p><code>notifyAll():</code>唤醒所有在该对象上等待的线程优先级高的线程有可能先竞争到对象锁</p>
<p>只能在同步方法和同步代码块中</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.szxy.productcustom;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 商品类 </span></span><br><span class="line"><span class="comment"> * 共享资源</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> wzer</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Goods</span> </span>&#123;</span><br><span class="line">	<span class="keyword">private</span> String brand;<span class="comment">//名称</span></span><br><span class="line">	<span class="keyword">private</span> String name;<span class="comment">// 名字</span></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">boolean</span> isflag=<span class="keyword">false</span>; <span class="comment">//判断是否有商品生产出来  默认没有商品生产出来</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">Goods</span><span class="params">(String brand, String name)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">super</span>();</span><br><span class="line">		<span class="keyword">this</span>.brand = brand;</span><br><span class="line">		<span class="keyword">this</span>.name = name;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">Goods</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">super</span>();</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getBrand</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> brand;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setBrand</span><span class="params">(String brand)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.brand = brand;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> name;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.name = name;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">//同步监视器   同步方法解决了数据错乱的问题</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">synchronized</span> <span class="keyword">void</span> <span class="title">setGoods</span><span class="params">(String brand, String name)</span></span>&#123;</span><br><span class="line">			<span class="keyword">if</span>(isflag)&#123;</span><br><span class="line">				<span class="keyword">try</span> &#123;</span><br><span class="line">					<span class="keyword">super</span>.wait();</span><br><span class="line">				&#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">					<span class="comment">// TODO 自动生成的 catch 块</span></span><br><span class="line">					e.printStackTrace();</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">this</span>.setBrand(brand);</span><br><span class="line">			System.out.print(<span class="string">"生产"</span>+<span class="keyword">this</span>.brand+<span class="string">"牌的--"</span>);</span><br><span class="line">			<span class="keyword">try</span> &#123;</span><br><span class="line">				Thread.sleep(<span class="number">300</span>);</span><br><span class="line">			&#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">				<span class="comment">// TODO 自动生成的 catch 块</span></span><br><span class="line">				e.printStackTrace();</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">this</span>.setName(name);		</span><br><span class="line">			System.out.print(name+<span class="string">"产品\n"</span>);</span><br><span class="line">			<span class="keyword">super</span>.notify();</span><br><span class="line">			<span class="keyword">this</span>.isflag = <span class="keyword">true</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span>   <span class="keyword">synchronized</span> <span class="keyword">void</span> <span class="title">getGoods</span><span class="params">()</span></span>&#123;</span><br><span class="line">		<span class="keyword">if</span>(!isflag)&#123;</span><br><span class="line">			<span class="keyword">try</span> &#123;</span><br><span class="line">				<span class="keyword">super</span>.wait();</span><br><span class="line">			&#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">				<span class="comment">// TODO 自动生成的 catch 块</span></span><br><span class="line">				e.printStackTrace();</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		System.out.println(<span class="string">"消费了"</span>+<span class="keyword">this</span>.getBrand() +<span class="string">"的"</span>+<span class="keyword">this</span>.getName());</span><br><span class="line">		<span class="keyword">super</span>.notify();</span><br><span class="line">		<span class="keyword">this</span>.isflag = <span class="keyword">false</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">	<span class="keyword">package</span> cn.szxy.productcustom;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> *生产者 </span></span><br><span class="line"><span class="comment"> *生产商品</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Producter</span> <span class="keyword">extends</span> <span class="title">Thread</span></span>&#123;</span><br><span class="line">	<span class="keyword">private</span> Goods g;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">Producter</span><span class="params">(Goods g)</span> </span>&#123;</span><br><span class="line">		<span class="comment">// TODO 自动生成的构造函数存根</span></span><br><span class="line">		<span class="keyword">this</span>.g =g;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;<span class="number">10</span>;i++)&#123;</span><br><span class="line">			<span class="keyword">if</span>(i%<span class="number">2</span>!=<span class="number">0</span>)&#123;</span><br><span class="line">				<span class="comment">/*System.out.println("生产旺仔牌--");</span></span><br><span class="line"><span class="comment">				g.setBrand("旺仔");</span></span><br><span class="line"><span class="comment">				try &#123;</span></span><br><span class="line"><span class="comment">					Thread.sleep(300);</span></span><br><span class="line"><span class="comment">				&#125; catch (InterruptedException e) &#123;</span></span><br><span class="line"><span class="comment">					// TODO 自动生成的 catch 块</span></span><br><span class="line"><span class="comment">					e.printStackTrace();</span></span><br><span class="line"><span class="comment">				&#125;</span></span><br><span class="line"><span class="comment">				System.out.print("小馒头\n");</span></span><br><span class="line"><span class="comment">				g.setBrand("小馒头");*/</span></span><br><span class="line">				</span><br><span class="line">				g.setGoods(<span class="string">"旺仔"</span>,<span class="string">"小馒头"</span>);</span><br><span class="line">			</span><br><span class="line">				</span><br><span class="line">			&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">				<span class="comment">/*System.out.println("生产娃哈哈牌-- ");</span></span><br><span class="line"><span class="comment">				g.setBrand("娃哈哈");</span></span><br><span class="line"><span class="comment">				try &#123;</span></span><br><span class="line"><span class="comment">					Thread.sleep(300);</span></span><br><span class="line"><span class="comment">				&#125; catch (InterruptedException e) &#123;</span></span><br><span class="line"><span class="comment">					// TODO 自动生成的 catch 块</span></span><br><span class="line"><span class="comment">					e.printStackTrace();</span></span><br><span class="line"><span class="comment">				&#125;</span></span><br><span class="line"><span class="comment">				System.out.print("矿泉水\n");</span></span><br><span class="line"><span class="comment">				g.setBrand("矿泉水");*/</span></span><br><span class="line">				g.setGoods(<span class="string">"娃哈哈"</span>, <span class="string">"矿泉水"</span>);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.szxy.productcustom;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 消费者 消费商品</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> wzer</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Customer</span> <span class="keyword">extends</span> <span class="title">Thread</span></span>&#123;</span><br><span class="line">	<span class="keyword">private</span> Goods g;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">Customer</span><span class="params">(Goods g)</span> </span>&#123;</span><br><span class="line">		<span class="comment">// TODO 自动生成的构造函数存根</span></span><br><span class="line">		<span class="keyword">this</span>.g = g;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;<span class="number">10</span>;i++)&#123;</span><br><span class="line">			g.getGoods();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.szxy.productcustom;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 测试类</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> wzer</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		<span class="comment">//共享资源</span></span><br><span class="line">		Goods g = <span class="keyword">new</span> Goods();</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//生产者和消费者</span></span><br><span class="line">		Producter p = <span class="keyword">new</span> Producter(g);</span><br><span class="line">		Customer c = <span class="keyword">new</span> Customer(g);</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//开始线程</span></span><br><span class="line">		p.start();</span><br><span class="line">		c.start();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


        
      
    </div>

    
    
    
      <footer class="post-footer">
          <div class="post-eof"></div>
        
      </footer>
  </div>
  
  
  
  </article>

    
        <article itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block home">
    <link itemprop="mainEntityOfPage" href="http://zwer.xyz/2018/11/09/Java/20181109 IO 技术/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="zwer">
      <meta itemprop="description" content="记录学习的日常">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="zwer 的博客空间">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
            
            <a href="/2018/11/09/Java/20181109 IO 技术/" class="post-title-link" itemprop="url">IO 流技术</a>
          
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              
                
              

              <time title="Created: 2018-11-09 00:00:00" itemprop="dateCreated datePublished" datetime="2018-11-09T00:00:00+08:00">2018-11-09</time>
            </span>
          
            

            
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2018-11-11 12:36:20" itemprop="dateModified" datetime="2018-11-11T12:36:20+08:00">2018-11-11</time>
              </span>
            
          

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h4 id="1-IO-基本概念"><a href="#1-IO-基本概念" class="headerlink" title="1 IO 基本概念"></a>1 IO 基本概念</h4><h5 id="1-1-流的概念"><a href="#1-1-流的概念" class="headerlink" title="1.1 流的概念"></a>1.1 流的概念</h5><p>1 数据的输入/输出操作以流 Stream 的方法</p>
<p>2 流的种类很多  </p>
<p>3 Java 的流类型一般位于 java.io 包中</p>
<h5 id="1-2-流的概念"><a href="#1-2-流的概念" class="headerlink" title="1.2 流的概念"></a>1.2 流的概念</h5><h5 id="数据源"><a href="#数据源" class="headerlink" title="数据源"></a>数据源</h5><p>1 data source 提供原始数据的原始媒介。 常见：数据库</p>
<p>2 流是一个抽象、动态的概念，是一串连续动态的数据集合</p>
<p><img src="C:%5CUsers%5CLenovo%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1541761010135.png" alt="1541761010135"></p>
<h4 id="2-流概念细分和体系-四大抽象类"><a href="#2-流概念细分和体系-四大抽象类" class="headerlink" title="2 流概念细分和体系 四大抽象类"></a>2 流概念细分和体系 四大抽象类</h4><h5 id="2-1-流的分类"><a href="#2-1-流的分类" class="headerlink" title="2.1 流的分类"></a>2.1 流的分类</h5><p><strong>流的方向</strong>：</p>
<p>1 输入流： 数据源到程序(<code>InputStream</code> Reader)</p>
<p>2 输出流： 程序到目的地( <code>OutStream</code>  Writer)</p>
<p><strong>处理数据单元</strong>：</p>
<p>1 字节流：按照字节读取数据</p>
<p>2 字符流：按照字符读取数据</p>
<p><img src="C:%5CUsers%5CLenovo%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1541761344592.png" alt="1541761344592"></p>
<p>注意：输入输出是相对于<strong>程序</strong>而言，而不是相对源或目的地</p>
<p><strong>功能分类</strong>：</p>
<p>节点流：可以直接从数据源或目的地读写数据</p>
<p>处理流：不直接连接到数据源或目的地，是其他流进行封装。目的主要是简化操作和提高性能.</p>
<p>节点流与处理流的关系：</p>
<p>1 节点流:节点流处于IO操作的第一线，所有操作必须经过它们处理可行</p>
<p>2  处理流(包装流): 处理流可以其它流进行处理(提交效率或操作)</p>
<p><img src="C:%5CUsers%5CLenovo%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1541761527074.png" alt="1541761527074"></p>
<h5 id="2-2-IO-流-四大-抽象-类"><a href="#2-2-IO-流-四大-抽象-类" class="headerlink" title="2.2 IO 流 四大 抽象 类"></a>2.2 IO 流 四大 抽象 类</h5><p>1 <code>OutStream</code>  <code>InputStream</code></p>
<p>2  Reader Writer</p>
<p><img src="http://www.zwer.xyz/image/IO/2.%E6%B5%81%E7%9A%84%E7%BB%86%E5%88%86%E5%92%8C%E4%BD%93%E7%B3%BB_%E5%9B%9B%E5%A4%A7%E6%8A%BD%E8%B1%A1%E7%B1%BB-.jpg" alt="2.流的细分和体系_四大抽象类-"></p>
<h4 id="3-文件字节流"><a href="#3-文件字节流" class="headerlink" title="3 文件字节流"></a>3 文件字节流</h4><h5 id="3-1-FileInputStream"><a href="#3-1-FileInputStream" class="headerlink" title="3.1 FileInputStream"></a>3.1 <code>FileInputStream</code></h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.szxy.InputStream;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.FileInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.FileNotFoundException;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Array;</span><br><span class="line"><span class="keyword">import</span> java.util.Arrays;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestFileStream</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">		<span class="comment">//数据源与程序间建立连接</span></span><br><span class="line">		FileInputStream fis = <span class="keyword">new</span> FileInputStream(<span class="string">"D://1.txt"</span>);</span><br><span class="line">		<span class="comment">//从数据源中读出数据</span></span><br><span class="line">		System.out.println(<span class="string">"文件中的字节数： "</span>+fis.available());</span><br><span class="line">		<span class="comment">//读取一个字节</span></span><br><span class="line">		<span class="comment">//int buf = fis.read();</span></span><br><span class="line">		<span class="comment">//System.out.println((char)buf);</span></span><br><span class="line">		<span class="comment">//while()</span></span><br><span class="line">		<span class="comment">//一次读取一个字节 </span></span><br><span class="line">		<span class="comment">/*int count1=0;</span></span><br><span class="line"><span class="comment">		while(fis.available() != 0)&#123;</span></span><br><span class="line"><span class="comment">			count1++;</span></span><br><span class="line"><span class="comment">			int buf = fis.read();</span></span><br><span class="line"><span class="comment">			System.out.println((char)buf);</span></span><br><span class="line"><span class="comment">		&#125;</span></span><br><span class="line"><span class="comment">		System.out.println(count1);</span></span><br><span class="line"><span class="comment">		*/</span></span><br><span class="line">		<span class="comment">//中转站</span></span><br><span class="line">		<span class="keyword">byte</span>[] buf = <span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">1024</span>];</span><br><span class="line">		<span class="keyword">int</span> len=<span class="number">0</span>;</span><br><span class="line">		<span class="keyword">int</span> count=<span class="number">0</span>;<span class="comment">//读取次数</span></span><br><span class="line">		<span class="keyword">while</span>((len=fis.read(buf))!=-<span class="number">1</span>)&#123;</span><br><span class="line">			count++;</span><br><span class="line">			<span class="comment">//借助String类的构造方法</span></span><br><span class="line">			System.out.println(<span class="keyword">new</span> String(buf,<span class="number">0</span>,len));</span><br><span class="line">			<span class="comment">/*for(int i=0;i&lt;len;i++)&#123;</span></span><br><span class="line"><span class="comment">				System.out.print((char)buf[i]+" ");</span></span><br><span class="line"><span class="comment">			&#125;*/</span></span><br><span class="line">	</span><br><span class="line">		&#125;</span><br><span class="line">		System.out.println(<span class="string">"\n读取次数: "</span>+count);</span><br><span class="line">		<span class="comment">//关闭连接</span></span><br><span class="line">		fis.close();</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="3-2-FileOutStream"><a href="#3-2-FileOutStream" class="headerlink" title="3.2 FileOutStream"></a>3.2 <code>FileOutStream</code></h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.szxy.OutStream;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.FileNotFoundException;</span><br><span class="line"><span class="keyword">import</span> java.io.FileOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestFileOutStream</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		FileOutputStream fos = <span class="keyword">null</span>;</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			fos = <span class="keyword">new</span> FileOutputStream(<span class="string">"D://a.txt"</span>,<span class="keyword">true</span>);<span class="comment">//若为true，则若原文件中有数据，在后面追随，不会覆盖</span></span><br><span class="line">		&#125; <span class="keyword">catch</span> (FileNotFoundException e) &#123;</span><br><span class="line">			<span class="comment">// TODO 自动生成的 catch 块</span></span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">char</span> buf = <span class="string">'a'</span>;</span><br><span class="line">		<span class="keyword">byte</span>[] bufs = <span class="string">"HelloWorld"</span>.getBytes();</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			<span class="comment">//一次写入一个字节</span></span><br><span class="line">			<span class="comment">//fos.write(buf);</span></span><br><span class="line">			fos.write(bufs);   </span><br><span class="line">		&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">			<span class="comment">// TODO 自动生成的 catch 块</span></span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">if</span>(fos !=<span class="keyword">null</span>)&#123;</span><br><span class="line">			<span class="keyword">try</span> &#123;</span><br><span class="line">				System.out.println(<span class="string">"关闭"</span>);</span><br><span class="line">				fos.close();</span><br><span class="line">			&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">				<span class="comment">// TODO 自动生成的 catch 块</span></span><br><span class="line">				e.printStackTrace();</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="C:%5CUsers%5CLenovo%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1541763445778.png" alt="1541763445778"></p>
<h4 id="4-使用字节流实现文件的复制"><a href="#4-使用字节流实现文件的复制" class="headerlink" title="4  使用字节流实现文件的复制"></a>4  使用字节流实现文件的复制</h4><h5 id="4-1-文件复制的原理"><a href="#4-1-文件复制的原理" class="headerlink" title="4.1  文件复制的原理"></a>4.1  文件复制的原理</h5><p><strong><img src="C:%5CUsers%5CLenovo%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1541766243480.png" alt="1541766243480"></strong></p>
<h5 id="4-2-文件复制的代码"><a href="#4-2-文件复制的代码" class="headerlink" title="4.2 文件复制的代码"></a>4.2 文件复制的代码</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.szxy.FileCopy;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.FileInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.FileNotFoundException;</span><br><span class="line"><span class="keyword">import</span> java.io.FileOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">FileCopy</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		<span class="comment">//搭建</span></span><br><span class="line">		FileInputStream fis=<span class="keyword">null</span>;</span><br><span class="line">		FileOutputStream fos=<span class="keyword">null</span>;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			fis = <span class="keyword">new</span> FileInputStream(<span class="string">"D://a.txt"</span>);</span><br><span class="line">			fos = <span class="keyword">new</span> FileOutputStream(<span class="string">"E://a.txt"</span>);</span><br><span class="line">			</span><br><span class="line">		<span class="comment">/*	int b=0;//存储读出到的单字节</span></span><br><span class="line"><span class="comment">			//将数据以一个字节的形式读出，然后通过中转站b，写入文件</span></span><br><span class="line"><span class="comment">			while((b=fis.read())!=-1)&#123;</span></span><br><span class="line"><span class="comment">				fos.write(b);	</span></span><br><span class="line"><span class="comment">			&#125;*/</span></span><br><span class="line">			</span><br><span class="line">			</span><br><span class="line">			<span class="keyword">byte</span>[] buf = <span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">1024</span>];</span><br><span class="line">			<span class="keyword">int</span> len = <span class="number">0</span>;</span><br><span class="line">			<span class="keyword">while</span>((len=fis.read(buf))!=-<span class="number">1</span>)&#123;</span><br><span class="line">				fos.write(buf, <span class="number">0</span>, len);</span><br><span class="line">			&#125;</span><br><span class="line">			</span><br><span class="line">			</span><br><span class="line">		</span><br><span class="line">		&#125; <span class="keyword">catch</span> (FileNotFoundException e) &#123;</span><br><span class="line">			<span class="comment">// TODO 自动生成的 catch 块</span></span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">			<span class="comment">// TODO 自动生成的 catch 块</span></span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;<span class="keyword">finally</span>&#123;<span class="comment">//无论发生，都要 关闭 输出流和输入流</span></span><br><span class="line">			<span class="keyword">try</span> &#123;</span><br><span class="line">				<span class="keyword">if</span>(fos!=<span class="keyword">null</span>)&#123;</span><br><span class="line">					fos.close();</span><br><span class="line">					System.out.println(<span class="string">"关闭"</span>);</span><br><span class="line">				&#125;</span><br><span class="line">			&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">				<span class="comment">// TODO 自动生成的 catch 块</span></span><br><span class="line">				e.printStackTrace();</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">try</span> &#123;</span><br><span class="line">				<span class="keyword">if</span>(fis != <span class="keyword">null</span>)&#123;</span><br><span class="line">					fis.close();</span><br><span class="line">				&#125;</span><br><span class="line">			&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">				<span class="comment">// TODO 自动生成的 catch 块</span></span><br><span class="line">				e.printStackTrace();</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="5-文件字符流"><a href="#5-文件字符流" class="headerlink" title="5  文件字符流"></a>5  文件字符流</h4><h5 id="5-1-Reader-Writer-从数据源读内容"><a href="#5-1-Reader-Writer-从数据源读内容" class="headerlink" title="5.1 Reader/Writer 从数据源读内容"></a>5.1 Reader/Writer 从数据源读内容</h5><h5 id="5-2-Writer-写内容"><a href="#5-2-Writer-写内容" class="headerlink" title="5.2 Writer 写内容"></a>5.2 Writer 写内容</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.szxy.OutStream;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.FileNotFoundException;</span><br><span class="line"><span class="keyword">import</span> java.io.FileReader;</span><br><span class="line"><span class="keyword">import</span> java.io.FileWriter;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestFileWriter</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		<span class="comment">//1. 搭桥</span></span><br><span class="line">		FileReader fr=<span class="keyword">null</span>;</span><br><span class="line">		FileWriter fw=<span class="keyword">null</span>;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			fr = <span class="keyword">new</span> FileReader(<span class="string">"D://a.txt"</span>);</span><br><span class="line">			fw = <span class="keyword">new</span> FileWriter(<span class="string">"E://b.txt"</span>);</span><br><span class="line">			<span class="comment">//中转站</span></span><br><span class="line">			<span class="keyword">char</span>[] cbuf = <span class="keyword">new</span> <span class="keyword">char</span>[<span class="number">1024</span>];</span><br><span class="line">			<span class="keyword">int</span> b=<span class="number">0</span>;</span><br><span class="line">			<span class="keyword">while</span>((b=fr.read(cbuf))!=-<span class="number">1</span>)&#123;</span><br><span class="line">				fw.write(cbuf, <span class="number">0</span>, b);</span><br><span class="line">				fw.flush();</span><br><span class="line">			&#125;</span><br><span class="line">		&#125; <span class="keyword">catch</span> (FileNotFoundException e) &#123;</span><br><span class="line">			<span class="comment">// TODO 自动生成的 catch 块</span></span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">			<span class="comment">// TODO 自动生成的 catch 块</span></span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;<span class="keyword">finally</span>&#123;</span><br><span class="line">			<span class="keyword">try</span> &#123;</span><br><span class="line">				<span class="keyword">if</span>(fw!=<span class="keyword">null</span>)&#123;</span><br><span class="line">					fw.close();</span><br><span class="line">					System.out.println(<span class="string">"fw.close"</span>);</span><br><span class="line">				&#125;</span><br><span class="line">			&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">				<span class="comment">// TODO 自动生成的 catch 块</span></span><br><span class="line">				e.printStackTrace();</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">try</span> &#123;</span><br><span class="line">				<span class="keyword">if</span>(fr!=<span class="keyword">null</span>)&#123;</span><br><span class="line">					fr.close();</span><br><span class="line">					System.out.println(<span class="string">"fr.close"</span>);</span><br><span class="line">				&#125;</span><br><span class="line">			&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">				<span class="comment">// TODO 自动生成的 catch 块</span></span><br><span class="line">				e.printStackTrace();</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="C:%5CUsers%5CLenovo%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1541770512720.png" alt="1541770512720"></p>
<h4 id="6-缓冲字节流-缓冲字符流"><a href="#6-缓冲字节流-缓冲字符流" class="headerlink" title="6 缓冲字节流 缓冲字符流"></a>6 缓冲字节流 缓冲字符流</h4><p><img src="C:%5CUsers%5CLenovo%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1541770143750.png" alt="1541770143750"></p>
<p><img src="C:%5CUsers%5CLenovo%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1541770600207.png" alt="1541770600207"></p>
<p><code>BufferedInputStream</code> 和  <code>BufferedOutputStream</code> 是处理流（包装流）<br>1) 读文件和写文件都使用了缓冲区，<strong>减少了读写次数，从而提高了效率</strong><br>2) 当创建这两个缓冲流的对象时时，会创建了内部缓冲数组，缺省使用 32 字节大小的缓冲区.<br>3) 当读取数据时，数据按块读入缓冲区，其后的读操作则直接访问缓冲区<br>4) 当写入数据时，首先写入缓冲区，当缓冲区满时，其中的数据写入所连接的输出流。使用方法 flush()可以强制将缓冲区的内容全部写入输出流<br>5) 关闭流的顺序和打开流的顺序<strong>相反.</strong>只要关闭高层流即可，关闭高层流其实关闭的底层节点流<br>6) Flush 的使用：手动将 buffer 中内容写入文件</p>
<p><img src="C:%5CUsers%5CLenovo%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1541770260938.png" alt="1541770260938"></p>
<h5 id="6-1-缓冲字节流"><a href="#6-1-缓冲字节流" class="headerlink" title="6.1 缓冲字节流"></a>6.1 缓冲字节流</h5><p>适用于：大多数场合</p>
<p>1 <code>BufferedInputStream</code></p>
<p>read()</p>
<p>2 <code>BufferedOutputStream</code></p>
<p>write()</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.szxy.TestCopy;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.BufferedInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.BufferedOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.FileInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.FileNotFoundException;</span><br><span class="line"><span class="keyword">import</span> java.io.FileOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestCopy</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		FileInputStream fis = <span class="keyword">null</span>;</span><br><span class="line">		FileOutputStream fos = <span class="keyword">null</span>;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			fis = <span class="keyword">new</span> FileInputStream(<span class="string">"E://jdk1.8_有道.CHM"</span>);</span><br><span class="line">			fos = <span class="keyword">new</span> FileOutputStream(<span class="string">"D://jdk1.8_有道.CHM"</span>);</span><br><span class="line">			</span><br><span class="line">			<span class="comment">//使用缓冲池    复制速度加快</span></span><br><span class="line">			BufferedInputStream bis = <span class="keyword">new</span> BufferedInputStream(fis);</span><br><span class="line">			BufferedOutputStream bos = <span class="keyword">new</span> BufferedOutputStream(fos);</span><br><span class="line">			</span><br><span class="line">			<span class="keyword">byte</span>[] buf = <span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">1024</span>];</span><br><span class="line">			<span class="keyword">int</span> len=<span class="number">0</span>;</span><br><span class="line">			Long start = System.currentTimeMillis();</span><br><span class="line">			<span class="keyword">while</span>((len=bis.read(buf))!= -<span class="number">1</span>)&#123;</span><br><span class="line">				bos.write(buf, <span class="number">0</span>, len);</span><br><span class="line">			&#125;</span><br><span class="line">			Long end = System.currentTimeMillis();</span><br><span class="line">			System.out.println(<span class="string">"所需时间："</span>+(end-start)+<span class="string">"ms"</span>);</span><br><span class="line">		&#125; <span class="keyword">catch</span> (FileNotFoundException e) &#123;</span><br><span class="line">			<span class="comment">// TODO 自动生成的 catch 块</span></span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">			<span class="comment">// TODO 自动生成的 catch 块</span></span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;<span class="keyword">finally</span>&#123;</span><br><span class="line">			<span class="keyword">if</span>(fos != <span class="keyword">null</span>)&#123;</span><br><span class="line">				<span class="keyword">try</span> &#123;</span><br><span class="line">					fos.close();</span><br><span class="line">				&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">					<span class="comment">// TODO 自动生成的 catch 块</span></span><br><span class="line">					e.printStackTrace();</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">if</span>(fis != <span class="keyword">null</span>)&#123;</span><br><span class="line">				<span class="keyword">try</span> &#123;</span><br><span class="line">					fis.close();</span><br><span class="line">				&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">					<span class="comment">// TODO 自动生成的 catch 块</span></span><br><span class="line">					e.printStackTrace();</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">			</span><br><span class="line">			</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="6-2-缓冲字符流"><a href="#6-2-缓冲字符流" class="headerlink" title="6.2 缓冲字符流"></a>6.2 缓冲字符流</h5><p>用于：适用于读取纯文本</p>
<p>1 <code>BufferedReader</code></p>
<p><code>readerLine()</code>读取一个文本行的数据</p>
<p>2 <code>BufferedWriter</code></p>
<p><code>newLine()</code>  写入一个行分隔符</p>
<p>使用缓冲字符流是复制文本文件常用方式</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.szxy.TestCopy;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.BufferedInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.BufferedOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.BufferedReader;</span><br><span class="line"><span class="keyword">import</span> java.io.BufferedWriter;</span><br><span class="line"><span class="keyword">import</span> java.io.FileInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.FileNotFoundException;</span><br><span class="line"><span class="keyword">import</span> java.io.FileOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.FileReader;</span><br><span class="line"><span class="keyword">import</span> java.io.FileWriter;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestCopy2</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		BufferedReader bis=<span class="keyword">null</span>;</span><br><span class="line">		BufferedWriter bos=<span class="keyword">null</span>;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			bis = <span class="keyword">new</span> BufferedReader(<span class="keyword">new</span> FileReader(<span class="string">"D://1.txt"</span>));</span><br><span class="line">			bos = <span class="keyword">new</span> BufferedWriter(<span class="keyword">new</span> FileWriter(<span class="string">"E://1.txt"</span>));</span><br><span class="line">			</span><br><span class="line">			String line = <span class="keyword">null</span>;<span class="comment">//存储字符</span></span><br><span class="line">			<span class="keyword">while</span>((line=bis.readLine())!= <span class="keyword">null</span>)&#123;</span><br><span class="line">				bos.write(line);</span><br><span class="line">				bos.newLine();<span class="comment">//换行</span></span><br><span class="line">				bos.flush();</span><br><span class="line">			&#125;</span><br><span class="line">		&#125; <span class="keyword">catch</span> (FileNotFoundException e) &#123;</span><br><span class="line">			<span class="comment">// TODO 自动生成的 catch 块</span></span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">			<span class="comment">// TODO 自动生成的 catch 块</span></span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;<span class="keyword">finally</span>&#123;</span><br><span class="line">			<span class="keyword">if</span>(bos!=<span class="keyword">null</span>)&#123;</span><br><span class="line">			<span class="keyword">try</span> &#123;</span><br><span class="line">				bos.close();</span><br><span class="line">			&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">				<span class="comment">// TODO 自动生成的 catch 块</span></span><br><span class="line">				e.printStackTrace();</span><br><span class="line">			&#125;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">if</span>(bis!=<span class="keyword">null</span>)&#123;</span><br><span class="line">				<span class="keyword">try</span> &#123;</span><br><span class="line">					bis.close();</span><br><span class="line">				&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">					<span class="comment">// TODO 自动生成的 catch 块</span></span><br><span class="line">					e.printStackTrace();</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">			</span><br><span class="line">		&#125;</span><br><span class="line">			</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="7-转换流"><a href="#7-转换流" class="headerlink" title="7  转换流"></a>7  转换流</h4><h5 id="7-1-InputStreamReader-OutputStreamWriter"><a href="#7-1-InputStreamReader-OutputStreamWriter" class="headerlink" title="7.1 InputStreamReader  OutputStreamWriter"></a>7.1 <code>InputStreamReader</code>  <code>OutputStreamWriter</code></h5><p>将从键盘输入的<strong>字节流转换成指定的字符流</strong>，然后保存到磁盘文件中。</p>
<p>数据源是标准的输入设备，键盘 <code>system.in</code></p>
<h5 id="7-2-用法"><a href="#7-2-用法" class="headerlink" title="7.2 用法"></a>7.2 用法</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.szxy.convert;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.BufferedInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.BufferedReader;</span><br><span class="line"><span class="keyword">import</span> java.io.BufferedWriter;</span><br><span class="line"><span class="keyword">import</span> java.io.FileNotFoundException;</span><br><span class="line"><span class="keyword">import</span> java.io.FileOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStreamReader;</span><br><span class="line"><span class="keyword">import</span> java.io.OutputStreamWriter;</span><br><span class="line"><span class="keyword">import</span> java.io.UnsupportedEncodingException;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 将字节流转换为字符流</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> wzer</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestConvert</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//1 数据源是标准输入的设备，键盘 System.in</span></span><br><span class="line">		InputStream is = System.in;</span><br><span class="line">		<span class="comment">//2 使用转换流， 将字节流转换为字符流 </span></span><br><span class="line">		<span class="comment">//3 提高读取效率</span></span><br><span class="line">		BufferedReader br=<span class="keyword">null</span>;</span><br><span class="line">		BufferedWriter bw=<span class="keyword">null</span>;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			InputStreamReader isr = <span class="keyword">new</span> InputStreamReader(is,<span class="string">"GBK"</span>);</span><br><span class="line">			br = <span class="keyword">new</span> BufferedReader(isr);</span><br><span class="line"></span><br><span class="line">			FileOutputStream fos = <span class="keyword">new</span> FileOutputStream(<span class="string">"D://r.txt"</span>);</span><br><span class="line">			OutputStreamWriter osw = <span class="keyword">new</span> OutputStreamWriter(fos,<span class="string">"GBK"</span>);</span><br><span class="line">			bw = <span class="keyword">new</span> BufferedWriter(osw);</span><br><span class="line">			<span class="comment">//4 提高写入效率</span></span><br><span class="line">			String line=<span class="keyword">null</span>;</span><br><span class="line">			<span class="keyword">while</span>( !<span class="string">"over"</span>.equals((line=br.readLine())))&#123;<span class="comment">//输入over,键盘输入条件</span></span><br><span class="line">				bw.write(line);</span><br><span class="line">				bw.newLine();</span><br><span class="line">				bw.flush();<span class="comment">//手动刷新缓冲区</span></span><br><span class="line">			&#125;</span><br><span class="line">		&#125; <span class="keyword">catch</span> (UnsupportedEncodingException e) &#123;</span><br><span class="line">			<span class="comment">// TODO 自动生成的 catch 块</span></span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125; <span class="keyword">catch</span> (FileNotFoundException e) &#123;</span><br><span class="line">			<span class="comment">// TODO 自动生成的 catch 块</span></span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">			<span class="comment">// TODO 自动生成的 catch 块</span></span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;<span class="keyword">finally</span>&#123;</span><br><span class="line">			<span class="comment">//5 关闭</span></span><br><span class="line">			<span class="keyword">if</span>(bw != <span class="keyword">null</span>)&#123;</span><br><span class="line">				<span class="keyword">try</span> &#123;</span><br><span class="line">					bw.close();</span><br><span class="line">				&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">					<span class="comment">// TODO 自动生成的 catch 块</span></span><br><span class="line">					e.printStackTrace();</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">if</span>(br != <span class="keyword">null</span>)&#123;</span><br><span class="line">				<span class="keyword">try</span> &#123;</span><br><span class="line">					br.close();</span><br><span class="line">				&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">					<span class="comment">// TODO 自动生成的 catch 块</span></span><br><span class="line">					e.printStackTrace();</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;		</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="8-打印流"><a href="#8-打印流" class="headerlink" title="8 打印流"></a>8 打印流</h4><p>无须类型转换，自动转换为String类型</p>
<h5 id="8-1-PrintStream"><a href="#8-1-PrintStream" class="headerlink" title="8.1 PrintStream"></a>8.1 <code>PrintStream</code></h5><p>1) <code>PrintStream</code> 提供了一系列的 print()和 <code>println()</code>，可以实现将<strong>基本数据类型格式化成字符串输出</strong>。对象类型将先调用<code>toString()</code>，然后输出该方法返回的字符串</p>
<p>2) System.out 就是 <code>PrintStream</code> 的一个实例，代表显示器</p>
<p>3) System.err 也是 <code>PrintStream</code>的一个实例，代表显示器</p>
<p>4) <code>PrintStream</code>的输出功能非常强大，通常需要输出文本内容都可以将输出流包装成 <code>PrintStream</code>后进行输出</p>
<p>5) <code>PrintStream</code> 的方法都不抛出<code>IOException</code></p>
<h5 id="8-2-PrintWriter"><a href="#8-2-PrintWriter" class="headerlink" title="8.2 PrintWriter"></a>8.2 <code>PrintWriter</code></h5><p>1) <code>PrintStream</code> 的对应字符流，功能相同，方法对应。</p>
<p>2) <code>PrintWriter</code>的方法也不抛出 IOException</p>
<p>3) 复制文件时可以使用<code>PrintWriter</code>代替<code>BufferedWriter</code>完成，更方便</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.szxy.printStream;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.FileNotFoundException;</span><br><span class="line"><span class="keyword">import</span> java.io.FileOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.FileWriter;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.PrintStream;</span><br><span class="line"><span class="keyword">import</span> java.io.PrintWriter;</span><br><span class="line"><span class="keyword">import</span> java.util.Date;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestPrintStream</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//PrintStream ps = System.out;</span></span><br><span class="line">		<span class="comment">//PrintStream ps = System.err;</span></span><br><span class="line">		<span class="comment">//PrintStream ps = new PrintStream(new FileOutputStream("D://print.txt"));</span></span><br><span class="line">		PrintWriter ps = <span class="keyword">new</span> PrintWriter(<span class="keyword">new</span> FileWriter(<span class="string">"D://print1.txt"</span>));</span><br><span class="line">		ps.println(<span class="string">"HelloWorld"</span>);</span><br><span class="line">		ps.println(<span class="number">123</span>);</span><br><span class="line">		ps.println(<span class="number">123.132</span>);</span><br><span class="line">		ps.println(<span class="keyword">new</span> Date(<span class="number">1000</span>));</span><br><span class="line">		ps.flush();</span><br><span class="line">		ps.close();</span><br><span class="line">		</span><br><span class="line">		</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="9-数据流"><a href="#9-数据流" class="headerlink" title="9 数据流"></a>9 数据流</h4><h5 id="9-1-DataInputStream-和-DataOutputStream"><a href="#9-1-DataInputStream-和-DataOutputStream" class="headerlink" title="9.1 DataInputStream 和 DataOutputStream"></a>9.1 <code>DataInputStream</code> 和 <code>DataOutputStream</code></h5><p>1) 提供了可以存取所有 Java 基础类型数据（如：<code>int</code>，double等）和 String 的方法。<br>2) 处理流，只针对字节流，二进制文件<br>3) 输入流链和输出流链<br>4) 注意：<strong>只要关闭上层流即可</strong></p>
<p><img src="C:%5CUsers%5CLenovo%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1541814958778.png" alt="1541814958778"></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.szxy.datestream;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.BufferedInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.BufferedOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.DataInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.DataOutput;</span><br><span class="line"><span class="keyword">import</span> java.io.DataOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.FileInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.FileOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.PrintStream;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestDateStream</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">		write();</span><br><span class="line">		read();</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">write</span><span class="params">()</span> <span class="keyword">throws</span> IOException</span>&#123;</span><br><span class="line">		<span class="comment">/*//1.目的地</span></span><br><span class="line"><span class="comment">		FileOutputStream fos = new FileOutputStream("D://d.txt");</span></span><br><span class="line"><span class="comment">		//2.缓冲区，提高写入效率</span></span><br><span class="line"><span class="comment">		BufferedOutputStream bos = new BufferedOutputStream(fos);</span></span><br><span class="line"><span class="comment">		//3.使用数据流，保存基本数据类型和String类型</span></span><br><span class="line"><span class="comment">		DataOutputStream dos = new DataOutputStream(bos);*/</span></span><br><span class="line">		</span><br><span class="line">		<span class="comment">//简化</span></span><br><span class="line">		DataOutputStream dos = <span class="keyword">null</span>;</span><br><span class="line">		dos = <span class="keyword">new</span> DataOutputStream(<span class="keyword">new</span> BufferedOutputStream(<span class="keyword">new</span> FileOutputStream(<span class="string">"D://d.txt"</span>)));</span><br><span class="line">		</span><br><span class="line">		dos.writeInt(<span class="number">123234</span>);</span><br><span class="line">		dos.writeDouble(<span class="number">234.34</span>);</span><br><span class="line">		dos.writeChar(<span class="string">'c'</span>);</span><br><span class="line">		dos.writeUTF(<span class="string">"HelloWord123"</span>);</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//4. 关闭</span></span><br><span class="line">		<span class="keyword">if</span>(dos!=<span class="keyword">null</span>)&#123;</span><br><span class="line">			dos.close();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span>  <span class="title">read</span><span class="params">()</span> <span class="keyword">throws</span> IOException</span>&#123;</span><br><span class="line">		<span class="comment">/*//1.目的地</span></span><br><span class="line"><span class="comment">		FileInputStream  fis = new FileInputStream("D://d.txt");</span></span><br><span class="line"><span class="comment">		//2. 缓冲区，提高读取效率</span></span><br><span class="line"><span class="comment">		BufferedInputStream bis = new BufferedInputStream(fis);</span></span><br><span class="line"><span class="comment">		//3. 使用数据流，保存基本数据类型和String类型</span></span><br><span class="line"><span class="comment">		DataInputStream ds = new DataInputStream(bis);*/</span></span><br><span class="line">		</span><br><span class="line">		<span class="comment">//简化</span></span><br><span class="line">		DataInputStream ds = <span class="keyword">null</span>;</span><br><span class="line">		ds = <span class="keyword">new</span> DataInputStream(<span class="keyword">new</span> BufferedInputStream(<span class="keyword">new</span> FileInputStream(<span class="string">"D://d.txt"</span>)));</span><br><span class="line">		</span><br><span class="line">		System.out.println(ds.readInt());</span><br><span class="line">		System.out.println(ds.readDouble());</span><br><span class="line">		System.out.println(ds.readChar());</span><br><span class="line">		System.out.println(ds.readUTF());</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//4. 关闭</span></span><br><span class="line">		<span class="keyword">if</span>(ds !=<span class="keyword">null</span>)&#123;</span><br><span class="line">			ds.close();</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="10-对象流"><a href="#10-对象流" class="headerlink" title="10 对象流"></a>10 对象流</h4><h5 id="10-1-对象序列化-Serialization"><a href="#10-1-对象序列化-Serialization" class="headerlink" title="10.1 对象序列化 (Serialization)"></a>10.1 对象序列化 (Serialization)</h5><p><code>ObjectOutStream</code> 写对象 也叫作 序列化  </p>
<p>对象的内存状态以字节的形式存储到磁盘的文件上</p>
<p><code>ObjectInputStream</code> 反序列化  读对象 也叫 反序列化</p>
<p>磁盘上的字节形式的数据还原成对象的内存状态</p>
<h5 id="10-2-使用序列化的原因"><a href="#10-2-使用序列化的原因" class="headerlink" title="10.2 使用序列化的原因"></a>10.2 使用序列化的原因</h5><p><img src="C:%5CUsers%5CLenovo%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1541817194127.png" alt="1541817194127"></p>
<h5 id="10-3-对象序列化的条件"><a href="#10-3-对象序列化的条件" class="headerlink" title="10.3  对象序列化的条件"></a>10.3  对象序列化的条件</h5><p>被序列化的类需要实现 Serializable 接口</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.szxy.oject;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.FileInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.FileNotFoundException;</span><br><span class="line"><span class="keyword">import</span> java.io.FileOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.ObjectInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.ObjectOutput;</span><br><span class="line"><span class="keyword">import</span> java.io.ObjectOutputStream;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 对象序列化与反序列化</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> wzer</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestObjectStream</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		write();</span><br><span class="line">		read();</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">read</span><span class="params">()</span></span>&#123;</span><br><span class="line">		<span class="comment">// 1 创建对象流对象</span></span><br><span class="line">		ObjectInputStream ois=<span class="keyword">null</span>;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			ois = <span class="keyword">new</span> ObjectInputStream(<span class="keyword">new</span> FileInputStream(<span class="string">"D://object.txt"</span>));</span><br><span class="line">			<span class="comment">//2 读取对象  读取的顺序与写入的顺序必须一致</span></span><br><span class="line">			Person p = (Person)ois.readObject();</span><br><span class="line">			System.out.println(p);</span><br><span class="line">			System.out.println(ois.readInt());</span><br><span class="line">			System.out.println(ois.readUTF());</span><br><span class="line">			</span><br><span class="line">		&#125; <span class="keyword">catch</span> (FileNotFoundException e) &#123;</span><br><span class="line">			<span class="comment">// TODO 自动生成的 catch 块</span></span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125; <span class="keyword">catch</span> (ClassNotFoundException e) &#123;</span><br><span class="line">			<span class="comment">// TODO 自动生成的 catch 块</span></span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">			<span class="comment">// TODO 自动生成的 catch 块</span></span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;<span class="keyword">finally</span>&#123;</span><br><span class="line">			<span class="keyword">if</span>(ois !=<span class="keyword">null</span>)&#123;</span><br><span class="line">				<span class="keyword">try</span> &#123;</span><br><span class="line">					ois.close();</span><br><span class="line">				&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">					<span class="comment">// TODO 自动生成的 catch 块</span></span><br><span class="line">					e.printStackTrace();</span><br><span class="line">				&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="comment">//3 关闭</span></span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">write</span><span class="params">()</span></span>&#123;</span><br><span class="line">		<span class="comment">//1 创建对象流对象</span></span><br><span class="line">		ObjectOutputStream oos=<span class="keyword">null</span>;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			oos = <span class="keyword">new</span> ObjectOutputStream(<span class="keyword">new</span> FileOutputStream(<span class="string">"D://object.txt"</span>));</span><br><span class="line">			<span class="comment">//2 创建对象  </span></span><br><span class="line">			oos.writeObject(<span class="keyword">new</span> Person(<span class="string">"Marry"</span>,<span class="number">20</span>));</span><br><span class="line">			oos.writeInt(<span class="number">123</span>);</span><br><span class="line">			oos.writeUTF(<span class="string">"HelloWorld"</span>);</span><br><span class="line">		&#125; <span class="keyword">catch</span> (FileNotFoundException e) &#123;</span><br><span class="line">			<span class="comment">// TODO 自动生成的 catch 块</span></span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">			<span class="comment">// TODO 自动生成的 catch 块</span></span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;<span class="keyword">finally</span>&#123;</span><br><span class="line">			<span class="comment">//3 关闭</span></span><br><span class="line">			<span class="keyword">if</span>(oos !=<span class="keyword">null</span>)&#123;</span><br><span class="line">				<span class="keyword">try</span> &#123;</span><br><span class="line">					oos.close();</span><br><span class="line">				&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">					<span class="comment">// TODO 自动生成的 catch 块</span></span><br><span class="line">					e.printStackTrace();</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">			</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.szxy.oject;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.Serializable;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Person</span> <span class="keyword">implements</span> <span class="title">Serializable</span></span>&#123;</span><br><span class="line">	<span class="keyword">private</span> String name;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">int</span> age;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">Person</span><span class="params">(String name, <span class="keyword">int</span> age)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">super</span>();</span><br><span class="line">		<span class="keyword">this</span>.name = name;</span><br><span class="line">		<span class="keyword">this</span>.age = age;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">Person</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">super</span>();</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> name;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.name = name;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getAge</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> age;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setAge</span><span class="params">(<span class="keyword">int</span> age)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.age = age;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="string">"Person [name="</span> + name + <span class="string">", age="</span> + age + <span class="string">"]"</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="11-序列化与反序列化"><a href="#11-序列化与反序列化" class="headerlink" title="11 序列化与反序列化"></a>11 序列化与反序列化</h4><p>序列化只针对属性，不针对方法</p>
<p>transient //序列化时不再添加用这个关键字修饰的变量</p>
<p>类中静态变量也不会被序列化</p>
<p>对象是可序列化，其中对象的成员对象必须也是也序列化的</p>
<p>添加序列化号，应对版本升级问题</p>
<p>实现序列化，是可继承的，若父类实现的序列化，子类可不必再写一遍</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.szxy.oject;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.FileInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.FileNotFoundException;</span><br><span class="line"><span class="keyword">import</span> java.io.FileOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.ObjectInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.ObjectOutputStream;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestStudent</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		read();</span><br><span class="line">		write();</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">read</span><span class="params">()</span></span>&#123;</span><br><span class="line">		<span class="comment">//1 创建对象流对象</span></span><br><span class="line">		ObjectOutputStream oos =<span class="keyword">null</span>;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			oos = <span class="keyword">new</span> ObjectOutputStream(<span class="keyword">new</span> FileOutputStream(<span class="string">"D://student.txt"</span>));</span><br><span class="line">			</span><br><span class="line">			<span class="comment">//2 创建Student对象</span></span><br><span class="line">			Student s = <span class="keyword">new</span> Student(<span class="string">"Tom"</span>, <span class="number">20</span>, <span class="string">"132"</span>);</span><br><span class="line">			Student.SCHOLL_NAME = <span class="string">"szxy"</span>;</span><br><span class="line">			oos.writeObject(s);</span><br><span class="line">		&#125; <span class="keyword">catch</span> (FileNotFoundException e) &#123;</span><br><span class="line">			<span class="comment">// TODO 自动生成的 catch 块</span></span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">			<span class="comment">// TODO 自动生成的 catch 块</span></span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;<span class="keyword">finally</span>&#123;</span><br><span class="line">			<span class="comment">//3 关闭</span></span><br><span class="line">			<span class="keyword">if</span>(oos!=<span class="keyword">null</span>)&#123;</span><br><span class="line">				<span class="keyword">try</span> &#123;</span><br><span class="line">					oos.close();</span><br><span class="line">				&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">					<span class="comment">// TODO 自动生成的 catch 块</span></span><br><span class="line">					e.printStackTrace();</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;	</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">write</span><span class="params">()</span></span>&#123;</span><br><span class="line">		<span class="comment">//1 创建对象流对象</span></span><br><span class="line">		ObjectInputStream ois = <span class="keyword">null</span>;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			ois = <span class="keyword">new</span> ObjectInputStream(<span class="keyword">new</span> FileInputStream(<span class="string">"D://student.txt"</span>));</span><br><span class="line">			</span><br><span class="line">			<span class="comment">//2 从磁盘中读取对象</span></span><br><span class="line">			Student s = (Student)ois.readObject();</span><br><span class="line">			System.out.println(s);</span><br><span class="line">		&#125; <span class="keyword">catch</span> (FileNotFoundException e) &#123;</span><br><span class="line">			<span class="comment">// TODO 自动生成的 catch 块</span></span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125; <span class="keyword">catch</span> (ClassNotFoundException e) &#123;</span><br><span class="line">			<span class="comment">// TODO 自动生成的 catch 块</span></span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">			<span class="comment">// TODO 自动生成的 catch 块</span></span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;<span class="keyword">finally</span>&#123;</span><br><span class="line">			<span class="keyword">if</span>(ois!=<span class="keyword">null</span>)&#123;</span><br><span class="line">			<span class="keyword">try</span> &#123;</span><br><span class="line">				ois.close();</span><br><span class="line">			&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">				<span class="comment">// TODO 自动生成的 catch 块</span></span><br><span class="line">				e.printStackTrace();</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.szxy.oject;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.Serializable;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Student</span> <span class="keyword">extends</span> <span class="title">Person</span> <span class="keyword">implements</span> <span class="title">Serializable</span></span>&#123;</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * </span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = <span class="number">261590964285085543L</span>;</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> String SCHOLL_NAME;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">transient</span> String passWord;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">Student</span><span class="params">(String name, <span class="keyword">int</span> age, String passWord)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">super</span>(name, age);</span><br><span class="line">		<span class="keyword">this</span>.passWord = passWord;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">Student</span><span class="params">(String name, <span class="keyword">int</span> age)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">super</span>(name, age);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">getSCHOLL_NAME</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> SCHOLL_NAME;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">setSCHOLL_NAME</span><span class="params">(String sCHOLL_NAME)</span> </span>&#123;</span><br><span class="line">		SCHOLL_NAME = sCHOLL_NAME;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getPassWord</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> passWord;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setPassWord</span><span class="params">(String passWord)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.passWord = passWord;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span>  <span class="keyword">super</span>.toString() + <span class="string">"Student passWord="</span> + passWord +<span class="string">"\tSCHOOL_NAME: "</span> +Student.SCHOLL_NAME;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.szxy.oject;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.Serializable;</span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Classes</span> <span class="keyword">implements</span> <span class="title">Serializable</span></span>&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * </span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="comment">//private static final long serialVersionUID = -670033821580185843L;</span></span><br><span class="line">	<span class="keyword">private</span> String className;</span><br><span class="line">	<span class="keyword">private</span> ArrayList&lt;Student&gt; al;</span><br><span class="line">	<span class="keyword">public</span>  String  addr;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">Classes</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="comment">// TODO 自动生成的构造函数存根</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">Classes</span><span class="params">(String className, ArrayList&lt;Student&gt; al)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">super</span>();</span><br><span class="line">		<span class="keyword">this</span>.className = className;</span><br><span class="line">		<span class="keyword">this</span>.al = al;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getClassName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> className;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setClassName</span><span class="params">(String className)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.className = className;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> ArrayList&lt;Student&gt; <span class="title">getAl</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> al;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setAl</span><span class="params">(ArrayList&lt;Student&gt; al)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.al = al;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="string">"Classes [className="</span> + className + <span class="string">", al="</span> + al + <span class="string">"]"</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.szxy.oject;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.FileInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.FileNotFoundException;</span><br><span class="line"><span class="keyword">import</span> java.io.FileOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.ObjectInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.ObjectOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestClasses</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		read();</span><br><span class="line">		write();</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">write</span><span class="params">()</span></span>&#123;</span><br><span class="line">		<span class="comment">//1 创建对象流对象</span></span><br><span class="line">		ObjectInputStream ois = <span class="keyword">null</span>;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			ois = <span class="keyword">new</span> ObjectInputStream(<span class="keyword">new</span> FileInputStream(<span class="string">"D://classes.txt"</span>));</span><br><span class="line">			</span><br><span class="line">			<span class="comment">//2 读入磁盘中的对象</span></span><br><span class="line">			Classes c = (Classes)ois.readObject();</span><br><span class="line">			System.out.println(c);</span><br><span class="line">		&#125; <span class="keyword">catch</span> (FileNotFoundException e) &#123;</span><br><span class="line">			<span class="comment">// TODO 自动生成的 catch 块</span></span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125; <span class="keyword">catch</span> (ClassNotFoundException e) &#123;</span><br><span class="line">			<span class="comment">// TODO 自动生成的 catch 块</span></span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">			<span class="comment">// TODO 自动生成的 catch 块</span></span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;<span class="keyword">finally</span>&#123;</span><br><span class="line">			<span class="comment">//3 关闭</span></span><br><span class="line">			<span class="keyword">if</span>(ois!=<span class="keyword">null</span>)&#123;</span><br><span class="line">				<span class="keyword">try</span> &#123;</span><br><span class="line">					ois.close();</span><br><span class="line">				&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">					<span class="comment">// TODO 自动生成的 catch 块</span></span><br><span class="line">					e.printStackTrace();</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">read</span><span class="params">()</span></span>&#123;</span><br><span class="line">		<span class="comment">//1 创建对象流对象</span></span><br><span class="line">		ObjectOutputStream oos = <span class="keyword">null</span>;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			oos = <span class="keyword">new</span> ObjectOutputStream(<span class="keyword">new</span> FileOutputStream(<span class="string">"D://classes.txt"</span>));</span><br><span class="line">			</span><br><span class="line">			<span class="comment">//2 创建对象 读入</span></span><br><span class="line">			ArrayList&lt;Student&gt; al = <span class="keyword">new</span> ArrayList&lt;Student&gt;();</span><br><span class="line">			al.add(<span class="keyword">new</span> Student(<span class="string">"Tom"</span>,<span class="number">20</span>,<span class="string">"123"</span>));</span><br><span class="line">			al.add(<span class="keyword">new</span> Student(<span class="string">"Marry"</span>,<span class="number">21</span>,<span class="string">"1ewr23"</span>));</span><br><span class="line">			al.add(<span class="keyword">new</span> Student(<span class="string">"Jack"</span>,<span class="number">34</span>,<span class="string">"123324"</span>));</span><br><span class="line">			al.add(<span class="keyword">new</span> Student(<span class="string">"HHHo"</span>,<span class="number">12</span>,<span class="string">"12334"</span>));</span><br><span class="line">			</span><br><span class="line">			Classes c = <span class="keyword">new</span> Classes(<span class="string">"szxy"</span>,al);</span><br><span class="line">			oos.writeObject(c);</span><br><span class="line">		&#125; <span class="keyword">catch</span> (FileNotFoundException e) &#123;</span><br><span class="line">			<span class="comment">// TODO 自动生成的 catch 块</span></span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">			<span class="comment">// TODO 自动生成的 catch 块</span></span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;<span class="keyword">finally</span>&#123;</span><br><span class="line">			<span class="keyword">if</span>(oos!=<span class="keyword">null</span>)&#123;</span><br><span class="line">						<span class="keyword">try</span> &#123;</span><br><span class="line">							oos.close();</span><br><span class="line">						&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">							<span class="comment">// TODO 自动生成的 catch 块</span></span><br><span class="line">							e.printStackTrace();</span><br><span class="line">						&#125;</span><br><span class="line">					&#125;</span><br><span class="line">		&#125;</span><br><span class="line">			</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="12-文件夹的复制"><a href="#12-文件夹的复制" class="headerlink" title="12  文件夹的复制"></a>12  文件夹的复制</h4><p><strong>字节流</strong>，字符流</p>
<p><code>BufferedInputStream</code>  <code>BufferedOutputStream</code></p>
<p><code>FileInputStream</code> <code>FileOutputStream</code></p>
<p>问题分解：</p>
<p>1 复制一个文件</p>
<p>2 复制一个目录下的文件</p>
<p>3 复制一个目录下的文件的所有子目录</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.szxy.TestCopy;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.BufferedInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.BufferedOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.File;</span><br><span class="line"><span class="keyword">import</span> java.io.FileInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.FileNotFoundException;</span><br><span class="line"><span class="keyword">import</span> java.io.FileOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 文件夹复制</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> wzer</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestCopyDirandfile</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		<span class="comment">/*File srcFile = new File("D://1.txt");</span></span><br><span class="line"><span class="comment">		File targetFile = new File("E://1.txt");</span></span><br><span class="line"><span class="comment">		FileCopy(srcFile,targetFile);*/</span></span><br><span class="line">		File srcDir = <span class="keyword">new</span> File(<span class="string">"D://数据结构/"</span>);</span><br><span class="line">		File targetDir = <span class="keyword">new</span> File(<span class="string">"E://数据结构/"</span>);</span><br><span class="line">		System.out.println(targetDir);<span class="comment">//File对象本身就是一个路径</span></span><br><span class="line">		DirCopy(srcDir, targetDir);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">DirCopy</span><span class="params">(File srcDir,File targetDir)</span></span>&#123;</span><br><span class="line">		<span class="keyword">if</span>(!targetDir.exists())&#123;<span class="comment">//若目标目录，不存在则创建目录</span></span><br><span class="line">			targetDir.mkdir();</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="comment">//获得源目录下的所有File对象（包括文件和目录）</span></span><br><span class="line">		File[] files = srcDir.listFiles();</span><br><span class="line">		<span class="keyword">for</span>(File file: files)&#123;</span><br><span class="line">			<span class="keyword">if</span>(file.isFile())&#123;<span class="comment">//文件路径用拼接的形式，注意传入实参的类型</span></span><br><span class="line">				File srcFile = <span class="keyword">new</span> File(srcDir+<span class="string">"//"</span>+file.getName());</span><br><span class="line">				File targetFile = <span class="keyword">new</span> File(targetDir+<span class="string">"//"</span>+file.getName());</span><br><span class="line">				FileCopy(srcFile,targetFile);</span><br><span class="line">			&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">				<span class="comment">//System.out.println(file.getName());</span></span><br><span class="line">				DirCopy(file,<span class="keyword">new</span> File(targetDir+<span class="string">"//"</span>+file.getName()));</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">				</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">FileCopy</span><span class="params">(File srcFile,File targetFile)</span></span>&#123;</span><br><span class="line">		<span class="comment">//从数据源读入数据</span></span><br><span class="line">		BufferedInputStream bis = <span class="keyword">null</span>;</span><br><span class="line">		BufferedOutputStream bos = <span class="keyword">null</span>;;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			bis = <span class="keyword">new</span> BufferedInputStream(<span class="keyword">new</span> FileInputStream(srcFile));<span class="comment">//源</span></span><br><span class="line">			bos = <span class="keyword">new</span> BufferedOutputStream(<span class="keyword">new</span> FileOutputStream(targetFile));<span class="comment">//目的地</span></span><br><span class="line">			</span><br><span class="line">			<span class="comment">//使用缓冲池加快读入速度</span></span><br><span class="line">			<span class="keyword">byte</span>[] bufs = <span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">1024</span>];</span><br><span class="line">			<span class="keyword">int</span> len = <span class="number">0</span>; <span class="comment">//获得读取字节的长度</span></span><br><span class="line">			<span class="comment">//边读边写</span></span><br><span class="line">			<span class="keyword">while</span>((len=bis.read(bufs))!= -<span class="number">1</span>)&#123;</span><br><span class="line">				bos.write(bufs, <span class="number">0</span>, len);</span><br><span class="line">			&#125;</span><br><span class="line">			</span><br><span class="line">		&#125; <span class="keyword">catch</span> (FileNotFoundException e) &#123;</span><br><span class="line">			<span class="comment">// TODO 自动生成的 catch 块</span></span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">			<span class="comment">// TODO 自动生成的 catch 块</span></span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;<span class="keyword">finally</span>&#123;<span class="comment">//无论读取是否发生异常，都要关闭流</span></span><br><span class="line">			<span class="comment">//关闭</span></span><br><span class="line">			<span class="keyword">if</span>(bos!=<span class="keyword">null</span>)&#123;</span><br><span class="line">				<span class="keyword">try</span> &#123;</span><br><span class="line">					bos.close();</span><br><span class="line">				&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">					<span class="comment">// TODO 自动生成的 catch 块</span></span><br><span class="line">					e.printStackTrace();</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">if</span>(bis!=<span class="keyword">null</span>)&#123;</span><br><span class="line">				<span class="keyword">try</span> &#123;</span><br><span class="line">					bis.close();</span><br><span class="line">				&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">					<span class="comment">// TODO 自动生成的 catch 块</span></span><br><span class="line">					e.printStackTrace();</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">			</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="13-ByteArrayInputStream-ByteArrayInputStream"><a href="#13-ByteArrayInputStream-ByteArrayInputStream" class="headerlink" title="13  ByteArrayInputStream  ByteArrayInputStream"></a>13  <code>ByteArrayInputStream</code>  <code>ByteArrayInputStream</code></h4><p>1 数据源或目的地为: 字节数组</p>
<p>2 只有字节流，没有字符流</p>
<p>3 节点流</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.szxy.byteArrayStream;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.ByteArrayInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.ByteArrayOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.ObjectInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.ObjectOutput;</span><br><span class="line"><span class="keyword">import</span> java.io.ObjectOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.util.Date;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 字符数组流</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> wzer</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestByteArrayStream</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">byte</span>[] buf = write();<span class="comment">//调用写对象的方法</span></span><br><span class="line">		read(buf);<span class="comment">//调用读对象的方法</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">read</span><span class="params">(<span class="keyword">byte</span>[] buf)</span></span>&#123;</span><br><span class="line">		<span class="comment">//创建字节数组对象</span></span><br><span class="line">		ByteArrayInputStream bais = <span class="keyword">null</span>;</span><br><span class="line">		bais = <span class="keyword">new</span> ByteArrayInputStream(buf);</span><br><span class="line">		ObjectInputStream ois = <span class="keyword">null</span>;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			ois = <span class="keyword">new</span> ObjectInputStream(bais);</span><br><span class="line">			System.out.println(ois.readInt());</span><br><span class="line">			System.out.println(ois.readDouble());</span><br><span class="line">			System.out.println(ois.readChar());</span><br><span class="line">			System.out.println(ois.readUTF());</span><br><span class="line">			System.out.println(ois.readObject());</span><br><span class="line">		&#125; <span class="keyword">catch</span> (ClassNotFoundException e) &#123;</span><br><span class="line">			<span class="comment">// TODO 自动生成的 catch 块</span></span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">			<span class="comment">// TODO 自动生成的 catch 块</span></span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;<span class="keyword">finally</span>&#123;</span><br><span class="line">			<span class="keyword">if</span>(ois!=<span class="keyword">null</span>)&#123;</span><br><span class="line">				<span class="keyword">try</span> &#123;</span><br><span class="line">					ois.close();</span><br><span class="line">				&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">					<span class="comment">// TODO 自动生成的 catch 块</span></span><br><span class="line">					e.printStackTrace();</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">byte</span>[] write()&#123;</span><br><span class="line">		<span class="comment">//创建字节数组对象</span></span><br><span class="line">		ByteArrayOutputStream baos = <span class="keyword">null</span>;</span><br><span class="line">		baos = <span class="keyword">new</span> ByteArrayOutputStream();<span class="comment">//调用构造函数，创建一个size为32的数组</span></span><br><span class="line">		ObjectOutputStream oos =<span class="keyword">null</span>;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			oos = <span class="keyword">new</span> ObjectOutputStream(baos);</span><br><span class="line">			<span class="comment">//写入数据</span></span><br><span class="line">			oos.writeInt(<span class="number">124</span>);</span><br><span class="line">			oos.writeDouble(<span class="number">123.23</span>);</span><br><span class="line">			oos.writeChar(<span class="string">'a'</span>);</span><br><span class="line">			oos.writeUTF(<span class="string">"String"</span>);</span><br><span class="line">			oos.writeObject(<span class="keyword">new</span> Date(<span class="number">1000</span>));</span><br><span class="line">		&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">			<span class="comment">// TODO 自动生成的 catch 块</span></span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;<span class="keyword">finally</span>&#123;</span><br><span class="line">			</span><br><span class="line">			<span class="keyword">if</span>(oos!=<span class="keyword">null</span>)&#123;</span><br><span class="line">				<span class="keyword">try</span> &#123;</span><br><span class="line">					oos.close();</span><br><span class="line">				&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">					<span class="comment">// TODO 自动生成的 catch 块</span></span><br><span class="line">					e.printStackTrace();</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">			</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> baos.toByteArray();</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="14-设计模式——装饰器模式"><a href="#14-设计模式——装饰器模式" class="headerlink" title="14 设计模式——装饰器模式"></a>14 设计模式——装饰器模式</h4><p>IO 流使用装饰设计模式</p>
<h5 id="装饰模式定义"><a href="#装饰模式定义" class="headerlink" title="装饰模式定义"></a>装饰模式定义</h5><p>职责：动态的为一个对象增加新的功能</p>
<p>装饰模式是一个替代继承的技术，无序添加通过继承增加子类</p>
<p>就能扩展对象的新功能。使用对象的关联关系代替继承关<br>系，更加灵活，同时避免类型体系的快速膨胀。</p>
<p><img src="C:%5CUsers%5CLenovo%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1541905360889.png" alt="1541905360889"></p>
<p>实现细节：<br>（1） 抽象构件角色 ICar<br>（2） 具体的构件角色 Car<br>（3） 装饰器角色 SuperCar<br>（4） 具体的装饰器角色 FlyCar、WaterCar、AICar</p>
<p><img src="C:%5CUsers%5CLenovo%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1541908107939.png" alt="1541908107939"></p>
<h5 id="优点"><a href="#优点" class="headerlink" title="优点"></a><strong>优点</strong></h5><p>1) 扩展对象功能，比继承灵活，不会导致类个数急剧增加<br>2) 可以对一个对象进行多次装饰，创建出不同行为的组合，<br>车<br>飞行汽车<br>增加浮沉箱，水上汽车<br>增加人工智能，自动驾驶<br>增加翅膀<br>得到功能更加大的对象</p>
<p>3) 具体构建类和具体装饰类可以独立变化，用户可以根据需<br>要自己增加新的具体构件子类和具体装饰子类</p>
<h5 id="缺点"><a href="#缺点" class="headerlink" title="缺点"></a><strong>缺点</strong></h5><p>1) 产生很多小对象。大量小对象占据内存，一定程序上影响性能<br>2) 装饰模式易于出错，调试排查比较麻烦</p>
<h5 id="IO-流实现细节"><a href="#IO-流实现细节" class="headerlink" title="IO 流实现细节"></a>IO 流实现细节</h5><p>(1)抽象构件角色 InputStream,OutputStream,Reader,Writer<br>(2)具体构件角色 FileInputStream,FileOutputStream<br>(3)装饰器角色 FilterInputStream,FilterOutputStream<br> 持有一个抽象构件的引用<br>(4)具体装饰角色<br>BufferedInputStream,BufferedOutputStream 等</p>
<h5 id="代码Demo"><a href="#代码Demo" class="headerlink" title="代码Demo"></a>代码Demo</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.szxy.moshi;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 接口</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> wzer</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">ICar</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">moved</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.szxy.moshi;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 具体的构建</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> wzer</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Car</span> <span class="keyword">implements</span> <span class="title">ICar</span></span>&#123;</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">moved</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"可以在陆地上行走"</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.szxy.moshi;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * 装饰器  服务于Car类 通过moved方法，为Car类增加新的功能</span></span><br><span class="line"><span class="comment"> * </span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SuperCar</span> <span class="keyword">implements</span> <span class="title">ICar</span></span>&#123;</span><br><span class="line">	<span class="keyword">private</span> ICar car;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">SuperCar</span><span class="params">(ICar c)</span> </span>&#123;</span><br><span class="line">		<span class="comment">// TODO 自动生成的构造函数存根</span></span><br><span class="line">		<span class="keyword">this</span>.car = c;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">moved</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="comment">//调用Car对象的方法</span></span><br><span class="line">		car.moved();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.szxy.moshi;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">FlyCar</span> <span class="keyword">extends</span> <span class="title">SuperCar</span></span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">FlyCar</span><span class="params">(ICar c)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">super</span>(c);</span><br><span class="line">		<span class="comment">// TODO 自动生成的构造函数存根</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">moved</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">super</span>.moved();</span><br><span class="line">		System.out.println(<span class="string">"可以在天空飞翔，因为有翅膀"</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.szxy.moshi;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">WaterCar</span> <span class="keyword">extends</span> <span class="title">SuperCar</span></span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">WaterCar</span><span class="params">(ICar c)</span> </span>&#123;</span><br><span class="line">		<span class="comment">// TODO 自动生成的构造函数存根</span></span><br><span class="line">		<span class="keyword">super</span>(c);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">moved</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="comment">// TODO 自动生成的方法存根</span></span><br><span class="line">		<span class="keyword">super</span>.moved();</span><br><span class="line">		System.out.println(<span class="string">"可以在水中漂浮，因为有浮沉箱"</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.szxy.moshi;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AICar</span> <span class="keyword">extends</span> <span class="title">SuperCar</span></span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">AICar</span><span class="params">(ICar c)</span> </span>&#123;</span><br><span class="line">		<span class="comment">// TODO 自动生成的构造函数存根</span></span><br><span class="line">		<span class="keyword">super</span>(c);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">moved</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="comment">// TODO 自动生成的方法存根</span></span><br><span class="line">		<span class="keyword">super</span>.moved();</span><br><span class="line">		System.out.println(<span class="string">"可以自动驾驶，因为有AI"</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.szxy.moshi;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.BufferedOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.FileNotFoundException;</span><br><span class="line"><span class="keyword">import</span> java.io.FileOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.FilterOutputStream;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 测试类</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> wzer</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		ICar c = <span class="keyword">new</span> Car();</span><br><span class="line">		System.out.print(<span class="string">"基本功能: "</span>);</span><br><span class="line">		c.moved();</span><br><span class="line">		</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//装饰器</span></span><br><span class="line">		System.out.println(<span class="string">"\n添加飞行的功能"</span>);</span><br><span class="line">		FlyCar fc = <span class="keyword">new</span> FlyCar(c);</span><br><span class="line">		fc.moved();</span><br><span class="line">		</span><br><span class="line">		System.out.println(<span class="string">"\n添加潜水的功能"</span>);</span><br><span class="line">		WaterCar  wc = <span class="keyword">new</span> WaterCar(fc);</span><br><span class="line">		wc.moved();</span><br><span class="line">		</span><br><span class="line">		System.out.println(<span class="string">"\n添加AI的功能"</span>);</span><br><span class="line">		AICar aicar = <span class="keyword">new</span> AICar(wc);</span><br><span class="line">		aicar.moved();</span><br><span class="line">		</span><br><span class="line">		System.out.println(<span class="string">"\n上面可简写为：\n"</span>);</span><br><span class="line">		AICar aicar2 = <span class="keyword">new</span> AICar(<span class="keyword">new</span> WaterCar(<span class="keyword">new</span> FlyCar(<span class="keyword">new</span> Car())));</span><br><span class="line">		aicar2.moved();</span><br><span class="line">		</span><br><span class="line">		System.out.println(<span class="string">"IO流采用的装饰器模式"</span>);</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			BufferedOutputStream bos = <span class="keyword">new</span> BufferedOutputStream(<span class="keyword">new</span> FilterOutputStream(<span class="keyword">new</span> FileOutputStream(<span class="string">"D://1.txt"</span>)));</span><br><span class="line">		&#125; <span class="keyword">catch</span> (FileNotFoundException e) &#123;</span><br><span class="line">			<span class="comment">// TODO 自动生成的 catch 块</span></span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="15-IO-流总结"><a href="#15-IO-流总结" class="headerlink" title="15 IO 流总结"></a>15 IO 流总结</h4><p>字符流主要处理纯文本，其他都可以使用字节流</p>
<h5 id="15-1-IO-流整体架构体系"><a href="#15-1-IO-流整体架构体系" class="headerlink" title="15.1 IO 流整体架构体系"></a>15.1 IO 流整体架构体系</h5><p>(1) 字节流 :<code>InputStream</code>,<code>OutputStream</code><br>(2) 字符流:Reader ,Writer<br>(3) 数据流:DataInputStream,DataOutputStream<br>(4) 对象流:ObjectInputStream,ObjectOutputStream<br>(5) 缓冲流:BufferedInputStream,BufferedOutputStream<br>BufferedReader,BufferedWriter<br>(6) 转换流:InputStreamReader,OutputStreamWriter<br>(7) 数组流:<br>ByteArrayInputStream,ByteArrayOutputStream<br>(8) 打印流:PrintStream,PrintWriter</p>
<p><img src="C:%5CUsers%5CLenovo%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1541909039407.png" alt="1541909039407"></p>
<h4 id="16-IOUtils"><a href="#16-IOUtils" class="headerlink" title="16 IOUtils"></a>16 <code>IOUtils</code></h4><p>封装了许多IO的操作 读取文件，拷贝文件 复制文件等</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.szxy.TestIOUtils;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.FileInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.FileNotFoundException;</span><br><span class="line"><span class="keyword">import</span> java.io.FileOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.commons.io.IOUtils;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestIOUtils</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> FileNotFoundException, IOException </span>&#123;</span><br><span class="line">		String str = IOUtils.toString(<span class="keyword">new</span> FileInputStream(<span class="string">"D://1.txt"</span>));</span><br><span class="line">		System.out.println(str);</span><br><span class="line">		</span><br><span class="line">		IOUtils.write(str, <span class="keyword">new</span> FileOutputStream(<span class="string">"D://2.txt"</span>));</span><br><span class="line"></span><br><span class="line">		IOUtils.copy(<span class="keyword">new</span> FileInputStream(<span class="string">"D://1.txt"</span>),<span class="keyword">new</span> FileOutputStream(<span class="string">"E://1.txt"</span>));</span><br><span class="line">		</span><br><span class="line">		</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.szxy.TestIOUtils;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.File;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.net.MalformedURLException;</span><br><span class="line"><span class="keyword">import</span> java.net.URI;</span><br><span class="line"><span class="keyword">import</span> java.net.URL;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.commons.io.FileSystemUtils;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.io.FileUtils;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestFileUtils</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">		FileUtils.copyFile(<span class="keyword">new</span> File(<span class="string">"D://1.txt"</span>), <span class="keyword">new</span> File(<span class="string">"E:f.txt"</span>));</span><br><span class="line">		</span><br><span class="line">	URL url = <span class="keyword">new</span> URL(<span class="string">"http://www.baidu.com"</span>);</span><br><span class="line"></span><br><span class="line">	FileUtils.copyURLToFile(url, <span class="keyword">new</span> File(<span class="string">"E://baidu.html"</span>));</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


        
      
    </div>

    
    
    
      <footer class="post-footer">
          <div class="post-eof"></div>
        
      </footer>
  </div>
  
  
  
  </article>

    
        <article itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block home">
    <link itemprop="mainEntityOfPage" href="http://zwer.xyz/2018/11/08/Java/20181104 容器/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="zwer">
      <meta itemprop="description" content="记录学习的日常">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="zwer 的博客空间">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
            
            <a href="/2018/11/08/Java/20181104 容器/" class="post-title-link" itemprop="url">容器container</a>
          
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              
                
              

              <time title="Created: 2018-11-08 22:00:35" itemprop="dateCreated datePublished" datetime="2018-11-08T22:00:35+08:00">2018-11-08</time>
            </span>
          
            

            
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2019-09-08 19:49:00" itemprop="dateModified" datetime="2019-09-08T19:49:00+08:00">2019-09-08</time>
              </span>
            
          

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="容器"><a href="#容器" class="headerlink" title="容器"></a>容器</h2><h4 id="1-基本概念-Collection-Set-List-接口介绍"><a href="#1-基本概念-Collection-Set-List-接口介绍" class="headerlink" title="1.基本概念_Collection_Set_List 接口介绍"></a>1.基本概念_Collection_Set_List 接口介绍</h4><h5 id="1-1-集合"><a href="#1-1-集合" class="headerlink" title="1.1 集合"></a>1.1 集合</h5><p>数组：  一旦创建长度不能更改 局限性</p>
<p><strong>只能存 引用数据类型</strong></p>
<h5 id="1-2-容器框架"><a href="#1-2-容器框架" class="headerlink" title="1.2 容器框架"></a>1.2 容器框架</h5><p><img src="http://www.zwer.xyz/Collection0.png" alt="1541292931739"></p>
<h5 id="1-3-各接口的特点"><a href="#1-3-各接口的特点" class="headerlink" title="1.3 各接口的特点"></a>1.3 各接口的特点</h5><p>底层数据结构不同 </p>
<p>LinkedList底层数据结构是链表，删除和添加数据元素的效率高，数据结构复杂</p>
<p>ArrayList底层数据结构是数组，删除和添加数据元素的效率低</p>
<p>Collection 接口存储一组不唯一，无序的对象</p>
<p>List接口存储一组不唯一，<strong>有序</strong>（索引顺序）的对象</p>
<p>Set接口存储一组唯一，<strong>无序的</strong>对象</p>
<h4 id="2-List接口ArrayList用法详解"><a href="#2-List接口ArrayList用法详解" class="headerlink" title="2. List接口ArrayList用法详解"></a>2. List接口<code>ArrayList</code>用法详解</h4><h5 id="2-1ArrayList-实现类-用法"><a href="#2-1ArrayList-实现类-用法" class="headerlink" title="2.1ArrayList 实现类 用法"></a>2.1ArrayList 实现类 用法</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.szxy.TestListarray;</span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.Iterator;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.util.ListIterator;</span><br><span class="line"><span class="keyword">import</span> java.util.Scanner;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestListArray</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		<span class="comment">//创建List接口的实现类ArrayList</span></span><br><span class="line">		List list = <span class="keyword">new</span> ArrayList();</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//1. add方法</span></span><br><span class="line">		list.add(<span class="string">"HelloArray"</span>);</span><br><span class="line">		list.add(<span class="number">123</span>);<span class="comment">//自动装箱  Integer.valueOf(123);</span></span><br><span class="line">		list.add(<span class="keyword">new</span> Scanner(System.in));</span><br><span class="line">		System.out.println(<span class="string">"list: "</span>+list);</span><br><span class="line">		List list2 = <span class="keyword">new</span> ArrayList();</span><br><span class="line">		list2.add(<span class="string">"HelloArray"</span>);</span><br><span class="line">		list2.add(<span class="number">123</span>);</span><br><span class="line">		System.out.println(<span class="string">"list2: "</span>+list2);</span><br><span class="line">		<span class="comment">//2. addAll</span></span><br><span class="line">		list.addAll(list2);</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//3.remove</span></span><br><span class="line">		list.remove(<span class="string">"HelloArray"</span>);</span><br><span class="line">		<span class="comment">//list.remove(123);//123被认为是索引，而非元素内容</span></span><br><span class="line">		list.remove(<span class="keyword">new</span> Integer(<span class="number">123</span>));</span><br><span class="line">		list.remove(<span class="number">0</span>);<span class="comment">//根据索引删除元素</span></span><br><span class="line">		System.out.println(<span class="string">"list: "</span>+list);</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//4.removeAll</span></span><br><span class="line">		list.add(<span class="string">"zwz"</span>);</span><br><span class="line">		<span class="comment">//list.removeAll(list2);</span></span><br><span class="line">		list.retainAll(list2);</span><br><span class="line">		System.out.println(<span class="string">"list: "</span>+list);</span><br><span class="line">		</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//5. 判断</span></span><br><span class="line">		System.out.println(<span class="string">"list中元素的个数: "</span>+list.size());</span><br><span class="line">		System.out.println(<span class="string">"list中元素是否为空: "</span>+list.isEmpty());</span><br><span class="line">		System.out.println(<span class="string">"判断list中的元素HelloAray是否存在 "</span>+list.contains(<span class="string">"HelloArray"</span>));</span><br><span class="line">		System.out.println(<span class="string">"判断list是否包含list2 "</span>+list.containsAll(list2));</span><br><span class="line">		<span class="comment">//contains  containsAll</span></span><br><span class="line">		</span><br><span class="line"></span><br><span class="line">		</span><br><span class="line">		<span class="comment">//6. 插入元素</span></span><br><span class="line">		list.set(<span class="number">1</span>, <span class="string">"set"</span>);</span><br><span class="line">		list.add(<span class="number">0</span>, <span class="string">"add"</span>);</span><br><span class="line">		System.out.println(<span class="string">"list: "</span>+list);</span><br><span class="line">		</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//7. 获得元素</span></span><br><span class="line">		System.out.println(<span class="string">"获得索引位置为1上的元素："</span>+list.get(<span class="number">1</span>));</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//8. 查找元素</span></span><br><span class="line">		System.out.println(<span class="string">"查找set元素 ："</span>+list.indexOf(<span class="string">"set"</span>));<span class="comment">// return 2</span></span><br><span class="line">		System.out.println(<span class="string">"查找Hello元素 ： "</span>+list.indexOf(<span class="string">"Hello"</span>));<span class="comment">//return -1</span></span><br><span class="line">		</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//9. 遍历list</span></span><br><span class="line">		System.out.println(<span class="string">"\n使用增强for循环遍历\n"</span>);</span><br><span class="line">		<span class="keyword">for</span>(Object obj:list)&#123;</span><br><span class="line">			System.out.println(obj);</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		System.out.println(<span class="string">"\n使用for循环遍历\n"</span>);</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;list.size();i++)&#123;</span><br><span class="line">			System.out.println(list.get(i));</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		System.out.println(<span class="string">"\n使用迭代器遍历\n"</span>);</span><br><span class="line">		System.out.println(<span class="string">" interator 正向遍历"</span>);</span><br><span class="line">		Iterator iter =  list.iterator();</span><br><span class="line">		<span class="keyword">while</span>(iter.hasNext())&#123;</span><br><span class="line">			System.out.println(iter.next());</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		ListIterator interator =  list.listIterator();</span><br><span class="line">		System.out.println(<span class="string">"正向遍历"</span>);</span><br><span class="line">		<span class="keyword">while</span>(interator.hasNext())&#123;<span class="comment">//判断下一个元素是否存在</span></span><br><span class="line">			System.out.println(interator.next());</span><br><span class="line">		&#125;</span><br><span class="line">		System.out.println(<span class="string">"反向遍历"</span>);</span><br><span class="line">		<span class="keyword">while</span>(interator.hasPrevious())&#123;</span><br><span class="line">			System.out.println(interator.previous());</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>运行结果：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">list: [HelloArray, 123, java.util.Scanner[delimiters=\p&#123;javaWhitespace&#125;+][position=0][match valid=false][need input=false][source closed=false][skipped=false][group separator=\,][decimal separator=\.][positive prefix=][negative prefix=\Q-\E][positive suffix=][negative suffix=][NaN string=\Q?\E][infinity string=\Q∞\E]]</span><br><span class="line">list2: [HelloArray, 123]</span><br><span class="line">list: [HelloArray, 123]</span><br><span class="line">list: [HelloArray, 123]</span><br><span class="line">list中元素的个数: 2</span><br><span class="line">list中元素是否为空: false</span><br><span class="line">判断list中的元素HelloAray是否存在 true</span><br><span class="line">判断list是否包含list2 true</span><br><span class="line">list: [add, HelloArray, set]</span><br><span class="line">获得索引位置为1上的元素：HelloArray</span><br><span class="line">查找set元素 ：2</span><br><span class="line">查找Hello元素 ： -1</span><br><span class="line"></span><br><span class="line">使用增强for循环遍历</span><br><span class="line"></span><br><span class="line">add</span><br><span class="line">HelloArray</span><br><span class="line">set</span><br><span class="line"></span><br><span class="line">使用for循环遍历</span><br><span class="line"></span><br><span class="line">add</span><br><span class="line">HelloArray</span><br><span class="line">set</span><br><span class="line"></span><br><span class="line">使用迭代器遍历</span><br><span class="line"></span><br><span class="line"> interator 正向遍历</span><br><span class="line">add</span><br><span class="line">HelloArray</span><br><span class="line">set</span><br><span class="line">正向遍历</span><br><span class="line">add</span><br><span class="line">HelloArray</span><br><span class="line">set</span><br><span class="line">反向遍历</span><br><span class="line">set</span><br><span class="line">HelloArray</span><br><span class="line">add</span><br></pre></td></tr></table></figure>

<h4 id="3-ArrayList-JDK源码分析"><a href="#3-ArrayList-JDK源码分析" class="headerlink" title="3  ArrayList_JDK源码分析"></a>3  <code>ArrayList</code>_JDK源码分析</h4><h5 id="3-1-源码分析"><a href="#3-1-源码分析" class="headerlink" title="3.1 源码分析"></a>3.1 源码分析</h5><p>1 构造方法</p>
<p>2 添加方法</p>
<p>3 扩容的原理  <strong>重点</strong></p>
<p>获得当前List对象的容量，检测容量够不够使用，然后跟数组的长度做比较，若小于数组的长度，则使用<code>ArrayList</code>默认的长度，否则进行扩容。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.bjsxt.arraylist;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.Arrays;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestArrayList</span> </span>&#123;</span><br><span class="line">	<span class="comment">/**ArrayList源码分析</span></span><br><span class="line"><span class="comment">	 * (1)无参构造方法</span></span><br><span class="line"><span class="comment">	 *       this.elementData 是一个Object类型的数组</span></span><br><span class="line"><span class="comment">	 *       DEFAULTCAPACITY_EMPTY_ELEMENTDATA;也是一个Object类型的数组</span></span><br><span class="line"><span class="comment">	 *       DEFAULTCAPACITY_EMPTY_ELEMENTDATA=&#123;&#125;;默认长度为0</span></span><br><span class="line"><span class="comment">	 *     public ArrayList() &#123;</span></span><br><span class="line"><span class="comment">               this.elementData = DEFAULTCAPACITY_EMPTY_ELEMENTDATA;</span></span><br><span class="line"><span class="comment">               //相当于this.elementData=&#123;&#125;;</span></span><br><span class="line"><span class="comment">          &#125;</span></span><br><span class="line"><span class="comment">        (2)带参构造方法</span></span><br><span class="line"><span class="comment">            </span></span><br><span class="line"><span class="comment">         public ArrayList(int initialCapacity) &#123;</span></span><br><span class="line"><span class="comment">	        if (initialCapacity &gt; 0) &#123;</span></span><br><span class="line"><span class="comment">	            this.elementData = new Object[initialCapacity];</span></span><br><span class="line"><span class="comment">	            //this.elementData=new Object[20];</span></span><br><span class="line"><span class="comment">	        &#125; </span></span><br><span class="line"><span class="comment">    	&#125;</span></span><br><span class="line"><span class="comment">    	(3)添加方法 add(Object obj)</span></span><br><span class="line"><span class="comment">    	 public boolean add(E e) &#123;</span></span><br><span class="line"><span class="comment">    	        //检测空间容量是否够用</span></span><br><span class="line"><span class="comment">		        ensureCapacityInternal(size + 1);  // Increments modCount!!</span></span><br><span class="line"><span class="comment">		        //添加元素    elementData[size]=e; size++;</span></span><br><span class="line"><span class="comment">		        elementData[size++] = e;</span></span><br><span class="line"><span class="comment">		        return true;</span></span><br><span class="line"><span class="comment">    	&#125;</span></span><br><span class="line"><span class="comment">    	(4)检测空间容量是否够用</span></span><br><span class="line"><span class="comment">    	private void ensureCapacityInternal(int minCapacity) &#123;</span></span><br><span class="line"><span class="comment">        	ensureExplicitCapacity(calculateCapacity(elementData, minCapacity));</span></span><br><span class="line"><span class="comment">    	&#125;</span></span><br><span class="line"><span class="comment">    	首先调用执行 ,计算容量</span></span><br><span class="line"><span class="comment">         calculateCapacity(elementData, minCapacity)</span></span><br><span class="line"><span class="comment">         </span></span><br><span class="line"><span class="comment">         //calculateCapacity方法定义</span></span><br><span class="line"><span class="comment">         private static int calculateCapacity(Object[] elementData, int minCapacity) &#123;</span></span><br><span class="line"><span class="comment">		            //以下代码相当于elementData==&#123;&#125;</span></span><br><span class="line"><span class="comment">		        if (elementData == DEFAULTCAPACITY_EMPTY_ELEMENTDATA) &#123;  //true</span></span><br><span class="line"><span class="comment">		                   //Math.max(10,1);</span></span><br><span class="line"><span class="comment">		            return Math.max(DEFAULT_CAPACITY, minCapacity);</span></span><br><span class="line"><span class="comment">		        &#125;</span></span><br><span class="line"><span class="comment">        return minCapacity;  //执行完之后的结果为  10</span></span><br><span class="line"><span class="comment">       &#125;</span></span><br><span class="line"><span class="comment">        //容量计算完毕后，执行ensureExplicitCapacity方法    ensureExplicitCapacity(10)</span></span><br><span class="line"><span class="comment">         ensureExplicitCapacity方法定义</span></span><br><span class="line"><span class="comment">         </span></span><br><span class="line"><span class="comment">         private void ensureExplicitCapacity(int minCapacity) &#123;  //10</span></span><br><span class="line"><span class="comment">	        modCount++;</span></span><br><span class="line"><span class="comment">	</span></span><br><span class="line"><span class="comment">	        // overflow-conscious code</span></span><br><span class="line"><span class="comment">	         * 10-0 &gt;0  true</span></span><br><span class="line"><span class="comment">	        if (minCapacity - elementData.length &gt; 0)</span></span><br><span class="line"><span class="comment">	            grow(minCapacity);</span></span><br><span class="line"><span class="comment">	    &#125;</span></span><br><span class="line"><span class="comment">	    (5)扩充容量</span></span><br><span class="line"><span class="comment">	      private void grow(int minCapacity) &#123;    //10</span></span><br><span class="line"><span class="comment">	        // overflow-conscious code</span></span><br><span class="line"><span class="comment">	        int oldCapacity = elementData.length;        //int oldCapactiy=0;</span></span><br><span class="line"><span class="comment">	        </span></span><br><span class="line"><span class="comment">	        int newCapacity = oldCapacity + (oldCapacity &gt;&gt; 1);   //int newCapacity=0+0&gt;&gt;1  结果为0</span></span><br><span class="line"><span class="comment">	      </span></span><br><span class="line"><span class="comment">	        if (newCapacity - minCapacity &lt; 0)       // 0-10&lt;0    true</span></span><br><span class="line"><span class="comment">	        </span></span><br><span class="line"><span class="comment">	            newCapacity = minCapacity;           //newCapacity=10;</span></span><br><span class="line"><span class="comment">	            </span></span><br><span class="line"><span class="comment">	      </span></span><br><span class="line"><span class="comment">	        elementData = Arrays.copyOf(elementData, newCapacity); //数组拷贝 elementData的长度就是 10</span></span><br><span class="line"><span class="comment">    &#125;</span></span><br><span class="line"><span class="comment">	 * */</span></span><br><span class="line">       </span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		ArrayList list=<span class="keyword">new</span> ArrayList();</span><br><span class="line">		<span class="comment">//第一次调用添加方法时，完成Object类型数组的初始化容量 ，10</span></span><br><span class="line">		list.add(<span class="string">"hello"</span>);</span><br><span class="line">		list.add(<span class="string">"world"</span>);</span><br><span class="line">		list.add(<span class="string">"hello"</span>);</span><br><span class="line">		list.add(<span class="string">"world"</span>);</span><br><span class="line">		list.add(<span class="string">"hello"</span>);</span><br><span class="line">		list.add(<span class="string">"world"</span>);</span><br><span class="line">		list.add(<span class="string">"hello"</span>);</span><br><span class="line">		list.add(<span class="string">"world"</span>);</span><br><span class="line">		list.add(<span class="string">"hello"</span>);</span><br><span class="line">		list.add(<span class="string">"world"</span>);<span class="comment">//10个元素对象</span></span><br><span class="line">		<span class="comment">/**当添加第11个元素时，所需容量为11，而数组的长度为10，已经无法容纳元素了，这个时候需要扩容，</span></span><br><span class="line"><span class="comment">		 * 原始容量+原始容量&gt;&gt;1   得到新容量</span></span><br><span class="line"><span class="comment">		 * 10+10&gt;&gt;1           15*/</span></span><br><span class="line">		</span><br><span class="line">		list.add(<span class="string">"hello"</span>);<span class="comment">//当添加第11个元素对象时 怎么办？</span></span><br><span class="line">		</span><br><span class="line">		Object [] obj=&#123;&#125;;</span><br><span class="line">		</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="3-2-源码分析2"><a href="#3-2-源码分析2" class="headerlink" title="3.2 源码分析2"></a>3.2 源码分析2</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.bjsxt.arraylist.source;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.Iterator;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestArrayList</span> </span>&#123;</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * ArrayList源码分析_2</span></span><br><span class="line"><span class="comment">	 * (1)add(int index,Object obj)</span></span><br><span class="line"><span class="comment">	 *  public void add(int index, E element) &#123;</span></span><br><span class="line"><span class="comment">	       </span></span><br><span class="line"><span class="comment">	                        //源数组              ,源数组开始位置  ,新数组            ,新数组开始位置</span></span><br><span class="line"><span class="comment">	        System.arraycopy(elementData, index,  elementData, index + 1,</span></span><br><span class="line"><span class="comment">	                         size - index);  //size-index ，拷贝的元素的个数</span></span><br><span class="line"><span class="comment">	                         </span></span><br><span class="line"><span class="comment">	        elementData[index] = element;//将元素添加到索引为 index的位置上</span></span><br><span class="line"><span class="comment">	        size++;            //元素的个数+1</span></span><br><span class="line"><span class="comment">    &#125;</span></span><br><span class="line"><span class="comment">     (2)get(int index)根据索引获取元素对象</span></span><br><span class="line"><span class="comment">        public E get(int index) &#123;</span></span><br><span class="line"><span class="comment">        </span></span><br><span class="line"><span class="comment">            return elementData(index);  //调用了elementData()的方法</span></span><br><span class="line"><span class="comment">       &#125;</span></span><br><span class="line"><span class="comment">         //elementData方法的定义</span></span><br><span class="line"><span class="comment">        E elementData(int index) &#123;</span></span><br><span class="line"><span class="comment">        </span></span><br><span class="line"><span class="comment">        return (E) elementData[index];   //在Object类型的数组中根据索引取出元素对象</span></span><br><span class="line"><span class="comment">    &#125;</span></span><br><span class="line"><span class="comment">    (3)size()</span></span><br><span class="line"><span class="comment">       public int size() &#123;</span></span><br><span class="line"><span class="comment">        return size;   //用于记录集合中元素的个数</span></span><br><span class="line"><span class="comment">      &#125;</span></span><br><span class="line"><span class="comment">    (4)isEmpty()</span></span><br><span class="line"><span class="comment">       public boolean isEmpty() &#123;</span></span><br><span class="line"><span class="comment">        return size == 0;  //集合中一个元素都没有的时候，集合就是空的</span></span><br><span class="line"><span class="comment">       &#125;</span></span><br><span class="line"><span class="comment">    (5)set(int index, Object obj)</span></span><br><span class="line"><span class="comment">	    public E set(int index, E element) &#123;</span></span><br><span class="line"><span class="comment">	        </span></span><br><span class="line"><span class="comment">	        E oldValue = elementData(index);   //根据索引在数组中获取元素</span></span><br><span class="line"><span class="comment">	        </span></span><br><span class="line"><span class="comment">	        elementData[index] = element;  //将新元素设置到数组中索引为index的位置上</span></span><br><span class="line"><span class="comment">	        </span></span><br><span class="line"><span class="comment">	        return oldValue;        //返回原始元素对象</span></span><br><span class="line"><span class="comment">	    &#125;</span></span><br><span class="line"><span class="comment">	  (6)remove(int index)</span></span><br><span class="line"><span class="comment">	  </span></span><br><span class="line"><span class="comment">		  public E remove(int index) &#123;</span></span><br><span class="line"><span class="comment">	         </span></span><br><span class="line"><span class="comment">	        E oldValue = elementData(index);//根据索引获取原始元素对象</span></span><br><span class="line"><span class="comment">	</span></span><br><span class="line"><span class="comment">	        int numMoved = size - index - 1;   //拷贝的元素的个数</span></span><br><span class="line"><span class="comment">	        </span></span><br><span class="line"><span class="comment">	        if (numMoved &gt; 0)</span></span><br><span class="line"><span class="comment">	            System.arraycopy(elementData, index+1, elementData, index,</span></span><br><span class="line"><span class="comment">	                             numMoved);</span></span><br><span class="line"><span class="comment">	                             </span></span><br><span class="line"><span class="comment">	        elementData[--size] = null; //   将最后一个位置设置为null</span></span><br><span class="line"><span class="comment">	</span></span><br><span class="line"><span class="comment">	        return oldValue;        //返回原始元素对象</span></span><br><span class="line"><span class="comment">     &#125;</span></span><br><span class="line"><span class="comment">      (7)clear()</span></span><br><span class="line"><span class="comment">        public void clear() &#123;</span></span><br><span class="line"><span class="comment">        </span></span><br><span class="line"><span class="comment">        // clear to let GC do its work</span></span><br><span class="line"><span class="comment">        for (int i = 0; i &lt; size; i++)</span></span><br><span class="line"><span class="comment">            elementData[i] = null;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">        size = 0;</span></span><br><span class="line"><span class="comment">     &#125;</span></span><br><span class="line"><span class="comment">      (8)iterator()</span></span><br><span class="line"><span class="comment">	 * */</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		<span class="comment">//创建ArrayList集合对象</span></span><br><span class="line">		ArrayList list=<span class="keyword">new</span> ArrayList();</span><br><span class="line">		list.add(<span class="string">"hello"</span>);</span><br><span class="line">		list.add(<span class="string">"world"</span>);</span><br><span class="line">		list.add(<span class="number">0</span>, <span class="string">"java"</span>);<span class="comment">//在索引为0的位置上添加"java"</span></span><br><span class="line">		System.out.println(list);</span><br><span class="line">		System.out.println(list.get(<span class="number">1</span>));</span><br><span class="line">		System.out.println(list.size());</span><br><span class="line">		System.out.println(list.isEmpty());</span><br><span class="line">		System.out.println(list.set(<span class="number">2</span>, <span class="string">"sql"</span>));</span><br><span class="line">		System.out.println(list);</span><br><span class="line">		list.remove(<span class="number">1</span>);</span><br><span class="line">		list.clear();</span><br><span class="line">		Iterator ite= list.iterator();</span><br><span class="line">		<span class="keyword">while</span>(ite.hasNext())&#123;</span><br><span class="line">			Object obj=ite.next();</span><br><span class="line">			System.out.println(obj);</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="4-LinkedList的特点-链表-JDK源码分析"><a href="#4-LinkedList的特点-链表-JDK源码分析" class="headerlink" title="4 LinkedList的特点_链表_JDK源码分析"></a>4 <code>LinkedList</code>的特点_链表_JDK源码分析</h4><h5 id="4-1LinkedList概念"><a href="#4-1LinkedList概念" class="headerlink" title="4.1LinkedList概念"></a>4.1<code>LinkedList</code>概念</h5><p><img src="http://www.zwer.xyz/ListedList.png" alt="1541416351640"></p>
<p>​        </p>
<h5 id="4-2-JDK源码分析"><a href="#4-2-JDK源码分析" class="headerlink" title="4.2 JDK源码分析"></a>4.2 JDK源码分析</h5><p><code>LinkedList</code>底层数据结构是链表,删除和添加元素的效率比较高，数据结构复杂<br><code>ArrayList</code> 底层数据结构是数组， 删除和添加元素效率比较低</p>
<ol>
<li><code>add(Object obj)</code></li>
<li><code>addFirst()</code></li>
<li><code>removeFirst()</code></li>
<li><code>removeLast()</code></li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.bjsxt.linkedlist;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.LinkedList;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestLinkedList</span> </span>&#123;</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * LinkedList底层数据结构是链表,删除和添加元素的效率比较高，数据结构复杂</span></span><br><span class="line"><span class="comment">	 * ArrayList底层数据结构是数组， 删除和添加元素效率比较低</span></span><br><span class="line"><span class="comment">	 * LinkedList底层源码分析</span></span><br><span class="line"><span class="comment">	 * (1)构造方法</span></span><br><span class="line"><span class="comment">	 * public LinkedList() &#123;</span></span><br><span class="line"><span class="comment">       &#125;</span></span><br><span class="line"><span class="comment">       (2)添加方法</span></span><br><span class="line"><span class="comment">      public boolean add(E e) &#123;</span></span><br><span class="line"><span class="comment">        linkLast(e);</span></span><br><span class="line"><span class="comment">        return true;</span></span><br><span class="line"><span class="comment">    &#125;</span></span><br><span class="line"><span class="comment">      </span></span><br><span class="line"><span class="comment">	 * */</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		LinkedList list=<span class="keyword">new</span> LinkedList();</span><br><span class="line">		<span class="comment">//添加元素</span></span><br><span class="line">		list.add(<span class="string">"hello"</span>);</span><br><span class="line">		list.addFirst(<span class="string">"java"</span>);</span><br><span class="line">		list.addLast(<span class="string">"world"</span>);</span><br><span class="line">		<span class="comment">//删头，删尾</span></span><br><span class="line">		<span class="comment">//list.removeLast();</span></span><br><span class="line">		<span class="comment">//list.removeFirst();</span></span><br><span class="line">		System.out.println(list);</span><br><span class="line">		<span class="comment">//遍历</span></span><br><span class="line">		<span class="keyword">for</span>(Object obj:list)&#123;</span><br><span class="line">			System.out.println(obj);</span><br><span class="line">		&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="4-3-作业"><a href="#4-3-作业" class="headerlink" title="4.3  作业"></a>4.3  作业</h5><p><strong>项目目标</strong></p>
<p>手写 LinkedList，并实现 add 、remove 、get 方法</p>
<p><strong>项目代码</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.szxy;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.AbstractSequentialList;</span><br><span class="line"><span class="keyword">import</span> java.util.Arrays;</span><br><span class="line"><span class="keyword">import</span> java.util.Deque;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 手写 LinkList，并实现 add 、remove 、get方法</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Administrator</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestLinkedList</span>&lt;<span class="title">E</span>&gt; </span>&#123;	</span><br><span class="line">	 <span class="keyword">int</span> size = <span class="number">0</span>;  <span class="comment">//节点的个数</span></span><br><span class="line">	 Node&lt;E&gt; first; <span class="comment">//前驱</span></span><br><span class="line">	 Node&lt;E&gt; last;  <span class="comment">//后继</span></span><br><span class="line">	  </span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">TestLinkedList</span><span class="params">()</span> </span>&#123;<span class="comment">//无参构造方法</span></span><br><span class="line">		</span><br><span class="line">    &#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">add</span><span class="params">(E e)</span> </span>&#123;<span class="comment">//添加元素</span></span><br><span class="line">        linkLast(e);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">linkLast</span><span class="params">(E e)</span> </span>&#123;<span class="comment">//在链尾添加新的元素</span></span><br><span class="line">        <span class="keyword">final</span> Node&lt;E&gt; l = last;       <span class="comment">//指向前面的指针 元素的值 指向后面的指针 </span></span><br><span class="line">        <span class="keyword">final</span> Node&lt;E&gt; newNode = <span class="keyword">new</span> Node&lt;&gt;(l, e, <span class="keyword">null</span>);<span class="comment">//新的节点对象</span></span><br><span class="line">        last = newNode;</span><br><span class="line">        <span class="keyword">if</span> (l == <span class="keyword">null</span>) &#123;<span class="comment">//最开始没有元素的情况下，即没有前继</span></span><br><span class="line">            first = newNode;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            l.next = newNode;</span><br><span class="line">        &#125;</span><br><span class="line">        size++;<span class="comment">//节点的个数加 1</span></span><br><span class="line">    &#125;</span><br><span class="line">	<span class="comment">//根据 元素 移除 节点</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">remove</span><span class="params">(Object o)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (o == <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="keyword">for</span> (Node&lt;E&gt; x = first; x != <span class="keyword">null</span>; x = x.next) &#123;</span><br><span class="line">                <span class="keyword">if</span> (x.item == <span class="keyword">null</span>) &#123;</span><br><span class="line">                    unlink(x);</span><br><span class="line">                    <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">for</span> (Node&lt;E&gt; x = first; x != <span class="keyword">null</span>; x = x.next) &#123;</span><br><span class="line">                <span class="keyword">if</span> (o.equals(x.item)) &#123;</span><br><span class="line">                    unlink(x);</span><br><span class="line">                    <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">	<span class="function">E <span class="title">unlink</span><span class="params">(Node&lt;E&gt; x)</span> </span>&#123; <span class="comment">//去除节点</span></span><br><span class="line">        <span class="keyword">final</span> E element = x.item; <span class="comment">// 保存被去除节点元素的值</span></span><br><span class="line">        <span class="keyword">final</span> Node&lt;E&gt; next = x.next;</span><br><span class="line">        <span class="keyword">final</span> Node&lt;E&gt; prev = x.prev;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (prev == <span class="keyword">null</span>) &#123;</span><br><span class="line">            first = next;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            prev.next = next;</span><br><span class="line">            x.prev = <span class="keyword">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (next == <span class="keyword">null</span>) &#123;</span><br><span class="line">            last = prev;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            next.prev = prev;</span><br><span class="line">            x.next = <span class="keyword">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        x.item = <span class="keyword">null</span>;</span><br><span class="line">        size--; <span class="comment">//节点的个数 减一</span></span><br><span class="line">        <span class="keyword">return</span> element; <span class="comment">// 返回被移除节点的值</span></span><br><span class="line">    &#125;</span><br><span class="line">	</span><br><span class="line">	 <span class="keyword">public</span> Object[] toArray() &#123;<span class="comment">//遍历双链表，返回节点的值</span></span><br><span class="line">	        Object[] result = <span class="keyword">new</span> Object[size];</span><br><span class="line">	        <span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line">	        <span class="comment">//将首指针 first 赋给节点 x ，用 x 遍历 双链表，从头到尾</span></span><br><span class="line">	        <span class="keyword">for</span> (Node&lt;E&gt; x = first; x != <span class="keyword">null</span>; x = x.next) &#123;</span><br><span class="line">	            result[i++] = x.item;</span><br><span class="line">	        	<span class="comment">//System.out.println("指针x："+x.item);</span></span><br><span class="line">	        &#125;</span><br><span class="line">	        <span class="keyword">return</span> result;</span><br><span class="line">	  &#125;</span><br><span class="line">	 <span class="comment">// 根据 索引 获的 元素</span></span><br><span class="line">	 <span class="function"><span class="keyword">public</span> E <span class="title">get</span><span class="params">(<span class="keyword">int</span> index)</span> </span>&#123;</span><br><span class="line">	        checkElementIndex(index);<span class="comment">//检查元素是否越界</span></span><br><span class="line">	        <span class="keyword">return</span> node(index).item;</span><br><span class="line">	    &#125;</span><br><span class="line">	 <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">checkElementIndex</span><span class="params">(<span class="keyword">int</span> index)</span> </span>&#123;</span><br><span class="line">	        <span class="keyword">if</span> (!isElementIndex(index))</span><br><span class="line">	            <span class="keyword">throw</span> <span class="keyword">new</span> IndexOutOfBoundsException(outOfBoundsMsg(index));</span><br><span class="line">	    &#125;</span><br><span class="line">	 <span class="function"><span class="keyword">private</span> String <span class="title">outOfBoundsMsg</span><span class="params">(<span class="keyword">int</span> index)</span> </span>&#123;</span><br><span class="line">	        <span class="keyword">return</span> <span class="string">"Index: "</span>+index+<span class="string">", Size: "</span>+size;</span><br><span class="line">	    &#125;</span><br><span class="line">	 <span class="function"><span class="keyword">private</span> <span class="keyword">boolean</span> <span class="title">isElementIndex</span><span class="params">(<span class="keyword">int</span> index)</span> </span>&#123;</span><br><span class="line">	        <span class="keyword">return</span> index &gt;= <span class="number">0</span> &amp;&amp; index &lt; size;</span><br><span class="line">	    &#125;</span><br><span class="line">	 <span class="function">Node&lt;E&gt; <span class="title">node</span><span class="params">(<span class="keyword">int</span> index)</span> </span>&#123;<span class="comment">//根据索引获的对应的节点元素的值</span></span><br><span class="line">	        <span class="keyword">if</span> (index &lt; (size &gt;&gt; <span class="number">1</span>)) &#123;</span><br><span class="line">	            Node&lt;E&gt; x = first;</span><br><span class="line">	            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; index; i++)</span><br><span class="line">	                x = x.next;</span><br><span class="line">	            <span class="keyword">return</span> x;</span><br><span class="line">	        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">	            Node&lt;E&gt; x = last;</span><br><span class="line">	            <span class="keyword">for</span> (<span class="keyword">int</span> i = size - <span class="number">1</span>; i &gt; index; i--)</span><br><span class="line">	                x = x.prev;</span><br><span class="line">	            <span class="keyword">return</span> x;</span><br><span class="line">	        &#125;</span><br><span class="line">	    &#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//静态内部类  节点类  双链表结构</span></span><br><span class="line">	 <span class="keyword">private</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">Node</span>&lt;<span class="title">E</span>&gt; </span>&#123;</span><br><span class="line">	        E item; <span class="comment">// 元素的值</span></span><br><span class="line">	        Node&lt;E&gt; next;<span class="comment">//指向后一个节点 前驱</span></span><br><span class="line">	        Node&lt;E&gt; prev;<span class="comment">//指向前一个节点 后继</span></span><br><span class="line"></span><br><span class="line">	        Node(Node&lt;E&gt; prev, E element, Node&lt;E&gt; next) &#123;</span><br><span class="line">	            <span class="keyword">this</span>.item = element;</span><br><span class="line">	            <span class="keyword">this</span>.next = next;</span><br><span class="line">	            <span class="keyword">this</span>.prev = prev;</span><br><span class="line">	        &#125;</span><br><span class="line">	    &#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">			TestLinkedList&lt;String&gt; t = <span class="keyword">new</span> TestLinkedList&lt;String&gt;();</span><br><span class="line">			System.out.println(<span class="string">"1 通过 add 方法添加节点元素："</span>);</span><br><span class="line">			t.add(<span class="string">"HelloWorld"</span>);</span><br><span class="line">			t.add(<span class="string">"XML"</span>);</span><br><span class="line">			t.add(<span class="string">"Schema"</span>);</span><br><span class="line">			t.add(<span class="string">"Mysql"</span>);</span><br><span class="line">			t.add(<span class="string">"Struct of Data"</span>);</span><br><span class="line">			System.out.println(Arrays.toString(t.toArray())+<span class="string">"\n"</span>);</span><br><span class="line">			</span><br><span class="line">			System.out.println(<span class="string">"2 通过 remove 方法删除节点元素 XML ："</span>);</span><br><span class="line">			System.out.println(Arrays.toString(t.toArray())+<span class="string">"\n"</span>);</span><br><span class="line">			</span><br><span class="line">			System.out.println(<span class="string">"3 通过 get方法 获取元素 HelloWorld"</span>);</span><br><span class="line">			System.out.println(<span class="string">"调用 get方法 获的: "</span>+t.get(<span class="number">0</span>)+<span class="string">"\n"</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>项目运行结果</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span> 通过 add 方法添加节点元素：</span><br><span class="line">[HelloWorld, XML, Schema, Mysql, Struct of Data]</span><br><span class="line"></span><br><span class="line"><span class="number">2</span> 通过 remove 方法删除节点元素 XML ：</span><br><span class="line">[HelloWorld, XML, Schema, Mysql, Struct of Data]</span><br><span class="line"></span><br><span class="line"><span class="number">3</span> 通过 get方法 获取元素 HelloWorld</span><br><span class="line">调用 get方法 获的: HelloWorld</span><br></pre></td></tr></table></figure>

<p><strong>项目心得</strong></p>
<p>  首先明确 Java 中的 LinkedList 的底层数据结构是链表，而且是双链表结构，也就是<br><br>  每个双链表中的节点都有一个前驱和一个后继，并且可以正向遍历，也可以反向遍历。</p>
<ul>
<li>1 add 方法编写，先判断是否存在节点，若不存在节点，则第一个放入的元素当做首节点，<br>  若存在节点，则将最后的节点指向新节点的前驱，并将新节点的后继设为 null，最后<pre><code>节点的个数加 1.</code></pre></li>
<li>2 remove 方法编写，先将整个双链表遍历，找到与要移除值相等的节点，然后将其移除，<br>  最后节点的个数减 1。</li>
<li>3 get方法的编写，是根据索引获的对应位置的节点中的值。先将双链表遍历，找到索引元素所在的<br>  位置，然后将其取出并返回。</li>
</ul>
<h4 id="5-Vector-用法和ArrayList区别"><a href="#5-Vector-用法和ArrayList区别" class="headerlink" title="5 Vector 用法和ArrayList区别"></a>5 Vector 用法和<code>ArrayList</code>区别</h4><h5 id="5-1-Vector-用法"><a href="#5-1-Vector-用法" class="headerlink" title="5.1 Vector 用法"></a>5.1 Vector 用法</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.szxy.collection.vector;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Iterator;</span><br><span class="line"><span class="keyword">import</span> java.util.Vector;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestVector</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		Vector vector = <span class="keyword">new</span> Vector();</span><br><span class="line">		System.out.println(<span class="string">"vector初始容量"</span>+vector.capacity()+<span class="string">"\tvector中元素的个数"</span>+vector.size());</span><br><span class="line">		vector.add(<span class="string">"Hello"</span>);</span><br><span class="line">		vector.addElement(<span class="string">"World!"</span>);</span><br><span class="line">		vector.add(<span class="string">"真好"</span>);</span><br><span class="line">		vector.add(<span class="string">"Hello"</span>);</span><br><span class="line">		vector.addElement(<span class="string">"World!"</span>);</span><br><span class="line">		vector.add(<span class="string">"真好"</span>);</span><br><span class="line">		vector.add(<span class="string">"Hello"</span>);</span><br><span class="line">		vector.addElement(<span class="string">"World!"</span>);</span><br><span class="line">		vector.add(<span class="string">"真好"</span>);</span><br><span class="line">		vector.add(<span class="string">"Hello"</span>);</span><br><span class="line">		vector.addElement(<span class="string">"World!"</span>);</span><br><span class="line">		vector.add(<span class="string">"真好"</span>);</span><br><span class="line">		System.out.println(<span class="string">"vector初始容量"</span>+vector.capacity()+<span class="string">"\tvector中元素的个数"</span>+vector.size());</span><br><span class="line">		System.out.println(vector);</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//vector.remove(1);</span></span><br><span class="line">		<span class="comment">//vector.remove("真好");</span></span><br><span class="line">		<span class="comment">//vector.clear();</span></span><br><span class="line">		<span class="comment">//vector.removeElement(1);</span></span><br><span class="line">		System.out.println(vector);</span><br><span class="line">		</span><br><span class="line">		System.out.println(<span class="string">"使用增强for循环遍历"</span>);</span><br><span class="line">		<span class="keyword">for</span>(Object obj: vector)&#123;</span><br><span class="line">			System.out.println(obj);</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		System.out.println(<span class="string">"使用迭代器遍历 推荐使用for循环，省内存空间，用完对象即消除"</span>);</span><br><span class="line">		<span class="keyword">for</span>(Iterator ite = vector.iterator();ite.hasNext();)&#123;</span><br><span class="line">				System.out.println(ite.next());</span><br><span class="line">		&#125;</span><br><span class="line">		System.out.println(<span class="string">"使用while遍历"</span>);</span><br><span class="line">		Iterator ite = vector.iterator();</span><br><span class="line">		<span class="keyword">while</span>(ite.hasNext())&#123;</span><br><span class="line">			System.out.println(ite.next());</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="5-2-Vector-与-ArrayList-的区别"><a href="#5-2-Vector-与-ArrayList-的区别" class="headerlink" title="5.2 Vector 与 ArrayList 的区别"></a>5.2 Vector 与 <code>ArrayList</code> 的区别</h5><p>相同：底层数据结构相同，都是Object类型的数组</p>
<p>区别：同步  扩容  初始化容量 安全 效率 </p>
<p>1 Vector的add()方法是<strong>同步</strong>方法，而<code>ArrayList</code>方法add()方法是非同步方法</p>
<p>2 Vector扩容每次扩充<strong>1倍</strong>，<code>ArrayList</code>扩容每次扩充<strong>0.5倍</strong></p>
<p>3 Vector 是在<strong>调用构造方法</strong>时，直接初始化容量为10，<code>ArrayList</code>是在第一次<strong>调用添加方法时</strong>，初始化容量为10     </p>
<p>4 Vector的版本是JDK1.0，而<code>ArraryList</code>的版本是JDK1.2</p>
<p>5 Vector 是线程同步的，安全性高，效率低</p>
<p>  <code>ArrayList</code>是线程非同步的，安全性低，效率高</p>
<h4 id="6-Map接口-HashMap-Hashtable"><a href="#6-Map接口-HashMap-Hashtable" class="headerlink" title="6 Map接口  HashMap _Hashtable"></a>6 Map接口  <code>HashMap</code> _<code>Hashtable</code></h4><h5 id="6-1-Map接口"><a href="#6-1-Map接口" class="headerlink" title="6.1 Map接口"></a>6.1 Map接口</h5><p>1 实现Map接口的类用来存储键(key)值(value)对</p>
<p>2 Map接口的实现类有 <code>HashMap</code>和<code>TreeMap</code>等</p>
<p>3 Map 类中存储的键-值对通过键来标识，所以<strong>键值不能重复</strong>,否则后者的值会覆盖前者</p>
<h5 id="6-2-Map用法"><a href="#6-2-Map用法" class="headerlink" title="6.2 Map用法"></a>6.2 Map用法</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.szxy.collection.map;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Collection;</span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.Set;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestHashMap</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		HashMap  h   = <span class="keyword">new</span> HashMap();</span><br><span class="line">		<span class="comment">//放入</span></span><br><span class="line">		h.put(<span class="number">1</span>,<span class="string">"HelloWorld"</span>);</span><br><span class="line">		h.put(<span class="number">2</span>,<span class="string">"Java"</span>);</span><br><span class="line">		h.put(<span class="number">3</span>,<span class="string">"key3"</span>);</span><br><span class="line">		h.put(<span class="number">3</span>,<span class="string">"key4"</span>);</span><br><span class="line">		System.out.println(<span class="string">"集合中元素是否为空:"</span>+h.isEmpty());</span><br><span class="line">		System.out.println(<span class="string">"集合汇总元素的个数为:"</span>+h.size());</span><br><span class="line">		System.out.println(h);</span><br><span class="line">		<span class="comment">//移除</span></span><br><span class="line">		System.out.println(<span class="string">"移除键值为1的值："</span>+h.remove(<span class="number">1</span>));</span><br><span class="line">		System.out.println(h);</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//判断</span></span><br><span class="line">		System.out.println(<span class="string">"判断键是否存在"</span>+h.containsKey(<span class="number">1</span>)+<span class="string">"\t"</span>+h.containsKey(<span class="string">"2"</span>));</span><br><span class="line">		System.out.println(<span class="string">"判断值是否存在"</span>+h.containsValue(<span class="string">"love"</span>) +<span class="string">"\t"</span>+h.containsValue(<span class="string">"Java"</span>));</span><br><span class="line">		</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//获取</span></span><br><span class="line">		System.out.println(h.get(<span class="number">1</span>));</span><br><span class="line">		System.out.println(h.get(<span class="number">2</span>));</span><br><span class="line">		</span><br><span class="line">		Set keyset = h.keySet();</span><br><span class="line">		System.out.println(<span class="string">"获得所有的键:"</span>+keyset);</span><br><span class="line">		</span><br><span class="line">		Collection col = h.values();</span><br><span class="line">		System.out.println(<span class="string">"获得所有的值："</span>+col);</span><br><span class="line">		</span><br><span class="line">		Set entryset = h.entrySet();</span><br><span class="line">		System.out.println(<span class="string">"获得所有的键值对："</span>+entryset);</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/*结果：</span></span><br><span class="line"><span class="comment">    集合中元素是否为空:false</span></span><br><span class="line"><span class="comment">    集合汇总元素的个数为:3</span></span><br><span class="line"><span class="comment">    &#123;1=HelloWorld, 2=Java, 3=key4&#125;</span></span><br><span class="line"><span class="comment">    移除键值为1的值：HelloWorld</span></span><br><span class="line"><span class="comment">    &#123;2=Java, 3=key4&#125;</span></span><br><span class="line"><span class="comment">    判断键是否存在false	false</span></span><br><span class="line"><span class="comment">    判断值是否存在false	true</span></span><br><span class="line"><span class="comment">    null</span></span><br><span class="line"><span class="comment">    Java</span></span><br><span class="line"><span class="comment">    获得所有的键:[2, 3]</span></span><br><span class="line"><span class="comment">    获得所有的值：[Java, key4]</span></span><br><span class="line"><span class="comment">    获得所有的键值对：[2=Java, 3=key4]*/</span></span><br></pre></td></tr></table></figure>

<h5 id="6-3-HashMap与Hashtable区别"><a href="#6-3-HashMap与Hashtable区别" class="headerlink" title="6.3 HashMap与Hashtable区别"></a>6.3 <code>HashMap</code>与<code>Hashtable</code>区别</h5><p>区别：</p>
<p>1 版本不同<code>HashMap</code> JDK1.2      <code>Hashtable</code> JDK1.0</p>
<p>2 <code>Hashmap</code>继承了<code>AbstractMap</code> ，实现了Map接口，<code>Hashtable</code>继承了<code>Directionary</code>实现了Map接口</p>
<p>3 <code>HashMap</code>允许null值和null键，但是null作为key值允许一个，<code>Hashtable</code>非null键和值</p>
<p>4 <code>HashMap</code>是线程不同步的（效率高，安全性低）</p>
<p>   <code>Hashtable</code>是线程同步的（安全性高，效率低）</p>
<h4 id="7-HashMap-的底层原理"><a href="#7-HashMap-的底层原理" class="headerlink" title="7 HashMap 的底层原理"></a>7 HashMap 的底层原理</h4><p>7.1 </p>
<p>概念： Hashtable 也叫 散列表</p>
<p>特点： 炒鸡快</p>
<p>结构： 结构有多种  </p>
<p>最流行+最容易理解：<strong>顺序表+链表</strong></p>
<p>主结构：顺序表</p>
<p>每个顺序表的节点在单独引出一个链表</p>
<p><img src="http://www.zwer.xyz/%E5%8F%8C%E9%93%BE%E8%A1%A8.png" alt="双链表"></p>
<p><img src="http://www.zwer.xyz/HashMap.jpg" alt="HashMap的存储原理"></p>
<h4 id="8-二叉树与红黑树"><a href="#8-二叉树与红黑树" class="headerlink" title="8 二叉树与红黑树"></a>8 二叉树与红黑树</h4><h5 id="8-1-二叉树"><a href="#8-1-二叉树" class="headerlink" title="8.1 二叉树"></a>8.1 二叉树</h5><h5 id="8-2-二叉查询树"><a href="#8-2-二叉查询树" class="headerlink" title="8.2 二叉查询树"></a>8.2 二叉查询树</h5><h5 id="8-3-红黑树（二叉平衡树）"><a href="#8-3-红黑树（二叉平衡树）" class="headerlink" title="8.3 红黑树（二叉平衡树）"></a>8.3 红黑树（二叉平衡树）</h5><h5 id="9-TreeMap的使用和底层实现"><a href="#9-TreeMap的使用和底层实现" class="headerlink" title="9 TreeMap的使用和底层实现"></a>9 <code>TreeMap</code>的使用和底层实现</h5><h5 id="9-1-TreeMap-的用法"><a href="#9-1-TreeMap-的用法" class="headerlink" title="9.1 TreeMap 的用法"></a>9.1 <code>TreeMap</code> 的用法</h5><p><code>TreeMap</code>中键是<strong>有序的**</strong>，而且是<strong>升序的**</strong></p>
<p>底层数据结构：<strong>红黑树</strong></p>
<p><code>HashMap</code>中键是无序的</p>
<h5 id="9-2-TreeMap的底层实现"><a href="#9-2-TreeMap的底层实现" class="headerlink" title="9.2 TreeMap的底层实现"></a>9.2 T<code>reeMap</code>的底层实现</h5><p>如果使用<code>TreeMap</code>存储自定义对象作为key时，要求必须</p>
<p>具备<strong>比较规则</strong>，否则运行报错。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.bjsxt.treemap;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Comparator;</span><br><span class="line"><span class="keyword">import</span> java.util.TreeMap;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestTreeMap</span> </span>&#123;</span><br><span class="line">	<span class="comment">/***</span></span><br><span class="line"><span class="comment">	 * TreeMap的底层实现</span></span><br><span class="line"><span class="comment">	 * </span></span><br><span class="line"><span class="comment">	 *  private final Comparator&lt;? super K&gt; comparator;  外部比较器，用于比较大小的</span></span><br><span class="line"><span class="comment">	 *  private transient Entry&lt;K,V&gt; root;   //代表的是树根</span></span><br><span class="line"><span class="comment">	 * public TreeMap() &#123;</span></span><br><span class="line"><span class="comment">        comparator = null;</span></span><br><span class="line"><span class="comment">       &#125;</span></span><br><span class="line"><span class="comment">       public V put(K key, V value) &#123;</span></span><br><span class="line"><span class="comment">        Entry&lt;K,V&gt; t = root;   //指向树根</span></span><br><span class="line"><span class="comment">        if (t == null) &#123;</span></span><br><span class="line"><span class="comment">              //比较大小</span></span><br><span class="line"><span class="comment">            compare(key, key); // type (and possibly null) check</span></span><br><span class="line"><span class="comment">            //创建一个根节点</span></span><br><span class="line"><span class="comment">            root = new Entry&lt;&gt;(key, value, null);</span></span><br><span class="line"><span class="comment">            </span></span><br><span class="line"><span class="comment">            size = 1;   //个数++</span></span><br><span class="line"><span class="comment">            modCount++;</span></span><br><span class="line"><span class="comment">            return null;</span></span><br><span class="line"><span class="comment">        &#125;</span></span><br><span class="line"><span class="comment">        int cmp;</span></span><br><span class="line"><span class="comment">        Entry&lt;K,V&gt; parent;   //父节点</span></span><br><span class="line"><span class="comment">        // split comparator and comparable paths</span></span><br><span class="line"><span class="comment">         * </span></span><br><span class="line"><span class="comment">        Comparator&lt;? super K&gt; cpr = comparator;   //null</span></span><br><span class="line"><span class="comment">         //如果外部比较器不等于null,说明外部比较器存在</span></span><br><span class="line"><span class="comment">        if (cpr != null) &#123;</span></span><br><span class="line"><span class="comment">            do &#123;</span></span><br><span class="line"><span class="comment">                parent = t;   //把root赋给父节点</span></span><br><span class="line"><span class="comment">                </span></span><br><span class="line"><span class="comment">                cmp = cpr.compare(key, t.key);  //调用外部比较器的比较方法开始比大小,结果是一个int类型的值</span></span><br><span class="line"><span class="comment">                </span></span><br><span class="line"><span class="comment">                if (cmp &lt; 0)</span></span><br><span class="line"><span class="comment">                    t = t.left;   //在左子树上查找</span></span><br><span class="line"><span class="comment">                else if (cmp &gt; 0)   //在右子树上查找</span></span><br><span class="line"><span class="comment">                    t = t.right;</span></span><br><span class="line"><span class="comment">                else</span></span><br><span class="line"><span class="comment">                    return t.setValue(value);   //找到了，值进行覆盖</span></span><br><span class="line"><span class="comment">            &#125; while (t != null);</span></span><br><span class="line"><span class="comment">        &#125;</span></span><br><span class="line"><span class="comment">        else &#123;  //外部比较器不存在，使用内部比较器进行比较</span></span><br><span class="line"><span class="comment">            if (key == null)</span></span><br><span class="line"><span class="comment">                throw new NullPointerException();</span></span><br><span class="line"><span class="comment">            <span class="doctag">@SuppressWarnings</span>("unchecked")</span></span><br><span class="line"><span class="comment">                Comparable&lt;? super K&gt; k = (Comparable&lt;? super K&gt;) key;</span></span><br><span class="line"><span class="comment">            do &#123;</span></span><br><span class="line"><span class="comment">                parent = t;    //root赋给父节点</span></span><br><span class="line"><span class="comment">                cmp = k.compareTo(t.key);  //调用内部比较器的比较大小的方法，比较结果为int类型</span></span><br><span class="line"><span class="comment">                if (cmp &lt; 0)   </span></span><br><span class="line"><span class="comment">                    t = t.left;     //在左子树上查找</span></span><br><span class="line"><span class="comment">                else if (cmp &gt; 0)   //在右子树上查找</span></span><br><span class="line"><span class="comment">                    t = t.right;</span></span><br><span class="line"><span class="comment">                else</span></span><br><span class="line"><span class="comment">                    return t.setValue(value);   找到了值的覆盖</span></span><br><span class="line"><span class="comment">            &#125; while (t != null);</span></span><br><span class="line"><span class="comment">        &#125;</span></span><br><span class="line"><span class="comment">         //创建一个节点</span></span><br><span class="line"><span class="comment">        Entry&lt;K,V&gt; e = new Entry&lt;&gt;(key, value, parent);</span></span><br><span class="line"><span class="comment">        </span></span><br><span class="line"><span class="comment">        if (cmp &lt; 0)</span></span><br><span class="line"><span class="comment">            parent.left = e;   //添加到左子树</span></span><br><span class="line"><span class="comment">        else</span></span><br><span class="line"><span class="comment">            parent.right = e;    //添加到右子树</span></span><br><span class="line"><span class="comment">        fixAfterInsertion(e);</span></span><br><span class="line"><span class="comment">        size++;      </span></span><br><span class="line"><span class="comment">        modCount++;</span></span><br><span class="line"><span class="comment">        return null;</span></span><br><span class="line"><span class="comment">    &#125;</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		<span class="comment">//创建集合对象</span></span><br><span class="line">		<span class="comment">//TreeMap treeMap=new TreeMap();</span></span><br><span class="line">		<span class="comment">//创建外部比较器对象,定义比较规则</span></span><br><span class="line">		Comparator comLength=<span class="keyword">new</span> CompareLength();</span><br><span class="line">		TreeMap treeMap=<span class="keyword">new</span> TreeMap(comLength);</span><br><span class="line">		<span class="comment">//添加数据</span></span><br><span class="line">		treeMap.put(<span class="string">"hello"</span>, <span class="number">123</span>);</span><br><span class="line">		treeMap.put(<span class="string">"world1"</span>, <span class="number">456</span>);</span><br><span class="line">		treeMap.put(<span class="string">"hello11"</span>, <span class="number">789</span>);</span><br><span class="line">		treeMap.put(<span class="string">"java"</span>, <span class="number">1000</span>);</span><br><span class="line">		System.out.println(<span class="string">"集合中元素的个数:"</span>+treeMap.size());</span><br><span class="line">		System.out.println(treeMap);</span><br><span class="line">		System.out.println(treeMap.containsKey(<span class="string">"hello"</span>)+<span class="string">"\t"</span>+treeMap.containsKey(<span class="string">"sql"</span>));</span><br><span class="line">		System.out.println(treeMap.containsValue(<span class="number">789</span>)+<span class="string">"\t"</span>+treeMap.containsValue(<span class="number">1002</span>));</span><br><span class="line">		System.out.println(treeMap.get(<span class="string">"java"</span>));</span><br><span class="line">		</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>编写一个外部比较器的实现类，用于实现根据英文字母的个数进行升序比较</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.bjsxt.treemap;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Comparator;</span><br><span class="line"><span class="comment">//编写一个外部比较器的实现类，用于实现根据英文字母的个数进行升序比较</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CompareLength</span> <span class="keyword">implements</span> <span class="title">Comparator</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">compare</span><span class="params">(Object o1, Object o2)</span> </span>&#123;</span><br><span class="line">		<span class="comment">//向下类型转换</span></span><br><span class="line">		String s1=(String)o1;</span><br><span class="line">		String s2=(String)o2;</span><br><span class="line">		<span class="keyword">return</span> s1.length()-s2.length();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="10-Set接口-HashSet的用法"><a href="#10-Set接口-HashSet的用法" class="headerlink" title="10 Set接口_HashSet的用法"></a>10 Set接口_<code>HashSet</code>的用法</h4><h4 id="10-1-Set接口"><a href="#10-1-Set接口" class="headerlink" title="10.1 Set接口"></a>10.1 Set接口</h4><p> Set接口的特点：唯一、无序</p>
<h5 id="10-2-HashSet用法"><a href="#10-2-HashSet用法" class="headerlink" title="10.2 HashSet用法"></a>10.2 <code>HashSet</code>用法</h5><p> //Student类 JavaBean</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.szxy.collection.set;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Student</span> </span>&#123;</span><br><span class="line">	<span class="keyword">private</span> String name;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">int</span> age;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">Student</span><span class="params">(String name, <span class="keyword">int</span> age)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">super</span>();</span><br><span class="line">		<span class="keyword">this</span>.name = name;</span><br><span class="line">		<span class="keyword">this</span>.age = age;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">Student</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">super</span>();</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> name;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.name = name;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getAge</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> age;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setAge</span><span class="params">(<span class="keyword">int</span> age)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.age = age;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">hashCode</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"hashCode()"</span>);</span><br><span class="line">		<span class="keyword">final</span> <span class="keyword">int</span> prime = <span class="number">31</span>;</span><br><span class="line">		<span class="keyword">int</span> result = <span class="number">1</span>;</span><br><span class="line">		result = prime * result + age;</span><br><span class="line">		result = prime * result + ((name == <span class="keyword">null</span>) ? <span class="number">0</span> : name.hashCode());</span><br><span class="line">		<span class="keyword">return</span> result;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">equals</span><span class="params">(Object obj)</span> </span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"equals()"</span>);</span><br><span class="line">		<span class="keyword">if</span> (<span class="keyword">this</span> == obj)</span><br><span class="line">			<span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">		<span class="keyword">if</span> (obj == <span class="keyword">null</span>)</span><br><span class="line">			<span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">		<span class="keyword">if</span> (getClass() != obj.getClass())</span><br><span class="line">			<span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">		Student other = (Student) obj;</span><br><span class="line">		<span class="keyword">if</span> (age != other.age)</span><br><span class="line">			<span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">		<span class="keyword">if</span> (name == <span class="keyword">null</span>) &#123;</span><br><span class="line">			<span class="keyword">if</span> (other.name != <span class="keyword">null</span>)</span><br><span class="line">				<span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">		&#125; <span class="keyword">else</span> <span class="keyword">if</span> (!name.equals(other.name))</span><br><span class="line">			<span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="string">"Student [name="</span> + name + <span class="string">", age="</span> + age + <span class="string">"]"</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>​    //测试类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.szxy.collection.set;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.HashSet;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestStudent</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		HashSet hs = <span class="keyword">new</span> HashSet();</span><br><span class="line">		</span><br><span class="line">		Student s1 = <span class="keyword">new</span> Student(<span class="string">"Jack"</span>,<span class="number">18</span>);</span><br><span class="line">		Student s2 = <span class="keyword">new</span> Student(<span class="string">"Tom"</span>,<span class="number">24</span>);</span><br><span class="line">		Student s3 = <span class="keyword">new</span> Student(<span class="string">"Jack"</span>,<span class="number">18</span>);</span><br><span class="line">		Student s4 = <span class="keyword">new</span> Student(<span class="string">"Marry"</span>,<span class="number">20</span>);</span><br><span class="line">		</span><br><span class="line">		</span><br><span class="line">		hs.add(s1);</span><br><span class="line">		hs.add(s2);</span><br><span class="line">		hs.add(s3);</span><br><span class="line">		hs.add(s4);</span><br><span class="line">		</span><br><span class="line">		System.out.println(hs);</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">	hashCode()</span></span><br><span class="line"><span class="comment">    hashCode()</span></span><br><span class="line"><span class="comment">    hashCode()</span></span><br><span class="line"><span class="comment">    equals()</span></span><br><span class="line"><span class="comment">    hashCode()</span></span><br><span class="line"><span class="comment">    [Student [name=Marry, age=20], Student [name=Tom, age=24], Student [name=Jack, age=18]]</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>

<h5 id="10-3-HashSet底层源码分析"><a href="#10-3-HashSet底层源码分析" class="headerlink" title="10.3 HashSet底层源码分析"></a>10.3 <code>HashSet</code>底层源码分析</h5><p><code>HashSet</code>底层数组结构使用的是hash表  ,主结构数组, +链表</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.bjsxt.hashset;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.HashSet;</span><br><span class="line"><span class="keyword">import</span> java.util.Iterator;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestHashSet</span> </span>&#123;</span><br><span class="line">	<span class="comment">/***</span></span><br><span class="line"><span class="comment">	 * HashSet底层源码分析</span></span><br><span class="line"><span class="comment">	 *  private transient HashMap&lt;E,Object&gt; map;</span></span><br><span class="line"><span class="comment">	 *   private static final Object PRESENT = new Object();</span></span><br><span class="line"><span class="comment">	 *  public HashSet() &#123;</span></span><br><span class="line"><span class="comment">             map = new HashMap&lt;&gt;();//创建HashSet时，底层创建的是一个HashMap对象</span></span><br><span class="line"><span class="comment">     &#125;</span></span><br><span class="line"><span class="comment">     public boolean add(E e) &#123;</span></span><br><span class="line"><span class="comment">                     key--&gt;e ,value--&gt;PRESENT ,是一个Object类型的对象</span></span><br><span class="line"><span class="comment">                     map集合中的所有value都是统一的Object类型对象</span></span><br><span class="line"><span class="comment">        return map.put(e, PRESENT)==null;</span></span><br><span class="line"><span class="comment">        </span></span><br><span class="line"><span class="comment">     &#125;</span></span><br><span class="line"><span class="comment">     public int size() &#123;</span></span><br><span class="line"><span class="comment">        return map.size();</span></span><br><span class="line"><span class="comment">    &#125;</span></span><br><span class="line"><span class="comment">    </span></span><br><span class="line"><span class="comment">     public boolean contains(Object o) &#123;</span></span><br><span class="line"><span class="comment">        return map.containsKey(o);  //在map集合中判断key是否存在</span></span><br><span class="line"><span class="comment">    &#125;</span></span><br><span class="line"><span class="comment">    public Iterator&lt;E&gt; iterator() &#123;</span></span><br><span class="line"><span class="comment">          //获取map集合中所有的key的集合，再得到迭代器对象</span></span><br><span class="line"><span class="comment">        return map.keySet().iterator();</span></span><br><span class="line"><span class="comment">    &#125;</span></span><br><span class="line"><span class="comment">    HashSet使用了HashMap的数据结构，</span></span><br><span class="line"><span class="comment">         底层都是哈希表 (顺序表+链表)</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@param</span> args</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		<span class="comment">//HashSet底层数组结构使用的是hash表  ,主结构数组, +链表</span></span><br><span class="line">		<span class="comment">//创建集合对象</span></span><br><span class="line">		HashSet hs=<span class="keyword">new</span> HashSet();</span><br><span class="line">		hs.add(<span class="string">"hello"</span>);</span><br><span class="line">		hs.add(<span class="string">"world"</span>);</span><br><span class="line">		hs.add(<span class="string">"java"</span>);</span><br><span class="line">		System.out.println(hs.add(<span class="string">"world"</span>));</span><br><span class="line">		System.out.println(<span class="string">"集合中元素的个数:"</span>+hs.size());</span><br><span class="line">		System.out.println(hs);</span><br><span class="line">		System.out.println(hs.contains(<span class="string">"java"</span>)+<span class="string">"\t"</span>+hs.contains(<span class="string">"sql"</span>));</span><br><span class="line">		<span class="comment">//使用迭代器遍历元素</span></span><br><span class="line">		Iterator ite=hs.iterator();</span><br><span class="line">		<span class="keyword">while</span>(ite.hasNext())&#123;</span><br><span class="line">			System.out.println(ite.next());</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="11-TreeSet-用法和底层源码"><a href="#11-TreeSet-用法和底层源码" class="headerlink" title="11 TreeSet  用法和底层源码"></a>11 <code>TreeSet</code>  用法和底层源码</h4><h5 id="11-1-TreeMap-的使用和TreeMap的底层实现"><a href="#11-1-TreeMap-的使用和TreeMap的底层实现" class="headerlink" title="11.1 TreeMap 的使用和TreeMap的底层实现"></a>11.1 <code>TreeMap</code> 的使用和<code>TreeMap</code>的底层实现</h5><p>Key：唯一，有序，升序</p>
<p>如果使用<code>Treemap</code>存储自定义对象作为key时，要求必须具备比较规则，否则运行报错</p>
<h5 id="11-2-TreeSet-的使用和-TreeSet-的底层实现"><a href="#11-2-TreeSet-的使用和-TreeSet-的底层实现" class="headerlink" title="11.2 TreeSet 的使用和 TreeSet 的底层实现"></a>11.2 <code>TreeSet</code> 的使用和 <code>TreeSet</code> 的底层实现</h5><p>1  <code>TreeMap</code>  (key,唯一，而且有序，升序)，底层数据结构是红黑树，</p>
<p>而且 <code>TreeMap</code> 中可以实际上就是一个 <code>TreeSet</code>，如果使用自定义对象</p>
<p>作为 key，要求<strong>必须具备比较规则</strong></p>
<p>2 使用 <code>TreeMap</code>  要求使用内部比较器和外部比较器</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.bjsxt.treeset;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Comparator;</span><br><span class="line"><span class="keyword">import</span> java.util.NavigableMap;</span><br><span class="line"><span class="keyword">import</span> java.util.TreeMap;</span><br><span class="line"><span class="keyword">import</span> java.util.TreeSet;</span><br><span class="line"></span><br><span class="line"><span class="comment">/** </span></span><br><span class="line"><span class="comment"> * TreeSet的底层所使用的是TreeMap   --&gt;红黑树</span></span><br><span class="line"><span class="comment"> * TreeSet JDK源码分析</span></span><br><span class="line"><span class="comment"> *  private transient NavigableMap&lt;E,Object&gt; m;  //一个接口,间接继承了Map</span></span><br><span class="line"><span class="comment"> *    private static final Object PRESENT = new Object();</span></span><br><span class="line"><span class="comment"> *  public TreeSet() &#123;</span></span><br><span class="line"><span class="comment">        this(new TreeMap&lt;E,Object&gt;());  //创建了一个TreeMap的对象</span></span><br><span class="line"><span class="comment">    &#125;</span></span><br><span class="line"><span class="comment">    //调用的本类中的带参构造方法</span></span><br><span class="line"><span class="comment">    TreeSet(NavigableMap&lt;E,Object&gt; m) &#123;</span></span><br><span class="line"><span class="comment">        this.m = m;   //接口new 实现类</span></span><br><span class="line"><span class="comment">    &#125;</span></span><br><span class="line"><span class="comment">     public TreeSet(Comparator&lt;? super E&gt; comparator) &#123;</span></span><br><span class="line"><span class="comment">        this(new TreeMap&lt;&gt;(comparator));  //调用了本类中的带参构造方法</span></span><br><span class="line"><span class="comment">    &#125;</span></span><br><span class="line"><span class="comment">    添加方法</span></span><br><span class="line"><span class="comment">     public boolean add(E e) &#123;</span></span><br><span class="line"><span class="comment">        return m.put(e, PRESENT)==null;  //传入的元素作为Map中的key，统一的值为Object类型的对象</span></span><br><span class="line"><span class="comment">    &#125;</span></span><br><span class="line"><span class="comment">    public int size() &#123;</span></span><br><span class="line"><span class="comment">        return m.size();</span></span><br><span class="line"><span class="comment">    &#125;</span></span><br><span class="line"><span class="comment">    </span></span><br><span class="line"><span class="comment">    </span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Administrator</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestTreeSet</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">	</span><br><span class="line">		<span class="comment">//创建集合对象</span></span><br><span class="line">		<span class="comment">//TreeSet ts=new TreeSet();</span></span><br><span class="line">		<span class="comment">//Comparator comc=new ComCharactor();//创建外部比较器对象</span></span><br><span class="line">		Comparator com=<span class="keyword">new</span> ComCharactorAndAge();</span><br><span class="line">		TreeSet ts=<span class="keyword">new</span> TreeSet(com);</span><br><span class="line">		<span class="comment">//创建Person对象</span></span><br><span class="line">		Person p1=<span class="keyword">new</span> Person(<span class="string">"marry"</span>, <span class="number">20</span>);</span><br><span class="line">		Person p2=<span class="keyword">new</span> Person(<span class="string">"lili"</span>, <span class="number">19</span>);</span><br><span class="line">		Person p3=<span class="keyword">new</span> Person(<span class="string">"jack"</span>, <span class="number">20</span>);</span><br><span class="line">		Person p4=<span class="keyword">new</span> Person(<span class="string">"marry"</span>, <span class="number">18</span>);</span><br><span class="line">		<span class="comment">//添加到集合中</span></span><br><span class="line">		ts.add(p1);</span><br><span class="line">		ts.add(p2);</span><br><span class="line">		ts.add(p3);</span><br><span class="line">		ts.add(p4);</span><br><span class="line">		System.out.println(<span class="string">"集合中元素的个数:"</span>+ts.size());</span><br><span class="line">		System.out.println(ts);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">[Person [name=aMarry, age=7], Person [name=aMarry, age=10], Person [name=bTom, age=14], Person [name=cJack, age=20]]</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">/*</span></span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.szxy.collection.treeset;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Comparator;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 外部比较器，即先比较名字，当名字相同的时候，比较年龄</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> wzer</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ComparotAgeandName</span> <span class="keyword">implements</span> <span class="title">Comparator</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">compare</span><span class="params">(Object o1, Object o2)</span> </span>&#123;</span><br><span class="line">		<span class="comment">// TODO 自动生成的方法存根</span></span><br><span class="line">		Person p1 = (Person)o1;</span><br><span class="line">		Person p2 = (Person)o2;</span><br><span class="line">		<span class="keyword">if</span>(p1.getName().compareTo(p2.getName())&gt;<span class="number">0</span>)&#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">		&#125;<span class="keyword">else</span> <span class="keyword">if</span>(p1.getName().compareTo(p2.getName())&lt;<span class="number">0</span>)&#123;</span><br><span class="line">			<span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">		&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">			<span class="keyword">return</span> p1.getAge()-p2.getAge();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.szxy.collection.treeset;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Comparator;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 外部比较器</span></span><br><span class="line"><span class="comment"> * 只比较年龄大小   实现Comparator接口</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> wzer</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CompartorAge</span> <span class="keyword">implements</span> <span class="title">Comparator</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">compare</span><span class="params">(Object o1, Object o2)</span> </span>&#123;</span><br><span class="line">		Person p1 = (Person)o1;</span><br><span class="line">		Person p2 = (Person)o2;</span><br><span class="line">		<span class="keyword">return</span>  p1.getAge()-p2.getAge();</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="12-泛型"><a href="#12-泛型" class="headerlink" title="12 泛型"></a>12 泛型</h5><h5 id="12-1-泛型的概念"><a href="#12-1-泛型的概念" class="headerlink" title="12.1 泛型的概念"></a>12.1 泛型的概念</h5><p>提出 JDK1.5新特性</p>
<p>在创建集合对象时，明确集合中所存储的元素类型</p>
<p>  泛型：在定义集合的时候同时定义集合中对象的类型</p>
<p>好处：增强程序的可读性和安全性</p>
<h5 id="12-2-泛型的分类"><a href="#12-2-泛型的分类" class="headerlink" title="12.2 泛型的分类"></a>12.2 泛型的分类</h5><p>1 泛型类</p>
<p>2 泛型接口</p>
<p>3 泛型方法   </p>
<p>解决了参数个数相同的情况下的方法重载</p>
<p>​    可变参数的泛型方法，解决参数的个数不同，类型不同的方法重载</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.szxy.genenic;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">interface</span> <span class="title">MyInter</span>&lt;<span class="title">T</span>&gt;</span>&#123;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyIplem</span>&lt;<span class="title">T</span>&gt; <span class="keyword">implements</span> <span class="title">MyInter</span>&lt;<span class="title">T</span>&gt;</span>&#123;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyIplem2</span>&lt;<span class="title">Integer</span>&gt; <span class="keyword">implements</span> <span class="title">MyInter</span>&lt;<span class="title">Integer</span>&gt;</span>&#123;</span><br><span class="line">	</span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestGenenic</span>&lt;<span class="title">T</span>&gt;</span>&#123;</span><br><span class="line">	<span class="keyword">public</span> &lt;T&gt; <span class="function"><span class="keyword">void</span> <span class="title">show</span><span class="params">(T t)</span></span>&#123;<span class="comment">//创建TestGenenic对象是决定</span></span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">public</span> &lt;Q&gt; <span class="function"><span class="keyword">void</span> <span class="title">method</span><span class="params">(Q q)</span></span>&#123;<span class="comment">//在调用method这个方法是明确</span></span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">public</span> &lt;K&gt; <span class="function"><span class="keyword">void</span> <span class="title">fun</span><span class="params">(K...k)</span></span>&#123;<span class="comment">//可变泛型方法</span></span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; k.length; i++) &#123;</span><br><span class="line">			System.out.println(k[i]);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Genenic</span></span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		MyInter&lt;String&gt; mi = <span class="keyword">new</span> MyIplem&lt;String&gt;();</span><br><span class="line">		MyInter&lt;Integer&gt; mi2 = <span class="keyword">new</span> MyIplem2&lt;Integer&gt;();</span><br><span class="line">		</span><br><span class="line">		TestGenenic&lt;String &gt; tg = <span class="keyword">new</span> TestGenenic&lt;String&gt;();</span><br><span class="line">		tg.show(<span class="string">"adb"</span>);</span><br><span class="line">		tg.method(<span class="number">123</span>);</span><br><span class="line">		tg.method(<span class="string">"1232"</span>);</span><br><span class="line">		tg.method(<span class="string">"234"</span>);</span><br><span class="line">		</span><br><span class="line">		tg.fun(<span class="number">1312</span>);</span><br><span class="line">		tg.fun(<span class="number">123</span>,<span class="number">23324</span>,<span class="string">"324"</span>);</span><br><span class="line">				</span><br><span class="line"> 	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="13-泛型的高级使用和-容器中使用的泛型"><a href="#13-泛型的高级使用和-容器中使用的泛型" class="headerlink" title="13 泛型的高级使用和 容器中使用的泛型"></a>13 泛型的高级使用和 容器中使用的泛型</h4><h5 id="13-1-泛型的高级使用"><a href="#13-1-泛型的高级使用" class="headerlink" title="13.1 泛型的高级使用"></a>13.1 泛型的高级使用</h5><p><strong>目标：根据泛型的上限和下限，在API看懂方法参数</strong> </p>
<p>泛型的上限：使用关键字 <code>extends</code> 表示参数化类型可能是所指定的类型或者是此类型的<strong>子类</strong></p>
<p>泛型的下限：使用关键字 <code>supper</code>进行声明，表示参数化类型可能是所指定的类型或者是此类型的<strong>父类</strong>，直至 <code>Object</code>  类</p>
<h5 id="13-2-容器中使用的泛型"><a href="#13-2-容器中使用的泛型" class="headerlink" title="13.2 容器中使用的泛型"></a>13.2 容器中使用的泛型</h5><pre><code>注意：泛型只看编译期间起作用</code></pre><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.szxy.genenic;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.HashSet;</span><br><span class="line"><span class="keyword">import</span> java.util.LinkedList;</span><br><span class="line"><span class="keyword">import</span> java.util.TreeMap;</span><br><span class="line"><span class="keyword">import</span> java.util.TreeSet;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test2</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		ArrayList&lt;String&gt;  al = <span class="keyword">new</span> ArrayList&lt;String&gt;();</span><br><span class="line">		al.add(<span class="string">"HelloWorld"</span>);</span><br><span class="line">		</span><br><span class="line">		</span><br><span class="line">		LinkedList&lt;Integer&gt; ll = <span class="keyword">new</span> LinkedList&lt;&gt;();</span><br><span class="line">		ll.add(<span class="number">111</span>);<span class="comment">//自动装箱</span></span><br><span class="line">		</span><br><span class="line">		Person p1 = <span class="keyword">new</span> Person(<span class="string">"龟"</span>,<span class="number">123</span>);</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//存储自定义对象是，要求Person类重写hashcode方法和equals方法</span></span><br><span class="line">		HashSet&lt;Person&gt; hs = <span class="keyword">new</span> HashSet&lt;Person&gt;();</span><br><span class="line">		hs.add(p1);</span><br><span class="line">		System.out.println(hs);</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//Person对象具备比较规则，要求有内部比较器或外部比较器</span></span><br><span class="line">		TreeSet&lt;Person&gt; ts = <span class="keyword">new</span> TreeSet&lt;Person&gt;();</span><br><span class="line">		ts.add(p1);</span><br><span class="line"></span><br><span class="line">		<span class="comment">//</span></span><br><span class="line">		HashMap&lt;Person, Integer&gt; hm = <span class="keyword">new</span> HashMap&lt;Person,Integer&gt;();</span><br><span class="line">		hm.put(p1,<span class="number">123</span>);<span class="comment">//123自动装箱</span></span><br><span class="line">		</span><br><span class="line">		TreeMap&lt;Person,Integer&gt; tm = <span class="keyword">new</span> TreeMap&lt;Person,Integer&gt;();</span><br><span class="line">		tm.put(p1,<span class="number">123</span>);</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//泛型只看编译期间起作用</span></span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="14-迭代器"><a href="#14-迭代器" class="headerlink" title="14 迭代器"></a>14 迭代器</h4><h5 id="14-1-遍历-List-Set"><a href="#14-1-遍历-List-Set" class="headerlink" title="14.1  遍历 List Set"></a>14.1  遍历 List Set</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.szxy.iterator;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.ConcurrentModificationException;</span><br><span class="line"><span class="keyword">import</span> java.util.HashSet;</span><br><span class="line"><span class="keyword">import</span> java.util.Iterator;</span><br><span class="line"><span class="keyword">import</span> java.util.NoSuchElementException;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 遍历	</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> wzer</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestIterator</span> </span>&#123;</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 *    public boolean hasNext() &#123;</span></span><br><span class="line"><span class="comment">            return cursor != size;</span></span><br><span class="line"><span class="comment">        &#125;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">        public E next() &#123;</span></span><br><span class="line"><span class="comment">            checkForComodification();</span></span><br><span class="line"><span class="comment">            int i = cursor;</span></span><br><span class="line"><span class="comment">            cursor = i + 1;</span></span><br><span class="line"><span class="comment">            return (E) elementData[lastRet = i];</span></span><br><span class="line"><span class="comment">        &#125;</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@param</span> args</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		ArrayList&lt;Integer&gt; al = <span class="keyword">new</span> ArrayList&lt;Integer&gt;();</span><br><span class="line">		al.add(<span class="number">123</span>);</span><br><span class="line">		al.add(<span class="number">456</span>);</span><br><span class="line">		al.add(<span class="number">789</span>);</span><br><span class="line">		<span class="comment">//遍历     1.判断？，2,返回</span></span><br><span class="line">		<span class="keyword">for</span>(Iterator ite = al.iterator();ite.hasNext();)&#123;</span><br><span class="line">			System.out.println(ite.next());</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		HashSet&lt;String&gt; hs = <span class="keyword">new</span> HashSet&lt;String&gt;();</span><br><span class="line">		hs.add(<span class="string">"abc"</span>);</span><br><span class="line">		hs.add(<span class="string">"ytg"</span>);</span><br><span class="line">		hs.add(<span class="string">"AJ"</span>);</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//遍历</span></span><br><span class="line">		<span class="keyword">for</span>(Iterator ite = hs.iterator();ite.hasNext();)&#123;</span><br><span class="line">			System.out.println(ite.next());</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="http://www.zwer.xyz/Itetator.png" alt="1541675584800"></p>
<h5 id="14-2-遍历-Map"><a href="#14-2-遍历-Map" class="headerlink" title="14.2 遍历 Map"></a>14.2 遍历 Map</h5><p><code>ListIterator</code>是 Iterator 接口的扩展，用于解决并发遍历</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.szxy.iterator;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.ListIterator;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestListIterator</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		ArrayList&lt;String&gt; al = <span class="keyword">new</span> ArrayList&lt;String&gt;();</span><br><span class="line">		al.add(<span class="string">"Hello"</span>);</span><br><span class="line">		al.add(<span class="string">"world"</span>);</span><br><span class="line">		al.add(<span class="string">"Java"</span>);</span><br><span class="line">		</span><br><span class="line">		ListIterator&lt;String&gt; ite =   al.listIterator();</span><br><span class="line">		<span class="keyword">while</span>(ite.hasNext())&#123;</span><br><span class="line">			String str =ite.next();</span><br><span class="line">			<span class="keyword">if</span>(<span class="string">"world"</span>.equals(str))&#123;</span><br><span class="line">				ite.add(<span class="string">"you"</span>);<span class="comment">//添加使用ite</span></span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		System.out.println(al);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">	[Hello, world, you, Java]</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>

<p>测试 <code>HashMap</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.szxy.iterator;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.Map.Entry;</span><br><span class="line"><span class="keyword">import</span> java.util.Set;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestListIterator3</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		HashMap&lt;String,Integer&gt;  hs = <span class="keyword">new</span> HashMap&lt;String,Integer&gt;();</span><br><span class="line">		hs.put(<span class="string">"Hello"</span>, <span class="number">123</span>);</span><br><span class="line">		hs.put(<span class="string">"World"</span>, <span class="number">567</span>);</span><br><span class="line">		hs.put(<span class="string">"Java"</span>,<span class="number">123</span>);</span><br><span class="line">		<span class="comment">//遍历</span></span><br><span class="line">		<span class="keyword">for</span>(String key:hs.keySet())&#123;</span><br><span class="line">			System.out.println(hs.get(key));</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="comment">//获取键和值</span></span><br><span class="line">		Set&lt;Entry&lt;String,Integer&gt;&gt; set = hs.entrySet();</span><br><span class="line">		<span class="keyword">for</span>(Entry&lt;String,Integer&gt; en:set)&#123;</span><br><span class="line">			System.out.println(en.getKey()+<span class="string">"\t"</span>+en.getValue());</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line"> 	&#125;</span><br><span class="line">&#125;	</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">123</span></span><br><span class="line"><span class="comment">123</span></span><br><span class="line"><span class="comment">567</span></span><br><span class="line"><span class="comment">Java	123</span></span><br><span class="line"><span class="comment">Hello	123</span></span><br><span class="line"><span class="comment">World	567</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>

<h4 id="15-容器总结"><a href="#15-容器总结" class="headerlink" title="15  容器总结"></a>15  容器总结</h4><p><img src="http://www.zwer.xyz/CollectionAndMap.png" alt="CollectionAndMap"></p>
<p><img src="http://www.zwer.xyz/CollectionAndMap%20of%20Summary.jpg" alt="19.集合体系框架总结"></p>

        
      
    </div>

    
    
    
      <footer class="post-footer">
          <div class="post-eof"></div>
        
      </footer>
  </div>
  
  
  
  </article>

    
  </div>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/6/"><i class="fa fa-angle-left" aria-label="Previous page"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/6/">6</a><span class="page-number current">7</span><a class="page-number" href="/page/8/">8</a><a class="extend next" rel="next" href="/page/8/"><i class="fa fa-angle-right" aria-label="Next page"></i></a>
  </nav>


          </div>
          

        </div>
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">zwer</p>
  <div class="site-description" itemprop="description">记录学习的日常</div>
</div>
  <nav class="site-state motion-element">
      <div class="site-state-item site-state-posts">
        
          <a href="/archives/">
        
          <span class="site-state-item-count">74</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
    
      
      
      <div class="site-state-item site-state-categories">
        
        <span class="site-state-item-count">10</span>
        <span class="site-state-item-name">categories</span>
        
      </div>
    
      
      
      <div class="site-state-item site-state-tags">
        
        <span class="site-state-item-count">51</span>
        <span class="site-state-item-name">tags</span>
        
      </div>
    
  </nav>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love" id="animate">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">zwer</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io" class="theme-link" rel="noopener" target="_blank">Hexo</a> v3.9.0</div>
  <span class="post-meta-divider">|</span>
  <div class="theme-info">Theme – <a href="https://theme-next.org" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a> v7.4.0</div>

        












        
      </div>
    </footer>
  </div>

  


  <script src="/lib/anime.min.js?v=3.1.0"></script>
  <script src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  <script src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
<script src="/js/utils.js?v=7.4.0"></script><script src="/js/motion.js?v=7.4.0"></script>
<script src="/js/schemes/muse.js?v=7.4.0"></script>
<script src="/js/next-boot.js?v=7.4.0"></script>



  





















  

  

  

</body>
</html>
